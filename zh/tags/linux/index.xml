<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>linux on è¿‡æ²³å’</title>
    <link>https://ramsayleung.github.io/zh/tags/linux/</link>
    <description>Recent content in linux on è¿‡æ²³å’</description>
    <image>
      <title>è¿‡æ²³å’</title>
      <url>https://ramsayleung.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E</url>
      <link>https://ramsayleung.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E</link>
    </image>
    <generator>Hugo -- 0.120.4</generator>
    <language>zh</language>
    <copyright>See this site&amp;rsquo;s source code here, licensed under GPLv3 Â·</copyright>
    <lastBuildDate>Thu, 09 Jan 2025 20:52:24 -0800</lastBuildDate>
    <atom:link href="https://ramsayleung.github.io/zh/tags/linux/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Linuxä¸‹å¦‚ä½•é¿å…è“ç‰™éŸ³ç®±è‡ªåŠ¨å…³æœº</title>
      <link>https://ramsayleung.github.io/zh/post/2023/linux%E4%B8%8B%E5%A6%82%E4%BD%95%E9%81%BF%E5%85%8D%E8%93%9D%E7%89%99%E9%9F%B3%E7%AE%B1%E8%87%AA%E5%8A%A8%E5%85%B3%E6%9C%BA/</link>
      <pubDate>Mon, 15 May 2023 20:48:00 -0700</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2023/linux%E4%B8%8B%E5%A6%82%E4%BD%95%E9%81%BF%E5%85%8D%E8%93%9D%E7%89%99%E9%9F%B3%E7%AE%B1%E8%87%AA%E5%8A%A8%E5%85%B3%E6%9C%BA/</guid>
      <description>1 é—®é¢˜ æœ€è¿‘æ•´ç†äº†æ¡Œä¸Šä¹±ç³Ÿç³Ÿçš„çº¿ï¼ŒæŠŠåŸæ¥ä½¿ç”¨aux çº¿è¿æ¥çš„è“ç‰™éŸ³å“æ¢æˆé€šè¿‡è“ç‰™è¿æ¥ã€‚ ç„¶åå°±å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œåªè¦éŸ³å“æ²¡æœ‰å‘å‡ºå£°éŸ³è¶…è¿‡30åˆ†é’Ÿï¼Œè“ç‰™</description>
      <content:encoded><![CDATA[<h2 id="é—®é¢˜"><span class="section-num">1</span> é—®é¢˜</h2>
<p>æœ€è¿‘æ•´ç†äº†æ¡Œä¸Šä¹±ç³Ÿç³Ÿçš„çº¿ï¼ŒæŠŠåŸæ¥ä½¿ç”¨aux çº¿è¿æ¥çš„è“ç‰™éŸ³å“æ¢æˆé€šè¿‡è“ç‰™è¿æ¥ã€‚ <br/></p>
<p>ç„¶åå°±å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œåªè¦éŸ³å“æ²¡æœ‰å‘å‡ºå£°éŸ³è¶…è¿‡30åˆ†é’Ÿï¼Œè“ç‰™éŸ³å“å°±ä¼šæ–­å¼€è¿æ¥ï¼Œå¹¶ä¸”è‡ªåŠ¨å…³æœºï¼Œå³ä½¿è“ç‰™éŸ³å“è¿æ¥ç€ç”µæºã€‚ <br/></p>
<p>ä¸€ç•ªæœç´¢ä¹‹åï¼Œå°±åœ¨çŸ¥ä¹ä¸Šå‘ç°äº†è¿™ä¸ªé—®é¢˜ï¼š<a href="https://www.zhihu.com/question/41682642">æ±‚é—®å¦‚ä½•é¿å…è“ç‰™éŸ³ç®±è‡ªåŠ¨å…³æœºï¼Ÿ</a> <br/></p>
<p>ä½†é‡Œé¢æåˆ°çš„è§£å†³æ–¹æ¡ˆï¼Œå¤§å¤šåªé€‚ç”¨äºç‰¹å®šå¹³å°ï¼Œä¾‹å¦‚Windows æˆ–è€…Macos, æ²¡æœ‰æåˆ° Linux ä¸Šçš„è§£å†³æ–¹æ¡ˆã€‚ <br/></p>
<p>æ¯è¿‡åŠä¸ªå°æ—¶æ‰‹åŠ¨æ‰“å¼€è“ç‰™éŸ³å“å†è¿æ¥çš„æ–¹å¼ï¼Œå®åœ¨æ˜¯å¤ªè ¢äº†ã€‚ <br/></p>
<h2 id="çµæ„Ÿ"><span class="section-num">2</span> çµæ„Ÿ</h2>
<p>ä½†æ˜¯çŸ¥ä¹é—®é¢˜é‡Œé¢çš„éƒ¨åˆ†å›ç­”ç»™äº†æˆ‘çµæ„Ÿï¼Œè®©æˆ‘ä»¬æƒ³èµ·å›½å†…æŸäº›APP ä¸ºäº†ä¿æ´»ï¼Œé¿å…è¢«ç³»ç»Ÿkill æ‰ï¼Œåœ¨åå°æ’­æ”¾æ— å£°éŸ³é¢‘çš„æ“ä½œã€‚ <br/></p>
<p>æˆ‘å¯ä»¥ä»¥ä½éŸ³é‡å¾ªç¯æ’­æ”¾ä¸€æ®µéŸ³é¢‘ï¼Œä»¥å®ç°ä¿æ´»çš„ä½œç”¨ï¼š <br/></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">mpg123 -f <span class="m">1000</span> ~/music/listen_to_the_sea.mp3 --loop -1
</span></span></code></pre></td></tr></table>
</div>
</div><p>mpg123 æ˜¯mp3 æ’­æ”¾å‘½ä»¤è¡Œï¼Œ <code>-f 1000</code> å‚æ•°çš„å«ä¹‰æ˜¯ï¼š100%çš„éŸ³é‡æ˜¯32768, 1000 çº¦ç­‰äºæ˜¯1000/32768 = 3% çš„éŸ³é‡ï¼Œ <code>-loop -1</code> å°±æ˜¯æŒ‡æ— é™å¾ªç¯æ’­æ”¾ã€‚ <br/></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">man mpg123
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-f factor, --scale factor
</span></span><span class="line"><span class="cl">Change scale factor <span class="o">(</span>default: 32768<span class="o">)</span>.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">--loop <span class="nb">times</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> looping track<span class="o">(</span>s<span class="o">)</span> a certain number of times, &lt; <span class="m">0</span> means infinite loop <span class="o">(</span>not with --random!<span class="o">)</span>.
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ä¼˜åŒ–"><span class="section-num">3</span> ä¼˜åŒ–</h2>
<p>è¿™æ ·å°±å®ç°äº†ä¸€ä¸ªå¯ç”¨çš„ç‰ˆæœ¬ï¼Œåªæ˜¯è¿˜è¦ä¾èµ–ä¸€ä¸ª mp3 æ–‡ä»¶ï¼Œè‚¯å®šè¿˜æœ‰ä¼˜åŒ–çš„ç©ºé—´ã€‚ <br/></p>
<p>ä¸€ç•ªè°ƒç ”ä¹‹åå‘ç°ï¼Œ <code>play/sox</code> å‘½ä»¤å¯ä»¥æ’­æ”¾æŒ‡å®šé¢‘ç‡å’Œæ—¶é•¿çš„å£°éŸ³ï¼Œå¯ä»¥æ’­æ”¾20 hzä»¥ä¸‹çš„å£°éŸ³ï¼Œè¿™ä¸ªé¢‘ç‡ä¸‹çš„å£°éŸ³äººè€³æ˜¯å¬ä¸åˆ°çš„ï¼š <br/></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">play -q -n synth <span class="m">10</span> sin <span class="m">20</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>-q</code>: ä¸æ˜¾ç¤ºæ’­æ”¾è¿›åº¦æ¡ <br/></li>
<li><code>-n synth 10</code> æ’­æ”¾10ç§’çš„éŸ³é¢‘ <br/></li>
<li><code>sin 20</code> é¢‘ç‡ä¸º20 hz(å¦‚æœå¬åˆ°äº†ï¼Œå¯ä»¥è®¾ç½®æˆæ›´ä½) <br/></li>
</ul>
<p>æ‰§è¡Œå‘½ä»¤ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨ <code>pavucontrol</code> å‘½ä»¤æŸ¥çœ‹å£°éŸ³è¾“å‡ºï¼Œåº”è¯¥æ˜¯ç±»ä¼¼è¿™æ ·çš„æ•ˆæœï¼š <br/></p>
<p><figure>
    <img loading="lazy" src="/ox-hugo/sox_pavucontrol.png"/> 
</figure>
 <br/></p>
<h2 id="å®šæ—¶æ‰§è¡Œ"><span class="section-num">4</span> å®šæ—¶æ‰§è¡Œ</h2>
<p>ä¸€ç›´å¼€ç€ä¸ªterminal çª—å£è¿è¡Œå‘½ä»¤æœ‰ç‚¹éº»çƒ¦ï¼Œè¿™ç§é‡å¤æ€§çš„å·¥ä½œï¼Œå°±å¯ä»¥äº¤ç»™ crontab, è®©å®ƒæ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œæ¯æ¬¡æ’­æ”¾10ç§’ã€‚ <br/></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">* * * * * play -q -n synth <span class="m">10</span> sin <span class="m">20</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½†å®é™…è¿è¡Œï¼Œå‘ç°å£°éŸ³ä¸èƒ½å¦‚é¢„æœŸé‚£æ ·æ’­æ”¾ã€‚ä¸€ç•ªæœç´¢ä¹‹åï¼Œå‘ç° <a href="https://askubuntu.com/questions/832072/can-i-use-cron-to-chime-at-top-of-hour-like-a-grandfather-clock">StackExchange</a> ä¸Šæœ‰ä¸ªç­”æ¡ˆæåˆ°éœ€è¦ export ä¸ªç¯å¢ƒå˜é‡ï¼Œæ‰€ä»¥æœ€å¥½åˆ›å»ºä¸ªè„šæœ¬ <code>play_beep.sh</code>: <br/></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nb">export</span> <span class="nv">XDG_RUNTIME_DIR</span><span class="o">=</span>/run/user/1000
</span></span><span class="line"><span class="cl">play -q -n synth <span class="m">10</span> sin <span class="m">10</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="k">$(</span>date<span class="k">)</span> <span class="c1"># æ‰“å°æ—¥æœŸï¼Œä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿æ’æŸ¥</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åå†å®‰è£…ä¸€ä¸ª crontab ä»»åŠ¡: <br/></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">* * * * * /usr/bin/sh /home/ramsay/code/shell/play_beep.sh &gt;&gt; /tmp/beep.log 2&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç»è¿‡éªŒè¯ï¼Œä¸€å¤©éƒ½æ²¡æœ‰æ–­å¼€è¿‡è“ç‰™ï¼Œè‡ªåŠ¨å…³æœºäº†ã€‚ <br/></p>
<h2 id="å‚è€ƒ"><span class="section-num">5</span> å‚è€ƒ</h2>
<ul>
<li><a href="https://www.zhihu.com/question/41682642">æ±‚é—®å¦‚ä½•é¿å…è“ç‰™éŸ³ç®±è‡ªåŠ¨å…³æœºï¼Ÿ</a> <br/></li>
<li><a href="https://askubuntu.com/questions/832072/can-i-use-cron-to-chime-at-top-of-hour-like-a-grandfather-clock/832266#832266">Can I use cron to chime at top of hour like a grandfather clock?</a> <br/></li>
</ul>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
]]></content:encoded>
    </item>
    <item>
      <title>lsof can&#39;t identify protocol</title>
      <link>https://ramsayleung.github.io/zh/post/2018/lsof_cant_identify_protocol/</link>
      <pubDate>Wed, 11 Apr 2018 15:24:00 +0800</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2018/lsof_cant_identify_protocol/</guid>
      <description>Socket æ³„æ¼å¼•èµ·çš„Tomcat å®•æœºé—®é¢˜åˆ†æ åœ¨2018å¹´4æœˆ9å·ä¸‹åˆï¼Œæ”¶åˆ°åé¦ˆï¼šæµ‹è¯•é›†ç¾¤éƒ¨åˆ†æ¥å£è®¿é—®æœ‰é—®é¢˜ï¼Œè¯·æ±‚æ—¶è€Œæ­£å¸¸ï¼Œæ—¶è€Œè¶…æ—¶ã€‚ æœ€è¿‘çš„æµ‹è¯•ç¯å¢ƒçœŸ</description>
      <content:encoded><![CDATA[<p>Socket æ³„æ¼å¼•èµ·çš„Tomcat å®•æœºé—®é¢˜åˆ†æ</p>
<p>åœ¨2018å¹´4æœˆ9å·ä¸‹åˆï¼Œæ”¶åˆ°åé¦ˆï¼šæµ‹è¯•é›†ç¾¤éƒ¨åˆ†æ¥å£è®¿é—®æœ‰é—®é¢˜ï¼Œè¯·æ±‚æ—¶è€Œæ­£å¸¸ï¼Œæ—¶è€Œè¶…æ—¶ã€‚</p>
<p>æœ€è¿‘çš„æµ‹è¯•ç¯å¢ƒçœŸçš„æ˜¯é—®é¢˜å¤šå¤šï¼Œå¯æ˜¯æµ‹è¯•ç¯å¢ƒå°±æ˜¯æˆ‘æ­å»ºçš„ï¼Œå†ã€‚æŸ¥çœ‹æ—¥å¿—å‘ç°87 è¿™å° æœåŠ¡å™¨çš„Tomcat æ— æ³•è®¿é—®ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">2018-04-09 17:41:31,568 - [ERROR] - from org.apache.tomcat.util.net.NioEndpoint in http-nio-47001-Acceptor-0
</span></span><span class="line"><span class="cl">Socket accept failed
</span></span><span class="line"><span class="cl">java.io.IOException: Too many open files
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept0(Native Method)
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:422)
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:250)
</span></span><span class="line"><span class="cl">at org.apache.tomcat.util.net.NioEndpoint$Acceptor.run(NioEndpoint.java:825)
</span></span><span class="line"><span class="cl">at java.lang.Thread.run(Thread.java:745)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2018-04-09 17:41:33,168 - [ERROR] - from org.apache.tomcat.util.net.NioEndpoint in http-nio-47001-Acceptor-0
</span></span><span class="line"><span class="cl">Socket accept failed
</span></span><span class="line"><span class="cl">java.io.IOException: Too many open files
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept0(Native Method)
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:422)
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:250)
</span></span><span class="line"><span class="cl">at org.apache.tomcat.util.net.NioEndpoint$Acceptor.run(NioEndpoint.java:825)
</span></span><span class="line"><span class="cl">at java.lang.Thread.run(Thread.java:745)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="linux-æ–‡ä»¶å¥æŸ„é™åˆ¶"><span class="section-num">1</span> Linux æ–‡ä»¶å¥æŸ„é™åˆ¶</h2>
<p>æŠ¥é”™çœ‹èµ·æ¥åƒæ˜¯è¿›ç¨‹æ‰“å¼€æ–‡ä»¶å¥æŸ„çš„ä¸ªæ•°è¾¾åˆ°äº†linuxçš„é™åˆ¶ã€‚è€Œè¿™ç§é™åˆ¶æ˜¯åˆ†ä¸ºç³»ç»Ÿå±‚é¢çš„å’Œç”¨æˆ·å±‚é¢çš„</p>
<h3 id="ç³»ç»Ÿå±‚é¢"><span class="section-num">1.1</span> ç³»ç»Ÿå±‚é¢</h3>
<p>ç³»ç»Ÿå±‚é¢çš„åœ¨ï¼š/proc/sys/fs/file-maxé‡Œè®¾ç½®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">cat /proc/sys/fs/file-max
</span></span><span class="line"><span class="cl"><span class="m">2442976</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ç”¨æˆ·å±‚é¢"><span class="section-num">1.2</span> ç”¨æˆ·å±‚é¢</h3>
<p>ç”¨æˆ·å±‚é¢çš„é™åˆ¶åœ¨ï¼š/etc/security/limits.confé‡Œè®¾å®šã€‚é€šè¿‡<code>ulimit -a</code> æŸ¥çœ‹ç³»ç»Ÿå…è®¸å•ä¸ªè¿›ç¨‹æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æ•°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="nb">ulimit</span> -a
</span></span><span class="line"><span class="cl">core file size          <span class="o">(</span>blocks, -c<span class="o">)</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">data seg size           <span class="o">(</span>kbytes, -d<span class="o">)</span> unlimited
</span></span><span class="line"><span class="cl">scheduling priority             <span class="o">(</span>-e<span class="o">)</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">file size               <span class="o">(</span>blocks, -f<span class="o">)</span> unlimited
</span></span><span class="line"><span class="cl">pending signals                 <span class="o">(</span>-i<span class="o">)</span> <span class="m">192059</span>
</span></span><span class="line"><span class="cl">max locked memory       <span class="o">(</span>kbytes, -l<span class="o">)</span> <span class="m">64</span>
</span></span><span class="line"><span class="cl">max memory size         <span class="o">(</span>kbytes, -m<span class="o">)</span> unlimited
</span></span><span class="line"><span class="cl">open files                      <span class="o">(</span>-n<span class="o">)</span> <span class="m">65536</span>
</span></span><span class="line"><span class="cl">pipe size            <span class="o">(</span><span class="m">512</span> bytes, -p<span class="o">)</span> <span class="m">8</span>
</span></span><span class="line"><span class="cl">POSIX message queues     <span class="o">(</span>bytes, -q<span class="o">)</span> <span class="m">819200</span>
</span></span><span class="line"><span class="cl">real-time priority              <span class="o">(</span>-r<span class="o">)</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">stack size              <span class="o">(</span>kbytes, -s<span class="o">)</span> <span class="m">10240</span>
</span></span><span class="line"><span class="cl">cpu <span class="nb">time</span>               <span class="o">(</span>seconds, -t<span class="o">)</span> unlimited
</span></span><span class="line"><span class="cl">max user processes              <span class="o">(</span>-u<span class="o">)</span> <span class="m">65535</span>
</span></span><span class="line"><span class="cl">virtual memory          <span class="o">(</span>kbytes, -v<span class="o">)</span> unlimited
</span></span><span class="line"><span class="cl">file locks                      <span class="o">(</span>-x<span class="o">)</span> unlimited
</span></span></code></pre></td></tr></table>
</div>
</div><p>å•ä¸ªè¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æ•°æ˜¯ 65536</p>
<h2 id="lsof-æ˜¾ç¤ºå¤§é‡open-file"><span class="section-num">2</span> lsof æ˜¾ç¤ºå¤§é‡open file</h2>
<p>æŒ‰ç…§Tomcat ç»™å‡ºçš„æŠ¥é”™ä¿¡æ¯ï¼Œç™»å½•87 è¿™å°æœåŠ¡å™¨æ£€æŸ¥æ‰“å¼€çš„æ–‡ä»¶æ•°ï¼Œå‘ç°æ‰“å¼€çš„æ–‡ä»¶è¶…è¿‡70000:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">lsof <span class="p">|</span>wc -l
</span></span><span class="line"><span class="cl"><span class="m">75924</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åæ‰¾å‡ºæ‰“å¼€æ–‡ä»¶æ•°æœ€å¤šçš„è¿›ç¨‹ï¼ŒæŒ‰æ–‡ä»¶æ•°é™åºæ’åˆ—ï¼Œå·¦è¾¹æ˜¯ open file çš„æ•°é‡ï¼Œå³è¾¹æ˜¯è¿›ç¨‹IDï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">lsof -n<span class="p">|</span>awk <span class="s1">&#39;{print $2}&#39;</span><span class="p">|</span> sort <span class="p">|</span> uniq -c <span class="p">|</span> sort -nr <span class="p">|</span> head
</span></span><span class="line"><span class="cl"><span class="m">65966</span> <span class="m">25204</span>
</span></span><span class="line"><span class="cl"><span class="m">5374</span> <span class="m">20179</span>
</span></span><span class="line"><span class="cl"><span class="m">184</span> <span class="m">27275</span>
</span></span><span class="line"><span class="cl"><span class="m">65</span> <span class="m">5361</span>
</span></span><span class="line"><span class="cl"><span class="m">61</span> <span class="m">29421</span>
</span></span><span class="line"><span class="cl"><span class="m">16</span> <span class="m">22177</span>
</span></span><span class="line"><span class="cl"><span class="m">14</span> <span class="m">19751</span>
</span></span><span class="line"><span class="cl"><span class="m">12</span> <span class="m">22181</span>
</span></span><span class="line"><span class="cl"><span class="m">12</span> <span class="m">22179</span>
</span></span><span class="line"><span class="cl"><span class="m">12</span> <span class="m">22178</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‘ç° <code>25204</code> è¿™ä¸ªè¿›ç¨‹æ‰“å¼€äº†å¤§é‡çš„æ–‡ä»¶ï¼Œå·²ç»è¶…è¿‡äº†å•ä¸ªè¿›ç¨‹çš„æœ€å¤§æ–‡ä»¶æ•°é™åˆ¶ã€‚è€Œè¿™ä¸ªè¿›ç¨‹å°±æ˜¯éƒ¨ç½²çš„java åº”ç”¨å¯¹åº”çš„è¿›ç¨‹ã€‚æ‰“å¼€çš„æ–‡ä»¶å¥æŸ„æ•°é‡å·²ç»è¶…è¿‡Linux é™åˆ¶ï¼Œ
Tomcat æ— æ³•åˆ›å»ºæ–°çš„socket è¿æ¥ã€‚</p>
<h2 id="can-t-identify-protocol"><span class="section-num">3</span> can&rsquo;t identify protocol</h2>
<p>ç”¨ lsof æŸ¥çœ‹ java åº”ç”¨æ‰“å¼€çš„æ–‡ä»¶çš„æ—¶å€™ï¼Œå‘ç°æœ‰éå¸¸å¤šå¥‡æ€ªçš„è¾“å‡ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">java    <span class="m">25204</span> nemo *516u  sock                0,6       0t0 <span class="m">215137625</span> can<span class="s1">&#39;t identify protocol
</span></span></span><span class="line"><span class="cl"><span class="s1">java    25204 nemo *517u  sock                0,6       0t0 215137626 can&#39;</span>t identify protocol
</span></span><span class="line"><span class="cl">java    <span class="m">25204</span> nemo *518u  sock                0,6       0t0 <span class="m">215137627</span> can<span class="s1">&#39;t identify protocol
</span></span></span><span class="line"><span class="cl"><span class="s1">java    25204 nemo *519u  sock                0,6       0t0 215137628 can&#39;</span>t identify protocol
</span></span><span class="line"><span class="cl">java    <span class="m">25204</span> nemo *520u  sock                0,6       0t0 <span class="m">215137629</span> can<span class="s1">&#39;t identify protocol
</span></span></span><span class="line"><span class="cl"><span class="s1">java    25204 nemo *521u  sock                0,6       0t0 215137630 can&#39;</span>t identify protocol
</span></span><span class="line"><span class="cl">java    <span class="m">25204</span> nemo *522u  sock                0,6       0t0 <span class="m">215137631</span> can<span class="s1">&#39;t identify protocol
</span></span></span><span class="line"><span class="cl"><span class="s1">java    25204 nemo *523u  sock                0,6       0t0 215137634 can&#39;</span>t identify protocol
</span></span><span class="line"><span class="cl">java    <span class="m">25204</span> nemo *524u  sock                0,6       0t0 <span class="m">215137635</span> can<span class="s1">&#39;t identify protocol
</span></span></span><span class="line"><span class="cl"><span class="s1">java    25204 nemo *525u  sock                0,6       0t0 215137636 can&#39;</span>t identify protocol
</span></span><span class="line"><span class="cl">java    <span class="m">25204</span> nemo *526u  sock                0,6       0t0 <span class="m">215137637</span> can<span class="s1">&#39;t identify protocol
</span></span></span><span class="line"><span class="cl"><span class="s1">java    25204 nemo *527u  sock                0,6       0t0 215137638 can&#39;</span>t identify protocol
</span></span><span class="line"><span class="cl">java    <span class="m">25204</span> nemo *528u  sock                0,6       0t0 <span class="m">215137639</span> can<span class="s1">&#39;t identify protocol
</span></span></span><span class="line"><span class="cl"><span class="s1">java    25204 nemo *529u  sock                0,6       0t0 215137640 can&#39;</span>t identify protocol
</span></span><span class="line"><span class="cl">java    <span class="m">25204</span> nemo *530u  sock                0,6       0t0 <span class="m">215137641</span> can<span class="s1">&#39;t identify protocol
</span></span></span><span class="line"><span class="cl"><span class="s1">java    25204 nemo *531u  sock                0,6       0t0 215137642 can&#39;</span>t identify protocol
</span></span><span class="line"><span class="cl">java    <span class="m">25204</span> nemo *532u  sock                0,6       0t0 <span class="m">215137644</span> can<span class="s1">&#39;t identify protocol
</span></span></span><span class="line"><span class="cl"><span class="s1">java    25204 nemo *533u  sock                0,6       0t0 215137646 can&#39;</span>t identify protocol
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç»Ÿè®¡ä¹‹åå‘ç°ï¼Œ <code>can't identify protocol</code> è¿™æ ·çš„æ–‡ä»¶æ•°é‡éå¸¸å¤šï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">lsof -p 25204<span class="p">|</span>grep <span class="s2">&#34;can&#39;t identify protocol&#34;</span><span class="p">|</span>wc -l
</span></span><span class="line"><span class="cl"><span class="m">64214</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¹Ÿå°±æ˜¯å¤§éƒ¨ä»½æ‰“å¼€çš„æ–‡ä»¶éƒ½æ˜¯å±äº <code>cant' identify  protocol</code> çš„æ–‡ä»¶ã€‚</p>
<h2 id="é—®é¢˜å®šä½"><span class="section-num">4</span> é—®é¢˜å®šä½</h2>
<p>Google æœç´¢ä¹‹åå‘ç°ï¼Œè¿™ä¸ª <code>cant' identify protocol</code> çš„ä¸œä¸œå‡ºç°çš„åŸå› æ˜¯å› ä¸º è¿™äº›
sockets å¤„äº <code>CLOSED</code> çš„çŠ¶æ€ï¼Œä½†æ˜¯å´æ²¡æœ‰çœŸæ­£close æ‰ï¼Œæ­£å¤„äº <code>half-close</code> çŠ¶æ€ã€‚å› æ­¤ï¼Œå¦‚æœä½¿ç”¨ <code>netstat</code> æ¥æŸ¥çœ‹socket çŠ¶æ€ï¼Œæ˜¯ä¸ä¼šæ˜¾ç¤ºè¿™äº› <code>half-close</code>çš„ socket çš„ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">netstat  -nat <span class="p">|</span>wc -l
</span></span><span class="line"><span class="cl"><span class="m">881</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨ <code>netstat</code> çš„æ”¹è¿›ç‰ˆæœ¬ <code>ss</code> å°±èƒ½å‘ç°å¤§é‡å¤„äº <code>Closed</code> çŠ¶æ€çš„ socket:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">ss -s
</span></span><span class="line"><span class="cl">Total: <span class="m">76052</span> <span class="o">(</span>kernel 76254<span class="o">)</span>
</span></span><span class="line"><span class="cl">TCP:   <span class="m">75924</span> <span class="o">(</span>estab 123, closed 75524, orphaned 0, synrecv 0, timewait 173/0<span class="o">)</span>, ports <span class="m">104</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Transport Total     IP        IPv6
</span></span><span class="line"><span class="cl">*         <span class="m">76254</span>    -         -
</span></span><span class="line"><span class="cl">RAW       <span class="m">0</span>         <span class="m">0</span>         <span class="m">0</span>
</span></span><span class="line"><span class="cl">UDP       <span class="m">9</span>         <span class="m">6</span>         <span class="m">3</span>
</span></span><span class="line"><span class="cl">TCP       <span class="m">116</span>       <span class="m">80</span>        <span class="m">36</span>
</span></span><span class="line"><span class="cl">INET      <span class="m">125</span>       <span class="m">86</span>        <span class="m">39</span>
</span></span><span class="line"><span class="cl">FRAG      <span class="m">0</span>         <span class="m">0</span>         <span class="m">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¥ç€æŸ¥çœ‹å†…æ ¸çš„ socket æƒ…å†µï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">cat /proc/net/sockstat
</span></span><span class="line"><span class="cl">sockets: used <span class="m">75724</span>
</span></span><span class="line"><span class="cl">TCP: inuse <span class="m">886</span> orphan <span class="m">0</span> tw <span class="m">0</span> alloc <span class="m">72134</span> mem <span class="m">222</span>
</span></span><span class="line"><span class="cl">UDP: inuse <span class="m">5</span> mem <span class="m">0</span>
</span></span><span class="line"><span class="cl">UDPLITE: inuse <span class="m">0</span>
</span></span><span class="line"><span class="cl">RAW: inuse <span class="m">0</span>
</span></span><span class="line"><span class="cl">FRAG: inuse <span class="m">0</span> memory <span class="m">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¾ˆå¤šçš„ socket å¤„äº <code>alloc</code>, åªæœ‰å°‘é‡çš„ socket å¤„äº <code>inuse</code>. å¯ä»¥ç¡®è®¤æ˜¯ java åº”ç”¨å‡ºç°äº† socket fd çš„æ³„æ¼ã€‚ ä½†æ˜¯ä¸ºä»€ä¹ˆä¼šæœ‰é‚£ä¹ˆå¤šçš„socket æ³„æ¼å‘¢ï¼Ÿ</p>
<h2 id="å¤§èƒ†å‡è®¾"><span class="section-num">5</span> å¤§èƒ†å‡è®¾</h2>
<p>ç°åœ¨å¯ä»¥ç¡®å®šçš„æ˜¯ javaåº”ç”¨å‡ºç°äº†é—®é¢˜ï¼Œå¯¼è‡´äº†socket æ³„æ¼ï¼Œè®© Tomcat æ— æ³•å»ºç«‹æ–°è¿æ¥ï¼Œæœ€ç»ˆå®•æœºã€‚æ—¢ç„¶å¯¼è‡´é—®é¢˜å‡ºç°çš„æ˜¯ java åº”ç”¨ï¼Œé‚£ä¹ˆå°±åº”è¯¥å»æ£€æŸ¥åº”ç”¨æ—¥å¿—ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">2018-04-09 17:41:31,491 - [ERROR] - from com.alibaba.druid.pool.DruidDataSource in Druid-ConnectionPool-CreateScheduler--4-thread-214
</span></span><span class="line"><span class="cl">create connection error, url: jdbc:mysql://test-server-host:3306/db_name?readOnlyPropagatesToServer=false&amp;rewriteBatchedStatements=true&amp;failOverReadOnly=false&amp;socketTimeout=6000&amp;connectTimeout=20000&amp;zeroDateTimeBehavior=convertToNull&amp;allowMultiQueries=true&amp;characterEncoding=utf-8&amp;autoReconnect=true
</span></span><span class="line"><span class="cl">com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: Could not create connection to database server. Attempted reconnect 3 times. Giving up.
</span></span><span class="line"><span class="cl">at sun.reflect.GeneratedConstructorAccessor169.newInstance(Unknown Source)
</span></span><span class="line"><span class="cl">at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
</span></span><span class="line"><span class="cl">at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.Util.getInstance(Util.java:408)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:918)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:897)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:886)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:860)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.connectWithRetries(ConnectionImpl.java:2163)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2088)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.&lt;init&gt;(ConnectionImpl.java:806)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.JDBC4Connection.&lt;init&gt;(JDBC4Connection.java:47)
</span></span><span class="line"><span class="cl">at sun.reflect.GeneratedConstructorAccessor152.newInstance(Unknown Source)
</span></span><span class="line"><span class="cl">at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
</span></span><span class="line"><span class="cl">at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:410)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:328)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.filter.FilterChainImpl.connection_connect(FilterChainImpl.java:148)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.filter.stat.StatFilter.connection_connect(StatFilter.java:211)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.filter.FilterChainImpl.connection_connect(FilterChainImpl.java:142)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:1423)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:1477)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.pool.DruidDataSource$CreateConnectionTask.runInternal(DruidDataSource.java:1884)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.pool.DruidDataSource$CreateConnectionTask.run(DruidDataSource.java:1849)
</span></span><span class="line"><span class="cl">at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
</span></span><span class="line"><span class="cl">at java.util.concurrent.FutureTask.run(FutureTask.java:266)
</span></span><span class="line"><span class="cl">at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
</span></span><span class="line"><span class="cl">at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
</span></span><span class="line"><span class="cl">at java.lang.Thread.run(Thread.java:745)
</span></span><span class="line"><span class="cl">Caused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
</span></span><span class="line"><span class="cl">at sun.reflect.GeneratedConstructorAccessor157.newInstance(Unknown Source)
</span></span><span class="line"><span class="cl">at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
</span></span><span class="line"><span class="cl">at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:989)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.MysqlIO.&lt;init&gt;(MysqlIO.java:341)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2251)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.connectWithRetries(ConnectionImpl.java:2104)
</span></span><span class="line"><span class="cl">... 21 common frames omitted
</span></span><span class="line"><span class="cl">Caused by: java.net.SocketException: Too many open files
</span></span><span class="line"><span class="cl">at java.net.Socket.createImpl(Socket.java:460)
</span></span><span class="line"><span class="cl">at java.net.Socket.getImpl(Socket.java:520)
</span></span><span class="line"><span class="cl">at java.net.Socket.setTcpNoDelay(Socket.java:980)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.StandardSocketFactory.configureSocket(StandardSocketFactory.java:132)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:203)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.MysqlIO.&lt;init&gt;(MysqlIO.java:300)
</span></span><span class="line"><span class="cl">... 23 common frames omitted
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2018-04-09 17:41:31,568 - [ERROR] - from org.apache.tomcat.util.net.NioEndpoint in http-nio-47001-Acceptor-0
</span></span><span class="line"><span class="cl">Socket accept failed
</span></span><span class="line"><span class="cl">java.io.IOException: Too many open files
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept0(Native Method)
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:422)
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:250)
</span></span><span class="line"><span class="cl">at org.apache.tomcat.util.net.NioEndpoint$Acceptor.run(NioEndpoint.java:825)
</span></span><span class="line"><span class="cl">at java.lang.Thread.run(Thread.java:745)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2018-04-09 17:41:33,168 - [ERROR] - from org.apache.tomcat.util.net.NioEndpoint in http-nio-47001-Acceptor-0
</span></span><span class="line"><span class="cl">Socket accept failed
</span></span><span class="line"><span class="cl">java.io.IOException: Too many open files
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept0(Native Method)
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:422)
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:250)
</span></span><span class="line"><span class="cl">at org.apache.tomcat.util.net.NioEndpoint$Acceptor.run(NioEndpoint.java:825)
</span></span><span class="line"><span class="cl">at java.lang.Thread.run(Thread.java:745)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2018-04-09 17:41:34,470 - [ERROR] - from com.alibaba.druid.pool.DruidDataSource in Druid-ConnectionPool-CreateScheduler--4-thread-216
</span></span><span class="line"><span class="cl">create connection error, url: jdbc:mysql://test-server-url:3306/db_name?readOnlyPropagatesToServer=false&amp;rewriteBatchedStatements=true&amp;failOverReadOnly=false&amp;socketTimeout=6000&amp;connectTimeout=20000&amp;zeroDateTimeBehavior=convertToNull&amp;allowMultiQueries=true&amp;characterEncoding=utf-8&amp;autoReconnect=true
</span></span><span class="line"><span class="cl">com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: Could not create connection to database server. Attempted reconnect 3 times. Giving up.
</span></span><span class="line"><span class="cl">at sun.reflect.GeneratedConstructorAccessor169.newInstance(Unknown Source)
</span></span><span class="line"><span class="cl">at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
</span></span><span class="line"><span class="cl">at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.Util.getInstance(Util.java:408)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:918)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:897)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:886)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:860)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.connectWithRetries(ConnectionImpl.java:2163)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2088)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.&lt;init&gt;(ConnectionImpl.java:806)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.JDBC4Connection.&lt;init&gt;(JDBC4Connection.java:47)
</span></span><span class="line"><span class="cl">at sun.reflect.GeneratedConstructorAccessor152.newInstance(Unknown Source)
</span></span><span class="line"><span class="cl">at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
</span></span><span class="line"><span class="cl">at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:410)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:328)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.filter.FilterChainImpl.connection_connect(FilterChainImpl.java:148)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.filter.stat.StatFilter.connection_connect(StatFilter.java:211)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.filter.FilterChainImpl.connection_connect(FilterChainImpl.java:142)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:1423)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:1477)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.pool.DruidDataSource$CreateConnectionTask.runInternal(DruidDataSource.java:1884)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.pool.DruidDataSource$CreateConnectionTask.run(DruidDataSource.java:1849)
</span></span><span class="line"><span class="cl">at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
</span></span><span class="line"><span class="cl">at java.util.concurrent.FutureTask.run(FutureTask.java:266)
</span></span><span class="line"><span class="cl">at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
</span></span><span class="line"><span class="cl">at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
</span></span><span class="line"><span class="cl">at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
</span></span><span class="line"><span class="cl">at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
</span></span><span class="line"><span class="cl">at java.lang.Thread.run(Thread.java:745)
</span></span><span class="line"><span class="cl">Caused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
</span></span><span class="line"><span class="cl">at sun.reflect.GeneratedConstructorAccessor157.newInstance(Unknown Source)
</span></span><span class="line"><span class="cl">at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
</span></span><span class="line"><span class="cl">at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:989)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.MysqlIO.&lt;init&gt;(MysqlIO.java:341)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2251)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.connectWithRetries(ConnectionImpl.java:2104)
</span></span><span class="line"><span class="cl">... 23 common frames omitted
</span></span><span class="line"><span class="cl">Caused by: java.net.SocketException: Too many open files
</span></span><span class="line"><span class="cl">at java.net.Socket.createImpl(Socket.java:460)
</span></span><span class="line"><span class="cl">at java.net.Socket.getImpl(Socket.java:520)
</span></span><span class="line"><span class="cl">at java.net.Socket.setTcpNoDelay(Socket.java:980)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.StandardSocketFactory.configureSocket(StandardSocketFactory.java:132)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:203)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.MysqlIO.&lt;init&gt;(MysqlIO.java:300)
</span></span><span class="line"><span class="cl">... 25 common frames omitted
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2018-04-09 17:41:34,769 - [ERROR] - from org.apache.tomcat.util.net.NioEndpoint in http-nio-47001-Acceptor-0
</span></span><span class="line"><span class="cl">Socket accept failed
</span></span><span class="line"><span class="cl">java.io.IOException: Too many open files
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept0(Native Method)
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:422)
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:250)
</span></span><span class="line"><span class="cl">at org.apache.tomcat.util.net.NioEndpoint$Acceptor.run(NioEndpoint.java:825)
</span></span><span class="line"><span class="cl">at java.lang.Thread.run(Thread.java:745)
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ£€æŸ¥æ—¥å¿—å‘ç°ï¼Œåœ¨ Tomcat å½»åº•æŒ‚æœºä¹‹å‰ï¼Œæ›¾ç»æœ‰æ¯”è¾ƒå¤§é‡çš„æ•°æ®æºè¿æ¥æ± å‡ºé”™ï¼Œæ— æ³•è®¿é—® Mysql, ä½†æ˜¯éå¸¸å¥‡æ€ªçš„æ˜¯ï¼Œåœ¨87 è¿™å°æœºå™¨ä¸Šé¢ï¼Œæ˜¯å¯ä»¥ä½¿ç”¨ mysql å‘½ä»¤è¡Œè¿æ¥åˆ°æµ‹è¯•æ•°æ®åº“çš„ï¼Œè¯´æ˜ Mysql çš„è¿æ¥æ˜¯æ²¡æœ‰é—®é¢˜ã€‚</p>
<p>ä½†æ˜¯æ•°æ®æºè¿æ¥å°±ä¼šå‡ºé”™ï¼ï¼ çœŸçš„æ˜¯å¾ˆå¥‡æ€ªï¼Œä¸ºä»€ä¹ˆè¿æ¥æ± ä¼šæŠ¥é”™ï¼Œæœ‰æ²¡æœ‰å¯èƒ½æ˜¯è¿™äº›å¼‚å¸¸å¯¼è‡´ socket æ³„æ¼å‘¢ï¼Ÿåæ¥ï¼Œåœ¨æœ¬åœ°è¿è¡Œåº”ç”¨ï¼Œæœ‰æ—¶å€™ä¼šå‘ç°IDE çš„æ§åˆ¶å°æŠ¥é”™ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span><span class="lnt">96
</span><span class="lnt">97
</span><span class="lnt">98
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mi">2018</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">11</span> <span class="mi">09</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="mi">48</span><span class="p">,</span><span class="mi">363</span> <span class="o">-</span> <span class="p">[</span><span class="n">ERROR</span><span class="p">]</span> <span class="o">-</span> <span class="n">from</span> <span class="n">com</span><span class="o">.</span><span class="n">alibaba</span><span class="o">.</span><span class="n">druid</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">DruidDataSource</span> <span class="ow">in</span> <span class="n">poolTaskScheduler</span><span class="o">-</span><span class="mi">11</span>
</span></span><span class="line"><span class="cl"><span class="n">discard</span> <span class="n">connection</span>
</span></span><span class="line"><span class="cl"><span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">jdbc4</span><span class="o">.</span><span class="n">CommunicationsException</span><span class="p">:</span> <span class="n">Communications</span> <span class="n">link</span> <span class="n">failure</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">last</span> <span class="n">packet</span> <span class="n">successfully</span> <span class="n">received</span> <span class="n">from</span> <span class="n">the</span> <span class="n">server</span> <span class="n">was</span> <span class="mi">100</span><span class="p">,</span><span class="mi">610</span> <span class="n">milliseconds</span> <span class="n">ago</span><span class="o">.</span>  <span class="n">The</span> <span class="n">last</span> <span class="n">packet</span> <span class="n">sent</span> <span class="n">successfully</span> <span class="n">to</span> <span class="n">the</span> <span class="n">server</span> <span class="n">was</span> <span class="mi">0</span> <span class="n">milliseconds</span> <span class="n">ago</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">sun</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">GeneratedConstructorAccessor108</span><span class="o">.</span><span class="n">newInstance</span><span class="p">(</span><span class="n">Unknown</span> <span class="n">Source</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">sun</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">DelegatingConstructorAccessorImpl</span><span class="o">.</span><span class="n">newInstance</span><span class="p">(</span><span class="n">DelegatingConstructorAccessorImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">45</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">Constructor</span><span class="o">.</span><span class="n">newInstance</span><span class="p">(</span><span class="n">Constructor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">423</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">handleNewInstance</span><span class="p">(</span><span class="n">Util</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">425</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">SQLError</span><span class="o">.</span><span class="n">createCommunicationsException</span><span class="p">(</span><span class="n">SQLError</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">989</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">reuseAndReadPacket</span><span class="p">(</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">3556</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">reuseAndReadPacket</span><span class="p">(</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">3456</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">checkErrorPacket</span><span class="p">(</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">3897</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">sendCommand</span><span class="p">(</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">2524</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">sqlQueryDirect</span><span class="p">(</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">2677</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">ConnectionImpl</span><span class="o">.</span><span class="n">execSQL</span><span class="p">(</span><span class="n">ConnectionImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">2545</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">ConnectionImpl</span><span class="o">.</span><span class="n">execSQL</span><span class="p">(</span><span class="n">ConnectionImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">2503</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">StatementImpl</span><span class="o">.</span><span class="n">executeQuery</span><span class="p">(</span><span class="n">StatementImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">1369</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">alibaba</span><span class="o">.</span><span class="n">druid</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">FilterChainImpl</span><span class="o">.</span><span class="n">statement_executeQuery</span><span class="p">(</span><span class="n">FilterChainImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">2363</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">alibaba</span><span class="o">.</span><span class="n">druid</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">FilterAdapter</span><span class="o">.</span><span class="n">statement_executeQuery</span><span class="p">(</span><span class="n">FilterAdapter</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">2481</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">alibaba</span><span class="o">.</span><span class="n">druid</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">FilterEventAdapter</span><span class="o">.</span><span class="n">statement_executeQuery</span><span class="p">(</span><span class="n">FilterEventAdapter</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">302</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">alibaba</span><span class="o">.</span><span class="n">druid</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">FilterChainImpl</span><span class="o">.</span><span class="n">statement_executeQuery</span><span class="p">(</span><span class="n">FilterChainImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">2360</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">alibaba</span><span class="o">.</span><span class="n">druid</span><span class="o">.</span><span class="n">proxy</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">StatementProxyImpl</span><span class="o">.</span><span class="n">executeQuery</span><span class="p">(</span><span class="n">StatementProxyImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">211</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">alibaba</span><span class="o">.</span><span class="n">druid</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">DruidPooledStatement</span><span class="o">.</span><span class="n">executeQuery</span><span class="p">(</span><span class="n">DruidPooledStatement</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">138</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">atom</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TStatementWrapper</span><span class="o">.</span><span class="n">executeQuery</span><span class="p">(</span><span class="n">TStatementWrapper</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">315</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TGroupStatement</span><span class="o">.</span><span class="n">executeQueryOnConnection</span><span class="p">(</span><span class="n">TGroupStatement</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">549</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TGroupStatement</span><span class="o">$</span><span class="mf">4.</span><span class="n">tryOnDataSource</span><span class="p">(</span><span class="n">TGroupStatement</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">633</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TGroupStatement</span><span class="o">$</span><span class="mf">4.</span><span class="n">tryOnDataSource</span><span class="p">(</span><span class="n">TGroupStatement</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">615</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">dbselector</span><span class="o">.</span><span class="n">AbstractDBSelector</span><span class="o">.</span><span class="n">tryOnDataSourceHolder</span><span class="p">(</span><span class="n">AbstractDBSelector</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">155</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">dbselector</span><span class="o">.</span><span class="n">OneDBSelector</span><span class="o">.</span><span class="n">tryExecuteInternal</span><span class="p">(</span><span class="n">OneDBSelector</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">52</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">dbselector</span><span class="o">.</span><span class="n">AbstractDBSelector</span><span class="o">.</span><span class="n">tryExecute</span><span class="p">(</span><span class="n">AbstractDBSelector</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">405</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">dbselector</span><span class="o">.</span><span class="n">AbstractDBSelector</span><span class="o">.</span><span class="n">tryExecute</span><span class="p">(</span><span class="n">AbstractDBSelector</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">412</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TGroupStatement</span><span class="o">.</span><span class="n">executeQuery</span><span class="p">(</span><span class="n">TGroupStatement</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">488</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TGroupStatement</span><span class="o">.</span><span class="n">executeInternal</span><span class="p">(</span><span class="n">TGroupStatement</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">131</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TGroupStatement</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">TGroupStatement</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">101</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">repo</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">spi</span><span class="o">.</span><span class="n">My_JdbcHandler</span><span class="o">.</span><span class="n">executeQuery</span><span class="p">(</span><span class="n">My_JdbcHandler</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">521</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">repo</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">spi</span><span class="o">.</span><span class="n">My_Cursor</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">My_Cursor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">106</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">repo</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">handler</span><span class="o">.</span><span class="n">QueryMyHandler</span><span class="o">.</span><span class="n">handle</span><span class="p">(</span><span class="n">QueryMyHandler</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">89</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">AbstractGroupExecutor</span><span class="o">.</span><span class="n">executeInner</span><span class="p">(</span><span class="n">AbstractGroupExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">47</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">AbstractGroupExecutor</span><span class="o">.</span><span class="n">execByExecPlanNode</span><span class="p">(</span><span class="n">AbstractGroupExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">36</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">TopologyExecutor</span><span class="o">.</span><span class="n">execByExecPlanNode</span><span class="p">(</span><span class="n">TopologyExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">66</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">MatrixExecutor</span><span class="o">.</span><span class="n">execByExecPlanNodeByOne</span><span class="p">(</span><span class="n">MatrixExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">670</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">MatrixExecutor</span><span class="o">.</span><span class="n">execByExecPlanNode</span><span class="p">(</span><span class="n">MatrixExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">659</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">MatrixExecutor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">MatrixExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">137</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TConnection</span><span class="o">.</span><span class="n">executeSQL</span><span class="p">(</span><span class="n">TConnection</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">241</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TPreparedStatement</span><span class="o">.</span><span class="n">executeSQL</span><span class="p">(</span><span class="n">TPreparedStatement</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">64</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TStatement</span><span class="o">.</span><span class="n">executeInternal</span><span class="p">(</span><span class="n">TStatement</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">133</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TPreparedStatement</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">TPreparedStatement</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">49</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">sun</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">GeneratedMethodAccessor148</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">Unknown</span> <span class="n">Source</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">sun</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">DelegatingMethodAccessorImpl</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">DelegatingMethodAccessorImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">43</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">Method</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">Method</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">498</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">PreparedStatementLogger</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">PreparedStatementLogger</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">59</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">sun</span><span class="o">.</span><span class="n">proxy</span><span class="o">.$</span><span class="n">Proxy102</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">Unknown</span> <span class="n">Source</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">statement</span><span class="o">.</span><span class="n">PreparedStatementHandler</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">PreparedStatementHandler</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">63</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">statement</span><span class="o">.</span><span class="n">RoutingStatementHandler</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">RoutingStatementHandler</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">79</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">SimpleExecutor</span><span class="o">.</span><span class="n">doQuery</span><span class="p">(</span><span class="n">SimpleExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">63</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">BaseExecutor</span><span class="o">.</span><span class="n">queryFromDatabase</span><span class="p">(</span><span class="n">BaseExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">325</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">BaseExecutor</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">BaseExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">156</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">CachingExecutor</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">CachingExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">109</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">CachingExecutor</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">CachingExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">83</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">sun</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">GeneratedMethodAccessor146</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">Unknown</span> <span class="n">Source</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">sun</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">DelegatingMethodAccessorImpl</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">DelegatingMethodAccessorImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">43</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">Method</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">Method</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">498</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">plugin</span><span class="o">.</span><span class="n">Invocation</span><span class="o">.</span><span class="n">proceed</span><span class="p">(</span><span class="n">Invocation</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">49</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">fastfish</span><span class="o">.</span><span class="n">interceptor</span><span class="o">.</span><span class="n">DbLogInterceptor</span><span class="o">.</span><span class="n">intercept</span><span class="p">(</span><span class="n">DbLogInterceptor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">49</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">plugin</span><span class="o">.</span><span class="n">Plugin</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">Plugin</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">61</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">sun</span><span class="o">.</span><span class="n">proxy</span><span class="o">.$</span><span class="n">Proxy100</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Unknown</span> <span class="n">Source</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">DefaultSqlSession</span><span class="o">.</span><span class="n">selectList</span><span class="p">(</span><span class="n">DefaultSqlSession</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">148</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">DefaultSqlSession</span><span class="o">.</span><span class="n">selectList</span><span class="p">(</span><span class="n">DefaultSqlSession</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">141</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">sun</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">GeneratedMethodAccessor145</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">Unknown</span> <span class="n">Source</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">sun</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">DelegatingMethodAccessorImpl</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">DelegatingMethodAccessorImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">43</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">Method</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">Method</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">498</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">mybatis</span><span class="o">.</span><span class="n">spring</span><span class="o">.</span><span class="n">SqlSessionTemplate</span><span class="o">$</span><span class="n">SqlSessionInterceptor</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">SqlSessionTemplate</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">434</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">sun</span><span class="o">.</span><span class="n">proxy</span><span class="o">.$</span><span class="n">Proxy87</span><span class="o">.</span><span class="n">selectList</span><span class="p">(</span><span class="n">Unknown</span> <span class="n">Source</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">mybatis</span><span class="o">.</span><span class="n">spring</span><span class="o">.</span><span class="n">SqlSessionTemplate</span><span class="o">.</span><span class="n">selectList</span><span class="p">(</span><span class="n">SqlSessionTemplate</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">231</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">binding</span><span class="o">.</span><span class="n">MapperMethod</span><span class="o">.</span><span class="n">executeForMany</span><span class="p">(</span><span class="n">MapperMethod</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">128</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">binding</span><span class="o">.</span><span class="n">MapperMethod</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">MapperMethod</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">68</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">binding</span><span class="o">.</span><span class="n">MapperProxy</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">MapperProxy</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">53</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">sun</span><span class="o">.</span><span class="n">proxy</span><span class="o">.$</span><span class="n">Proxy124</span><span class="o">.</span><span class="n">selectAll</span><span class="p">(</span><span class="n">Unknown</span> <span class="n">Source</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">fastfish</span><span class="o">.</span><span class="n">services</span><span class="o">.</span><span class="n">BusinessService</span><span class="o">.</span><span class="n">getAll</span><span class="p">(</span><span class="n">BusinessService</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">73</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">fastfish</span><span class="o">.</span><span class="n">services</span><span class="o">.</span><span class="n">BusinessService</span><span class="o">.</span><span class="n">loadDB</span><span class="p">(</span><span class="n">BusinessService</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">38</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">sun</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">GeneratedMethodAccessor190</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">Unknown</span> <span class="n">Source</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">sun</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">DelegatingMethodAccessorImpl</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">DelegatingMethodAccessorImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">43</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">Method</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">Method</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">498</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">springframework</span><span class="o">.</span><span class="n">scheduling</span><span class="o">.</span><span class="n">support</span><span class="o">.</span><span class="n">ScheduledMethodRunnable</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">ScheduledMethodRunnable</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">65</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">springframework</span><span class="o">.</span><span class="n">scheduling</span><span class="o">.</span><span class="n">support</span><span class="o">.</span><span class="n">DelegatingErrorHandlingRunnable</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">DelegatingErrorHandlingRunnable</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">54</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">concurrent</span><span class="o">.</span><span class="n">Executors</span><span class="o">$</span><span class="n">RunnableAdapter</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">Executors</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">511</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">concurrent</span><span class="o">.</span><span class="n">FutureTask</span><span class="o">.</span><span class="n">runAndReset</span><span class="o">$$$</span><span class="n">capture</span><span class="p">(</span><span class="n">FutureTask</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">308</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">concurrent</span><span class="o">.</span><span class="n">FutureTask</span><span class="o">.</span><span class="n">runAndReset</span><span class="p">(</span><span class="n">FutureTask</span><span class="o">.</span><span class="n">java</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">concurrent</span><span class="o">.</span><span class="n">ScheduledThreadPoolExecutor</span><span class="o">$</span><span class="n">ScheduledFutureTask</span><span class="o">.</span><span class="n">access</span><span class="o">$</span><span class="mi">301</span><span class="p">(</span><span class="n">ScheduledThreadPoolExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">180</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">concurrent</span><span class="o">.</span><span class="n">ScheduledThreadPoolExecutor</span><span class="o">$</span><span class="n">ScheduledFutureTask</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">ScheduledThreadPoolExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">294</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">concurrent</span><span class="o">.</span><span class="n">ThreadPoolExecutor</span><span class="o">.</span><span class="n">runWorker</span><span class="p">(</span><span class="n">ThreadPoolExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">1149</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">concurrent</span><span class="o">.</span><span class="n">ThreadPoolExecutor</span><span class="o">$</span><span class="n">Worker</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">ThreadPoolExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">624</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">Thread</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="ne">Thread</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">748</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Caused</span> <span class="n">by</span><span class="p">:</span> <span class="n">java</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">EOFException</span><span class="p">:</span> <span class="n">Can</span> <span class="ow">not</span> <span class="n">read</span> <span class="n">response</span> <span class="n">from</span> <span class="n">server</span><span class="o">.</span> <span class="n">Expected</span> <span class="n">to</span> <span class="n">read</span> <span class="mi">4</span> <span class="n">bytes</span><span class="p">,</span> <span class="n">read</span> <span class="mi">0</span> <span class="n">bytes</span> <span class="n">before</span> <span class="n">connection</span> <span class="n">was</span> <span class="n">unexpectedly</span> <span class="n">lost</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">readFully</span><span class="p">(</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">3008</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">reuseAndReadPacket</span><span class="p">(</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">3466</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span> <span class="mi">83</span> <span class="n">common</span> <span class="n">frames</span> <span class="n">omitted</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ˜¯æ•°æ®æ± è¿æ¥å‡ºé”™ã€‚ä½†æ˜¯æˆ‘æœ¬åœ°çš„åº”ç”¨ç¡®å®æ˜¯å¯ä»¥è®¿é—®æµ‹è¯•æ•°æ®åº“çš„ï¼Œ æ¯”è¾ƒæœ‰è¶£çš„å¼‚å¸¸å°±æ˜¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Caused by: java.io.EOFException: Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ•°æ®è¿˜æ²¡æœ‰è¯»å®Œï¼Œ Connection å°±ä¸¢äº†ã€‚ä¸ºä»€ä¹ˆä¼š lost connection å‘¢ï¼Œå¯èƒ½æ•°æ®åº“å‡ºé—®é¢˜ï¼Œä¹Ÿå¯èƒ½æ˜¯ç½‘ç»œå‡ºäº†é—®é¢˜ã€‚</p>
<p>æˆ‘è¿˜èƒ½ä»æ•°æ®åº“è¯»åˆ°æ•°æ®ï¼Œè¯´æ˜æ•°æ®åº“æ²¡é—®é¢˜çš„ï¼Œå…¼ä¹‹è¿™ä¸ªå¼‚å¸¸åªæ˜¯å¶å°”å‡ºç°ï¼Œæ‰€ä»¥å¯èƒ½å°±æ˜¯ç½‘ç»œå‡ºé—®é¢˜äº†ã€‚</p>
<p>å¦‚æ­¤è¯´æ¥ï¼Œæ˜¯å¦å¯èƒ½æ˜¯å› ä¸ºæµ‹è¯•ç¯å¢ƒç½‘ç»œä¸ç¨³å®šï¼Œè¿æ¥æ± æ— æ³•å’Œ Mysql ä¿æŒè¿æ¥ï¼Œåœ¨ä¸¢æ‰ Connection ä¹‹åï¼Œè¿æ¥æ± é‡æ–°å‘èµ·è¿æ¥ï¼Œä½†æ˜¯å› ä¸ºç½‘ç»œä¸ç¨³å®šåˆä¸¢æ‰äº†Connection, ä¸æ–­å¾ªç¯è¿™ä¸ªè¿‡ç¨‹ï¼Œå¯¼è‡´å»ºç«‹çš„ socket è¿æ¥è¶Š æ¥è¶Šå¤šï¼Œä½†æ˜¯å»ºç«‹çš„ socket å¾ˆå¿«å°±è¢«Close æ‰äº†ï¼Œå†…æ ¸åˆæ²¡æœ‰æŠŠè¿™äº› Close æ‰çš„ socket èµ„æºå›æ”¶æ‰ï¼Œå› æ­¤æ‰“å¼€çš„ socket æ–‡ä»¶è¶Šæ¥è¶Šå¤šï¼Œæœ€åå¯¼è‡´ Tomcat å› ä¸ºæ‰“å¼€çš„æ–‡ä»¶è¿‡å¤šæ— æ³•å»ºç«‹æ–°çš„ socket è¿æ¥ã€‚</p>
<h2 id="å°å¿ƒæ±‚è¯"><span class="section-num">6</span> å°å¿ƒæ±‚è¯</h2>
<p>å¦‚æœè¿æ¥æ± çœŸçš„ä¸æ–­å°è¯•è¿æ¥Mysql çš„è¯ï¼Œå¿…å®šä¼šå»ºç«‹å¾ˆå¤šçš„è¿æ¥ï¼Œè€ŒMysql æ˜¯ä¼šå°†è¿™äº›è®°å½•ä¿å­˜ä¸‹æ¥çš„ï¼Œæ£€æŸ¥Mysql çš„å˜é‡ï¼š</p>
<figure>
    <img loading="lazy" src="https://imgur.com/gAxepYH.png"/> 
</figure>

<p>æŸ¥çœ‹Mysql çš„æ–‡æ¡£å…³äº <code>Connection</code> å’Œ <code>Thread_connected</code> çš„è¯´æ˜ï¼š</p>
<ul>
<li>
<p>Connections</p>
<blockquote>
<p>The number of connection attempts (successful or not) to the MySQL server.</p>
</blockquote>
</li>
<li>
<p>Threads_connected</p>
<blockquote>
<p>The number of currently open connections.</p>
</blockquote>
</li>
</ul>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æ—¶å…±æœ‰20000 å¤šçš„è¿æ¥è¯·æ±‚ï¼Œä½†æ˜¯çœŸæ­£è¢« Mysql accpet å¹¶ä¸”æœåŠ¡çš„åªæœ‰ 28 ä¸ªè¿æ¥ã€‚çœ‹æ¥çš„ç¡®æ˜¯å› ä¸ºè¿æ¥æ± çš„è¿æ¥å¯¼è‡´ socket æ³„æ¼</p>
<h3 id="æ›´æ–°"><span class="section-num">6.1</span> æ›´æ–°</h3>
<p>å’Œè¿ç»´åŒå­¦æ²Ÿé€šä¹‹åï¼Œå‘ç°ä¸¢è¿æ¥çš„åŸå› ä¸æ˜¯ç½‘ç»œä¸ç¨³å®šï¼Œè€Œæ˜¯æµ‹è¯•é›†ç¾¤éƒ½æ˜¯è™šæ‹Ÿæœºï¼Œå†…å­˜ ç”¨å…‰ï¼Œå¯¼è‡´æ— æ³•å»ºç«‹æ–°çš„è¿æ¥ï¼Œå†…æ ¸é‡Šæ”¾ä¸€éƒ¨åˆ†èµ„æºä¹‹ååˆå¯ä»¥å»ºç«‹è¿æ¥äº†ã€‚å†…å­˜ç”¨å®Œï¼Œæˆ‘èƒ½æ€ä¹ˆåŠï¼Œæˆ‘ä¹Ÿå¾ˆæ— å¥ˆã€‚</p>
<h2 id="è§£å†³æ–¹æ³•"><span class="section-num">7</span> è§£å†³æ–¹æ³•</h2>
<p>è™½è¯´åŸºæœ¬ç¡®å®šäº† socket æ³„æ¼çš„æºå¤´ï¼Œä½†æ˜¯å¯¹äºå†…æ ¸ä¸ºä»€ä¹ˆæ— æ³•å›æ”¶å·²ç»å…³é—­ socket çš„åŸå› ä¾ç„¶ä¸æ˜ç¡®ã€‚</p>
<p>æœ€ä»¤äººç™¾æ€ä¸å¾—å…¶è§£çš„æ˜¯ï¼Œéƒ¨ç½²äº†åº”ç”¨çš„æµ‹è¯•æœåŠ¡å™¨æœ‰ä¸¤å°ï¼Œå¦å¤–ä¸€ å°æœåŠ¡å™¨ä¹Ÿæœ‰åŒæ ·çš„è¿æ¥æ± é—®é¢˜ï¼Œä½†æ˜¯å´æ²¡æœ‰å‡ºç° socket æ³„æ¼é—®é¢˜ï¼Œ å‡ºç°æ³„æ¼çš„åªæœ‰ 87 è¿™å°æœºå™¨ã€‚çœŸçš„ä»¤äººè´¹è§£. æ‰€ä»¥æœ€åè§£å†³æ–¹æ³•å°±æ˜¯æ’¤ä¸‹ 87 æœåŠ¡å™¨çš„åº”ç”¨ï¼Œæ¢ä¸€å°æœåŠ¡å™¨æ¥éƒ¨ç½²ã€‚</p>
<p>æ–°çš„æœåŠ¡å™¨éƒ¨ç½²åº”ç”¨ä¹‹åè™½è¯´ä¹Ÿæœ‰åŒæ ·çš„æ•°æ®åº“è¿æ¥æ± å¼‚å¸¸ï¼Œä½†æ˜¯å´æ²¡æœ‰å‡ºç° socket æ³„æ¼ï¼Œåˆæ­¥å®šä½æ˜¯ 87è¿™å°æœºå™¨çš„å†…æ ¸ç¯å¢ƒå­˜åœ¨é—®é¢˜ã€‚</p>
<h2 id="å‚è€ƒ"><span class="section-num">8</span> å‚è€ƒ</h2>
<ul>
<li><a href="http://mdba.cn/2015/03/10/tcp-socket%E6%96%87%E4%BB%B6%E5%8F%A5%E6%9F%84%E6%B3%84%E6%BC%8F/">tcp-socketæ–‡ä»¶å¥æŸ„æ³„æ¼/</a></li>
<li><a href="https://idea.popcount.org/2012-12-09-lsof-cant-identify-protocol/">lsof-cant-identify-protocol/</a></li>
</ul>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
]]></content:encoded>
    </item>
    <item>
      <title>Eshellå®ç°fzfçš„å†å²å‘½ä»¤æœç´¢åŠŸèƒ½</title>
      <link>https://ramsayleung.github.io/zh/post/2017/search_eshell_history_like_fzf/</link>
      <pubDate>Sun, 17 Dec 2017 15:46:00 -0800</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2017/search_eshell_history_like_fzf/</guid>
      <description>1 å‰è¨€ ç›®æ ‡: åœ¨=Eshell=ä¸­åƒåœ¨bash/zshä¸­ä½¿ç”¨=fzf=é‚£èˆ¬æœç´¢å†å²å‘½ä»¤ 2 fzf æˆ‘çš„ä¸»åŠ›Shell æ˜¯Eshell, ä½†æ˜¯å¹³æ—¶æˆ‘ä¹Ÿä¼šç”¨Z</description>
      <content:encoded><![CDATA[<h2 id="å‰è¨€"><span class="section-num">1</span> å‰è¨€</h2>
<p>ç›®æ ‡: åœ¨=Eshell=ä¸­åƒåœ¨bash/zshä¸­ä½¿ç”¨=fzf=é‚£èˆ¬æœç´¢å†å²å‘½ä»¤</p>
<h2 id="fzf"><span class="section-num">2</span> fzf</h2>
<p>æˆ‘çš„ä¸»åŠ›Shell æ˜¯Eshell, ä½†æ˜¯å¹³æ—¶æˆ‘ä¹Ÿä¼šç”¨Zsh, è€Œ<a href="https://github.com/junegunn/fzf">fzf</a> æ˜¯ä¸€ä¸ªéå¸¸å¥½ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äº†=fzf=æœç´¢å†å²å‘½ä»¤:</p>
<figure>
    <img loading="lazy" src="https://i.imgur.com/pPMxauw.gif"
         alt="Figure 1: fzf"/> <figcaption>
            <p><span class="figure-number">Figure 1: </span>fzf</p>
        </figcaption>
</figure>

<h2 id="eshell"><span class="section-num">3</span> Eshell</h2>
<p>æˆ‘æ—¥å¸¸çš„æ“ä½œåŸºæœ¬éƒ½æ˜¯åœ¨ Eshell ä¸Šé¢è¿›è¡Œçš„ï¼Œä¸è¿‡ Eshell æ˜¯æ²¡åŠæ³•ç›´æ¥åƒ Bash é‚£æ ·è°ƒç”¨ =fzf=æ¥æŸ¥æ‰¾å‘½ä»¤å†å²çš„ï¼Œæ‰€ä»¥æˆ‘å¸Œæœ›æŠŠè¿™ä¸ªåŠŸèƒ½è¿ç§»åˆ°åˆ°Eshell ä¸Šé¢æ¥ã€‚</p>
<p>æˆ‘åœ¨ Emacs ä½¿ç”¨çš„è¡¥å…¨æ¡†æ¶æ˜¯ <code>Ivy/Counsel</code>,å®ƒæœ‰ä¸€ä¸ª <code>counsel-esh-history=çš„å‘½ä»¤å¯ä»¥ä½¿ç”¨ =Ivy</code> æ¥æœç´¢å‘½ä»¤ï¼Œä½†æ˜¯æ²¡åŠæ³•ä½¿ç”¨ç”¨æˆ·å·²ç»è¾“å…¥çš„å†…å®¹æ¥è¿‡æ»¤å‘½ä»¤ï¼Œæ‰€ä»¥æˆ‘å°±åœ¨è‡ªå·±æŠ˜è…¾äº†ä¸€ä¸ª</p>
<p><code>counsel-esh-history</code> å‘½ä»¤ã€‚æ•ˆæœå¦‚ä¸‹ï¼š</p>
<figure>
    <img loading="lazy" src="https://i.imgur.com/3tvGDzW.gif"
         alt="Figure 2: æ„Ÿè§‰å¾ˆä¸é”™å˜› :)"/> <figcaption>
            <p><span class="figure-number">Figure 2: </span>æ„Ÿè§‰å¾ˆä¸é”™å˜› :)</p>
        </figcaption>
</figure>

<h2 id="æºä»£ç "><span class="section-num">4</span> æºä»£ç </h2>
<p>å¾—ç›Šäº =Ivy=å¼ºå¤§çš„å†…ç½®å‡½æ•°, åŠŸèƒ½å®ç°èµ·æ¥ç›¸å½“ä¾¿åˆ©ï¼Œå®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lisp" data-lang="lisp"><span class="line"><span class="cl"><span class="p">(</span><span class="nb">defun</span> <span class="nv">samray/esh-history</span> <span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="s">&#34;Interactive search eshell history.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nf">require</span> <span class="ss">&#39;em-hist</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nv">save-excursion</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nv">start-pos</span> <span class="p">(</span><span class="nv">eshell-bol</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="nv">end-pos</span> <span class="p">(</span><span class="nv">point-at-eol</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="nv">input</span> <span class="p">(</span><span class="nv">buffer-substring-no-properties</span> <span class="nv">start-pos</span> <span class="nv">end-pos</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nv">command</span> <span class="p">(</span><span class="nv">ivy-read</span> <span class="s">&#34;Command: &#34;</span>
</span></span><span class="line"><span class="cl">                                <span class="p">(</span><span class="nv">delete-dups</span>
</span></span><span class="line"><span class="cl">                                 <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nf">&gt;</span> <span class="p">(</span><span class="nv">ring-size</span> <span class="nv">eshell-history-ring</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                                   <span class="p">(</span><span class="nv">ring-elements</span> <span class="nv">eshell-history-ring</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">                                <span class="ss">:preselect</span> <span class="nv">input</span>
</span></span><span class="line"><span class="cl">                                <span class="ss">:action</span> <span class="nf">#&#39;</span><span class="nv">ivy-completion-in-region-action</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">             <span class="p">(</span><span class="nv">cursor-move</span> <span class="p">(</span><span class="nf">length</span> <span class="nv">command</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="nv">kill-region</span> <span class="p">(</span><span class="nf">+</span> <span class="nv">start-pos</span> <span class="nv">cursor-move</span><span class="p">)</span> <span class="p">(</span><span class="nf">+</span> <span class="nv">end-pos</span> <span class="nv">cursor-move</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="p">)))</span>
</span></span><span class="line"><span class="cl">  <span class="c1">;; move cursor to eol</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nv">end-of-line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»£ç ä¸æ˜¯å¾ˆå¤æ‚, ä¸»è¦åŠŸèƒ½æ˜¯è·å–ç”¨æˆ·è¾“å…¥çš„å‘½ä»¤, ç„¶åæŠŠæ‰€æœ‰çš„å†å²å‘½ä»¤è¯»å–å‡ºæ¥,æœ€åä½¿ç”¨=ivy-read=å†…ç½®çš„=ivy-completion-in-region-action=åŠŸèƒ½, ç”¨ç”¨æˆ·çš„è¾“å…¥çš„å‘½ä»¤ä¸å†å²å‘½ä»¤è¿›è¡ŒåŒ¹é…, ç”±ç”¨æˆ·é€‰æ‹©æœ€ç»ˆçš„å‘½ä»¤.</p>
<p>=ivy-read=æ˜¯Emacså†…ç½®=completing-read=çš„å‡½æ•°çš„å¼ºåŒ–, å…³äº=ivy-read=å…·ä½“ç”¨æ³•å¯ä»¥å‚è€ƒæ–‡æ¡£<a href="https://oremacs.com/swiper/#getting-started">ivy-read</a>.</p>
<h2 id="æ€»ç»“"><span class="section-num">5</span> æ€»ç»“</h2>
<p>æœ€å, æˆ‘ä¹Ÿé¡ºä¾¿æŠŠä»£ç åˆ†äº«åˆ° <a href="https://www.reddit.com/r/emacs/comments/7k54px/snippet_share_make_eshell_search_command_history/">Emacsç¤¾åŒº</a>, è€Œ <a href="https://github.com/manateelazycat">manateelazycat</a>ä¹ŸæŠŠè¿™æ®µä»£ç çš„åŠŸèƒ½åŠ å…¥åˆ°<a href="https://github.com/manateelazycat/aweshell/commit/ecaddac98b87f881910dbee8b51a98f00b6d9d5d">aweshell</a>, Oh yeah !</p>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
]]></content:encoded>
    </item>
    <item>
      <title>è„šæœ¬åˆ†äº«</title>
      <link>https://ramsayleung.github.io/zh/post/2017/share_shell_script/</link>
      <pubDate>Sat, 22 Apr 2017 00:00:00 -0700</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2017/share_shell_script/</guid>
      <description>share of my shell script snippet</description>
      <content:encoded><![CDATA[<p>åˆ†äº«ä¸€ä¸‹å¹³æ—¶å·¥ä½œç”Ÿæ´»ä¸­ç¼–å†™çš„ä¸€äº›è„šæœ¬ç‰‡æ®µ(ä¸€ç›´æ›´æ–°). é€‚ç”¨äº OS X å’Œ Linux</p>
<h2 id="å‡†å¤‡å·¥ä½œ"><span class="section-num">1</span> å‡†å¤‡å·¥ä½œ</h2>
<p>å› ä¸ºæˆ‘æ¯”è¾ƒå¤šçš„è„šæœ¬éƒ½æ˜¯åŸºäº <code>percol</code> è¿™ä¸ªç¥å™¨ï¼Œæ‰€ä»¥éœ€è¦å…ˆå®‰è£… <code>percol</code>, å¦‚æœ ä¸äº†è§£ <code>percol</code> çš„è¯ï¼Œå¯ä»¥ç¿»çœ‹ä¸€ä¸‹æˆ‘ä¹‹å‰çš„æ–‡ç«  <a href="https://ramsayleung.github.io/post/2017/percol/">Linux/Unix Shell äºŒä¸‰äº‹ä¹‹ç¥å™¨percol</a> .</p>
<p>æˆ‘ä¸€èˆ¬å°†å†™å¥½çš„å‡½æ•° source å‘½ä»¤æ·»åŠ åˆ° Shell. ä¾‹å¦‚è„šæœ¬å‡½æ•°éƒ½åœ¨ä¸€ä¸ªå« <code>tool_function.sh</code> çš„æ–‡ä»¶é‡Œé¢ï¼Œè€Œæˆ‘ä½¿ç”¨ Zsh, åˆ™åªéœ€è¦åœ¨ <code>.zshrc</code> æ·»åŠ ä¸€å¥è¯­å¥ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">source</span> /path/to/tool_function.sh
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æœä½¿ç”¨ Bash, æ·»åŠ åˆ° <code>.bashrc</code> å³å¯ã€‚</p>
<h2 id="æœ‰è¶£çš„è„šæœ¬"><span class="section-num">2</span> æœ‰è¶£çš„è„šæœ¬</h2>
<h3 id="ssh-å…å¯†ç ç™»å½•"><span class="section-num">2.1</span> SSH å…å¯†ç ç™»å½•</h3>
<p>SSH åŸºæœ¬å°±æ˜¯ç™»å½•è¿œç¨‹æœåŠ¡å™¨çš„æ ‡é…äº†ï¼Œåªæ˜¯æ¯æ¬¡ç™»å½•æœåŠ¡å™¨éƒ½è¦è¾“å…¥å¯†ç ï¼Œæœªå…å¤ªéº»çƒ¦äº†(å¥½å§ï¼Œæˆ‘æ‹¥æœ‰æ‡’æƒ°è¿™ä¸ªç¾å¾·)ï¼Œæ‰€ä»¥æˆ‘å†³å®šé…ç½® SSH çš„å…å¯†ç ç™»å½•ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="k">function</span> config_ssh_login_key<span class="o">(){</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">[</span> <span class="nv">$#</span> -lt <span class="m">3</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
</span></span><span class="line"><span class="cl">       <span class="nb">echo</span> <span class="s2">&#34;Usage: </span><span class="k">$(</span>basename <span class="nv">$0</span><span class="k">)</span><span class="s2"> -u user -h hostname -p port&#34;</span>
</span></span><span class="line"><span class="cl">       <span class="nb">kill</span> -INT <span class="nv">$$</span>
</span></span><span class="line"><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="cl">       <span class="c1">#if public/private key doesn&#39;t exist ,generate public/private key</span>
</span></span><span class="line"><span class="cl">       <span class="k">if</span> <span class="o">[</span> -f ~/.ssh/id_rsa <span class="o">]</span><span class="p">;</span><span class="k">then</span>
</span></span><span class="line"><span class="cl">          <span class="nb">echo</span> <span class="s2">&#34;public/private key exists&#34;</span>
</span></span><span class="line"><span class="cl">          <span class="k">else</span>
</span></span><span class="line"><span class="cl">              ssh-keygen -t rsa
</span></span><span class="line"><span class="cl">       <span class="k">fi</span>
</span></span><span class="line"><span class="cl">          <span class="k">while</span> <span class="nb">getopts</span> :u:h:p: option
</span></span><span class="line"><span class="cl">          <span class="k">do</span>
</span></span><span class="line"><span class="cl">              <span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$option</span><span class="s2">&#34;</span> in
</span></span><span class="line"><span class="cl">                  u<span class="o">)</span> <span class="nv">user</span><span class="o">=</span><span class="nv">$OPTARG</span><span class="p">;;</span>
</span></span><span class="line"><span class="cl">                  h<span class="o">)</span> <span class="nv">hostname</span><span class="o">=</span><span class="nv">$OPTARG</span><span class="p">;;</span>
</span></span><span class="line"><span class="cl">                  p<span class="o">)</span> <span class="nv">port</span><span class="o">=</span><span class="nv">$OPTARG</span><span class="p">;;</span>
</span></span><span class="line"><span class="cl">                  *<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;Unknown option:</span><span class="nv">$option</span><span class="s2">&#34;</span><span class="p">;;</span>
</span></span><span class="line"><span class="cl">              <span class="k">esac</span>
</span></span><span class="line"><span class="cl">          <span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&#34;</span><span class="nv">$port</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
</span></span><span class="line"><span class="cl">             <span class="nv">port</span><span class="o">=</span><span class="m">22</span>
</span></span><span class="line"><span class="cl">          <span class="k">fi</span>
</span></span><span class="line"><span class="cl">             <span class="c1">#check whether it is the first time to run this script and whether authorized_keys exists</span>
</span></span><span class="line"><span class="cl">             <span class="c1"># ssh_host_and_user=&#34;$1@$2&#34;</span>
</span></span><span class="line"><span class="cl">             <span class="nv">authorized_keys</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$HOME</span><span class="s2">/.ssh/authorized_keys&#34;</span>
</span></span><span class="line"><span class="cl">             <span class="nb">read</span> -r -s -p <span class="s2">&#34;</span><span class="nv">$user</span><span class="s2">@</span><span class="nv">$hostname</span><span class="s2">&#39;s password:&#34;</span> password
</span></span><span class="line"><span class="cl">             <span class="k">if</span> sshpass -pv <span class="nv">$password</span> ssh -p <span class="s2">&#34;</span><span class="nv">$port</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$user</span><span class="s2">@</span><span class="nv">$hostname</span><span class="s2">&#34;</span> <span class="nb">test</span> -e <span class="s2">&#34;</span><span class="nv">$authorized_keys</span><span class="s2">&#34;</span><span class="p">;</span><span class="k">then</span>
</span></span><span class="line"><span class="cl">                <span class="nb">echo</span> <span class="s2">&#34;authorized key exists&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="nb">kill</span> -INT <span class="nv">$$</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span>
</span></span><span class="line"><span class="cl">                    sshpass -p <span class="nv">$password</span> ssh  <span class="nv">$user</span>@<span class="nv">$hostname</span> -p <span class="nv">$port</span> <span class="s2">&#34;mkdir -p ~/.ssh;chmod 0700 .ssh&#34;</span>
</span></span><span class="line"><span class="cl">                    sshpass -p <span class="nv">$password</span> scp -P <span class="nv">$port</span>  ~/.ssh/id_rsa.pub <span class="nv">$user</span>@<span class="nv">$hostname</span>:~/.ssh/authorized_keys
</span></span><span class="line"><span class="cl">                    <span class="c1"># ssh-copy-id &#34;$user@$hostname -p $port&#34;</span>
</span></span><span class="line"><span class="cl">             <span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åŸºæœ¬åšæ³•å°±æ˜¯ç”Ÿæˆä¸€å¯¹å…¬ç§å¯†é’¥ï¼Œç„¶åæŠŠå…¬é’¥å‘é€åˆ°æœåŠ¡å™¨ã€‚è€Œè„šæœ¬å…¶ä»–çš„éƒ¨åˆ†å°±æ˜¯åˆ¤æ–­å¯†é’¥æ˜¯å¦å­˜åœ¨ï¼Œä¿®æ”¹å¯†é’¥æƒé™ç­‰å·¥ä½œã€‚ç”¨æ³•ä¹Ÿå¾ˆç®€å•ï¼Œå‡å¦‚ä½ æŠŠä»¥ä¸Šè„šæœ¬ä¿å­˜åˆ°äº†ä¸€ä¸ªå« <code>config_ssh_login_key.sh</code> çš„æ–‡ä»¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">bash config_ssh_login_key.sh -h your-server-ip -u user -p <span class="m">2222</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å½“ç„¶ï¼Œå¦‚æœä½ æŒ‰ç…§æˆ‘çš„å‰é¢æåˆ°çš„åšæ³•ï¼Œç”¨ source å‘½ä»¤å¼•å…¥è„šæœ¬ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨å‘½ä»¤è¡Œè¾“å…¥ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">config_ssh_login_key -u root -h your-server-ip
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æœç«¯å£æœªæŒ‡å®šï¼Œé»˜è®¤ç«¯å£ä¸º 22</p>
<h3 id="ç”Ÿæˆè‹¥å¹²ä½å¯†é’¥"><span class="section-num">2.2</span> ç”Ÿæˆè‹¥å¹²ä½å¯†é’¥</h3>
<p>ç”Ÿæˆè‹¥å¹²ä½çš„å¯†é’¥æ˜¯å¸¸è§çš„éœ€æ±‚ï¼Œå¾—ç›Šäº Linux/Unix å‘½ä»¤è¡Œå¼ºå¤§çš„è¿‡æ»¤å™¨ï¼Œæ‰€ä»¥åªéœ€æŠŠå‘½ä»¤æ•´ç†æˆè„šæœ¬å³å¯ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># generate key</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> gkey<span class="o">(){</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
</span></span><span class="line"><span class="cl">       <span class="nb">local</span> <span class="nv">length</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">       <span class="k">else</span>
</span></span><span class="line"><span class="cl">           <span class="nb">local</span> <span class="nv">length</span><span class="o">=</span><span class="m">32</span>
</span></span><span class="line"><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="cl">       <span class="nv">OS_NAME</span><span class="o">=</span><span class="k">$(</span>uname<span class="k">)</span>
</span></span><span class="line"><span class="cl">       <span class="k">if</span> <span class="o">[</span> <span class="nv">$OS_NAME</span> <span class="o">=</span> <span class="s2">&#34;Darwin&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">           <span class="nv">LC_CTYPE</span><span class="o">=</span>C cat /dev/urandom <span class="p">|</span>tr -cd <span class="s2">&#34;[:alnum:]&#34;</span><span class="p">|</span>head -c <span class="s2">&#34;</span><span class="nv">$length</span><span class="s2">&#34;</span><span class="p">;</span><span class="nb">echo</span>
</span></span><span class="line"><span class="cl">       <span class="k">else</span>
</span></span><span class="line"><span class="cl">           cat /dev/urandom <span class="p">|</span>tr -cd <span class="s2">&#34;[:alnum:]&#34;</span><span class="p">|</span>head -c <span class="s2">&#34;</span><span class="nv">$length</span><span class="s2">&#34;</span><span class="p">;</span><span class="nb">echo</span>
</span></span><span class="line"><span class="cl">       <span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç”¨æ³•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">gkey <span class="m">45</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å³ç”Ÿæˆä¸€ä¸ª45ä½å­—ç¬¦çš„éšæœºå¯†é’¥ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šé•¿åº¦çš„è¯ï¼Œé»˜è®¤æ˜¯ 32 ä½ã€‚å› ä¸º OS Xå’Œ Linux çš„ <code>tr</code> ä½¿ç”¨æœ‰å·®å¼‚ï¼Œæ‰€ä»¥è¦å¤„ç†ä¸€ä¸‹</p>
<h3 id="å¤åˆ¶å‘½ä»¤è¡Œè¾“å‡º"><span class="section-num">2.3</span> å¤åˆ¶å‘½ä»¤è¡Œè¾“å‡º</h3>
<p>æœ‰æ—¶å¯èƒ½éœ€è¦å¤åˆ¶æŸä¸ªå‘½ä»¤çš„è¾“å‡ºï¼Œä¸€èˆ¬çš„åšæ³•éƒ½æ˜¯è¿è¡ŒæŸä¸ªå‘½ä»¤ï¼Œç”¨é¼ æ ‡é€‰ä¸­ï¼Œç„¶åå¤åˆ¶ã€‚ä¾‹å¦‚åœ¨ç”Ÿæˆå¯†é’¥ä¹‹åï¼Œéœ€è¦å¤åˆ¶åˆ°é¡¹ç›®çš„é…ç½®æ–‡ä»¶ã€‚ä½†æ˜¯æ¯æ¬¡éƒ½è¦ç”¨é¼ æ ‡ï¼Œæ•ˆç‡å®åœ¨ä¸é«˜ã€‚è¿™ä¸ªåŠŸèƒ½å…¶å®å¯ä»¥è„šæœ¬å®ç°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nv">OS_NAME</span><span class="o">=</span><span class="k">$(</span>uname<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> pclip<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">[</span> <span class="nv">$OS_NAME</span> <span class="o">=</span> <span class="s2">&#34;CYGWIN&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">        putclip <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="o">[</span> <span class="nv">$OS_NAME</span> <span class="o">=</span> <span class="s2">&#34;Darwin&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">        pbcopy <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">[</span> -x /usr/bin/xsel <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">            xsel -ib <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">[</span> -x /usr/bin/xclip <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">                xclip -selection c <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span>
</span></span><span class="line"><span class="cl">                <span class="nb">echo</span> <span class="s2">&#34;Neither xsel or xclip is installed!&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">fi</span>
</span></span><span class="line"><span class="cl">        <span class="k">fi</span>
</span></span><span class="line"><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¤‡æ³¨ï¼šè¿™ä¸ªè„šæœ¬ä¸æ˜¯æˆ‘åŸåˆ›ï¼Œå–è‡ª <a href="http://blog.binchen.org/archive.html">é™ˆæ–Œ</a> åšå®¢ã€‚</p>
<p>åœ¨ Linux è¿è¡Œè¿™è„šæœ¬éœ€è¦å…ˆå®‰è£… xsel æˆ–è€…æ˜¯ xclip å‘½ä»¤ã€‚ç»“åˆç”Ÿæˆå¯†é’¥çš„å‘½ä»¤ä½¿ç”¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">gkey -28<span class="p">|</span>pclip
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ ·ï¼Œç”Ÿæˆçš„å¯†é’¥å°±è¢«å¤åˆ¶åˆ°ç³»ç»Ÿä¸Šäº†ã€‚</p>
<h3 id="å¤åˆ¶å½“å‰ç›®å½•"><span class="section-num">2.4</span> å¤åˆ¶å½“å‰ç›®å½•</h3>
<p>æœ‰æ—¶å€™ï¼Œæˆ‘éœ€è¦å¤åˆ¶å½“å‰ç›®å½•ä¸‹æŸä¸ªæ–‡ä»¶çš„è·¯å¾„ï¼Œä½†æ˜¯æ— è®ºæ˜¯æ–‡ä»¶ç®¡ç†å™¨ï¼Œè¿˜æ˜¯åœ¨Shell ä¸­éƒ½è¦ç”¨é¼ æ ‡é€‰ä¸­ç„¶åå¤åˆ¶æŒ‡å®šæ–‡ä»¶çš„è·¯å¾„ï¼Œæ•ˆç‡ä¸é«˜ä¸”å¾ˆä¸æ–¹ä¾¿ã€‚æ‰€ä»¥æˆ‘é€šè¿‡ç»“åˆ percol å’Œä¸Šé¢æé«˜çš„ pclip å‡½æ•°æ”¹è¿›äº†åšæ³•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="k">function</span> pwdf<span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">local</span> <span class="nv">current_dir</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">    <span class="nb">local</span> <span class="nv">copied_file</span><span class="o">=</span><span class="sb">`</span>find <span class="nv">$current_dir</span> -type f -print <span class="p">|</span>percol<span class="sb">`</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> -n <span class="nv">$copied_file</span> <span class="p">|</span>pclip<span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åªéœ€åœ¨ Shell ä¸­è¾“å…¥ <code>pwdf</code>, ç„¶åé€‰æ‹©éœ€è¦å¤åˆ¶çš„è·¯å¾„å³å¯ã€‚
è¿è¡Œæˆªå›¾ï¼š</p>
<figure>
    <img loading="lazy" src="https://i.imgur.com/Ppkm2xV.gif"/> 
</figure>

<hr>
<p><span class="timestamp-wrapper"><span class="timestamp">&lt;2017-05-22 Mon&gt; </span></span> Update</p>
<h3 id="åˆ¤æ–­-unix-ç³»ç»Ÿçš„ç‰ˆæœ¬"><span class="section-num">2.5</span> åˆ¤æ–­ Unix ç³»ç»Ÿçš„ç‰ˆæœ¬</h3>
<p>å› ä¸ºæˆ‘ç»å¸¸éœ€è¦åœ¨ä¸åŒçš„ Unix æœºå™¨ä¹‹é—´åˆ‡æ¢ï¼Œä¾‹å¦‚å·¥ä½œç”¨çš„ Mac OS X, å¦å¤–ä¸€å°ç¬”è®°æœ¬ä¸Šçš„ Fedora, è¿˜æœ‰ä¸€å°å·¥ä½œç«™ä¸Šçš„ Arch Linux, ä»¥åŠå„ç§å‘è¡Œç‰ˆæœ¬çš„ VPS ç­‰ï¼Œåœ¨ä¸åŒçš„å‘è¡Œç‰ˆæœ¬æˆ–è€…ç³»ç»Ÿä¹‹é—´åˆ‡æ¢ï¼Œæˆ‘å¸Œæœ›æˆ‘å¸¸ç”¨çš„å·¥å…·ä¹Ÿå¯ä»¥å¾ˆè½»æ˜“åœ°ç§»æ¤åˆ°ä¸åŒçš„å‘è¡Œç‰ˆæœ¬ä¸Šã€‚</p>
<p>ä½†æ˜¯ä¸åŒçš„å‘è¡Œç‰ˆæœ¬ä½¿ç”¨ä¸åŒçš„åŒ…å®‰è£…ç®¡ç†å™¨ï¼Œä¾‹å¦‚ OS X ä¸Šçš„ <code>brew</code>, Fedora çš„ <code>dnf</code>, Centos çš„ <code>yum</code>, Ubuntu ä¸Šçš„ <code>apt-get</code> ç­‰ç­‰ã€‚å¦‚æœå¯ä»¥é€šè¿‡ä½¿ç”¨è„šæœ¬æ¥å®ç°æ ¹æ®ä¸åŒçš„å‘è¡Œç‰ˆæœ¬ä½¿ç”¨ä¸åŒçš„åŒ…å®‰è£…ç®¡ç†å™¨å®‰è£…è½¯ä»¶ï¼Œè¿™æ ·å°±çœå¿ƒå¾ˆå¤šã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># GetOSVersion</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> GetOSVersion <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Figure out which vendor we are</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">[[</span> -x <span class="s2">&#34;`which sw_vers 2&gt;/dev/null`&#34;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># OS/X</span>
</span></span><span class="line"><span class="cl">        <span class="nv">os_VENDOR</span><span class="o">=</span><span class="sb">`</span>sw_vers -productName<span class="sb">`</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="o">[[</span> -x <span class="k">$(</span>which lsb_release 2&gt;/dev/null<span class="k">)</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">        <span class="nv">os_VENDOR</span><span class="o">=</span><span class="k">$(</span>lsb_release -i -s<span class="k">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">[[</span> <span class="s2">&#34;Debian,Ubuntu,LinuxMint&#34;</span> <span class="o">=</span>~ <span class="nv">$os_VENDOR</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">            <span class="nv">os_PACKAGE</span><span class="o">=</span><span class="s2">&#34;deb&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="o">[[</span> <span class="s2">&#34;SUSE LINUX&#34;</span> <span class="o">=</span>~ <span class="nv">$os_VENDOR</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">            lsb_release -d -s <span class="p">|</span> grep -q openSUSE
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">[[</span> <span class="nv">$?</span> -eq <span class="m">0</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">                <span class="nv">os_VENDOR</span><span class="o">=</span><span class="s2">&#34;openSUSE&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">fi</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="o">[[</span> <span class="nv">$os_VENDOR</span> <span class="o">==</span> <span class="s2">&#34;openSUSE project&#34;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">            <span class="nv">os_VENDOR</span><span class="o">=</span><span class="s2">&#34;openSUSE&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="o">[[</span> <span class="nv">$os_VENDOR</span> <span class="o">=</span>~ Red.*Hat <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">            <span class="nv">os_VENDOR</span><span class="o">=</span><span class="s2">&#34;Red Hat&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">fi</span>
</span></span><span class="line"><span class="cl">        <span class="nv">os_CODENAME</span><span class="o">=</span><span class="k">$(</span>lsb_release -c -s<span class="k">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="o">[[</span> -r /etc/redhat-release <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Red Hat Enterprise Linux Server release 5.5 (Tikanga)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Red Hat Enterprise Linux Server release 7.0 Beta (Maipo)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># CentOS release 5.5 (Final)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># CentOS Linux release 6.0 (Final)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Fedora release 16 (Verne)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># XenServer release 6.2.0-70446c (xenenterprise)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Oracle Linux release 7</span>
</span></span><span class="line"><span class="cl">        <span class="nv">os_CODENAME</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> r in <span class="s2">&#34;Red Hat&#34;</span> CentOS Fedora XenServer<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">            <span class="nv">os_VENDOR</span><span class="o">=</span><span class="nv">$r</span>
</span></span><span class="line"><span class="cl">        <span class="k">done</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$os_VENDOR</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;Red Hat&#34;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> -r /etc/oracle-release <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">            <span class="nv">os_VENDOR</span><span class="o">=</span>OracleLinux
</span></span><span class="line"><span class="cl">        <span class="k">fi</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="o">[[</span> -r /etc/SuSE-release <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> r in openSUSE <span class="s2">&#34;SUSE Linux&#34;</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="nv">$r</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;SUSE Linux&#34;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">                <span class="nv">os_VENDOR</span><span class="o">=</span><span class="s2">&#34;SUSE LINUX&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span>
</span></span><span class="line"><span class="cl">                <span class="nv">os_VENDOR</span><span class="o">=</span><span class="nv">$r</span>
</span></span><span class="line"><span class="cl">            <span class="k">fi</span>
</span></span><span class="line"><span class="cl">            <span class="nv">os_VENDOR</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">done</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># If lsb_release is not installed, we should be able to detect Debian OS</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="o">[[</span> -f /etc/debian_version <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[[</span> <span class="k">$(</span>cat /proc/version<span class="k">)</span> <span class="o">=</span>~ <span class="s2">&#34;Debian&#34;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">        <span class="nv">os_VENDOR</span><span class="o">=</span><span class="s2">&#34;Debian&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="cl">    <span class="nb">export</span> os_VENDOR
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ ¹æ®ä¸åŒçš„å‘è¡Œç‰ˆæœ¬å®‰è£…è½¯ä»¶"><span class="section-num">2.6</span> æ ¹æ®ä¸åŒçš„å‘è¡Œç‰ˆæœ¬å®‰è£…è½¯ä»¶</h3>
<p>åˆšåˆšä¸Šé¢çš„è„šæœ¬æ˜¯ä¸ºäº†å‡†ç¡®åˆ¤æ–­å‡ºæ‰€æœ‰çš„ *nix ç³»ç»Ÿçš„ï¼Œä½†æ˜¯æ–¹ä¾¿èµ·è§ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨=uname= å‘½ä»¤</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="k">$(</span>uname<span class="k">)</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;Darwin&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Do something under Mac OS X platform</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;This is mac os&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># check if brew exists</span>
</span></span><span class="line"><span class="cl">    <span class="nb">type</span> brew&gt;/dev/null 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="o">||</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s2">&#34; require brew but it&#39;s not installed.  Aborting.&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;install htop&#34;</span>
</span></span><span class="line"><span class="cl">    brew install htop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;install ag&#34;</span>
</span></span><span class="line"><span class="cl">    brew install ag
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;install httpie&#34;</span>
</span></span><span class="line"><span class="cl">    brew install httpie
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;install fasd&#34;</span>
</span></span><span class="line"><span class="cl">    brew install fasd
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;install tree&#34;</span>
</span></span><span class="line"><span class="cl">    brew install tree
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;install shellcheck&#34;</span>
</span></span><span class="line"><span class="cl">    brew install shellcheck
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;install guile&#34;</span>
</span></span><span class="line"><span class="cl">    brew install guile
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;install proxychains-ng&#34;</span>
</span></span><span class="line"><span class="cl">    brew install proxychains-ng
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;install pandoc&#34;</span>
</span></span><span class="line"><span class="cl">    brew install pandoc
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;install markdown&#34;</span>
</span></span><span class="line"><span class="cl">    brew install markdown
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;install cloc&#34;</span>
</span></span><span class="line"><span class="cl">    brew install cloc
</span></span><span class="line"><span class="cl"><span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="k">$(</span>expr substr <span class="k">$(</span>uname -s<span class="k">)</span> <span class="m">1</span> 5<span class="k">)</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;Linux&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Do something under GNU/Linux platform</span>
</span></span><span class="line"><span class="cl">    GetOSVersion
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$os_VENDOR</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;Ubuntu&#34;</span> <span class="o">]</span> <span class="o">||</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="nv">$os_VENDOR</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;Debian&#34;</span> <span class="o">]]</span> <span class="o">||</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="nv">$os_VENDOR</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;LinuxMint&#34;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># install htop</span>
</span></span><span class="line"><span class="cl">        sudo apt-get install htop -y
</span></span><span class="line"><span class="cl">        <span class="c1"># install httpie</span>
</span></span><span class="line"><span class="cl">        sudo apt-get install httpie -y
</span></span><span class="line"><span class="cl">        <span class="c1"># install ag</span>
</span></span><span class="line"><span class="cl">        sudo apt-get install  silversearcher-ag -y
</span></span><span class="line"><span class="cl">        <span class="c1"># install zeal</span>
</span></span><span class="line"><span class="cl">        sudo apt-get install zeal -y
</span></span><span class="line"><span class="cl">        <span class="c1"># install ncdu</span>
</span></span><span class="line"><span class="cl">        sudo apt-get install ncdu -y
</span></span><span class="line"><span class="cl">        <span class="c1"># install i3</span>
</span></span><span class="line"><span class="cl">        sudo apt-get install i3 -y
</span></span><span class="line"><span class="cl">        <span class="c1"># install emacs (i could die without it)</span>
</span></span><span class="line"><span class="cl">        sudo apt-get install emacs -y
</span></span><span class="line"><span class="cl">        <span class="c1"># install vim</span>
</span></span><span class="line"><span class="cl">        sudo apt-get install vim -y
</span></span><span class="line"><span class="cl">        <span class="c1"># install tree</span>
</span></span><span class="line"><span class="cl">        sudo apt-get install tree -y
</span></span><span class="line"><span class="cl">        <span class="c1"># install shellcheck</span>
</span></span><span class="line"><span class="cl">        sudo apt-get install shellcheck -y
</span></span><span class="line"><span class="cl">        <span class="c1"># install guile (scheme compiler)</span>
</span></span><span class="line"><span class="cl">        sudo apt-get install guile -y
</span></span><span class="line"><span class="cl">        <span class="c1"># install source code pro font</span>
</span></span><span class="line"><span class="cl">        <span class="o">[</span> -d /usr/share/fonts/opentype <span class="o">]</span> <span class="o">||</span> sudo mkdir /usr/share/fonts/opentype
</span></span><span class="line"><span class="cl">        sudo git clone https://github.com/adobe-fonts/source-code-pro.git /usr/share/fonts/opentype/scp
</span></span><span class="line"><span class="cl">        sudo fc-cache -f -v
</span></span><span class="line"><span class="cl">        <span class="c1"># install proxychains-ng</span>
</span></span><span class="line"><span class="cl">        sudo apt-get install proxychains-ng -y
</span></span><span class="line"><span class="cl">        <span class="c1"># install pandoc</span>
</span></span><span class="line"><span class="cl">        sudo apt-get install pandoc -y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        sudo apt-get install markdown -y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        sudo apt-get install cloc -y
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="o">[</span>  <span class="s2">&#34;</span><span class="nv">$os_VENDOR</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;Fedora&#34;</span> <span class="o">]</span> <span class="o">||</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="nv">$os_VENDOR</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;CentOS&#34;</span> <span class="o">]]</span> <span class="o">||</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="nv">$os_VENDOR</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;Korora&#34;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># install ag</span>
</span></span><span class="line"><span class="cl">        sudo yum install -y the_silver_searcher
</span></span><span class="line"><span class="cl">        <span class="c1"># install zeal</span>
</span></span><span class="line"><span class="cl">        sudo yum install -y zeal
</span></span><span class="line"><span class="cl">        <span class="c1"># install httpie</span>
</span></span><span class="line"><span class="cl">        sudo yum install -y httpie
</span></span><span class="line"><span class="cl">        <span class="c1"># install htop</span>
</span></span><span class="line"><span class="cl">        sudo yum install -y htop
</span></span><span class="line"><span class="cl">        <span class="c1"># install ncdu</span>
</span></span><span class="line"><span class="cl">        sudo yum install -y ncdu
</span></span><span class="line"><span class="cl">        <span class="c1"># install vim</span>
</span></span><span class="line"><span class="cl">        sudo yum install -y vim
</span></span><span class="line"><span class="cl">        <span class="c1"># install emacs</span>
</span></span><span class="line"><span class="cl">        sudo yum install -y emacs
</span></span><span class="line"><span class="cl">        <span class="c1"># install i3</span>
</span></span><span class="line"><span class="cl">        sudo yum install -y i3
</span></span><span class="line"><span class="cl">        <span class="c1"># install tree</span>
</span></span><span class="line"><span class="cl">        sudo yum install -y tree
</span></span><span class="line"><span class="cl">        <span class="c1"># install shellcheck</span>
</span></span><span class="line"><span class="cl">        sudo yum install ShellCheck -y
</span></span><span class="line"><span class="cl">        <span class="c1"># install guile</span>
</span></span><span class="line"><span class="cl">        sudo yum install guile -y
</span></span><span class="line"><span class="cl">        <span class="c1"># install source  code pro font</span>
</span></span><span class="line"><span class="cl">        sudo yum install adobe-source-code-pro-fonts -y
</span></span><span class="line"><span class="cl">        <span class="c1"># install proxychains-ng</span>
</span></span><span class="line"><span class="cl">        sudo yum install proxychains-ng -y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        sudo yum install pandoc -y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        sudo yum install markdown -y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># count line and space in code</span>
</span></span><span class="line"><span class="cl">        sudo yum install cloc  -y
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="o">[</span>  <span class="s2">&#34;</span><span class="nv">$os_VENDOR</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;Arch&#34;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># install ag</span>
</span></span><span class="line"><span class="cl">        sudo pacman -S -y the_silver_searcher
</span></span><span class="line"><span class="cl">        <span class="c1"># install zeal</span>
</span></span><span class="line"><span class="cl">        sudo pacman -S -y zeal
</span></span><span class="line"><span class="cl">        <span class="c1"># install httpie</span>
</span></span><span class="line"><span class="cl">        sudo pacman -S -y httpie
</span></span><span class="line"><span class="cl">        <span class="c1"># install htop</span>
</span></span><span class="line"><span class="cl">        sudo pacman -S -y htop
</span></span><span class="line"><span class="cl">        <span class="c1"># install ncdu</span>
</span></span><span class="line"><span class="cl">        sudo pacman -S -y ncdu
</span></span><span class="line"><span class="cl">        <span class="c1"># install vim</span>
</span></span><span class="line"><span class="cl">        sudo pacman -S -y vim
</span></span><span class="line"><span class="cl">        <span class="c1"># install emacs</span>
</span></span><span class="line"><span class="cl">        sudo pacman -S -y emacs
</span></span><span class="line"><span class="cl">        <span class="c1"># install i3</span>
</span></span><span class="line"><span class="cl">        sudo pacman -S -y i3
</span></span><span class="line"><span class="cl">        <span class="c1"># install tree</span>
</span></span><span class="line"><span class="cl">        sudo pacman -S -y tree
</span></span><span class="line"><span class="cl">        <span class="c1"># install shellcheck</span>
</span></span><span class="line"><span class="cl">        sudo pacman -S ShellCheck -y
</span></span><span class="line"><span class="cl">        <span class="c1"># install guile</span>
</span></span><span class="line"><span class="cl">        sudo pacman -S guile -y
</span></span><span class="line"><span class="cl">        <span class="c1"># install source-code-pro font</span>
</span></span><span class="line"><span class="cl">        sudo pacman -S adobe-source-code-pro-fonts -y
</span></span><span class="line"><span class="cl">        <span class="c1"># install proxychains-ng</span>
</span></span><span class="line"><span class="cl">        sudo pacman -S proxychains-ng -y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        sudo pacman -S pandoc -y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        sudo pacman -S markdown -y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        sudo pacman -S ripgrep -y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        sudo pacman -S cloc  -y
</span></span><span class="line"><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="k">$(</span>expr substr <span class="k">$(</span>uname -s<span class="k">)</span> <span class="m">1</span> 10<span class="k">)</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;MINGW32_NT&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Do something under 32 bits Windows NT platform</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;This is 32-bit windows&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="k">$(</span>expr substr <span class="k">$(</span>uname -s<span class="k">)</span> <span class="m">1</span> 10<span class="k">)</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;MINGW64_NT&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Do something under 64 bits Windows NT platform</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;this is 64-bit windows&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åŠ å¯†ç›®å½•"><span class="section-num">2.7</span> åŠ å¯†ç›®å½•</h3>
<p>æ¯ä¸ªäººéƒ½ä¼šæœ‰éœ€è¦åªå±äºè‡ªå·±çš„ä¸œè¥¿ï¼Œä¿æŠ¤è¿™äº›ä¸œè¥¿æœ€å¥½çš„åŠæ³•å°±æ˜¯å¯¹å…¶è¿›è¡ŒåŠ å¯†ï¼š</p>
<h4 id="åŠ å¯†"><span class="section-num">2.7.1</span> åŠ å¯†</h4>
<p>ä½¿ç”¨ <code>tar</code> å’Œ <code>openssl</code> å¯¹ç›®å½•è¿›è¡ŒåŠ å¯†ï¼Œå…ˆä½¿ç”¨ <code>tar</code> å½’æ¡£å½“å‰æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨
<code>aes256</code> ç®—æ³•è¿›è¡ŒåŠ å¯†ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">tar -czf - * <span class="p">|</span> openssl enc -e -aes256 -out encrypted.tar.gz
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="è§£å¯†"><span class="section-num">2.7.2</span> è§£å¯†</h4>
<p>æŠŠåŠ å¯†åçš„å½’æ¡£æ–‡ä»¶è§£å¯†åˆ°å½“å‰å‘½ä»¤ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">openssl enc -d -aes256 -in encrypted.tar.gz<span class="p">|</span> tar xz -C <span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
]]></content:encoded>
    </item>
    <item>
      <title>å¤§è¯Linuxæ–‡ä»¶ç³»ç»Ÿ</title>
      <link>https://ramsayleung.github.io/zh/post/2017/linux_file_system/</link>
      <pubDate>Thu, 30 Mar 2017 00:00:00 +0800</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2017/linux_file_system/</guid>
      <description>an discussion about linux file system</description>
      <content:encoded><![CDATA[<p>ä¸ä¹…å‰ï¼ŒApple çš„æ–‡ä»¶ç³»ç»Ÿ (Apple File System) æ–°æ¨å‡ºï¼Œç„¶åå„æ–¹ä¾¿ä¸€èµ·æŒ¤èº«å‘å‰å¯¹APFS &ldquo;è¯„å¤´å“è¶³&rdquo;,æˆ‘æ˜¯ä¸äº†è§£ APFS ,æ‰€ä»¥ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå‘è¨€æƒå˜›ï¼Œä¸è¿‡è¯åˆ†ä¸¤å¤´ï¼›</p>
<p>å¯¹Linuxçš„æ–‡ä»¶ç³»ç»Ÿï¼Œæˆ‘è¿˜æ˜¯æœ‰äº†è§£è¿‡çš„ï¼Œæ‰€ä»¥å¯ä»¥èŠèŠLinux çš„æ–‡ä»¶ç³»ç»Ÿï¼›ä¸Windows å’ŒApple ä¸¤å®¶å•†ä¸šå…¬å¸ä¸åŒï¼ŒLinux æ˜¯å¼€æºçš„ï¼Œå› æ­¤ï¼Œåªè¦ä½ æœ‰è¶³å¤Ÿçš„æ—¶é—´å’Œèƒ½åŠ›ï¼Œä½ å°±å¯ä»¥è‡ªå·±å†™ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œè¿™ä¸ªä¹Ÿæ˜¯Linux æ–‡ä»¶ç³»ç»Ÿä¼—å¤šçš„ä¸»è¦åŸå› ã€‚</p>
<p>é‚£ä¹ˆæœ‰ä¼—å¤šçš„Linux æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒä»¬çš„å·®å¼‚,ä¼˜ç¼ºç‚¹åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<h2 id="file-system"><span class="section-num">1</span> File System</h2>
<p>åœ¨å¼€å§‹ &ldquo;å¤§è¯&rdquo; å„ç§æ–‡ä»¶ç³»ç»Ÿçš„æ—¶å€™ï¼Œæˆ‘å…ˆæƒ³è°ˆè°ˆä»€ä¹ˆæ˜¯æ–‡ä»¶ç³»ç»Ÿã€‚</p>
<p>ä¸€èˆ¬ç”¨æˆ·å¹³æ—¶éƒ½ä¼šæœ‰ä¸Šç™¾G çš„æ•°æ®ï¼Œé‚£ä¹ˆå¤šçš„æ•°æ®ï¼Œåº”è¯¥æ€ä¹ˆä¿å­˜å‘¢ï¼Ÿ</p>
<p>ä¸çŸ¥é“æ€ä¹ˆå›ç­”ï¼Œå¯ä»¥å…ˆç±»æ¯”ä¸€ä¸‹ï¼Œæƒ³è±¡ä¸€ä¸‹ä½ æœ‰å¾ˆå¤šä¹¦ï¼Œä½ ä¼šæ€ä¹ˆæ”¾ç½®ä½ çš„ä¹¦ç±å‘¢ï¼Ÿç›´æ¥ä¸¢åœ¨å®¢å…ä¸­é—´ï¼Ÿæˆ–è€…æ˜¯æŒ‰ä¹¦å†…å®¹åˆ†ç±» æ”¾åˆ°ä¹¦æ¶ä¸Šï¼Ÿå¦‚æœåˆ†ç±»çš„è¯ï¼Œæ˜¯æŒ‰æ€ä¹ˆåˆ’åˆ†å‘¢ï¼Ÿä½ ä¹°å›æ¥çš„ä¹¦æ¶ä¸€æ¬¡å¯ä»¥æ”¾ç½®å¤šå°‘ä¹¦ç±å‘¢ï¼Ÿæ€ä¹ˆæ‰èƒ½æ›´å¿«åœ°æ‰¾åˆ°ä½ è¦æ‰¾çš„ä¹¦å‘¢ï¼Ÿ</p>
<p>å…¶å®æ–‡ä»¶ç³»ç»Ÿå¤„ç†ï¼Œæ£€ç´¢æ–‡ä»¶å’Œä½ æ”¾ç½®ï¼ŒæŸ¥æ‰¾ä¹¦ç±æ˜¯ç±»ä¼¼çš„ï¼æ­¤å¤–,åœ¨Windows ä¸‹å¸¸è§åˆ°çš„æ ¼å¼åŒ–ï¼Œå…¶å®å°±æ˜¯åœ¨ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿä¹‹é—´åˆ‡æ¢ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆæ•°æ®ä¼šä¸¢å¤±å‘¢ï¼Ÿ</p>
<p>ä½ å¯ä»¥ç±»æ¯”æˆä½ å®¶é‡Œè£…ä¿®ï¼Œæƒ³æ¢æ–°çš„ä¹¦æ¶ï¼Œä½†æ˜¯å¦‚æœä¸æŠŠåŸæ¥ä¹¦æ¶ä¸Šçš„ä¹¦ç±æ¬å‡ºå‡†å¤‡è£…ä¿®çš„å±‹å­ï¼Œè£…ä¿®æ—¶è‚¯å®šä¼šæŸåä¹¦ç±å˜›ï¼</p>
<h2 id="journaling"><span class="section-num">2</span> Journaling</h2>
<p>åœ¨æ¯”è¾ƒæ–‡ä»¶ç³»ç»Ÿä¹‹å‰ï¼Œå…ˆèŠèŠæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ—¥å¿— (Journaling), è€Œæœ‰äº›æ–‡ä»¶ç³»ç»Ÿæ˜¯æœ‰æ—¥å¿—åŠŸèƒ½çš„ï¼Œè€Œæœ‰äº›æ˜¯æ²¡æœ‰æ—¥å¿—åŠŸèƒ½çš„ï¼›</p>
<p>ä¸ºäº†äº†è§£å®ƒä»¬ä¹‹é—´çš„å·®å¼‚ï¼Œå°±éœ€è¦å…ˆäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯æ—¥å¿—ã€‚æ—¥å¿—çš„å‡ºç°æœ¬è´¨è€Œè¨€éƒ½æ˜¯ä¸ºäº†æ›´å¥½åœ°ä¿å­˜æ•°æ®ã€‚</p>
<p>å‡è®¾ä½ æ­£åœ¨å‘ç£ç›˜é‡Œå†™å…¥æ–‡ä»¶ï¼Œçªç„¶é—´æ–­ç”µäº†ï¼Œä½†æ˜¯ä½ çš„æ–‡ä»¶æ˜¯æ²¡æœ‰å®Œæˆå†™å…¥ç£ç›˜çš„ï¼Œè€Œä½ çš„ç”µè„‘æ˜¯ä¸çŸ¥é“æ˜¯å¦å·²ç»å®Œæˆå†™å…¥ï¼Œæ‰€ä»¥ä¸‹æ¬¡é‡æ–°æ¥ç”µå¯åŠ¨ç”µè„‘çš„æ—¶å€™ï¼Œæ˜¯æ²¡æœ‰â€œäººâ€å‘ŠçŸ¥ç”µè„‘æ˜¯å¦è¦é‡æ–°å†™æ•°æ®çš„ï¼Ÿè¿™æ ·æ•°æ®å°±ä¸¢å¤±äº†ã€‚</p>
<p>èƒ½ä¸èƒ½åœ¨æ–‡ä»¶è¿˜æ²¡æœ‰å®Œæˆå†™å›ç£ç›˜åˆä¸­é€”å‡ºç°é”™è¯¯çš„æ—¶å€™ï¼Œå‘Šè¯‰ç³»ç»Ÿä½ çš„ ç›®æ ‡æ–‡ä»¶è¿˜æœ‰æ•°æ®æ²¡æœ‰å†™å›ç£ç›˜ï¼Œä½ è¦è®°å¾—å®Œæˆè¿™é¡¹å·¥ä½œé˜¿ï¼Ÿ</p>
<p>å½“ç„¶å¯ä»¥ï¼Œè¿™å°±æ˜¯æ–‡ä»¶ç³»ç»Ÿä¸­æ—¥å¿—çš„åŠŸèƒ½ï¼Œåœ¨æ—¥å¿—çš„ååŠ©ä¸‹ï¼Œä½ çš„ç”µè„‘ä¼šåœ¨æ—¥å¿—ä¸­è®°ç€ï¼Œâ€œæˆ‘è¦æŠŠæŸæŸæ–‡ä»¶å†™å…¥åˆ°ç£ç›˜â€ï¼Œå¦‚æœé¡ºåˆ©å®Œæˆå†™å…¥ç£ç›˜å·¥ä½œï¼Œæ—¥å¿—çš„è¿™é¡¹è®°å½•å°±ä¼šè¢«åˆ é™¤ï¼Œå¦‚æœä¸­é€”å‡ºç°å¼‚å¸¸ï¼Œä¾‹ å¦‚æ–­ç”µäº†ï¼Œé‡æ–°å¯åŠ¨çš„æ—¶å€™ï¼Œä½ çš„ç³»ç»Ÿå°±ä¼šå‘ç°ï¼Œæˆ‘è¦å†™å…¥æŸæŸæ–‡ä»¶çš„å·¥ä½œè¿˜æ²¡å®Œæˆï¼Œå®ƒå°±ä¼šç»§ç»­æœªäº†çš„äº‹ä¸šï¼Œè¿™æ ·å°±å¯ä»¥ä¿éšœæ•°æ®ä¸ä¼šä¸¢å¤±ã€‚</p>
<p>(è€Œä½ æ—¥å¸¸å·¥ä½œç”Ÿæ´»ä¸­ï¼Œæ•°æ®çš„ä¸¢å¤±æ˜¯å› ä¸ºä½ æ²¡æœ‰ä¿å­˜æ•°æ®ï¼Œå³æ²¡æœ‰æŠŠæ•°æ®å†™å…¥åˆ°ç£ç›˜). å¦‚å›¾ï¼š</p>
<figure>
    <img loading="lazy" src="https://www.howtogeek.com/wp-content/uploads/2017/02/img_58af43716360e.png%20"/> 
</figure>

<p>å› ä¸ºå†™å…¥æ—¥å¿—éœ€è¦é¢å¤–çš„å·¥ä½œï¼Œæ‰€ä»¥éœ€è¦é¢å¤–çš„èµ„æºï¼Œä½†æ˜¯è¿™æ ·çš„æ¶ˆè€—æ˜¯ç›¸å½“å€¼å¾—åœ°ã€‚</p>
<h2 id="comparison"><span class="section-num">3</span> Comparison</h2>
<p>ä¸‹é¢å¯¹æ¯”ä¸€ä¸‹ å„ç§æ–‡ä»¶ç³»ç»Ÿçš„ç‰¹æ€§</p>
<figure>
    <img loading="lazy" src="/ox-hugo/comparison_file_system.png"
         alt="Figure 1: å›¾æ¥è‡ªarchwiki"/> <figcaption>
            <p><span class="figure-number">Figure 1: </span>å›¾æ¥è‡ªarchwiki</p>
        </figcaption>
</figure>

<p>å¦‚æœä½ æƒ³äº†è§£ä½ çš„Linux å†…æ ¸æ‰€æ”¯æŒçš„æ–‡ä»¶ç³»ç»Ÿï¼Œä½ å¯ä»¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">cat /proc/filesystems
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç°åœ¨å°±æ¥æ¯”è¾ƒä¸€ä¸‹å„ç§å¸¸è§çš„Linuxæ–‡ä»¶ç³»ç»Ÿ</p>
<h3 id="ext"><span class="section-num">3.1</span> Ext</h3>
<p>Ext æ˜¯æŒ‡&quot;Extended file system(æ‰©å±•æ–‡ä»¶ç³»ç»Ÿ)&quot;,åº”è¯¥ç®—æ˜¯Linux æ–‡ä»¶ç³»ç»Ÿé‡Œé¢çš„è€å¤§çˆ·äº†ï¼Œå®ƒæ˜¯ä»ç»å…¸çš„ Minix çš„æ–‡ä»¶ç³»ç»Ÿè¡ç”Ÿè¿‡æ¥çš„ï¼Œä¸ºLinux ä¸“é—¨è®¾è®¡çš„ï¼Œä½†æ˜¯å®ƒç¼ºä¹å¾ˆå¤šé‡è¦çš„ç‰¹æ€§ï¼Œæ¯”å¦‚ä¸Šé¢æåˆ°çš„æ—¥å¿—åŠŸèƒ½ï¼Œæ‰€ä»¥å¤§éƒ¨ä»½çš„Linux å‘è¡Œç‰ˆæœ¬éƒ½æ˜¯ä¸æ”¯æŒ Ext äº†</p>
<h3 id="ext2"><span class="section-num">3.2</span> Ext2</h3>
<p>Ext2 ä¹Ÿæ˜¯ä¸æ”¯æŒæ—¥å¿—çš„ï¼Œä½†æ˜¯å®ƒæ˜¯ç¬¬ä¸€ä¸ªæ”¯æŒæ‰©å±•æ–‡ä»¶å±æ€§å’Œ2T å®¹é‡çš„Linux æ–‡ä»¶ç³»ç»Ÿï¼Œä½†æ˜¯æ­£ç”±äºExt2 ä¸æ”¯æŒæ—¥å¿—åŠŸèƒ½ï¼Œå®ƒå¯ä»¥æ›´å°‘åœ°å†™ç£ç›˜ï¼Œæ‰€ä»¥å®ƒé€‚åˆåƒUSB è¿™ç§é—ªå­˜ï¼Œä½†æ˜¯Ext2 æ— æ³•è¢«Windows è¯†åˆ«çš„ï¼Œæ‰€ä»¥å®ƒçš„é—ªå­˜åŠŸèƒ½æ›´å¤šåœ°è¢«FAT32å’ŒexFATæ‰€ä»£æ›¿ï¼Œæ¢è¨€ä¹‹ï¼ŒExt2 ç”¨çš„ä¹Ÿä¸å¤š</p>
<h3 id="ext3"><span class="section-num">3.3</span> Ext3</h3>
<p>Ext3 å°±æ˜¯Ext2 å¸¦æœ‰æ—¥å¿—åŠŸèƒ½çš„æ‰©å±•ï¼Œå¹¶ä¸”Ext3 ä¹Ÿå‘åå…¼å®¹Ext2,æ‰€ä»¥ä½ åœ¨Ext2 å’ŒExt3 ä¹‹é—´åˆ‡æ¢ä¹Ÿæ˜¯ä¸éœ€è¦é‡æ–°æ ¼å¼åŒ–æ»´ï¼Œä½†æ˜¯æœ€å¸¸ç”¨çš„è¿˜ä¸æ˜¯Ext3,è€Œæ˜¯Ext4 :)</p>
<h3 id="ext4"><span class="section-num">3.4</span> Ext4</h3>
<p>Ext4 ä¹Ÿæ˜¯å‘åå…¼å®¹ Ext3 å’ŒExt2 çš„ï¼Œæ‰€ä»¥ä½ æ˜¯å¯ä»¥åœ¨Ext4,Ext3,Ext2 ä¹‹é—´åˆ‡æ¢è€Œæ— éœ€æ ¼å¼åŒ–æ–‡ä»¶ç³»ç»Ÿã€‚</p>
<p>Ext4 åŒ…å«å¾ˆå¤šæ–°çš„ç‰¹æ€§ï¼Œä¾‹å¦‚æ”¯æŒå­˜å‚¨æ›´å¤§çš„æ–‡ä»¶ï¼Œæ”¯æŒå»¶è¿Ÿåˆ†é…ä»¥ æ”¹è¿›å¯¹é—ªå­˜çš„æ”¯æŒï¼Œè¿˜èƒ½æœ‰æ•ˆåœ°å‡å°‘æ–‡ä»¶çš„ç¢ç‰‡åŒ–ï¼Œæé«˜åˆ©ç”¨æ•ˆç‡ã€‚</p>
<p>æ˜¾è€Œæ˜“è§ï¼ŒExt4 æ˜¯æœ€å…ˆè¿›çš„ Ext ç³»åˆ—çš„æ–‡ä»¶ç³»ç»Ÿï¼Œä¹Ÿæ˜¯å¤§éƒ¨åˆ†Linux å‘è¡Œç‰ˆæœ¬çš„é»˜è®¤æ–‡ä»¶ç³»ç»Ÿ</p>
<h3 id="zfs"><span class="section-num">3.5</span> ZFS</h3>
<p>ZFS æœ€åˆæ˜¯ç»™Sun çš„Solaris è®¾è®¡çš„ï¼ŒSun è¢«æ”¶è´­åï¼Œç°åœ¨æ˜¯å±äºOracle çš„ï¼ŒZFS æ”¯æŒ å¤§é‡éå¸¸å…ˆè¿›çš„ç‰¹æ€§ï¼Œæ¯”å¦‚è¯´ å¿«ç…§ (snapshot),åŠ¨æ€å­˜å‚¨ (dynamic disk striping), é©±åŠ¨æ± ç­‰ (drive pool);</p>
<p>æ­¤å¤–ZFS æ–‡ä»¶çš„æ¯ä¸ªæ–‡ä»¶éƒ½æ˜¯æœ‰æ ¡éªŒå’Œçš„ï¼Œæ‰€ä»¥é€šè¿‡æ£€æŸ¥æ ¡éªŒå’Œï¼Œå°±èƒ½ç¡®å®šæ–‡ä»¶çš„å®Œæ•´æ€§ã€‚ä½†æ˜¯ï¼Œè™½è¯´ZFS éå¸¸å¼ºå¤§ï¼Œå´å› ä¸ºZFS license çš„ç¼˜æ•…ï¼Œ ZFS æ— æ³•æ·»åŠ åˆ° Linux å†…æ ¸çš„ã€‚å¦‚æœä½ éå¸¸æƒ³è¦å°è¯•ZFS çš„è¯ï¼Œä½ å¯ä»¥è‡ªè¡Œæ·»åŠ å¯¹Linux å‘è¡Œç‰ˆæœ¬ä¸Šé¢æ·»åŠ ZFS çš„æ”¯æŒ</p>
<h3 id="brtfs"><span class="section-num">3.6</span> BrtFS</h3>
<p>Brtfs æ˜¯ç”±Oracle è®¾è®¡çš„ä¸€ä¸ªæ”¯æŒå†™æ—¶å¤åˆ¶ (copy on write) çš„ç°ä»£æ–‡ä»¶ç³»ç»Ÿ;</p>
<p>è€ŒBtrfs çš„æ„æ€æ˜¯ B æ ‘æ–‡ä»¶ç³»ç»Ÿ (B-Tree File System),å®ƒæ”¯æŒå¤§é‡éå¸¸å…ˆè¿›çš„ç‰¹æ€§ï¼Œä¾‹å¦‚ åŠ¨æ€inode åˆ†é…ï¼Œæ•°æ®æ ¡éªŒå’Œï¼Œæœ‰æ•ˆçš„å¢é‡å¤‡ä»½ï¼Œé©±åŠ¨æ± ï¼Œæœ€å¤§æ”¯æŒ 2^64 byte å®¹é‡å³16 Eib å¤§çš„æ–‡ä»¶ã€‚</p>
<p>BtrFS æ˜¯è¢«è®¾è®¡æˆå–ä»£Ext ç³»åˆ—çš„æ–‡ä»¶ç³»ç»Ÿçš„ï¼Œåªä¸è¿‡å› ä¸ºç°åœ¨çš„BtrFS è¿˜æ²¡æœ‰è¶³å¤Ÿæˆç†Ÿï¼Œæ‰€ä»¥è¿˜æ²¡æœ‰å¤§å…¬å¸åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ BtrFS,ä½†æ˜¯BtrFS çš„æœªæ¥å¯æœŸ</p>
<h3 id="jfs"><span class="section-num">3.7</span> JFS</h3>
<p>JFS æ˜¯IBM ä¸ºIBM è‡ªå®¶çš„AIX æ“ä½œç³»ç»Ÿè®¾è®¡çš„æ—¥å¿—æ–‡ä»¶ç³»ç»Ÿ (Journaled File System), åæ¥è¿ç§»åˆ°äº†Linux ç³»ç»Ÿä¸Š (HP-UX ä¹Ÿæœ‰ä¸€ä¸ªå«åšJFS çš„æ–‡ä»¶ç³»ç»Ÿ).</p>
<p>åœ¨AIX ç³»ç»Ÿä¸Šæ˜¯å­˜åœ¨è¿‡ä¸¤ä»£çš„JFSæ–‡ä»¶ç³»ç»Ÿçš„ï¼Œåˆ†åˆ«æ˜¯ JFS1å’ŒJFS2,è€ŒLinux ä¸Šå°±åªæœ‰JFS2äº†(Linux ä¸Šçš„JFSéƒ½æ˜¯æŒ‡JFS2)ã€‚</p>
<p>JFS æ— è®ºåœ¨å¤„ç†å¤§æ–‡ä»¶è¿˜æ˜¯å°æ–‡ä»¶éƒ½æœ‰éå¸¸ä¸é”™çš„è¡¨ç°ï¼Œå¹¶ä¸”CPU å ç”¨ä¹Ÿæ˜¯æ¯”è¾ƒä½çš„ï¼›JFS ä¹Ÿæ˜¯æ”¯æŒéå¸¸å¤šçš„ç‰¹æ€§çš„ï¼Œä¾‹å¦‚ B+ æ ‘ï¼ŒåŠ¨æ€Inode åˆ†é…ï¼Œå¹¶å‘IOç­‰ã€‚</p>
<p>JFS ä¹Ÿæ˜¯ä¸€ä¸ªè®¾è®¡ä¼˜ç§€çš„æ–‡ä»¶ç³»ç»Ÿå¹¶ä¸”æ”¯æŒå¤§éƒ¨åˆ†çš„Linux å‘è¡Œç‰ˆæœ¬ï¼Œä½†æ˜¯å› ä¸ºå®ƒæœ€åˆæ˜¯ä¸ºAIX è®¾è®¡ï¼Œæ‰€ä»¥åœ¨å¤„äºç”Ÿäº§ç¯å¢ƒä¸Šçš„LinuxæœåŠ¡å™¨çš„æµ‹è¯•å°±ä¸å¦‚Ext :(.</p>
<h3 id="reiserfs"><span class="section-num">3.8</span> ReiserFS</h3>
<p>ReiserFs æ˜¯ç¬¬ä¸€ä¸ªè¢«å¼•è¿›Linux æ ‡å‡†å†…æ ¸çš„æ—¥å¿—æ–‡ä»¶ç³»ç»Ÿ(åœ¨å†…æ ¸ç‰ˆæœ¬ä¸º2.4.1çš„æ—¶å€™å¼•è¿›),ä¹Ÿæ˜¯Linux æ–‡ä»¶ç³»ç»Ÿçš„ä¸€æ¬¡é£è·ƒï¼Œé‚£æ—¶çš„ReiserFS åŒ…å«äº†å¾ˆå¤šExt æ²¡æœ‰çš„æ–°ç‰¹æ€§ã€‚</p>
<p>è™½è¯´ ReiserFS åœ¨Linux æœ‰ä¸€ä¸ªéå¸¸åä¸½çš„å¼€å¤´ï¼Œä½†æ˜¯åæ¥ReiserFS çš„å¼€å‘å°±é™·å…¥äº†åœæ»ï¼Œå› ä¸ºReiserFS çš„æ ¸å¿ƒå¼€å‘è€…Hans Reiser(ReiserFS åå­—çš„æ¥ç”±)å› ä¸ºè°‹æ€å¦»å­è€Œè¢«æ”¶ç›‘ :(ã€‚</p>
<p>è€Œåæ¥çš„ReiserFS ä¹Ÿæ²¡æœ‰å‡ºç°åœ¨ä¸»è¦çš„Linux å†…æ ¸ç‰ˆæœ¬é‡Œé¢ï¼Œè™½è¯´ReiserFSæ˜¯éå¸¸å¥½çš„æ–‡ä»¶ç³»ç»Ÿï¼Œä½†æ˜¯å®ƒå‰æ™¯å¦‚ä½•ï¼Œæˆ‘ä»¬ä¹Ÿåªèƒ½æ‹­ç›®ä»¥å¾…äº†</p>
<h3 id="xfs"><span class="section-num">3.9</span> XFS</h3>
<p>XFS æœ€åˆæ˜¯Silicon Graphics ä¸ºSGI IRX æ“ä½œç³»ç»Ÿè®¾è®¡çš„64ä½é«˜æ€§èƒ½æ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨2001 å¹´è¿ç§»åˆ°äº†Linux.</p>
<p>å¾—ç›ŠäºXFS åŸºäº allocation groups çš„è®¾è®¡ï¼ŒXFS æ‹¥æœ‰éå¸¸ä¼˜ç§€çš„å¹¶è¡ŒIO èƒ½åŠ›ï¼Œå¹¶æ”¯æŒå»¶è¿Ÿåˆ†é… (delayed allocation) ä»¥æ”¹è¿›æ–‡ä»¶ç¢ç‰‡åŒ–ï¼Œåœ¨æŸç§ç¨‹åº¦ä¸Šï¼ŒXFS å’ŒExt æœ‰ä¸€å®šçš„ç›¸ä¼¼ï¼›</p>
<p>æ­¤å¤–ï¼Œè™½è¯´XFS æ˜¯é«˜æ€§èƒ½çš„æ–‡ä»¶ç³»ç»Ÿï¼Œä½†æ˜¯é‚£åªæ˜¯é’ˆå¯¹å¤§æ–‡ä»¶è€Œè¨€çš„ï¼Œå¯¹äºå°æ–‡ä»¶XFS å°±æœ‰ç‚¹åŠ›æ‰€ä¸èƒ½åŠ (å½“ç„¶ï¼Œè¿™æ˜¯ç›¸å¯¹è€Œè¨€).</p>
<p>æ‰€ä»¥å¦‚æœæ˜¯éœ€è¦ ç»å¸¸å¤„ç†å¤§æ–‡ä»¶çš„æœåŠ¡å™¨ï¼ŒXFS ä¼šæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©</p>
<h2 id="å°ç»“"><span class="section-num">4</span> å°ç»“</h2>
<p>å¦‚æœå°†Linux çš„æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œåˆ†ç±»çš„è¯ï¼Œè¿˜å¯ä»¥åˆ†æˆ FUSE (Filesystem in Userspace,
è®©ç”¨æˆ·åœ¨æ²¡æœ‰æƒé™çš„æƒ…å†µä¸‹ï¼Œåˆ›å»ºè‡ªå·±çš„æ–‡ä»¶ç³»ç»Ÿ), Stackable file System (å…ˆè¿›çš„å¤šå±‚æ¬¡ç»Ÿä¸€æ–‡ä»¶ç³»ç»Ÿ), Read-only file systems (åªè¯»æ–‡ä»¶ç³»ç»Ÿ), Clustered file systems
(é›†ç¾¤æ–‡ä»¶ç³»ç»Ÿ)ç­‰ç­‰ã€‚</p>
<p>Linux çš„æ–‡ä»¶ç³»ç»Ÿè¿˜æœ‰å¾ˆå¤šï¼Œæ¯ä¸€ç§éƒ½æœ‰è‡ªå·±çš„ç‰¹ç‚¹ï¼›ä½†æ˜¯å¦‚æœä½ æƒ³é—®ï¼š&ldquo;Linux æœ€å¥½çš„æ–‡ä»¶ç³»ç»Ÿæ˜¯ä»€ä¹ˆï¼Ÿ&quot;;è¿™ä¸ªé—®é¢˜å°±è·Ÿ &ldquo;æœ€å¥½çš„Linux å‘è¡Œç‰ˆæœ¬æ˜¯ä»€ä¹ˆï¼Ÿ&rdquo;, &ldquo;æœ€å¥½çš„æ–‡æœ¬ç¼–è¾‘å™¨æ˜¯ä»€ä¹ˆï¼Ÿ&rdquo; ä¸€æ ·ï¼Œæ˜¯æ²¡æœ‰æ ‡å‡†ç­”æ¡ˆï¼Œä¸€åƒä¸ªäººéƒ½æœ‰ä¸€åƒä¸ªå“ˆå§†é›·ç‰¹äº†ï¼Œä½ çš„å“ˆå§†é›·ç‰¹æ˜¯ä»€ä¹ˆæ ·å­ï¼Œåªæœ‰ä½ è‡ªå·±æ¸…æ¥šã€‚</p>
<p>ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿå¯¹åº”ä¸åŒçš„åœºæ™¯ï¼Œåªæœ‰é’ˆå¯¹ç‰¹å®šåœºæ™¯çš„æœ€ä¼˜è§£å†³æ–¹æ¡ˆï¼å¦‚æœè¿˜ä¸çŸ¥é“æ€ä¹ˆé€‰æ‹©ï¼Œé‚£å°±é€‰æ‹©Ext4 å§ï¼Œæ— æ³•åšå‡ºé€‰ æ‹©æ—¶ï¼Œé»˜è®¤çš„å°±æ˜¯æœ€å¥½ :)</p>
<h2 id="å‚è€ƒ"><span class="section-num">5</span> å‚è€ƒ</h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/File_system">https://en.wikipedia.org/wiki/File_system</a></li>
<li><a href="https://btrfs.wiki.kernel.org/index.php/Main_Page">https://btrfs.wiki.kernel.org/index.php/Main_Page</a></li>
<li><a href="https://en.wikipedia.org/wiki/JFS_(file_system)">https://en.wikipedia.org/wiki/JFS_(file_system)</a></li>
<li><a href="https://en.wikipedia.org/wiki/ReiserFS">https://en.wikipedia.org/wiki/ReiserFS</a></li>
<li><a href="https://www.howtogeek.com/howto/33552/htg-explains-which-linux-file-system-should-you-choose/">https://www.howtogeek.com/howto/33552/htg-explains-which-linux-file-system-should-you-choose/</a></li>
<li><a href="https://en.wikipedia.org/wiki/ZFS">https://en.wikipedia.org/wiki/ZFS</a></li>
<li><a href="https://en.wikipedia.org/wiki/XFS">https://en.wikipedia.org/wiki/XFS</a></li>
<li><a href="https://wiki.archlinux.org/index.php/file_systems">https://wiki.archlinux.org/index.php/file_systems</a></li>
</ul>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
]]></content:encoded>
    </item>
    <item>
      <title>å…³äºå·¥å…·, å…³äºæŠ˜è…¾</title>
      <link>https://ramsayleung.github.io/zh/post/2017/about_tool_about_tweak/</link>
      <pubDate>Fri, 24 Mar 2017 00:00:00 -0700</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2017/about_tool_about_tweak/</guid>
      <description>An discussion about tool and tweak</description>
      <content:encoded><![CDATA[<p>æˆ‘æœ€è¿‘ä¸€ç›´åœ¨æ€è€ƒï¼Œå…³äºå·¥å…·ï¼Œå…³äºæŠ˜è…¾ï¼Œå…³äºå…¶ä¸­çš„ä»˜å‡ºä¸æ”¶è·</p>
<h2 id="ä¹è¶£"><span class="section-num">1</span> ä¹è¶£</h2>
<h3 id="linux"><span class="section-num">1.1</span> Linux</h3>
<p>å›é¡¾æˆ‘çš„å¤§å­¦ï¼Œä»å¤§ä¸€å¼€å§‹å°±æ˜¯ä¸€ä¸ªä¸åœæŠ˜è…¾çš„è¿‡ç¨‹ï¼Œåœ¨å…¶ä»–çš„åŒå­¦è¿˜åœ¨ç”¨Windowsç©æ¸¸æˆçš„æ—¶å€™ï¼Œæˆ‘å·²ç»æŠŠç³»ç»Ÿæ¢æˆLinuxäº†.</p>
<p>è®°å¾—æœ€å¼€å§‹è£…çš„ç¬¬ä¸€ä¸ªå‘è¡Œç‰ˆæœ¬æ˜¯ <a href="https://www.kali.org/">Kali Linux</a>ä¸€ä¸ªé»‘å®¢å’Œå®‰å…¨ä¸“å®¶ä½¿ç”¨çš„å‘è¡Œç‰ˆæœ¬ï¼Œä¸Šé¢æœ‰ä¸è®¡å…¶æ•°çš„æ¸—é€å·¥å…·ï¼›æ¯•ç«Ÿæ¯ä¸€ä¸ªå­¦ è®¡ç®—æœºçš„å­©å­å¿ƒä¸­éƒ½æ˜¯æœ‰ä¸ª hacker dreamçš„å˜›ï¼Œæˆ‘ä¹Ÿä¸ä¾‹å¤–:)ã€‚</p>
<p>åªæ˜¯æˆ‘æœ€å¼€å§‹å¹¶æ²¡æœ‰èƒ½åŠ›å»ä½¿ç”¨Kali Linux; ç”šè‡³è¿åŸºæœ¬çš„å‘½ä»¤éƒ½å®Œå…¨ä¸äº†è§£ï¼›æˆ‘ç›¸å½“æ²®ä¸§ï¼Œå› ä¸º hackerå¹¶ä¸æ˜¯æƒ³è±¡ä¸­çš„é‚£ä¹ˆå®¹æ˜“çš„. æˆ‘åæ¥å°±æŠŠè‡ªå·±çš„ç³»ç»Ÿé‡è£…ï¼Œè£…äº†ä¸ª<a href="https://www.ubuntu.com/global"> Ubuntu</a>, ä¹° äº†ä¸€æœ¬ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹ï¼Œä¸€è¾¹å­¦ï¼Œä¸€è¾¹ç”¨ï¼Œå°±è¿™æ ·è¿›äº†Linuxçš„å‘äº†ã€‚</p>
<p>ã€Šé¸Ÿå“¥çš„ç§æˆ¿èœã€‹å¤§æ¦‚çœ‹äº†ä¸¤å¹´ï¼Œç¿»è¿‡å¥½å‡ æ¬¡äº†ï¼Œåæ¥ä¹Ÿçœ‹äº†ã€ŠæœåŠ¡å™¨ç¯‡ã€‹ï¼Œå‰åå…±çœ‹äº†è¿‘åæœ¬Linuxçš„ä¹¦ç±å§ï¼Œæ•´ä¸ªå¤§å­¦å¤§æ¦‚åœ¨è‡ªå·±ç”µè„‘ä¸Šå‰åè£…äº†10ç§çš„å‘è¡Œç‰ˆæœ¬å§</p>
<h3 id="vim-emacs"><span class="section-num">1.2</span> Vim/Emacs</h3>
<p>ã€Šé¸Ÿå“¥Linuxç§æˆ¿èœã€‹ä¸€ä¹¦ä¸­ï¼Œé¸Ÿå“¥å¼ºæ¨Vim, å…¶ä»–çš„Linuxè®ºå›ä¹Ÿå¯¹ Vim æ¨å´‡å¤‡è‡³ï¼Œæˆ‘ å¾ˆè‡ªç„¶å°±éšå¤§æµå»å­¦ä¹ Vimäº†ï¼Œå¼€å§‹çš„æ—¶å€™ï¼ŒçœŸçš„éå¸¸ä¸ä¹ æƒ¯ï¼Œç¼–è¾‘ä¸ªæ–‡æœ¬è¿˜è¦åˆ†é‚£ä¹ˆå¤š çš„æ¨¡å¼ï¼ŒçœŸçš„æ˜¯åäººç±»ï¼Œè¿ä¸ªå•è¯éƒ½ä¸èƒ½è¾“å…¥.</p>
<p>åæ¥ï¼Œå¥½ä¸å®¹æ˜“è¾“å®Œæ•°æ®ä¹‹åï¼Œåˆä¸çŸ¥é“æ€ä¹ˆä¿å­˜ (Ctrl-S? æƒ³å¤šäº†), ç„¶åç›´æ¥å…³é—­ï¼Œé‡æ–°æ‰“å¼€åˆæœ‰ä»€ä¹ˆæç¤ºè¯´æ˜¯å¦æ¢å¤æ•°æ®ã€‚ è§‰å¾—ä¸ºä½•æœ‰è¿™æ ·å¼‚ç±»éš¾ç”¨çš„ç¼–è¾‘å™¨, çœŸä¸çŸ¥é“ä¸ºä»€ä¹ˆé‚£ä¹ˆå¤šäººæ¨å´‡ã€‚</p>
<p>ä½†å½“æˆ‘åšæŒè¿™ç§ç…ç†¬åŠä¸ªæœˆä»¥åï¼Œå°±å‘ç°å…¶ä»–çš„ç¼–è¾‘å™¨éƒ½éå¸¸ä½æ•ˆï¼Œæ²¡é”™ï¼Œå°±æ˜¯éå¸¸ä½æ•ˆï¼Œåˆè¦é¼ æ ‡ï¼Œ åˆè¦é”®ç›˜ï¼Œä¸æ–­åœ°åˆ‡æ¢ï¼Œæ•ˆç‡å®åœ¨å¤ªä½äº†ã€‚</p>
<p>å°±è¿™æ ·ï¼Œæˆ‘ç³Šé‡Œç³Šæ¶‚å°±è¿›å…¥äº†Vimçš„é˜µè¥ï¼Œç›´åˆ°é‡åˆ° <a href="https://book.douban.com/subject/25869486/">Vimå®ç”¨æŠ€å·§ </a>è¿™æœ¬ç¥ä¹¦ï¼Œå®ƒè·Ÿä½ è®²è¿°äº†å¦‚ä½•å®ç° Vim &ldquo;Edit Text at the speed of thought&rdquo; çš„ç†å¿µï¼Œçš„ç¡®æ˜¯ç¥ä¹¦. è‡ªç„¶ï¼Œæˆ‘å¯¹Vimå°±æ›´ &ldquo;åšè´ä¸æ¸&rdquo; äº†ï¼›</p>
<hr>
<p>ç›´åˆ°æœ‰ä¸€å¤©ï¼Œåœ¨æµè§ˆLinux/Unixå†å²çš„æ—¶å€™æ€å¼€äº† Editor War(Vimä¸Emacsä¹‹æˆ˜)ä¸€ç« ï¼Œ é‚£äº› Emacser ç«Ÿæ•¢å®£ç§° Emacs æ¯” Vim å¥½ç”¨ï¼Œæˆ‘å¯¹æ­¤å¹¶ä¸æœæ°”ï¼Œä¸ç›¸ä¿¡æœ‰æ¯”Vimå¼ºçš„ç¼–è¾‘å™¨ï¼Œè¿™å¯æ˜¯ç¼–è¾‘å™¨ä¹‹ç¥é˜¿ï¼Œè€Œæˆ‘æ˜¯ä¸€ä¸ªå¾ˆå®åœ¨çš„äººï¼Œæ²¡ç”¨è¿‡ Emacs æ˜¯ä¸ä¼šéšä¾¿å‘
è¨€çš„ï¼Œæ‰€ä»¥å°±è·‘å»æŠ˜è…¾Emacs ,æ‰“ç®—æŠ˜è…¾å›æ¥å†è·Ÿ Emacser è®ºé“ï¼Œç»“æœå˜›ï¼Œæˆ‘å°± &ldquo;å›
é€ƒ&rdquo; åˆ°äº† Emacs äº† :)ã€‚</p>
<p>ä½œä¸ºä¸€ä¸ªæ›¾ç»çš„ Vim ç²‰ä¸ï¼Œæˆ‘å°±æŠ›å¼€ &ldquo;å®—æ•™å› ç´ &rdquo; æ¯”è¾ƒä¸€ä¸‹ Vim è·Ÿ Emacs:</p>
<ul>
<li>Vimçš„ modal edit æ˜¯æœ€å¥½çš„ï¼ŒçœŸçš„éš¾æœ‰æ•Œæ‰‹ï¼Œæ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨å„ç§çš„ IDE/editor éƒ½æœ‰ Vim æ’ä»¶çš„åŸå› ï¼›</li>
<li>ä½† Emacs çš„æ‰©å±•æ€§ä¹Ÿæ˜¯æ— å¯åŒ¹æ•Œ (æ¯•ç«Ÿæ˜¯ä¼ª è£…æˆç¼–è¾‘å™¨çš„æ“ä½œç³»ç»Ÿï¼Œåªç¼ºä¸€ä¸ªå¥½ç”¨çš„ç¼–è¾‘å™¨)ï¼Œåˆå› ä¸º Emacs lispè¿™ç§çœŸæ­£çš„ç¼–ç¨‹ è¯­è¨€(å¯¹æ¯”ä¹‹ä¸‹ vimlçœŸçš„å¾ˆå¼±)çš„å­˜åœ¨, Emacs å°±æœ‰äº†æ— é™å¯èƒ½ï¼Œè¿™ä¹Ÿæ˜¯ Emacs ä¸Šé¢æœ‰éå¸¸å¤šé«˜è´¨é‡çš„æ’ä»¶çš„åŸå› ä¹‹ä¸€ï¼Œå…¶ä¸­æœ€å…¸å‹çš„ä¾‹å­å°±æ˜¯ Org-mode ,æ— æ„§ç¥å™¨ä¹‹åï¼Œæˆ‘ç°åœ¨çš„åšæ–‡ä¹Ÿæ˜¯åœ¨ Emacs é‡Œé¢åˆ©ç”¨ Org-mode ç¼–å†™ï¼Œç„¶åå‘å¸ƒçš„ã€‚</li>
</ul>
<p>è€Œè‡³äºé€‰æ‹©ç¥ä¹‹ç¼–è¾‘å™¨è¿˜æ˜¯ç¼–è¾‘å™¨ä¹‹ç¥ï¼Œé‚£å°±æ˜¯ä¿¡ä»°çš„æŠ‰æ‹©äº†ã€‚æˆ‘é€‰æ‹©äº†åœ¨ Emacs é‡Œé¢ä½¿ç”¨ Vim çš„ç¼–
è¾‘æ¨¡å¼ Evil :)</p>
<h3 id="misc"><span class="section-num">1.3</span> Misc</h3>
<p>é™¤äº†æŠ˜è…¾ç¼–è¾‘å™¨ä¹‹å¤–ï¼Œæˆ‘è¿˜æŠ˜è…¾äº†å„ç§çš„å‘½ä»¤è¡Œï¼ŒShell è„šæœ¬ï¼Œè¿˜æœ‰ Firefox, Chromeæµè§ˆå™¨ã€‚å½“åˆé‚£äº› Windows ç”¨æˆ·ä¸€ç›´è¯´ Linux çš„æ¡Œé¢ä¸‘ï¼Œæˆ‘å°±å»äº†æŠ˜è…¾å„ç§ çš„æ¡Œé¢ç¯å¢ƒ (window manager)è¿™ç§æŠ˜è…¾å¯ä¸æ˜¯ Windows ä¸Šé¢çš„åˆ‡æ¢å£çº¸å“¦ï¼Œåæ¥æŠŠæ¡Œ é¢æŠ˜è…¾å¾—éå¸¸ç‚«ï¼Œä»¥è‡³åŒå­¦çœ‹åˆ°æˆ‘çš„ç”µè„‘å°±è¯´æˆ‘è£…äº†é»‘è‹¹æœï¼Œç„¶è€Œäº‹å®å¹¶éå¦‚æ­¤ã€‚</p>
<p>å¦‚æœä½ ä¹Ÿå¥½å¥‡é‚£äº›ç‚«é…·çš„ Linux/Unix æ¡Œé¢ï¼Œå¯ä»¥æŸ¥çœ‹ <a href="https://reddit.com/r/unixporn">https://reddit.com/r/unixporn</a> ä¸Šé¢æœ‰å„ç§ Linuxer/Unixer åˆ†äº«çš„ç‚«é…·æ¡Œé¢</p>
<h2 id="æŠ•å…¥äº§å‡ºæ¯”"><span class="section-num">2</span> æŠ•å…¥äº§å‡ºæ¯”</h2>
<h3 id="å€¼å¾—å¦"><span class="section-num">2.1</span> å€¼å¾—å¦ï¼Ÿ</h3>
<p>æˆ‘çš„å¤§å­¦åŸºæœ¬éƒ½æ˜¯åœ¨å­¦ä¹ å¹¶æŠ˜è…¾å„ç§çš„å·¥å…·æˆ–è€…æŠ€æœ¯ï¼Œå¹¶ä¸”ä¹åœ¨å…¶ä¸­.</p>
<p>ä½†æ˜¯æœ‰ä¸€å¤©å½“ç¬” è€…åˆåœ¨è·Ÿæœ‹å‹æ¨è Vim/Emacs, æˆ–è®¸æ˜¯æˆ‘å–‹å–‹ä¸ä¼‘å®åœ¨å¤ªå¤šæ¬¡äº†ï¼Œæœ‹å‹å›äº†æˆ‘ä¸€å¥ &quot; notepad++, sublime text ä¸ä¸€æ ·å¯ä»¥å†™ä»£ç ï¼Œä½ ä¸ºä»€ä¹ˆè¿˜è¦èŠ±é‚£ä¹ˆå¤šæ—¶é—´å»æŠ˜è…¾è¿™äº›ä¸œè¥¿å‘¢ï¼Œä½ å†™è„šæœ¬éƒ½å¯ä»¥ç›´æ¥ç”¨IDE,ä¸ºä»€ä¹ˆè¿˜è¦è‡ªå·±æŠ˜è…¾å‘¢ï¼ŒæŠŠæ—¶é—´èŠ±åˆ°å…¶ä»–åœ°æ–¹ä¸æ›´å¥½ä¹ˆï¼Ÿ&quot;.</p>
<p>æˆ‘éš¾ä»¥åé©³ï¼Œæˆ‘ä¹‹å‰ä¸€ç›´æ˜¯ç©å¾—å¾ˆå¼€å¿ƒï¼Œä»æœªæ›¾è€ƒè™‘è¿‡è¿™ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥é‚£ä¸ªæ—¶å€™å¼€å§‹è¯¢é—®è‡ªå·±ï¼Œè¿™æ˜¯å¦å€¼å¾—ï¼Œè‡ªå·±æ˜¯å¦è¦æŠŠæ—¶é—´ç”¨åˆ°å…¶ä»–åœ°æ–¹ï¼Ÿ</p>
<p>åœ¨ä¹‹åçš„ä¸€æ®µ æ—¶é—´ï¼Œæˆ‘éƒ½éš¾æ©æ²®ä¸§ï¼Œå› ä¸ºè§‰å¾—è‡ªå·±æµªè´¹äº†å¾ˆå¤šçš„æ—¶é—´æ¥å®Œæˆä¸€äº›æ— ç”¨åŠŸï¼</p>
<h3 id="é•¿æœŸæŠ•èµ„"><span class="section-num">2.2</span> é•¿æœŸæŠ•èµ„</h3>
<p>ä½†æ˜¯æœ€ç»ˆæˆ‘è¿˜æ˜¯è§£ç­”äº†è‡ªå·±çš„ç–‘é—®! æˆ‘ä¹‹å‰ä»˜å‡ºæ˜¯ç»å¯¹å€¼å¾—çš„ï¼Œå…ˆä¸è¯´æˆ‘åœ¨å…¶ä¸­è·å¾—çš„ä¹è¶£ï¼Œä¹è¶£æ˜¯æ— ä»·çš„å˜› :)</p>
<p>æˆ‘åœ¨æŠ˜è…¾çš„è¿‡ç¨‹ä¸­ä¹Ÿå­¦åˆ°å¾ˆå¤šæ–°çš„ä¸œè¥¿: ä¸ºäº†ç”¨å¥½æˆ‘é…ç½®çš„ Emacs, æˆ‘ä½¿ç”¨ Emacs å†™äº†å¾ˆå¤šä¸åŒçš„è„šæœ¬ï¼Œè¿™ç§æ„Ÿè§‰å°±å¥½åƒï¼Œä¾ å£«ä¸ºäº†å±•ç¤ºæ‰‹ä¸­åˆ©åˆƒä¹‹å¨åŠ›ï¼Œè‹¦ç»ƒæ­¦è‰º; è€Œåœ¨æŠ˜è…¾ Emacs lisp çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿå­¦ä¹ å¾ˆå¤šå‡½æ•°å¼ç¼–ç¨‹çš„æ€æƒ³ï¼Œç”šè‡³æŒæ¡äº†ä¸€é—¨æ–°çš„è¯­è¨€ &ndash; elisp, è™½è¯´å®ƒçš„è¯­æ³•å¾ˆå¥‡æ€ªã€‚</p>
<p>å…¶å®æˆ‘çš„ä»˜å‡ºæ˜¯é•¿æœŸæŠ•èµ„ï¼Œå­¦ä¼šäº† Vim çš„ moral edit, ä¹Ÿå¯ä»¥åœ¨å…¶ä»– IDEä½¿ç”¨å˜›ï¼Œè¿™å¹¶ä¸çŸ›ç›¾çš„ï¼Œæ— é¼ æ ‡æ“ä½œæ˜¯éå¸¸é«˜æ•ˆçš„ï¼Œä¹Ÿæ˜¯æ‰€è°“çš„ modern editor æ— æ³•æ¯”æ‹Ÿçš„ã€‚</p>
<p>æœ€é‡è¦çš„æ˜¯ï¼Œåœ¨æŠ˜è…¾è¿‡ç¨‹ä¸­æ‰€åŸ¹å…»çš„è§£å†³å›°éš¾çš„åŠ¨æ‰‹èƒ½åŠ›ï¼Œä¹Ÿæ˜¯å¯ä»¥å—ç›Šç»ˆç”Ÿçš„ï¼Œæˆ‘çŸ¥é“å¦‚ä½•å»googleï¼Œå¦‚ä½•å»æŸ¥æ‰¾æ–‡æ¡£ï¼Œå¦‚ä½•å»æé—®; è€Œä¸”åœ¨ä¸åœçš„æŠ˜è…¾è¿‡ç¨‹ä¸­ï¼Œä½ å¯¹æŸæ ·æŠ€æœ¯çš„ç†è§£æ˜¯å•çº¯çš„ç†è®ºå­¦ä¹ æ— æ³•æ¯”æ‹Ÿçš„ï¼›</p>
<p>åœ¨å¤§å­¦çš„æ“ä½œç³»ç»Ÿè¯¾ï¼Œæˆ‘åŸºæœ¬æ˜¯æ²¡å¬è€å¸ˆè®²è§£è¯¾ç¨‹çš„ï¼Œå› ä¸ºè€å¸ˆè®²çš„ï¼Œæˆ‘åŸºæœ¬éƒ½çŸ¥é“ï¼Œç”šè‡³å®è·µè¿‡ã€‚</p>
<h2 id="å·¥å…·é›†"><span class="section-num">3</span> å·¥å…·é›†</h2>
<p>åœ¨ç»å†å¤§å­¦çš„æŠ˜è…¾åï¼Œæˆ‘ç°åœ¨å¾ˆå¤šçš„å·¥å…·é›†éƒ½åŸºæœ¬ç¡®å®šä¸‹æ¥äº†ï¼›è¿™äº›ä¹Ÿæ˜¯å¯¹æˆ‘è€Œè¨€ï¼Œ
æœ€é«˜æ•ˆçš„å·¥å…·é›†</p>
<h3 id="ç¼–è¾‘å™¨"><span class="section-num">3.1</span> ç¼–è¾‘å™¨</h3>
<ul>
<li>Emacs ç¥ä¹‹ç¼–è¾‘å™¨ï¼Œä¸»åŠ›ç¼–è¾‘å™¨ <a href="https://github.com/ramsayleung/emacs.d">ä¸ªäººé…ç½®</a></li>
<li>Vim ç¼–è¾‘å™¨ä¹‹ç¥ï¼Œä¸€èˆ¬åœ¨æœåŠ¡å™¨æ”¹æ”¹é…ç½®çš„æ—¶å€™ç”¨</li>
</ul>
<h3 id="æµè§ˆå™¨"><span class="section-num">3.2</span> æµè§ˆå™¨</h3>
<ul>
<li>Chrome ä¸å¸¸ç”¨ï¼Œç‰¹å®šæƒ…å†µä¸‹ä½¿ç”¨</li>
<li>Firefox æ—¥å¸¸æµè§ˆå™¨ï¼Œæˆ‘ä¹ŸæŠ˜è…¾è¿‡éå¸¸ä¹…ï¼Œæ‰€ä»¥å³ä½¿ Chrome å¾ˆå¼ºï¼Œæˆ‘åªä¸º
Firefox å€¾å¿ƒ</li>
</ul>
<h3 id="firefoxæ‰©å±•"><span class="section-num">3.3</span> FireFoxæ‰©å±•</h3>
<p>å› ä¸º FireFox å¯¹æ’ä»¶çš„é™åˆ¶ç›¸å¯¹å®½æ¾ï¼Œæ‰€ä»¥ç¤¾åŒºå¼€å‘å‡ºäº†éå¸¸å¤šéå¸¸å¼ºçš„æ’ä»¶ï¼Œæˆ‘å°±
åˆ—ä¸¾ä¸€ä¸‹è‡ªå·±ä½¿ç”¨çš„æ‰©å±•é›†å§</p>
<ul>
<li>bitwarden -å…è´¹çš„å¯†ç ç®¡ç†å™¨ï¼Œæ¯”LastPasså¼º</li>
<li>Bluhell Firewall-è½»é‡çº§çš„å¹¿å‘Šæ‹¦æˆªå™¨ï¼Œå’Œéšç§ä¿æŠ¤</li>
<li>Clear Cache -æ›´æ–¹ä¾¿æ¸…é™¤ç¼“å­˜</li>
<li>FalshGot -ä¸‹è½½æ‰©å±•å™¨ï¼Œé…åˆaxelæˆ–è€…aria2ä½¿ç”¨æ›´ä½³</li>
<li>FoxyProxy -ç±»ä¼¼Chrome SwitchOmega,ä½†æ˜¯ç•¥æœ‰ä¸å¦‚ï¼Œé…åˆShadowsocksç¿»å¢™ï¼Œå¿…å¤‡</li>
<li>Ghostery -éšç§ä¿æŠ¤</li>
<li>Greasemonkey -ç”¨æˆ·è‡ªå®šä¹‰æ’ä»¶ç®¡ç†å™¨ï¼Œç¥å™¨</li>
<li>HttpRequester -ç±»ä¼¼Chrome Postman,å‘é€Httpè¯·æ±‚</li>
<li>HTTPtoHTTPS -å°½å¯èƒ½ä½¿ç”¨Https,æé«˜å®‰å…¨æ€§</li>
<li>KeySnail -æŠŠFirefoxå¿«æ·é”®è®¾ç½®ä¸ºEmacså¿«æ·é”®ï¼Œæ— é¼ æ ‡æ“ä½œï¼Œä½ ä¹Ÿå¯ä»¥ä¸ºè¯¥æ’ä»¶ç¼–
å†™æ’ä»¶.ç¥å™¨ï¼Œè¿™ä¸ªæ˜¯æˆ‘æ— æ³•åˆ‡æ¢å›Chromeçš„åŸå› </li>
<li>Octotree -ä»¥æ ‘çŠ¶ç›®å½•æ¥æµè§ˆGithubä»£ç ï¼Œéå¸¸æ–¹ä¾¿</li>
<li>uBlock Origin -å¹¿å‘Šblocker,ä½èµ„æºè¦æ±‚ï¼Œæ„Ÿè§‰æ¯”Adblock pluså¥½ç”¨</li>
<li>User Agent Switcher -åˆ‡æ¢User Agent,å†™çˆ¬è™«æ—¶éå¸¸æœ‰ç”¨</li>
<li>Xpath checker -ç›´æ¥è·å–DomèŠ‚ç‚¹çš„Xpath,é…åˆLxmlè§£æç½‘é¡µéå¸¸é«˜æ•ˆ</li>
<li>Firebug -ç¥å™¨ï¼Œä½†æ˜¯å·²ç»åœæ­¢å¼€å‘äº†ã€‚</li>
</ul>
<h3 id="æ¡Œé¢"><span class="section-num">3.4</span> æ¡Œé¢</h3>
<p>i3wm, åœ¨æŠ˜è…¾è¿‡ç‚«é…·çš„ KDE, Gnome, xfce, è€Œæˆ‘æœ€åé€‰æ‹©çš„æ˜¯ i3è¿™ä¸ªå¹³é“ºæ¡Œé¢ï¼Œå¯
ä»¥å®ç°æ— é¼ æ ‡æ“ä½œï¼Œéå¸¸è½»é‡ã€‚</p>
<h3 id="å‘½ä»¤è¡Œ"><span class="section-num">3.5</span> å‘½ä»¤è¡Œ</h3>
<h4 id="shell"><span class="section-num">3.5.1</span> Shell</h4>
<ul>
<li>zsh -é…åˆoh-my-zsh,å¯ä»¥éå¸¸é«˜æ•ˆï¼Œä½†æ˜¯ä½¿ç”¨é¢‘ç‡ä¸é«˜</li>
<li>Eshell -ä¸Emacsé›†æˆï¼Œæ˜¯æˆ‘çš„ä¸»åŠ›Shell,ä¸è¿‡æŸäº›Eshellä¸æ”¯æŒçš„æ“ä½œï¼Œåªå¥½åœ¨
zshå®Œæˆ</li>
</ul>
<h4 id="è¿‡æ»¤å™¨"><span class="section-num">3.5.2</span> è¿‡æ»¤å™¨</h4>
<ul>
<li><a href="https://github.com/ggreer/the_silver_searcher">ag</a>   grepçš„åŠ å¼ºç‰ˆï¼Œé€Ÿåº¦å¿«</li>
<li><a href="https://github.com/BurntSushi/ripgrep">ripgrep </a>æœ€å¿«çš„å‘½ä»¤æœç´¢å·¥å…·</li>
<li><a href="https://github.com/mooz/percol">percol</a> è¿‡æ»¤æ–‡æœ¬ï¼Œç¥å™¨</li>
<li><a href="https://github.com/clvv/fasd">fasd</a> ç›®å½•è·³è½¬ï¼Œæ–‡ä»¶æŸ¥æ‰¾ï¼Œé«˜æ•ˆ</li>
</ul>
<h4 id="misc"><span class="section-num">3.5.3</span> misc</h4>
<ul>
<li><a href="https://github.com/jakubroztocil/httpie">httpie</a> httpå®¢æˆ·ç«¯ï¼Œå‘é€httpè¯·æ±‚</li>
<li>htop topçš„æ”¹è¿›ç‰ˆï¼Œä¿¡æ¯æ›´è¯¦ç»†</li>
<li><a href="https://github.com/nicolargo/glances">glances</a> ä¸€ä¸ªå¥½ç”¨çš„ç³»ç»Ÿç›‘æ§å·¥å…·</li>
<li>ncdu Linuxæœ€å¥½ç”¨çš„ç£ç›˜åˆ†æå·¥å…·</li>
<li>git Linusåˆä¸€ç¥ä½œ</li>
</ul>
<p>å…¶å®ƒå°±æ˜¯å¸¸ç”¨çš„å†…ç½®å‘½ä»¤äº†</p>
<h3 id="å½±éŸ³"><span class="section-num">3.6</span> å½±éŸ³</h3>
<ul>
<li>VLC Linuxæœ€å¥½ç”¨çš„æ’­æ”¾å™¨</li>
<li>ç½‘æ˜“äº‘éŸ³ä¹ å›½äº§è‰¯å¿ƒéŸ³ä¹è½¯ä»¶</li>
<li><a href="https://github.com/darknessomi/musicbox">musicbox</a> ç½‘æ˜“äº‘éŸ³ä¹çš„ç¤¾åŒºå‘½ä»¤è¡Œç‰ˆæœ¬</li>
</ul>
<h3 id="å…¶å®ƒ"><span class="section-num">3.7</span> å…¶å®ƒ</h3>
<ul>
<li>Fcitx -ä¸­æ–‡è¾“å…¥</li>
<li>VirtualBox -å¼€æºè™šæ‹Ÿæœº</li>
<li>Shadowsocks ç¿»å¢™å¿…å¤‡</li>
<li>Zeal ç±»ä¼¼Mac ä¸Šçš„Dash,æŸ¥çœ‹å„ç§æ–‡æ¡£</li>
<li>Intellij Idea Java IDE(å†™Java æˆ‘æ˜¯ä¸ä¼šä½¿ç”¨Emacs çš„:) )</li>
<li>Datagrip SQL IDE</li>
</ul>
<p>ä½¿ç”¨æœ€é¢‘ç¹çš„å°±æ˜¯ I3+Firefox+Emacs,å®ç°æ— é¼ æ ‡æ“ä½œï¼Œå› ä¸ºä½¿ç”¨é¼ æ ‡å¤ªæ…¢äº†ï¼Œæ•ˆç‡å¤ª
ä½ã€‚æˆ‘ä¹Ÿä¸æ˜¯ä¸€ä¸ªç–¯å­ï¼Œæ‰€ä»¥åªä¼šç”¨Emacs åšåŠ›æ‰€èƒ½åŠçš„äº‹æƒ…ï¼Œç…®å’–å•¡å°±ç®—äº†ã€‚</p>
<h2 id="ç»“è¯­"><span class="section-num">4</span> ç»“è¯­</h2>
<p>å¦‚æœè®©æˆ‘çš„å¤§å­¦é‡æ¥ä¸€éï¼Œä¼°è®¡æˆ‘è¿˜æ˜¯ä¼šè¿™æ ·æŠ˜è…¾ï¼Œå› ä¸ºè‡ªå·±åŠ¨æ‰‹çš„æ„Ÿè§‰è¿˜æ˜¯å¾ˆç¾å¥½ï¼Œå……æ»¡æˆå°±æ„Ÿï¼Œè¿™ä¹Ÿæ˜¯ç©æ¸¸æˆæ‰€ä¸èƒ½ç»™äºˆæˆ‘çš„æ„Ÿè§‰ï¼Œæ¯•ç«Ÿ <strong>hacker</strong> ä¸æ˜¯æƒ³å‡ºæ¥çš„å˜›ï¼Œæ˜¯åšå‡ºæ¥çš„ã€‚</p>
<hr>
<p>æ›´æ–° 2017-4-21</p>
<p>ç¼–ç¨‹éšæƒ³ä¹Ÿå‘ä¸€ç¯‡æ–‡ç« æ¥è¯´æ˜<a href="https://program-think.blogspot.com/2017/04/The-Importance-of-Zheteng.html">èŠèŠã€æŠ˜è…¾ã€‘çš„é‡è¦æ€§</a>, æ¥é˜è¿°ã€ŒæŠ˜è…¾ã€å¯¹è‡ªå­¦ä¸æé«˜çš„é‡è¦æ€§ã€‚</p>
<ul>
<li>Enjoy tweaking;Enjoy Linux :)</li>
</ul>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
]]></content:encoded>
    </item>
    <item>
      <title>Linux/Unix Shell äºŒä¸‰äº‹ä¹‹è¿‡æ»¤å™¨grep</title>
      <link>https://ramsayleung.github.io/zh/post/2017/grep/</link>
      <pubDate>Mon, 13 Mar 2017 00:00:00 -0700</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2017/grep/</guid>
      <description>an introduction about grep</description>
      <content:encoded><![CDATA[<p>æ–‡æœ¬ä¸‰å‰‘å®¢ä¹‹ Grep</p>
<blockquote>
<p>grep - print  lines matching a pattern</p>
</blockquote>
<p>ä»Šå¤©æˆ‘æƒ³èŠèŠ <strong>grep</strong> è¿™ä¸ªå‘½ä»¤ï¼›æ®è¯´ï¼Œæœ‰Unix/Linux çš„åœ°æ–¹å°±ä¼šæœ‰ <strong>grep</strong>, è¿™ä¸ªå¯èƒ½æ˜¯å®‰è£…å¾—æœ€å¹¿æ³›çš„å‘½ä»¤ä¹‹ä¸€ï¼›é‚£ä¹ˆ <strong>grep</strong> æ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„å‘¢ï¼Ÿ</p>
<p>grep å…¶å®æ˜¯ç”¨æ¥åœ¨æ–‡ä»¶ä¸­æœç´¢ç‰¹å®šå†…å®¹æˆ–è€…æ¨¡å¼çš„å·¥å…·(é…åˆæ­£åˆ™è¡¨è¾¾å¼â€œé£Ÿç”¨â€ï¼Œå‘³é“æ›´ä½³ :))ç°åœ¨å°±æ¥ä¸€èµ·çœ‹çœ‹*grep* çš„ç”¨æ³•</p>
<h2 id="åŸºæœ¬ç”¨æ³•"><span class="section-num">1</span> åŸºæœ¬ç”¨æ³•</h2>
<h3 id="åŸºç¡€ç”¨æ³•"><span class="section-num">1.1</span> åŸºç¡€ç”¨æ³•</h3>
<p>ç°åœ¨å‡è®¾æœ‰ä¸€ä¸ªç®€å•çš„æ–‡æœ¬æ–‡ä»¶(åŒåŸè®°å¼€å¤´)tinytale.txt,å†…å®¹å¦‚ä¸‹</p>
<blockquote>
<p>it was the best of times it was the worst of times
it was the age of wisdom it was age of foolishness
it was the epoch of belief it was the epoch of incredulity
it was the season of light it was the season of darkness
IT WAS THE SPRING OF HOPE IT WAS THE WINTER OF DESPAIRE</p>
</blockquote>
<p>ç°åœ¨å¼€å§‹ä»‹ç» <strong>grep</strong> çš„åŸºæœ¬ç”¨æ³•ï¼š <strong>grep</strong> çš„åŸºæœ¬ç”¨æ³•å¾ˆç®€å•çš„ï¼Œå‡è®¾æˆ‘æƒ³è¦æœç´¢å•è¯ <strong>darkness</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">grep darkness /tmp/tinytale.txt
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">it was the season of light it was the season of darkness
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ç»“åˆæ­£åˆ™è¡¨è¾¾å¼"><span class="section-num">1.2</span> ç»“åˆæ­£åˆ™è¡¨è¾¾å¼</h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ <strong>grep</strong> æ˜¯å¼€å¯æ­£åˆ™è¡¨è¾¾å¼çš„æ¨¡å¼çš„ï¼Œæ‰€ä»¥ä½ å¯ä»¥ç›´æ¥åœ¨æ–‡ä»¶æœç´¢ä¸­ä½¿ç”¨
æ­£åˆ™è¡¨è¾¾å¼ã€‚ç°åœ¨åœ¨æ–‡ä»¶ä¸­æœç´¢ä»¥å­—æ¯ <strong>e</strong> å¼€å¤´åæ¥ä¸‰ä¸ªå­—ç¬¦ï¼Œç„¶åä»¥ <strong>h</strong> ç»“å°¾çš„å•è¯ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">grep <span class="s2">&#34;e...h&#34;</span> /tmp/tinytale.txt
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">it was the epoch of belief it was the epoch of incredulity
</span></span></code></pre></td></tr></table>
</div>
</div></blockquote>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…äº† <strong>epoch</strong> è¿™ä¸ªå•è¯ã€‚æ­£åˆ™è¡¨è¾¾å¼çš„å¨åŠ›æ— ä¸ä¼¦æ¯”çš„ï¼ŒæŠŠ <strong>grep*å’Œæ­£åˆ™è¡¨è¾¾å¼ç»“åˆèµ·æ¥å¯ä»¥æ›´å¥½åœ°å‘æŒ¥ *grep</strong> è¿™ä¸ªå·¥å…·çš„æ½œåŠ›ï¼›è€Œæœ¬æ–‡ä¸»è¦æ˜¯ä»‹ç» <strong>grep</strong>, æ›´å¤šæœ‰å…³æ­£åˆ™è¡¨è¾¾å¼çš„ç”¨æ³•ä¸ç»†è®²äº†</p>
<h3 id="ç»Ÿè®¡å‡ºç°çš„æ¬¡æ•°"><span class="section-num">1.3</span> ç»Ÿè®¡å‡ºç°çš„æ¬¡æ•°</h3>
<p>æœ‰æ—¶ï¼Œå¦‚æœä½ éœ€è¦ç»Ÿè®¡æŸç§æ¨¡å¼æˆ–è€…æŸä¸ªå•è¯å‡ºç°çš„ä¸ªæ•°ï¼Œä½ ä¼šå‘ç° <strong>grep</strong> éå¸¸æœ‰ç”¨ï¼›</p>
<p>è¦å®ç°è¯¥åŠŸèƒ½ï¼Œåªéœ€ç»™ <strong>grep</strong> æ·»åŠ  <strong>-c</strong> å‚æ•°ï¼›ä¾‹å¦‚ç»Ÿè®¡å•è¯ <strong>the</strong> å‡ºç°çš„ä¸ªæ•°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">grep -c the /tmp/tinytale.txt
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç»“æœè¾“å‡ºå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">4
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ–‡æœ¬ä¸­åŒ…å«4ä¸ª <strong>the</strong></p>
<h3 id="å¿½ç•¥å¤§å°å†™"><span class="section-num">1.4</span> å¿½ç•¥å¤§å°å†™</h3>
<p>å‰é¢æåˆ°ï¼Œ <strong>grep</strong> é»˜è®¤æ˜¯ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥æœç´¢æ–‡ä»¶çš„ï¼Œæ‰€ä»¥ <strong>grep</strong> æ˜¯åŒºåˆ†å¤§å°å†™çš„ï¼›</p>
<p>å¦‚æœä½ æƒ³ä¿®æ”¹ <strong>grep</strong> çš„é»˜è®¤è¡Œä¸ºæ¥å¿½ç•¥å¤§å°å†™ï¼Œä½ å¯ä»¥æ·»åŠ  <strong>-i</strong> å‚æ•°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">grep -i the /tmp/tinytale.txt
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">it was the best of times it was the worst of times
</span></span><span class="line"><span class="cl">it was the age of wisdom it was age of foolishness
</span></span><span class="line"><span class="cl">it was the epoch of belief it was the epoch of incredulity
</span></span><span class="line"><span class="cl">it was the season of light it was the season of darkness
</span></span><span class="line"><span class="cl">IT WAS THE SPRING OF HOPE IT WAS THE WINTER OF DESPAIRE
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥å‘ç° <strong>THE</strong> ä¹Ÿæ˜¯å¯ä»¥è¢« grep æœç´¢åˆ°çš„ï¼›ä½†æ˜¯å¦‚æœæ²¡æœ‰æ·»åŠ  <strong>-i</strong> ,ä½ åªä¼šçœ‹åˆ°4è¡Œè¾“å‡ºã€‚</p>
<p>å½“ç„¶ä½ å¯ä»¥åœ¨æ­£åˆ™è¡¨è¾¾å¼é‡Œé¢æ·»åŠ å¿½ç•¥å¤§å°å†™çš„æ¨¡å¼ï¼Œåªæ˜¯ç›´æ¥æ·»åŠ  <strong>-i</strong> ä¼šç®€å•å¾ˆå¤šã€‚</p>
<h2 id="æœç´¢å¤šä¸ªæ–‡ä»¶"><span class="section-num">2</span> æœç´¢å¤šä¸ªæ–‡ä»¶</h2>
<p>ä¸Šé¢æœç´¢çš„éƒ½åªæ˜¯å•ä¸ªæ–‡ä»¶ï¼Œè€Œ grep å¯ä»¥è®©ä½ åŒæ—¶æœç´¢å¤šä¸ªæ–‡ä»¶ï¼›ç°åœ¨å°±æ¥çœ‹çœ‹æ€ä¹ˆæœç´¢å¤šä¸ªæ–‡ä»¶å§ã€‚</p>
<p>ä¸‹é¢ä¸¤ç§å†™æ³•ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯æˆ‘ä¸ªäººæ¨å´‡ç¬¬ä¸€ç§ï¼Œå› ä¸ºå¯ä»¥è¾“å…¥æ›´å°‘ä¸€äº›å†…å®¹ :)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">grep belief /tmp/<span class="o">{</span>tinytale.txt,tale.txt<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">grep belief /tmp/tinytale.txt /tmp/tale.txt
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">tinytale.txt:it was the epoch of belief it was the epoch of incredulity
</span></span><span class="line"><span class="cl">tale.txt:it was the epoch of belief it was the epoch of incredulity
</span></span><span class="line"><span class="cl">tale.txt:pains of by rearing her in the belief that her father was dead
</span></span><span class="line"><span class="cl">tale.txt:this was no passive belief but an active weapon which they flashed
</span></span><span class="line"><span class="cl">tale.txt:belief in solomon deducting a mere trifle for this slight mistake
</span></span><span class="line"><span class="cl">tale.txt:you will bear testimony to what i have said and to your belief in it
</span></span><span class="line"><span class="cl">tale.txt:herself into the show of a belief that they would soon be reunited
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°ï¼Œ <strong>grep</strong> æŠŠåŒ¹é…åˆ°å•è¯çš„é‚£ä¸€è¡Œå†…å®¹å’Œå¯¹åº”çš„æ–‡ä»¶éƒ½æ˜¾ç¤ºå‡ºæ¥äº†ï¼Œä½ å°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°çœ‹åˆ°æœç´¢ç»“æœï¼Œå¹¶çŸ¥é“åŒ¹é…å•è¯çš„æ¥æºã€‚</p>
<p>å¦‚æœä½ ä¹Ÿåƒæˆ‘è¿™æ ·ï¼Œä¸æƒ³è¾“å…¥é‚£ä¹ˆå¤šçš„å†…å®¹ï¼Œä½ å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…æ‰€æœ‰çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">grep belief /tmp/*.txt
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºç»“æœä¹Ÿä¼šè·Ÿä¸Šé¢ä¸€è‡´ (å‡è®¾ä½  <strong><em>tmp</em></strong> ç›®å½•ä¸‹åªæœ‰ä¸¤ä¸ªæ–‡æœ¬æ–‡ä»¶); æˆ‘å‘Šè¯‰*grep* æœç´¢*/tmp* ä¸‹æ‰€æœ‰çš„ <strong>.txt</strong> æ–‡ä»¶ã€‚</p>
<h3 id="é€’å½’æœç´¢"><span class="section-num">2.1</span> é€’å½’æœç´¢</h3>
<p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <strong>grep</strong> é€’å½’æœç´¢ç›®å½•ï¼›ä½ åªéœ€åœ¨æŒ‡å®šç›®å½•åï¼Œæ·»åŠ  <strong>-R</strong> , <strong>grep</strong> å°±ä¼š
é€’å½’æœç´¢æŒ‡å®šç›®å½•çš„æ‰€æœ‰å­ç›®å½•ã€‚æˆ‘å·²ç»æŠŠå½“å‰ç›®å½•åˆ‡æ¢åˆ° <strong>/tmp</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">grep -R <span class="s2">&#34;belief&#34;</span> .
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">./tale.txt:it was the epoch of belief it was the epoch of incredulity
</span></span><span class="line"><span class="cl">./tale.txt:pains of by rearing her in the belief that her father was dead
</span></span><span class="line"><span class="cl">./tale.txt:this was no passive belief but an active weapon which they flashed
</span></span><span class="line"><span class="cl">./tale.txt:belief in solomon deducting a mere trifle for this slight mistake
</span></span><span class="line"><span class="cl">./tale.txt:you will bear testimony to what i have said and to your belief in it
</span></span><span class="line"><span class="cl">./tale.txt:herself into the show of a belief that they would soon be reunited
</span></span><span class="line"><span class="cl">./tinytale.txt:it was the epoch of belief it was the epoch of incredulity
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç»“æœå±•ç¤ºäº†ä¸€ç³»åˆ—åœ¨å½“å‰ç›®å½•å’Œå­ç›®å½•åŒ¹é… <strong>belief</strong> çš„æ–‡ä»¶ã€‚æ­¤å¤–ä½ ä¹Ÿå¯ä»¥æ’é™¤æ‰æŸäº›ä½ 
ä¸éœ€è¦æœç´¢çš„æ–‡ä»¶ï¼Œä¾‹å¦‚æœ‰ä¸€ä¸ª <strong>foo.xml</strong> çš„æ–‡ä»¶ï¼Œé‡Œé¢ä¹Ÿå¯èƒ½ä¼šæœ‰ <strong>belief</strong> è¿™ä¸ªå•è¯ï¼Œ
ä½†æ˜¯ä½ å°±æ˜¯ä¸æƒ³æœç´¢è¿™ä¸ªæ–‡ä»¶ï¼Œæˆ–è€…å…¨éƒ¨çš„ <strong>.xml</strong> æ–‡ä»¶ï¼Œä½ å¯ä»¥è¿™ä¹ˆç©ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">grep -R --exclude<span class="o">=</span><span class="s2">&#34;*.xml&#34;</span> <span class="s2">&#34;belief&#34;</span> .
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="åœ¨æ ‡å‡†è¾“å…¥æœç´¢"><span class="section-num">3</span> åœ¨æ ‡å‡†è¾“å…¥æœç´¢</h2>
<p><strong>grep</strong> ä¹Ÿæ˜¯è¿‡æ»¤å™¨ï¼Œæ‰€ä»¥ <strong>grep</strong> è‡ªç„¶è€Œç„¶å…·æœ‰å¤„ç†æ ‡å‡†è¾“å…¥è¾“å‡ºçš„èƒ½åŠ›äº†ï¼›å¤„ç†å…¶ä»–å‘½ä»¤çš„è¾“å‡ºç»“æœä¹Ÿæ˜¯ <strong>grep</strong> éå¸¸å¸¸ç”¨çš„åœºæ™¯ä¹‹ä¸€ã€‚å‡è®¾ä½ ç°åœ¨çš„ <strong>vim</strong> çªç„¶å¡é¡¿ï¼ŒæŒ‚äº†:),ä½ æƒ³è¦ <strong>kill</strong> æ‰ <strong>vim</strong> çš„è¿›ç¨‹ï¼Œä½ å¯ä»¥ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">ps -e<span class="p">|</span>grep vim
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç»“æœè¾“å‡ºå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">samray   21939     1  0 19:42 ?        00:00:00 gvim
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…¶ä¸­ç¬¬ä¸€æ¡è®°å½•å°±æ˜¯ä½ æƒ³è¦æœç´¢çš„è¿›ç¨‹äº†ï¼Œä½ è¿è¡Œ <strong>kill 21939</strong> å°±å¯ä»¥æ€æ‰ vim çš„è¿›ç¨‹äº†ï¼›å› ä¸ºæˆ‘ç³»ç»Ÿçš„æ˜¯å›¾å‹åŒ–ç•Œé¢çš„ vim, æ‰€ä»¥æ˜¯ gvim.</p>
<hr>
<p>æ­£å¦‚æˆ‘ä¹‹å‰çš„æ–‡ç« æåˆ°çš„é‚£æ ·ï¼Œå•çº¯çš„è¿‡æ»¤å™¨çš„ç”¨å¤„ä¼¼ä¹ä¸å¤§ï¼Œä½†æ˜¯å¦‚æœç»“åˆèµ·æ¥å°±ä¼šå¨åŠ›æ— ç©·è‡³äºï¼Œå¦‚ä½•ç»“åˆï¼Œå°±éœ€è¦æ…¢æ…¢æ¢ç´¢äº†ã€‚</p>
<h2 id="åå‘æœç´¢"><span class="section-num">4</span> åå‘æœç´¢</h2>
<p>ç°åœ¨æ‰§è¡Œçš„æœç´¢éƒ½æ˜¯åŒ¹é…æœç´¢ï¼Œå³å°†åŒ¹é…çš„å†…å®¹æ˜¾ç¤ºå‡ºæ¥ï¼Œè€Œ <strong>grep</strong> è¿˜æœ‰åå‘æœç´¢çš„åŠŸèƒ½ (invert Searches)å°±æ˜¯å°†ä¸åŒ…å«æœ‰æŒ‡å®šæ¨¡å¼çš„å†…å®¹æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<p>è¯¥åŠŸèƒ½åœ¨ç”¨æ¥ä¿®æ”¹æœ‰å¾ˆå¤šæ³¨é‡Šçš„é…ç½®æ–‡ä»¶æ—¶ç‰¹åˆ«æœ‰ç”¨ï¼›ä¾‹å¦‚å¸¸ç”¨çš„æœåŠ¡å™¨è½¯ä»¶ <strong>nginx</strong>  çš„é…ç½®æ–‡ä»¶æ˜¯é»˜è®¤æ˜¯å«æœ‰å¾ˆå¤šæ³¨é‡Šçš„ï¼Œå¦‚ä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cfg" data-lang="cfg"><span class="line"><span class="cl"><span class="c1">#user www-data;</span>
</span></span><span class="line"><span class="cl"><span class="na">worker_processes auto;</span>
</span></span><span class="line"><span class="cl"><span class="na">pid /run/nginx.pid;</span>
</span></span><span class="line"><span class="cl"><span class="na">include /etc/nginx/modules-enabled/*.conf;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="na">events {</span>
</span></span><span class="line"><span class="cl"><span class="na">worker_connections 1024;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># multi_accept on;</span>
</span></span><span class="line"><span class="cl"><span class="na">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="na">http {</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Basic Settings</span>
</span></span><span class="line"><span class="cl"><span class="c1">##</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="na">sendfile on;</span>
</span></span><span class="line"><span class="cl"><span class="na">tcp_nopush on;</span>
</span></span><span class="line"><span class="cl"><span class="na">tcp_nodelay on;</span>
</span></span><span class="line"><span class="cl"><span class="na">keepalive_timeout 65;</span>
</span></span><span class="line"><span class="cl"><span class="na">types_hash_max_size 2048;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># server_tokens off;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># server_names_hash_bucket_size 64;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># server_name_in_redirect off;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="na">include /etc/nginx/mime.types;</span>
</span></span><span class="line"><span class="cl"><span class="na">default_type application/octet-stream;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##</span>
</span></span><span class="line"><span class="cl"><span class="c1"># SSL Settings</span>
</span></span><span class="line"><span class="cl"><span class="c1">##</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="na">ssl_protocols TLSv1 TLSv1.1 TLSv1.2; # Dropping SSLv3, ref: POODLE</span>
</span></span><span class="line"><span class="cl"><span class="na">ssl_prefer_server_ciphers on;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Logging Settings</span>
</span></span><span class="line"><span class="cl"><span class="c1">##</span>
</span></span><span class="line"><span class="cl"><span class="na">log_format main &#39;$remote_addr - $remote_user [$time_local] &#34;$request&#34; $status $bytes_sent &#34;$http_referer&#34; &#34;$http_user_agent&#34; &#34;$gzip_ratio&#34;&#39;;</span>
</span></span><span class="line"><span class="cl"><span class="na">access_log /var/log/nginx/access.log;</span>
</span></span><span class="line"><span class="cl"><span class="na">error_log /var/log/nginx/error.log;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Gzip Settings</span>
</span></span><span class="line"><span class="cl"><span class="c1">##</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="na">gzip on;</span>
</span></span><span class="line"><span class="cl"><span class="na">gzip_disable &#34;msie6&#34;;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># gzip_vary on;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># gzip_proxied any;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># gzip_comp_level 6;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># gzip_buffers 16 8k;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># gzip_http_version 1.1;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">##</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Virtual Host Configs</span>
</span></span><span class="line"><span class="cl"><span class="c1">##</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="na">include /etc/nginx/conf.d/*.conf;</span>
</span></span><span class="line"><span class="cl"><span class="na">include /etc/nginx/sites-enabled/*;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="na">ignore_invalid_headers on;</span>
</span></span><span class="line"><span class="cl"><span class="na">client_header_timeout 240;</span>
</span></span><span class="line"><span class="cl"><span class="na">client_body_timeout 240;</span>
</span></span><span class="line"><span class="cl"><span class="na">send_timeout 240;</span>
</span></span><span class="line"><span class="cl"><span class="na">client_max_body_size 100m;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_buffer_size 128k;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_buffers 8 128k;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="na">upstream tomcat_server{</span>
</span></span><span class="line"><span class="cl"><span class="na">server 127.0.0.1:8080 fail_timeout</span><span class="o">=</span><span class="s">0;</span>
</span></span><span class="line"><span class="cl"><span class="na">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="na">upstream gunicorn_server{</span>
</span></span><span class="line"><span class="cl"><span class="na">server 127.0.0.1:5000 fail_timeout</span><span class="o">=</span><span class="s">0;</span>
</span></span><span class="line"><span class="cl"><span class="na">}</span>
</span></span><span class="line"><span class="cl"><span class="na">server{</span>
</span></span><span class="line"><span class="cl"><span class="na">server_name 127.0.0.1;</span>
</span></span><span class="line"><span class="cl"><span class="na">listen 443;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ssl on;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ssl_certificate /etc/letsencrypt/live/samray.ren/fullchain.pem;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ssl_certificate_key /etc/letsencrypt/live/samray.ren/privkey.pem;</span>
</span></span><span class="line"><span class="cl"><span class="na">location / {</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Forward SSL so that Tomcat knows what to do</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_set_header X-Forwarded-Host $host;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_set_header X-Forwarded-Server $host;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_pass http://tomcat_server;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_set_header X-Forwarded-Proto https;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="na">proxy_redirect off;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_connect_timeout      240;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_send_timeout         240;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_read_timeout         240;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="na">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="na">location /test{</span>
</span></span><span class="line"><span class="cl"><span class="na">return 402;</span>
</span></span><span class="line"><span class="cl"><span class="na">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="na">location /weixin {</span>
</span></span><span class="line"><span class="cl"><span class="c1"># try_files $uri @proxy_to_app;</span>
</span></span><span class="line"><span class="cl"><span class="na">return 402;</span>
</span></span><span class="line"><span class="cl"><span class="na">}</span>
</span></span><span class="line"><span class="cl"><span class="na">location @proxy_to_app {</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_set_header Host $http_host;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_redirect off;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_pass http://gunicorn_server;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="na">}</span>
</span></span><span class="line"><span class="cl"><span class="na">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="na">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#mail {</span>
</span></span><span class="line"><span class="cl"><span class="c1">#	# See sample authentication script at:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#	# http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1">#	# auth_http localhost/auth.php;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#	# pop3_capabilities &#34;TOP&#34; &#34;USER&#34;;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#	# imap_capabilities &#34;IMAP4rev1&#34; &#34;UIDPLUS&#34;;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1">#	server {</span>
</span></span><span class="line"><span class="cl"><span class="c1">#		listen     localhost:110;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#		protocol   pop3;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#		proxy      on;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#	}</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1">#	server {</span>
</span></span><span class="line"><span class="cl"><span class="c1">#		listen     localhost:143;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#		protocol   imap;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#		proxy      on;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#	}</span>
</span></span><span class="line"><span class="cl"><span class="c1">#}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é‡Œé¢å®åœ¨æœ‰å¤ªå¤šçš„æ³¨é‡Šäº†ï¼Œè™½è¯´æ˜¯å¾ˆå¥½çš„å‚è€ƒï¼Œä½†æ˜¯çœ‹å¤šäº†ä¼šæ„Ÿè§‰å¾ˆç¢çœ¼ï¼Œæ‰€ä»¥ä½ å¸Œæœ›å¯ä»¥æœ‰ä¸€ä»½æ²¡æœ‰æ³¨é‡Šçš„é…ç½®æ–‡ä»¶ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨ <strong>grep</strong> å’Œå‚æ•° <strong>-v</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">egrep -v <span class="s2">&#34;#|^</span>$<span class="s2">&#34;</span> /etc/nginx/nginx.conf &gt;/tmp/nging.conf
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç»“æœå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cfg" data-lang="cfg"><span class="line"><span class="cl"><span class="na">worker_processes auto;</span>
</span></span><span class="line"><span class="cl"><span class="na">pid /run/nginx.pid;</span>
</span></span><span class="line"><span class="cl"><span class="na">include /etc/nginx/modules-enabled/*.conf;</span>
</span></span><span class="line"><span class="cl"><span class="na">events {</span>
</span></span><span class="line"><span class="cl"><span class="na">worker_connections 1024;</span>
</span></span><span class="line"><span class="cl"><span class="na">}</span>
</span></span><span class="line"><span class="cl"><span class="na">http {</span>
</span></span><span class="line"><span class="cl"><span class="na">sendfile on;</span>
</span></span><span class="line"><span class="cl"><span class="na">tcp_nopush on;</span>
</span></span><span class="line"><span class="cl"><span class="na">tcp_nodelay on;</span>
</span></span><span class="line"><span class="cl"><span class="na">keepalive_timeout 65;</span>
</span></span><span class="line"><span class="cl"><span class="na">types_hash_max_size 2048;</span>
</span></span><span class="line"><span class="cl"><span class="na">include /etc/nginx/mime.types;</span>
</span></span><span class="line"><span class="cl"><span class="na">default_type application/octet-stream;</span>
</span></span><span class="line"><span class="cl"><span class="na">ssl_prefer_server_ciphers on;</span>
</span></span><span class="line"><span class="cl"><span class="na">log_format main &#39;$remote_addr - $remote_user [$time_local] &#34;$request&#34; $status $bytes_sent &#34;$http_referer&#34; &#34;$http_user_agent&#34; &#34;$gzip_ratio&#34;&#39;;</span>
</span></span><span class="line"><span class="cl"><span class="na">access_log /var/log/nginx/access.log;</span>
</span></span><span class="line"><span class="cl"><span class="na">error_log /var/log/nginx/error.log;</span>
</span></span><span class="line"><span class="cl"><span class="na">gzip on;</span>
</span></span><span class="line"><span class="cl"><span class="na">gzip_disable &#34;msie6&#34;;</span>
</span></span><span class="line"><span class="cl"><span class="na">include /etc/nginx/conf.d/*.conf;</span>
</span></span><span class="line"><span class="cl"><span class="na">include /etc/nginx/sites-enabled/*;</span>
</span></span><span class="line"><span class="cl"><span class="na">ignore_invalid_headers on;</span>
</span></span><span class="line"><span class="cl"><span class="na">client_header_timeout 240;</span>
</span></span><span class="line"><span class="cl"><span class="na">client_body_timeout 240;</span>
</span></span><span class="line"><span class="cl"><span class="na">send_timeout 240;</span>
</span></span><span class="line"><span class="cl"><span class="na">client_max_body_size 100m;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_buffer_size 128k;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_buffers 8 128k;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="na">upstream tomcat_server{</span>
</span></span><span class="line"><span class="cl"><span class="na">server 127.0.0.1:8080 fail_timeout</span><span class="o">=</span><span class="s">0;</span>
</span></span><span class="line"><span class="cl"><span class="na">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="na">upstream gunicorn_server{</span>
</span></span><span class="line"><span class="cl"><span class="na">server 127.0.0.1:5000 fail_timeout</span><span class="o">=</span><span class="s">0;</span>
</span></span><span class="line"><span class="cl"><span class="na">}</span>
</span></span><span class="line"><span class="cl"><span class="na">server{</span>
</span></span><span class="line"><span class="cl"><span class="na">server_name 127.0.0.1;</span>
</span></span><span class="line"><span class="cl"><span class="na">listen 443;</span>
</span></span><span class="line"><span class="cl"><span class="na">location / {</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="na">proxy_set_header X-Forwarded-Host $host;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_set_header X-Forwarded-Server $host;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_pass http://tomcat_server;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_set_header X-Forwarded-Proto https;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_redirect off;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_connect_timeout      240;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_send_timeout         240;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_read_timeout         240;</span>
</span></span><span class="line"><span class="cl"><span class="na">}</span>
</span></span><span class="line"><span class="cl"><span class="na">location /test{</span>
</span></span><span class="line"><span class="cl"><span class="na">return 402;</span>
</span></span><span class="line"><span class="cl"><span class="na">}</span>
</span></span><span class="line"><span class="cl"><span class="na">location /weixin {</span>
</span></span><span class="line"><span class="cl"><span class="na">return 402;</span>
</span></span><span class="line"><span class="cl"><span class="na">}</span>
</span></span><span class="line"><span class="cl"><span class="na">location @proxy_to_app {</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_set_header Host $http_host;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_redirect off;</span>
</span></span><span class="line"><span class="cl"><span class="na">proxy_pass http://gunicorn_server;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="na">}</span>
</span></span><span class="line"><span class="cl"><span class="na">}</span>
</span></span><span class="line"><span class="cl"><span class="na">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>egrep</strong> æ˜¯ <strong>grep</strong> çš„æ‰©å±•ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡ <strong>-E</strong> ä½¿ç”¨æ‰©å±•åŠŸèƒ½ã€‚å°±è¿™æ ·ï¼Œä½ å°±å¯ä»¥å¾—åˆ°ä¸€ä»½å¾ˆâ€œå¹²å‡€â€çš„é…ç½®æ–‡ä»¶äº†ã€‚</p>
<h2 id="å°ç»“"><span class="section-num">5</span> å°ç»“</h2>
<p>åœ¨ä»¥å‰ <strong>grep</strong> æ˜¯ <strong>hacker</strong> å·¥å…·ç®±é‡Œé¢å®¡æŸ¥æºä»£ç å¿…ä¸å¯å°‘çš„å·¥å…·ä¹‹ä¸€ï¼Œä½†æ˜¯éšç€æŠ€æœ¯çš„å‘å±•ï¼Œä¼¼ä¹å¯¹æ¯”å…¶ä»–åŒç±»å‹çš„å·¥å…·ï¼Œ <strong>grep</strong> çš„æ€§èƒ½å·²ç»éš¾å°½äººæ„ï¼Œç‰¹åˆ«æ˜¯å¯¹æ¯” <strong>ag</strong> è¿™ä¸ªæœç´¢ç¥å™¨ï¼›</p>
<p>è™½è¯´å¾ˆå¤šäººéƒ½å·²ç»è½¬ç§»åˆ°äº† <strong>ag</strong> é˜µè¥ï¼Œä½†æ˜¯å› ä¸º <strong>grep</strong> è¢«å¹¿æ³›é¢„è£…åˆ°å„ç±»çš„Linux/Unix æœºå™¨ï¼Œæ‰€ä»¥ <strong>grep</strong> è¿˜æ˜¯ä½¿ç”¨å¾—å¾ˆå¹¿æ³›æ»´ã€‚</p>
<p>æ›´å¤š <strong>grep</strong> çš„ç”¨æ³•å°±éœ€è¦æŸ¥è¯¢æ‰‹å†Œäº†ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">man grep
</span></span></code></pre></td></tr></table>
</div>
</div><p>Enjoy Shell :)</p>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
]]></content:encoded>
    </item>
    <item>
      <title>Linux/Unix Shell äºŒä¸‰äº‹ä¹‹è¿‡æ»¤å™¨diff</title>
      <link>https://ramsayleung.github.io/zh/post/2017/diff/</link>
      <pubDate>Tue, 28 Feb 2017 00:00:00 -0800</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2017/diff/</guid>
      <description>An introduction about diff</description>
      <content:encoded><![CDATA[<blockquote>
<p>diff - compare files line by line</p>
</blockquote>
<p>å¦‚æœä½ æœ‰ä½¿ç”¨è¿‡git,é‚£ä¹ˆä½ ä¸€å®šä¸ä¼šå¯¹diff é™Œç”Ÿï¼Œå› ä¸ºå¯¹ä½ æºæ–‡ä»¶å’Œä¿®æ”¹åçš„æ–‡ä»¶è¿›è¡Œæ¯”è¾ƒçš„å°±æ˜¯ <strong>diff</strong> è¿™ä¸ªå¤§åé¼é¼çš„å®¶ä¼™äº†ã€‚</p>
<p>å¤šå¹´ä»¥æ¥ï¼Œ <strong>diff</strong> éƒ½ä¸€ç›´æ˜¯éå¸¸é‡è¦çš„å·¥å…·ï¼Œä¸Šå¤å¤§ç¥ éƒ½æ˜¯ä½¿ç”¨ <strong>diff</strong> å’Œ <strong>patch</strong> å¯¹ç¨‹åºè¿›è¡Œå·®åˆ†å’Œæ‰“è¡¥ä¸æ»´(ç°åœ¨æœ‰gitäº†ï¼Œä½†æ˜¯diffåŒæ ·å‘æŒ¥ç€é‡è¦ä½œç”¨)</p>
<h2 id="è¯­æ³•"><span class="section-num">1</span> è¯­æ³•</h2>
<p>diff çš„è¯­æ³•å¦‚ä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">diff <span class="o">[</span>OPTION<span class="o">]</span>.... file1 file2
</span></span></code></pre></td></tr></table>
</div>
</div><p><em>OPTION</em> æŒ‡ä¸åŒçš„é€‰é¡¹å‚æ•°ï¼Œfile1,file2 æ˜¯æ–‡æœ¬æ–‡ä»¶çš„åå­—ï¼Œå¦‚æœæ¯”è¾ƒçš„ä¸¤ä¸ªæ–‡ä»¶ç›¸åŒ diff å°†ä¸è¾“å‡ºä»»ä½•ä¸œè¥¿ã€‚å¦‚æœä¸¤ä¸ªæ–‡ä»¶æœ‰å·®å¼‚ï¼Œdiff ä¼šæ˜¾ç¤ºä¸€ç³»åˆ—çš„æŒ‡ç¤ºï¼Œè®©ä½ å¯ä»¥æŠŠç¬¬ä¸€ä¸ªæ–‡ä»¶ä¿®æ”¹ä¸ºä¸ç¬¬äºŒä¸ªæ–‡ä»¶ä¸€è‡´</p>
<h2 id="ä¾‹å­"><span class="section-num">2</span> ä¾‹å­</h2>
<h3 id="ç”¨æ³•ä¸€"><span class="section-num">2.1</span> ç”¨æ³•ä¸€</h3>
<p>ç°åœ¨æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«ä¿å­˜ç€ä¸åŒçš„åœ°å€ã€‚
address1 åŒ…å«ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">guangdong
</span></span><span class="line"><span class="cl">shanghai
</span></span><span class="line"><span class="cl">beijing
</span></span><span class="line"><span class="cl">chengdu
</span></span></code></pre></td></tr></table>
</div>
</div><p>address2 åŒ…å«ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">guangdong
</span></span><span class="line"><span class="cl">shanghai
</span></span><span class="line"><span class="cl">beijin
</span></span><span class="line"><span class="cl">chengdu
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½ å¯ä»¥æ³¨æ„åˆ°ä¸¤ä¸ªæ–‡ä»¶çš„åŒºåˆ«å°±æ˜¯ç¬¬ä¸‰è¡Œçš„ <em>beijing</em>.ç„¶åè¿è¡Œ <strong>diff</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">diff address1 address2
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºç»“æœï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">3c3
</span></span><span class="line"><span class="cl">&lt; beijing
</span></span><span class="line"><span class="cl">---
</span></span><span class="line"><span class="cl">&gt; beijin
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¼¼ä¹æœ‰ç‚¹éš¾ä»¥ç†è§£ï¼Œè¾“å‡ºç»“æœæè¿°äº†ä»€ä¹ˆå‘¢ï¼Ÿå…¶å®diff æ˜¯åœ¨æŒ‡å¯¼å¦‚ä½•ä¿®æ”¹ä¸åŒçš„æ–‡ä»¶ä½¿ä¹‹ä¸€è‡´ <strong>&lt;</strong> åæ¥çš„æ˜¯æ–‡ä»¶1ä¸­ä¸æ–‡ä»¶2ä¸åŒçš„éƒ¨åˆ†ï¼Œ <strong>&gt;</strong> åæ¥çš„æ˜¯æ–‡ä»¶2ä¸­ä¸æ–‡ä»¶1ä¸åŒçš„éƒ¨åˆ†</p>
<p>diff çš„è¾“å‡ºä½¿ç”¨3ä¸ªä¸åŒçš„å•å­—ç¬¦æŒ‡å¯¼ï¼ša(append,è¿½åŠ ),c(change,ä¿®æ”¹),d(delete,åˆ é™¤). åœ¨ä¸Šé¢çš„ä¾‹å­ï¼Œåªæ˜¯çœ‹åˆ°ä¸€ä¸ª <em>c</em>,æ„å‘³ç€ï¼Œå¦‚æœæƒ³æŠŠ <em>address1</em> ä¿®æ”¹æˆ <em>address2</em> åªéœ€å°† <em>address1</em> çš„ç¬¬ä¸‰è¡Œä¿®æ”¹æˆ <em>address2</em> çš„ç¬¬ä¸‰è¡Œ</p>
<h3 id="ç”¨æ³•2"><span class="section-num">2.2</span> ç”¨æ³•2</h3>
<p>ç°åœ¨æŠŠ <em>address2</em> çš„æœ€åä¸€è¡Œåˆ é™¤ï¼Œçœ‹çœ‹è¿è¡Œ <em>diff</em> ç»“æœå¦‚ä½•ï¼š
address1 åŒ…å«ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">guangdong
</span></span><span class="line"><span class="cl">shanghai
</span></span><span class="line"><span class="cl">beijing
</span></span><span class="line"><span class="cl">chengdu
</span></span></code></pre></td></tr></table>
</div>
</div><p>address2 åŒ…å«ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">guangdong
</span></span><span class="line"><span class="cl">shanghai
</span></span><span class="line"><span class="cl">beijing
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">diff address1 address2
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºç»“æœï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">4d3
</span></span><span class="line"><span class="cl">&lt; chengdu
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨è¯¥ä¾‹å­ä¸­ï¼Œä¸ºäº†å°† <em>address1</em> å˜æˆ <em>address2</em> åªéœ€åˆ é™¤ <em>address1</em> çš„ç¬¬å››è¡Œ</p>
<h3 id="ç”¨æ³•3"><span class="section-num">2.3</span> ç”¨æ³•3</h3>
<p>ç°åœ¨æŠŠ <em>address1</em> çš„æœ€åä¸€è¡Œåˆ é™¤ï¼Œçœ‹çœ‹è¿è¡Œ <em>diff</em> ç»“æœå¦‚ä½•ï¼š
address1 åŒ…å«ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">guangdong
</span></span><span class="line"><span class="cl">shanghai
</span></span><span class="line"><span class="cl">beijing
</span></span></code></pre></td></tr></table>
</div>
</div><p>address2 åŒ…å«ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">guangdong
</span></span><span class="line"><span class="cl">shanghai
</span></span><span class="line"><span class="cl">beijing
</span></span><span class="line"><span class="cl">chengdu
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">diff address1 address2
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºç»“æœï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">3a4
</span></span><span class="line"><span class="cl">&gt; chengdu
</span></span></code></pre></td></tr></table>
</div>
</div><p>æƒ³å°†ç¬¬ä¸€ä¸ªæ–‡ä»¶è½¬æ¢æˆç¬¬äºŒä¸ªæ–‡ä»¶ï¼Œåªéœ€åœ¨ç¬¬ä¸€ä¸ªæ–‡ä»¶è¿½åŠ ç¬¬äºŒä¸ªæ–‡ä»¶çš„ç¬¬å››è¡Œ(å³åœ¨ç¬¬ä¸€ä¸ªæ–‡ä»¶çš„ç¬¬ <strong>3</strong> è¡Œä¹‹åè¿½åŠ ç¬¬äºŒä¸ªæ–‡ä»¶çš„ç¬¬ <strong>4</strong> è¡Œ)</p>
<h2 id="diff-é€‰é¡¹"><span class="section-num">3</span> diff é€‰é¡¹</h2>
<p>å› ä¸ºdiff æ˜¯ä¸€ä¸ªç›¸å½“å¼ºå¤§ä¹Ÿæ˜¯ä¸€ä¸ªç›¸å½“å¤æ‚çš„å‘½ä»¤ï¼Œæ‰€ä»¥æˆ‘æ²¡åŠæ³•å°†æ‰€æœ‰çš„ç”¨æ³•ä¸€ä¸€é“
å°½æ‰€ä»¥ç¬”è€…å°†æ¯”è¾ƒå¸¸ç”¨çš„é€‰é¡¹åˆ—ä¸¾å‡ºæ¥</p>
<ul>
<li><strong>-b</strong>:å¿½ç•¥åˆ¶è¡¨ç¬¦(ä¸å¿½ç•¥æ‰€æœ‰çš„ç©ºç™½ç¬¦ï¼ŒæŒ‡å¿½ç•¥ç©ºç™½ç¬¦æ•°é‡çš„å·®å¼‚),ä¾‹å¦‚ä¸‹é¢çš„ä¸¤è¡Œæ˜¯ç›¸åŒçš„</li>
</ul>
<!--listend-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">a    a
</span></span><span class="line"><span class="cl">a a
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>-B(blank lines)</strong>:å¿½ç•¥æ‰€æœ‰çš„ç©ºç™½è¡Œ</li>
<li><strong>-c(context)</strong>:ä»¥ä¸Šä¸‹æ–‡çš„å½¢å¼æ˜¾ç¤ºå·®å¼‚å†…å®¹ï¼Œå¯¹æ¯”é»˜è®¤è¾“å‡ºæ›´åŠ å®¹æ˜“ç†è§£(ä½†æ˜¯ä¹Ÿæ›´åŠ ç¹æ‚)</li>
<li><strong>-q(quiet)</strong>: diff é™é»˜è®¾ç½®ï¼Œå³å¦‚æœæ–‡ä»¶file1å’Œfile2æœ‰å·®å¼‚ï¼Œdiff ä¹Ÿåªä¼šæ˜¾ç¤º <em>File file1 and file2 differ</em></li>
<li><strong>-w(whitespace)</strong>:å¿½ç•¥æ‰€æœ‰çš„ç©ºç™½ç¬¦</li>
<li><strong>-u(unified output)</strong>: ä¸Šä¸‹æ–‡å½¢å¼æ˜¾ç¤ºçš„æ”¹è¿›ï¼Œä¸ä¼šè¾“å‡ºé‡å¤è¡Œ</li>
<li><strong>-y</strong>:å°†æ–‡ä»¶åˆ†æˆä¸¤åˆ—æˆ–å¤šåˆ—å¹¶æ’è¿›è¡Œè¾“å‡º(éå¸¸ç›´è§‚ï¼Œä½†æ˜¯è¾“å‡ºå¾ˆç¹æ‚)</li>
</ul>
<p>è¿˜æ˜¯è€è¯ï¼Œæ›´å¤šçš„ç”¨æ³•å°±éœ€è¦ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">man diff
</span></span></code></pre></td></tr></table>
</div>
</div><div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
]]></content:encoded>
    </item>
    <item>
      <title>æ¯æ ‘é€¢æ˜¥ä¹‹ArchLinuxé¢†é£éªš</title>
      <link>https://ramsayleung.github.io/zh/post/2017/install_archlinux/</link>
      <pubDate>Mon, 27 Feb 2017 00:00:00 +0800</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2017/install_archlinux/</guid>
      <description>An description about how to install arch linux in an old machine</description>
      <content:encoded><![CDATA[<h2 id="æ¯æ ‘"><span class="section-num">1</span> æ¯æ ‘</h2>
<p>å‘¨æœ«å›äº†ä¸€è¶Ÿå®¶ï¼Œæ²¡å¸¦è‡ªå·±çš„ç¬”è®°æœ¬ï¼Œåœ¨å®¶é—²æ¥æ— äº‹ï¼Œæ— æ„ä¸­çœ‹åˆ°å¢™è§’çš„ç”µè„‘ï¼Œå·²ç»å°˜å°å·²ä¹…åæ­£æ— äº‹ï¼Œä½•ä¸ç©ç©è¿™å°è€å¤è‘£å‘¢ï¼Ÿäºæ˜¯æŠŠç”µè„‘æ‹¿å»ä¿®ç†åº—æŠŠåäº†çš„ç¡¬ä»¶ä¿®å¥½ã€‚</p>
<p>ç¦»å¼€åº—çš„æ—¶å€™ï¼Œè€æ¿è¯´ï¼šâ€œä½ çš„ç³»ç»Ÿæœ‰é—®é¢˜ï¼Œæˆ‘çœ‹åˆ°ä½ è‡ªå·±ä¹Ÿæœ‰Ghost,å°±ä¸å¸®æè¿™ç³»ç»Ÿäº†ï¼Œ ä½ è‡ªå·±éƒ½èƒ½è§£å†³çš„ï¼Œæ¨èä½ è¿˜æ˜¯ç”¨XPå§ï¼Œè¿™ç”µè„‘é…ç½®ä½ï¼Œè¿˜æ˜¯XPå¥½ç”¨â€ã€‚æˆ‘å¿ä¸ä½å›å¤´å¯¹è€æ¿ä¸€ç¬‘ :)</p>
<h2 id="æ˜¥è‡³"><span class="section-num">2</span> æ˜¥è‡³</h2>
<p>åƒæˆ‘è¿™ç§Linuxer,è¿™ä¹ˆå¯èƒ½å†è£…å›XPå‘¢ï¼Œæœ€åˆè£…Win7,ä¹Ÿæ˜¯è€ƒè™‘åˆ°è€çˆ¹çš„æŠ€æœ¯ hold ä¸ä½ Linux, ç°åœ¨æ‰‹æœºé‚£ä¹ˆå‘è¾¾ï¼Œä»–å°±ä¸éœ€è¦ç”µè„‘äº†ï¼Œæ‰€ä»¥ï¼Œæ­¤æ—¶ä¸è£…Linux,æ›´å¾…ä½•æ—¶å‘¢ï¼Ÿ</p>
<h2 id="arch-linux"><span class="section-num">3</span> Arch Linux</h2>
<p>æˆ‘æ²¡æœ‰é€‰æ‹© Xubuntu è¿™ç§é€‚åˆè€æœºå™¨çš„ Ubuntu è¡ç”Ÿå‘è¡Œç‰ˆæœ¬ï¼Œå› ä¸ºæˆ‘ä¸å–œæ¬¢Ubuntu, æ‰€ä»¥æˆ‘æœ€åé€‰æ‹©çš„æ˜¯ Arch linux,å®˜ç½‘è¯´æœ€ä½é…ç½®åªéœ€500MBå†…å­˜ï¼Œ800MBçš„ ç¡¬ç›˜å­˜å‚¨ç©ºé—´ï¼Œæ­£é€‚åˆå®¶é‡Œçš„è€å®¶ä¼™</p>
<h3 id="å®‰è£…è¿‡ç¨‹"><span class="section-num">3.1</span> å®‰è£…è¿‡ç¨‹</h3>
<h4 id="ä¸‹è½½é•œåƒ"><span class="section-num">3.1.1</span> ä¸‹è½½é•œåƒ</h4>
<p><a href="https://www.archlinux.org/download/">Download Link</a> ,åœ¨ç½‘æ˜“çš„é•œåƒä¸‹è½½ISO, ç„¶åç”¨ddåˆ»å½•åˆ°Uç›˜ï¼ŒWindows å¯ä»¥é€‰æ‹© <a href="http://sourceforge.net/projects/usbwriter">USBwriter</a></p>
<h4 id="åˆ†åŒº"><span class="section-num">3.1.2</span> åˆ†åŒº</h4>
<p>ä½¿ç”¨fdisk, æˆ‘çš„ç¡¬ç›˜æ˜¯/dev/sda,å¦‚æœè¿˜æœ‰ä¸€å—ç¡¬ç›˜ï¼Œé‚£åº”è¯¥å°±æ˜¯/dev/sdb</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">fdisk /dev/sda
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>n:æ–°å»ºä¸€ä¸ªåˆ†åŒºï¼Œp æŒ‡ä¸»åˆ†åŒºï¼Œe æ˜¯æŒ‡æ‰©å±•åˆ†åŒº(é€»è¾‘åˆ†åŒºæ˜¯å»ºç«‹åœ¨æ‰©å±•åˆ†åŒºä¸Šçš„)
ä¸€å—ç¡¬ç›˜ä¸»åˆ†åŒºåŠ ä¸Šæ‰©å±•åˆ†åŒºæœ€å¤šåªèƒ½æ˜¯4ä¸ª</li>
<li>d: åˆ é™¤</li>
<li>m: æŸ¥è¯¢å…¶ä»–å‘½ä»¤ï¼Œä¸çŸ¥é“æ€ä¹ˆæ“ä½œå°±è¾“å…¥m å§</li>
</ul>
<p>åˆ†åŒºç»“æŸä»¥åï¼Œè¾“å…¥ <code>w</code> å®Œæˆåˆ†åŒº (æˆ‘åˆ†äº†ä¸‰ä¸ªåˆ†åŒº /dev/sda1 -&gt; swap
/dev/sda2 -&gt; / /dev/sda3 -&gt; /home)</p>
<h4 id="æ ¼å¼åŒ–åˆ†åŒº"><span class="section-num">3.1.3</span> æ ¼å¼åŒ–åˆ†åŒº</h4>
<p>æ ¼å¼åŒ– sda2 sda3ä¸ºext4æ ¼å¼ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">mkfs.ext4 /dev/sda2
</span></span><span class="line"><span class="cl">mkfs.ext4 /dev/sda3
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ ¼å¼åŒ–sda1 ä¸ºswap(è™šæ‹Ÿå†…å­˜),ä¸€èˆ¬æ˜¯å†…å­˜çš„ä¸¤å€ï¼Œå½“ç„¶å¦‚æœä½ çš„å†…å­˜å¾ˆå¤§çš„è¯å°±ä¸ç”¨åˆ’è¿™ä¸ªåˆ†åŒºäº†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">mkswap /dev/sda1
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¿€æ´»swap</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">swapon /dev/sda1
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="æŒ‚è½½"><span class="section-num">3.1.4</span> æŒ‚è½½</h4>
<p>å°†sda2æŒ‚è½½åˆ°/mnt,å…¶å®å°±æ˜¯è®©sda2åˆ†åŒºåšç³»ç»Ÿçš„æ ¹åˆ†åŒºï¼Œ/mnt/homeåŒç†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">mount /dev/sda2 /mnt
</span></span><span class="line"><span class="cl">mount /dev/sda3 /mnt/home
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="æ›´æ–°pacmanæº"><span class="section-num">3.1.5</span> æ›´æ–°pacmanæº</h4>
<p>ç½‘æ˜“çš„æºä¸é”™ï¼Œç¼–è¾‘ <code>/etc/pacman.d/mirrorlist</code> æ·»åŠ  <code>Server = http://mirrors.163.com/archlinux/$repo/os/$arch</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">vim /etc/pacman.d/mirrorlist
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åæ·»åŠ ï¼›æ·»åŠ å®Œä¹‹åï¼Œæ›´æ–°ä¸€ä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -Syy
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="å®‰è£…åŸºæœ¬ç³»ç»Ÿ"><span class="section-num">3.1.6</span> å®‰è£…åŸºæœ¬ç³»ç»Ÿ</h4>
<p>å®‰è£…åŸºæœ¬ç³»ç»Ÿåˆ° /mnt,å³sda2åˆ†åŒº</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacstrap /mnt base base-devel
</span></span></code></pre></td></tr></table>
</div>
</div><p>éœ€è¦å®‰è£…çš„éƒ½å®‰è£…å§ï¼Œç„¶åèµ°å¼€ç…®ä¸€æ¯å’–å•¡ï¼Œæ…¢æ…¢å“å°</p>
<h4 id="ç”Ÿæˆfstab"><span class="section-num">3.1.7</span> ç”Ÿæˆfstab</h4>
<p>fstab çš„ä½œç”¨ï¼š</p>
<blockquote>
<p>The fstab(5) file can be used to define how disk partitions, various other block devices, or remote filesystems should be mounted into the filesystem</p>
</blockquote>
<p>ç”Ÿæˆfstab,å¹¶ä¸”æŸ¥çœ‹æ˜¯å¦æ­£ç¡®ç”Ÿæˆfstab</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">genfstab -U -p /mnt &gt;&gt; /mnt/etc/fstab
</span></span><span class="line"><span class="cl">cat /mnt/etc/fstab
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="é…ç½®ç³»ç»Ÿ"><span class="section-num">3.1.8</span> é…ç½®ç³»ç»Ÿ</h4>
<p>åˆ‡æ¢åˆ°æ–°çš„ç³»ç»Ÿï¼Œç„¶åä½ ä¼šå‘ç°å‘½ä»¤è¡Œæç¤ºç¬¦å‘ç”Ÿäº†æ”¹å˜</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">arch-chroot /mnt
</span></span></code></pre></td></tr></table>
</div>
</div><!--list-separator-->
<ol>
<li>
<p>è®¾ç½®åœ°åŒº</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">ln -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<!--list-separator-->
<ol start="2">
<li>
<p>è®¾ç½®è¯­è¨€</p>
<p>ç¼–è¾‘ <code>/etc/locale.gen</code>,å› ä¸ºè¯¥æ–‡ä»¶æ‰€æœ‰çš„ä¿¡æ¯éƒ½æ˜¯è¢«æ³¨é‡Šæ»´ï¼Œæ‰€ä»¥åœ¨æœ€ä¸Šé¢æ·»åŠ <code>en_US.UTF-8 UTF-8</code> å³å¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">vim /etc/locale.gen
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åæ·»åŠ ï¼›æ·»åŠ å®Œæˆåï¼Œæ‰§è¡Œ <code>locale-gen</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">locale-gen
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¥ç€é…ç½® <code>locale.conf</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="nv">LANG</span><span class="o">=</span>en_US.UTF-8 &gt; /etc/locale.conf
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">LANG</span><span class="o">=</span>en_US.UTF-8
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<!--list-separator-->
<ol start="3">
<li>
<p>è®¾ç½®ä¸»æœºå</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">echo</span> samray-arch &gt; /etc/hostname
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<!--list-separator-->
<ol start="4">
<li>
<p>è®¾ç½®å¯†ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">passwd
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<!--list-separator-->
<ol start="5">
<li>
<p>é…ç½®ç½‘ç»œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -S net-tools
</span></span><span class="line"><span class="cl">systemctl <span class="nb">enable</span> dhcpcd.service
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<!--list-separator-->
<ol start="6">
<li>
<p>å®‰è£…GRUB</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -S grub-bios
</span></span></code></pre></td></tr></table>
</div>
</div><p>æŠŠgrub å®‰è£…åˆ°ç¡¬ç›˜sda,å¦‚æœåŒç³»ç»Ÿçš„è¯ï¼Œè¿˜è¦è§†æƒ…å†µåšæ›´æ”¹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">grub-install --recheck /dev/sda
</span></span><span class="line"><span class="cl">grub-mkconfig -o /boot/grub/grub.cfg
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h4 id="æ”¶å°¾å·¥ä½œ"><span class="section-num">3.1.9</span> æ”¶å°¾å·¥ä½œ</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">exit</span>
</span></span><span class="line"><span class="cl">umount /mnt/home
</span></span><span class="line"><span class="cl">umount /mnt
</span></span><span class="line"><span class="cl">reboot
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ ·Arch linux å°±è£…å¥½äº†ï¼Œä¸è¿‡ä½ é‡å¯ä¼šå‘ç°ï¼Œä½ çš„ç³»ç»Ÿæ˜¯æ²¡æœ‰å›¾å½¢åŒ–ç•Œé¢çš„</p>
<h3 id="å®‰è£…æ¡Œé¢ç¯å¢ƒ"><span class="section-num">3.2</span> å®‰è£…æ¡Œé¢ç¯å¢ƒ</h3>
<h4 id="å®‰è£…xæœåŠ¡"><span class="section-num">3.2.1</span> å®‰è£…xæœåŠ¡</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -S xorg-server xorg-server-utils xorg-xinit
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="å®‰è£…æ˜¾å¡é©±åŠ¨"><span class="section-num">3.2.2</span> å®‰è£…æ˜¾å¡é©±åŠ¨</h4>
<p>æŸ¥æ‰¾è‡ªå·±çš„æ˜¾å¡ç±»å‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">ispci <span class="p">|</span>grep VGA
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åæœç´¢åŒ¹é…è‡ªå·±æ˜¾å¡çš„é©±åŠ¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -Ss xf86-video <span class="p">|</span>less
</span></span></code></pre></td></tr></table>
</div>
</div><p>Intel é›†æˆæ˜¾å¡ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -S xf86-video-intel
</span></span></code></pre></td></tr></table>
</div>
</div><p>è™šæ‹Ÿæœºæ˜¾å¡ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -S xf86-video-vesa
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¬”è®°æœ¬è§¦æ‘¸æ¿é©±åŠ¨ (è€å®¶ä¼™æ˜¯å°å¼ï¼Œä¸éœ€è¦äº†):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -S xf86-input-synaptics
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®‰è£…è¾“å…¥æ³•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -S scim-pinyin
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…ˆå®‰è£… slim(å›¾åƒç™»å½•ç®¡ç†å™¨)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -S slim
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®‰è£…xfce4</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -S xfce4
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯åŠ¨xfce4</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">startxfce4
</span></span></code></pre></td></tr></table>
</div>
</div><p>åŸºæœ¬å°±å¤§åŠŸå‘Šæˆäº†ï¼Œå› ä¸ºæˆ‘çš„å°å¼ç”µè„‘æ˜¯bios, æ‰€ä»¥ä¸ç”¨æŠ˜è…¾uefi, è¿˜æœ‰æ— çº¿ç½‘ç»œã€‚</p>
<p><strong>Action is louder than words</strong>,è¿˜æ˜¯å¤šåŠ¨æ‰‹æ‰è¡Œï¼Œæˆ‘éƒ½è£…äº†ä¸‰æ¬¡æ‰æˆåŠŸï¼Œå†…æ ¸ç©ºæŒ‡é’ˆå’Œæ®µé”™è¯¯éƒ½é‡åˆ°äº† :ï¼‰</p>
<h3 id="å‚è€ƒ"><span class="section-num">3.3</span> å‚è€ƒ</h3>
<p><a href="https://wiki.archlinux.org/index.php/installation_guide">https://wiki.archlinux.org/index.php/installation_guide</a></p>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
]]></content:encoded>
    </item>
    <item>
      <title>Linux/Unix Shell äºŒä¸‰äº‹ä¹‹è¿‡æ»¤å™¨cat</title>
      <link>https://ramsayleung.github.io/zh/post/2017/cat/</link>
      <pubDate>Wed, 22 Feb 2017 00:00:00 -0800</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2017/cat/</guid>
      <description>An introduction about cat</description>
      <content:encoded><![CDATA[<blockquote>
<p>cat - concatenate files and print on the standard output</p>
</blockquote>
<h2 id="è¿‡æ»¤å™¨"><span class="section-num">1</span> è¿‡æ»¤å™¨</h2>
<p>ä½•è°“è¿‡æ»¤å™¨å‘¢ï¼Œä¾‹å¦‚cat,grep,wl ä¹‹ç±»çš„å‘½ä»¤å°±æ˜¯è¿‡æ»¤å™¨äº†ã€‚è¿™æ ·çš„å‘½ä»¤
è¯»å–æ•°æ®ï¼Œå¯¹æ•°æ®æ‰§è¡Œä¸€äº›æ“ä½œï¼Œç„¶åå†™å…¥ç»“æœã€‚æ›´å‡†ç¡®åœ°è¯´ï¼Œè¿‡æ»¤å™¨å°±æ˜¯ä»»ä½•èƒ½å¤Ÿä»æ ‡å‡†
è¾“å…¥è¯»å– <strong>æ–‡æœ¬</strong> æ•°æ®ï¼Œå¹¶å‘æ ‡å‡†è¾“å‡ºå†™å…¥ <strong>æ–‡æœ¬</strong> æ•°æ®çš„å‘½ä»¤ã€‚åˆå› ä¸ºUnix çš„ <strong>KISS</strong>
è®¾è®¡ç†å¿µï¼Œæ‰€ä»¥æ¯ä¸ªç¨‹åºéƒ½è¢«è®¾è®¡æˆèƒ½å¤Ÿå‡ºè‰²å®Œæˆä¸€é¡¹ç‰¹å®šä»»åŠ¡çš„å·¥å…·ã€‚åˆå› ä¸ºé‡å®šå‘å’Œ
ç®¡é“çš„å­˜åœ¨ï¼Œä½¿å¾—å¯ä»¥å°†è¿™äº›å·¥å…·ç»„åˆèµ·æ¥ï¼Œå‘æŒ¥æ— ç©·å¨åŠ›</p>
<h2 id="cat"><span class="section-num">2</span> cat</h2>
<p>åœ¨shell é‡Œé¢è¿è¡Œcat,ä½ ä¼šè¢«è¦æ±‚è¾“å…¥æ–‡æœ¬æ•°æ®ï¼Œå½“ä½ è¾“å…¥ä¸€è¡Œæ•°æ®ä»¥åï¼Œç„¶åæŒ‰ä¸‹å›
è½¦ä½ è¾“å…¥çš„æ•°æ®å°±ä¼šæ˜¾ç¤ºåœ¨å±å¹•ï¼Œå½“ä½ æŒ‰ä¸‹ ^D(&lt;ctrl&gt;+d),å‘é€eof ä¿¡å·ç»™shell,é€€å‡º
catã€‚cat åšçš„äº‹å°±æ˜¯æŠŠä½ è¾“å…¥çš„å­—ç¬¦ï¼Œå¤åˆ¶åˆ°æ ‡å‡†è¾“å‡º (ä¸€èˆ¬æƒ…å†µæ˜¯æŒ‡ä½ çš„å±å¹•).çœ‹åˆ°
è¿™é‡Œæœ‰äººæˆ–è®¸ä¼šè´¨ç–‘ï¼Œè¿™ä¸œè¥¿æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿä¼¼ä¹ä»€ä¹ˆéƒ½ä½œä¸äº†ã€‚ä¸ï¼Œå®ƒçš„ç”¨å¤„å¾ˆå¤§å‘¢ï¼Œ
ä¸”å®¹ç¬”è€…ç»†ç»†ç¦€æ¥</p>
<h3 id="åœºæ™¯1"><span class="section-num">2.1</span> åœºæ™¯1</h3>
<p>å‡å¦‚ä½ è¦æ–°å»ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œé‡Œé¢åªæ˜¯å¾ˆå°‘çš„æ–‡æœ¬ï¼Œä½ ä¼šæ€ä¹ˆåšå‘¢ï¼Ÿä¸€èˆ¬æƒ…å†µä¸‹ï¼Œéƒ½æ˜¯ç”¨
vim/emacs æ–°å»ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œç„¶åè¾“å…¥å‡ è¡Œæ–‡å­—ï¼Œç„¶åä¿å­˜é€€å‡ºã€‚è¿™æ˜¯ä¸€èˆ¬çš„åšæ³•ï¼Œ
çœ‹åˆ°è¿™é‡Œï¼Œå¾ˆè‡ªç„¶æœ‰äººä¼šå‘é—®ï¼Œéš¾é“æœ‰æ›´ä¼˜é›…çš„è§£å†³æ–¹æ³•ï¼Ÿæœ‰ï¼Œä¸ç”¨æ‰“å¼€æ–‡æœ¬ç¼–è¾‘å™¨å†™å…¥æ–‡æœ¬
çš„hackingæ–¹æ³•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">cat &gt; data
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å…¥æ•°æ®ï¼Œç„¶å ^D(&lt;ctrl&gt;+d) ä¿å­˜ã€‚ä½ å°±æ–°å»ºäº†ä¸€ä¸ªæ–‡æœ¬äº†ã€‚å½“ç„¶ï¼Œå¦‚æœä½ å·²ç»æœ‰ä¸€ä¸ª <strong>data</strong> æ–‡ä»¶
,å°±ä¼šè¢«ä»£æ›¿ï¼Œå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä¹Ÿåœ¨åŸæ¥æ–‡æœ¬æœ«å°¾æ·»åŠ çš„æ–¹æ³•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">cat &gt;&gt; data
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åœºæ™¯2"><span class="section-num">2.2</span> åœºæ™¯2</h3>
<p>å¦‚æœä½ æœ‰ä¸€ä¸ªçŸ­æ–‡ä»¶ï¼Œä½ æƒ³æŸ¥çœ‹ä¸€ä¸‹ï¼ŒåŒæ ·ï¼Œä½ å¯ä»¥ä½¿ç”¨cat</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">cat &lt; data
</span></span></code></pre></td></tr></table>
</div>
</div><p>å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥çœç•¥ <strong>&lt;</strong> è¿™ä¸ªé‡å®šå‘ç¬¦å·ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">cat data
</span></span></code></pre></td></tr></table>
</div>
</div><p>æŠ‘æˆ–æ˜¯ï¼Œä½ æƒ³æ˜¾ç¤ºæŸä¸ªå¤§æ–‡ä»¶çš„æœ€åä¸€éƒ¨åˆ†ï¼Œä½ ä¹Ÿå¯ä»¥å¦‚ä¸Šæ“ä½œã€‚æˆ–è®¸ä½ ä¼šè§‰å¾—ï¼Œè¿™ä¸ªåŠŸèƒ½
å¾ˆå¤šå‘½ä»¤ä¹Ÿæœ‰ï¼Œæœ€å…¸å‹çš„å°±æ˜¯ <strong>tail</strong>. ä½†æ˜¯å¦‚æœ <strong>cat</strong> å¯ä»¥å¾ˆå®Œç¾åœ°å¾ˆå…¶ä»–è¿‡æ»¤å™¨ç»“åˆ
å……å½“æ•´å¥—ç®¡é“çº¿å·¥å…·æµçš„èµ·å§‹ç«¯ï¼Œè¿™ä¸ªä»¥åæ…¢æ…¢å†é˜è¿°</p>
<h3 id="åœºæ™¯3"><span class="section-num">2.3</span> åœºæ™¯3</h3>
<p>å¦‚æœä½ æƒ³å¤åˆ¶æ–‡æœ¬æ–‡ä»¶ï¼Œä½ é¦–å…ˆä¼šæƒ³èµ·ä»€ä¹ˆå‘½ä»¤ï¼Ÿ <strong>cp</strong>,å¾ˆè‡ªç„¶å˜›ï¼Œæˆ‘ä¹Ÿä¸ä¾‹å¤–ï¼Œä½†æ˜¯cat
ä¹Ÿå¯ä»¥å®ç°åŒæ ·çš„åŠŸèƒ½ï¼Œå¾ˆæ„å¤–å§ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">cat &lt; file &gt; newfile
</span></span></code></pre></td></tr></table>
</div>
</div><p>å³æŠŠ <strong>file</strong> å¤åˆ¶åˆ°æ ‡å‡†è¾“å‡ºï¼Œç„¶åå†æŠŠ <strong>file</strong> å½“ä½œæ ‡å‡†è¾“å…¥å¤åˆ¶åˆ° <strong>newfile</strong>.hacking!</p>
<h3 id="åœºæ™¯4"><span class="section-num">2.4</span> åœºæ™¯4</h3>
<p>å¦‚æœä½ æƒ³æŠŠå¤šä¸ªæ–‡æœ¬æ–‡ä»¶çš„ç»„åˆåˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œä½ ä¼šæ€ä¹ˆåšï¼Ÿç”¨ç¼–è¾‘å™¨æ‰“å¼€æ‰€æœ‰çš„æ–‡ä»¶
ç„¶å select,cut,paste,save.æˆ‘ä¹Ÿä¼šå¾ˆè‡ªç„¶åœ°æƒ³åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯æ˜¯å¦å­˜åœ¨ç€æ›´
ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆå‘¢ï¼Ÿå½“ç„¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">cat file1 file2 file3 &gt;newfile
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="æ€»ç»“"><span class="section-num">3</span> æ€»ç»“</h2>
<p>ä¸Šé¢å·²ç»ä»‹ç»äº†æŒºå¤šcat çš„ä½¿ç”¨åœºæ™¯äº†ï¼Œä½ è§‰å¾—cat è¡¨ç°æ»´æ€ä¹ˆæ ·å‘¢ï¼Ÿç›¸ä¿¡ä½ çš„æ„Ÿè§‰æ˜¯
è¿˜è¡Œï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ï¼Œæˆ‘å¹å˜˜çš„é‚£ä¹ˆä»¤äººæƒŠè‰³ã€‚å› ä¸ºè¿™åªæ˜¯cat æœ€åŸºæœ¬çš„åŠŸèƒ½ï¼Œå®ƒæœ€å¤§çš„
ç”¨æ³•è¿˜æ²¡æœ‰å®Œå…¨å±•ç°å‡ºæ¥ï¼Œç¬”è€…å…ˆä¸¾ä¸€ä¾‹ï¼Œä»¥åå†æ…¢æ…¢è¯¦å™ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">cat file <span class="p">|</span>grep <span class="s2">&#34;something&#34;</span> <span class="p">|</span>sort -n <span class="p">|</span>tee newfile
</span></span></code></pre></td></tr></table>
</div>
</div><table>
<thead>
<tr>
<th>è¯­æ³•</th>
<th>ç”¨æ³•</th>
</tr>
</thead>
<tbody>
<tr>
<td>cat &gt; file</td>
<td>è¯»å–è¾“å…¥ï¼Œåˆ›å»ºæ–°çš„æ–‡ä»¶æˆ–æ›¿æ¢</td>
</tr>
<tr>
<td>cat &gt;&gt;file</td>
<td>è¯»å–è¾“å…¥ï¼Œè¿½åŠ æ–°çš„æ–‡ä»¶</td>
</tr>
<tr>
<td>cat file/cat &lt;file</td>
<td>æ˜¾ç¤ºä¸€ä¸ªå·²æœ‰æ–‡ä»¶</td>
</tr>
<tr>
<td>cat &lt;oldfile&gt; newfile</td>
<td>å¤åˆ¶ä¸€ä¸ªæ–‡ä»¶</td>
</tr>
<tr>
<td>cat file1 file2 file3&gt;file4</td>
<td>ç»„åˆå¤šä¸ªæ–‡ä»¶</td>
</tr>
</tbody>
</table>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
]]></content:encoded>
    </item>
  </channel>
</rss>
