<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Testing on è èæ²¹ä¸å¤©å…‰å¢Ÿ</title>
    <link>https://ramsayleung.github.io/zh/tags/testing/</link>
    <description>Recent content in Testing on è èæ²¹ä¸å¤©å…‰å¢Ÿ</description>
    <image>
      <title>è èæ²¹ä¸å¤©å…‰å¢Ÿ</title>
      <url>https://ramsayleung.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E</url>
      <link>https://ramsayleung.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E</link>
    </image>
    <generator>Hugo -- 0.146.7</generator>
    <language>zh</language>
    <copyright>See this site&amp;rsquo;s source code here, licensed under GPLv3 Â·</copyright>
    <lastBuildDate>Sat, 31 May 2025 17:28:38 -0700</lastBuildDate>
    <atom:link href="https://ramsayleung.github.io/zh/tags/testing/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>æµ‹è¯•æŠ€èƒ½è¿›é˜¶(ä¸‰): Property Based Testing</title>
      <link>https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%B8%89_property_based_testing/</link>
      <pubDate>Mon, 14 Oct 2024 09:37:00 -0700</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%B8%89_property_based_testing/</guid>
      <description>&lt;h2 id=&#34;å‰è¨€&#34;&gt;&lt;span class=&#34;section-num&#34;&gt;1&lt;/span&gt; å‰è¨€&lt;/h2&gt;
&lt;h3 id=&#34;test-caseçš„å±€é™&#34;&gt;&lt;span class=&#34;section-num&#34;&gt;1.1&lt;/span&gt; test caseçš„å±€é™&lt;/h3&gt;
&lt;p&gt;æƒ³è¦æ›´å¥½åœ°ç†è§£ä»€ä¹ˆæ˜¯ Property based testing, å°±æ¥å…ˆçœ‹ä¸‹å·²æœ‰ test case çš„å±€é™ï¼Œå†æ¥è§‚å¯Ÿå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨ä¹‹å‰&lt;a href=&#34;https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%BA%8C_parameterized_tests/&#34;&gt;ã€Šæµ‹è¯•æŠ€èƒ½è¿›é˜¶(äºŒ): Parameterized Testsã€‹&lt;/a&gt;ä¸­è®¡ç®—æŠ˜æ‰£çš„å‡½æ•°ä¸ºä¾‹ï¼š&lt;/p&gt;</description>
      <content:encoded><![CDATA[<h2 id="å‰è¨€"><span class="section-num">1</span> å‰è¨€</h2>
<h3 id="test-caseçš„å±€é™"><span class="section-num">1.1</span> test caseçš„å±€é™</h3>
<p>æƒ³è¦æ›´å¥½åœ°ç†è§£ä»€ä¹ˆæ˜¯ Property based testing, å°±æ¥å…ˆçœ‹ä¸‹å·²æœ‰ test case çš„å±€é™ï¼Œå†æ¥è§‚å¯Ÿå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ã€‚</p>
<p>ç”¨ä¹‹å‰<a href="https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%BA%8C_parameterized_tests/">ã€Šæµ‹è¯•æŠ€èƒ½è¿›é˜¶(äºŒ): Parameterized Testsã€‹</a>ä¸­è®¡ç®—æŠ˜æ‰£çš„å‡½æ•°ä¸ºä¾‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">calculate_discount</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">discount_percentage</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">price</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Price must be greater than zero: </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">discount_percentage</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Discount_percentage must be greater than zero: </span><span class="si">{</span><span class="n">discount_percentage</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">price</span> <span class="o">&gt;</span> <span class="mi">50000</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">price</span> <span class="o">-</span> <span class="p">(</span><span class="n">price</span> <span class="o">*</span> <span class="p">(</span><span class="n">discount_percentage</span> <span class="o">*</span> <span class="mf">1.15</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">price</span> <span class="o">&gt;</span> <span class="mi">100000</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">price</span> <span class="o">-</span> <span class="p">(</span><span class="n">price</span> <span class="o">*</span> <span class="p">(</span><span class="n">discount_percentage</span> <span class="o">*</span> <span class="mf">1.18</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">price</span> <span class="o">-</span> <span class="p">(</span><span class="n">price</span> <span class="o">*</span> <span class="n">discount_percentage</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å³ä½¿æˆ‘ä»¬ä½¿ç”¨äº† Parameterized Test, æŠŠæµ‹è¯•é€»è¾‘å’Œæµ‹è¯•æ•°æ®é›†ä½œäº†åˆ†ç¦»ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸¤ä¸ªç¼ºç‚¹ï¼š</p>
<ol>
<li>æˆ‘ä»¬çš„æµ‹è¯•æ•°æ®é›†è¿˜æ˜¯è¦æ‰‹å·¥æ„é€ ï¼Œå³ä½¿ç°åœ¨ä¸éœ€è¦å†™æ–°çš„ test case, æ‰‹å·¥æ„é€ æ•°æ®é›†è¿˜æ˜¯å¾ˆéº»çƒ¦</li>
<li>ç¬¬äºŒä¸ªé—®é¢˜æ›´ä¸¥é‡ï¼Œå°±æ˜¯æˆ‘ä»¬çš„æ„å»ºçš„æ•°æ®é›†å¯èƒ½ä¸æ˜¯å®Œå¤‡çš„ï¼Œå¦‚æœæ•°æ®é›†æ²¡æœ‰åŠæ³•è¦†ç›–æ‰€æœ‰çš„æ¡ä»¶åˆ†æ”¯ï¼Œé‚£æˆ‘ä»¬ä»ç„¶å¯èƒ½å‘ç°ä¸äº†ä»£ç ä¸­çš„Bug</li>
</ol>
<h2 id="property-based-testing"><span class="section-num">2</span> Property Based Testing</h2>
<p>è€Œ Property Based Testing å°±æ˜¯æƒ³è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®ƒå¸Œæœ›å¯ä»¥ç»“åˆäººè„‘å¯¹ç‰¹å®šé—®é¢˜åŸŸçš„ç†è§£å’Œæœºå™¨çš„è¿ç®—èƒ½åŠ›ï¼Œä½¿ç”¨æ›´å°‘çš„æ—¶é—´æ¥ç”Ÿæˆæ›´ä¼˜çš„æµ‹è¯•case.</p>
<p>Property Based Testing è¿™ä¸ªæ¦‚å¿µæ˜¯ç”± Haskell é¡¹ç›® <a href="https://en.wikipedia.org/wiki/QuickCheck">QuickCheck</a>Â <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>åœ¨1999å¹´å¼•å…¥çš„ï¼Œå®ƒçš„ç†å¿µæ˜¯ï¼Œç¨‹åºå‘˜åº”è¯¥åªå®šä¹‰æŸä¸ªæµ‹è¯•case, å‚æ•°éœ€è¦æ»¡è¶³çš„æ ‡å‡†(specification), ç„¶åç¨‹åºå°±ä¼šè‡ªåŠ¨ç”Ÿæˆå¤§é‡æ»¡è¶³è¿™ä¸ªæ ‡å‡†çš„éšæœºæ•°ï¼Œç”¨è¿™äº›éšæœºæ•°æ¥æµ‹è¯•è¿™ä¸ª test caseã€‚</p>
<p>è€Œå› ä¸ºæµ‹è¯•æ•°æ®æ˜¯éšæœºç”Ÿæˆçš„ï¼Œæ‰€ä»¥ä½ æ„æ–™ä¹‹å†…çš„æ•°æ®ï¼Œæˆ–è€…æ„æ–™ä¹‹å¤–çš„æ•°æ®éƒ½ä¼šè¢«ç”¨æ¥æµ‹è¯•ï¼Œ
æ—¢çœå»äº†è´¹æ—¶è´¹åŠ›æ„é€ ä¸åŒæ•°æ®ä½œæ•°æ®é›†æ¥æµ‹è¯•çš„çƒ¦æ¼ï¼Œåˆèƒ½ä¿è¯æ•°æ®é›†çš„å®Œå¤‡æ€§, ç»å¸¸å¯ä»¥å¸®åŠ©ä½ å‘ç°æ„æƒ³ä¸åˆ°çš„bug.</p>
<p>è¿™å°±æ˜¯å£°æ˜å¼å®šä¹‰çš„ä¸€ç§ï¼Œä½ åªéœ€è¦å£°æ˜ä½ æƒ³å¹²ä»€ä¹ˆ(ç”¨ä»€ä¹ˆæ ·çš„æ•°æ®æµ‹è¯•ä»€ä¹ˆå‡½æ•°)ï¼Œè€Œéå‘½ä»¤å¼å®šä¹‰ï¼ˆä½ éœ€è¦å®šä¹‰ä½ è¦æ€ä¹ˆåšï¼‰.</p>
<p>äººåŠ›åº”è¯¥æ˜¯å¾ˆçè´µï¼Œè€Œæœºå™¨çš„è®¡ç®—èµ„æºå´æ˜¯å¾ˆä¾¿å®œï¼Œåº”è¯¥è®©æœºå™¨ä»£æ›¿äººå»åšç”Ÿæˆæ•°æ®çš„äº‹ã€‚</p>
<p>ä¸¾ä¾‹æ¥è¯´, ä»¥ä¸Šé¢çš„ <code>calculate_discount</code> å‡½æ•°ä¸ºä¾‹ï¼Œå¦‚æœæˆ‘ä»¬å‘Šè¯‰ç¨‹åº, <code>price</code> å’Œ <code>discount_percentage</code> åº”è¯¥æ˜¯æ•´æ•°ï¼ˆspecificationï¼‰, é‚£ä¹ˆ Quickcheck å°±ä¼šç”Ÿæˆå„ç§æ•´æ•°, ä» Integer.Min åˆ° Integer.Max ä¸ç­‰ï¼Œç”¨æ¥æµ‹è¯•æˆ‘ä»¬çš„ç¨‹åº.</p>
<p>å¦‚æœè¿˜æ˜¯è§‰å¾—è¿™ä¸ªæ¦‚å¿µæ¯”è¾ƒæŠ½è±¡ï¼Œå¯ä»¥æ¥çœ‹ä¸‹å…·ä½“çš„ä¾‹å­ï¼š</p>
<h2 id="hypothesis"><span class="section-num">3</span> Hypothesis</h2>
<p>Python Property Based Testingçš„æµ‹è¯•æ¡†æ¶å« <a href="https://hypothesis.works/">Hypothesis </a><sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>(å‡æƒ³)ï¼Œè¿™ä¸ªé¡¹ç›®åå­—ä¹Ÿæ˜¯èµ·å¾—éå¸¸æœ‰æ°´å¹³ï¼Œç»“åˆProperty Based Testingçš„å“²å­¦ï¼Œå¯è°“ä¿¡é›…è¾¾.</p>
<p>å‡è®¾æˆ‘ä»¬ç°åœ¨è¦å®ç°ä¸€ä¸ªç®€å•çš„æ•°æ®å‹ç¼©çš„ç®—æ³•ï¼š <a href="https://en.wikipedia.org/wiki/Run-length_encoding">Run-length Encoding</a>Â <sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>(RLE)ï¼Œé€šå¸¸ç”¨äºå‹ç¼©åŒ…å«è¿ç»­é‡å¤æ•°æ®çš„åºåˆ—, è¿™ç§ç¼–ç æ–¹æ³•ç‰¹åˆ«é€‚ç”¨äºé‚£äº›æœ‰å¤§é‡é‡å¤å­—ç¬¦æˆ–å€¼çš„æ•°æ®.</p>
<p>å®ƒçš„åŸºæœ¬åŸç†æ˜¯ï¼š</p>
<ol>
<li>ç»Ÿè®¡è¿ç»­é‡å¤çš„æ•°æ®å…ƒç´ çš„æ•°é‡ã€‚</li>
<li>ç”¨ä¸€ä¸ªè®¡æ•°å€¼å’Œæ•°æ®å€¼çš„ç»„åˆæ¥æ›¿ä»£è¿™äº›é‡å¤çš„æ•°æ®ã€‚</li>
</ol>
<p>æ¯”å¦‚å­—ç¬¦ä¸²: <code>AABBBCCCC</code>, RLE ç¼–ç å: <code>2A3B4C</code>. <code>2A</code> è¡¨ç¤ºä¸¤ä¸ªè¿ç»­çš„ <code>A</code>, <code>3B</code> è¡¨ç¤ºä¸‰ä¸ªè¿ç»­çš„ <code>B</code>, <code>4C</code> è¡¨ç¤ºå››ä¸ªè¿ç»­çš„ <code>C</code> ã€‚</p>
<p>Pythonå®ç°å¦‚ä¸‹:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="n">input_string</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">prev</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">character</span> <span class="ow">in</span> <span class="n">input_string</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">character</span> <span class="o">!=</span> <span class="n">prev</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">prev</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">entry</span> <span class="o">=</span> <span class="p">(</span><span class="n">prev</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="n">prev</span> <span class="o">=</span> <span class="n">character</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">entry</span> <span class="o">=</span> <span class="p">(</span><span class="n">character</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">lst</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">character</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">q</span> <span class="o">+=</span> <span class="n">character</span> <span class="o">*</span> <span class="n">count</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">q</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æœæˆ‘ä»¬çš„ä»£ç å®ç°æ²¡æœ‰é—®é¢˜çš„è¯ï¼Œå¯¹äºä»»æ„çš„å­—ç¬¦ä¸²ï¼Œç¼–ç åçš„å­—ç¬¦ä¸²ï¼Œè§£ç åçš„ç»“æœåº”è¯¥å’ŒåŸæ¥çš„å­—ç¬¦ä¸²ä¸€è‡´çš„ï¼Œè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬çš„æµ‹è¯•é€»è¾‘:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">hypothesis</span> <span class="kn">import</span> <span class="n">given</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">hypothesis.strategies</span> <span class="kn">import</span> <span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@given</span><span class="p">(</span><span class="n">text</span><span class="p">())</span> <span class="c1"># å…¥å‚çš„æ ‡å‡†æ˜¯ï¼šä»»æ„çš„å­—ç¬¦ä¸²ï¼Œhypothesis æ¡†æ¶å°±ä¼šè‡ªåŠ¨ç”Ÿæˆéšæœºæ•°ï¼Œå¹¶è°ƒç”¨test_decode_inverts_encode</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_decode_inverts_encode</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">decode</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">==</span> <span class="n">s</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨ <code>pytest</code> è¿è¡Œä¸Šé¢çš„ç”¨ä¾‹ï¼Œç»“æœå¦‚ä¸‹:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; pytest property_based_testing.py
</span></span><span class="line"><span class="cl"><span class="o">===================================</span> <span class="nb">test</span> session <span class="nv">starts</span> <span class="o">====================================</span>
</span></span><span class="line"><span class="cl">platform darwin -- Python 3.12.6, pytest-8.3.3, pluggy-1.5.0
</span></span><span class="line"><span class="cl">rootdir: /Users/ramsayleung/code/python/test_technique
</span></span><span class="line"><span class="cl">plugins: hypothesis-6.115.0
</span></span><span class="line"><span class="cl">collected <span class="m">1</span> item
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">property_based_testing.py F                                                          <span class="o">[</span>100%<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">=========================================</span> <span class="nv">FAILURES</span> <span class="o">=========================================</span>
</span></span><span class="line"><span class="cl">________________________________ test_decode_inverts_encode ________________________________
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">@given<span class="o">(</span>text<span class="o">())</span>
</span></span><span class="line"><span class="cl">&gt;   def test_decode_inverts_encode<span class="o">(</span>s<span class="o">)</span>:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">property_based_testing.py:29:
</span></span><span class="line"><span class="cl">_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
</span></span><span class="line"><span class="cl">property_based_testing.py:30: in test_decode_inverts_encode
</span></span><span class="line"><span class="cl">assert decode<span class="o">(</span>encode<span class="o">(</span>s<span class="o">))</span> <span class="o">==</span> s
</span></span><span class="line"><span class="cl">_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">input_string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">def encode<span class="o">(</span>input_string<span class="o">)</span>:
</span></span><span class="line"><span class="cl"><span class="nv">count</span> <span class="o">=</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="nv">prev</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">lst</span> <span class="o">=</span> <span class="o">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> character in input_string:
</span></span><span class="line"><span class="cl">                 <span class="k">if</span> character !<span class="o">=</span> prev:
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> prev:
</span></span><span class="line"><span class="cl">                       <span class="nv">entry</span> <span class="o">=</span> <span class="o">(</span>prev, count<span class="o">)</span>
</span></span><span class="line"><span class="cl">                       lst.append<span class="o">(</span>entry<span class="o">)</span>
</span></span><span class="line"><span class="cl">                       <span class="nv">count</span> <span class="o">=</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">                       <span class="nv">prev</span> <span class="o">=</span> character
</span></span><span class="line"><span class="cl">                       <span class="k">else</span>:
</span></span><span class="line"><span class="cl">                       <span class="nv">count</span> <span class="o">+=</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">                       &gt;       <span class="nv">entry</span> <span class="o">=</span> <span class="o">(</span>character, count<span class="o">)</span>
</span></span><span class="line"><span class="cl">                       E       UnboundLocalError: cannot access <span class="nb">local</span> variable <span class="s1">&#39;character&#39;</span> where it is not associated with a value
</span></span><span class="line"><span class="cl">                       E       Falsifying example: test_decode_inverts_encode<span class="o">(</span>
</span></span><span class="line"><span class="cl">                           E           <span class="nv">s</span><span class="o">=</span><span class="s1">&#39;&#39;</span>,
</span></span><span class="line"><span class="cl">                           E       <span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                       property_based_testing.py:17: <span class="nv">UnboundLocalError</span>
</span></span><span class="line"><span class="cl">                       <span class="o">=================================</span> short <span class="nb">test</span> summary <span class="nv">info</span> <span class="o">==================================</span>
</span></span><span class="line"><span class="cl">                       FAILED property_based_testing.py::test_decode_inverts_encode - UnboundLocalError: cannot access <span class="nb">local</span> variable <span class="s1">&#39;character&#39;</span> where it is not associated ...
</span></span><span class="line"><span class="cl">                       <span class="o">====================================</span> <span class="m">1</span> failed in 0.14s <span class="o">=====================================</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°ï¼Œå½“ <code>input_string =''</code> æ˜¯ç©ºå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œ <code>encode</code> å‡½æ•°æŠ›å‡ºå¼‚å¸¸äº†ï¼Œè¯´ <code>character</code> å˜é‡æœªå®šä¹‰ã€‚åŸæ¥æ˜¯ <code>encode</code> å‡½æ•°æ²¡æœ‰å¯¹ç©ºå­—ç¬¦ä¸²è¿™ä¸ª corner case ä½œå¤„ç†ï¼Œé‚£ä¹ˆå°±åŠ ä¸ªåˆ¤æ–­æ¡ä»¶ï¼Œä¿®å¤ä¸€ä¸‹:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="n">input_string</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">input_string</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">prev</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">character</span> <span class="ow">in</span> <span class="n">input_string</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">character</span> <span class="o">!=</span> <span class="n">prev</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">prev</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">entry</span> <span class="o">=</span> <span class="p">(</span><span class="n">prev</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="n">prev</span> <span class="o">=</span> <span class="n">character</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">entry</span> <span class="o">=</span> <span class="p">(</span><span class="n">character</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">lst</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ—¢ç„¶æˆ‘ä»¬çŸ¥é“ç©ºå­—ç¬¦ä¸²æ˜¯ä¸ªç‰¹æ®Šçš„ case, å› ä¸º hypothesis ç”Ÿæˆçš„éƒ½æ˜¯ä»»æ„çš„éšæœºæ•°ï¼Œä¸ä¸€å®šæ¯æ¬¡éƒ½ä¼šæµ‹åˆ°ç©ºå­—ç¬¦ä¸²ï¼Œé‚£æˆ‘ä»¬å°±è‡ªå·±æŒ‡å®šä¸€ä¸ª case:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">hypothesis</span> <span class="kn">import</span> <span class="n">example</span><span class="p">,</span> <span class="n">given</span><span class="p">,</span> <span class="n">strategies</span> <span class="k">as</span> <span class="n">st</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@given</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nd">@example</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">)</span> <span class="c1"># æ‰‹å·¥æŒ‡å®šç©ºå­—ç¬¦ä¸²è¿™ä¸ª corner case</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_decode_inverts_encode</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">decode</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">==</span> <span class="n">s</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>pytest</code> é‡æ–°è¿è¡Œï¼Œæµ‹è¯•å°±é€šè¿‡äº†ã€‚ä½†æ˜¯ï¼Œå¯¹ <code>hypothesis</code> æ¡†æ¶è¿˜æ²¡æœ‰å»ºç«‹ä¿¡å¿ƒçš„ä½ æˆ‘å°±ä¸ç¡®å®šï¼Œå®ƒæ˜¯å¦çœŸçš„ç”Ÿæˆå¾ˆå¤šéšæœºæ¥è¿è¡Œè¿™ä¸ª test case å‘¢ï¼Ÿ</p>
<p>æœ‰ä¸¤ä¸ªæ–¹æ³•å¯ä»¥éªŒè¯ï¼š</p>
<p>æ–¹æ³•ä¸€ï¼šæœ€ç®€å•ç²—æš´çš„æ–¹å¼ï¼ŒæŠŠ <code>s</code> å˜é‡ç»™æ‰“å°å‡ºæ¥ï¼Œæ¯•ç«Ÿçœ¼è§ä¸ºå®:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@given</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nd">@example</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_decode_inverts_encode</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">decode</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">==</span> <span class="n">s</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åé€šè¿‡ <code>pytest -s</code> å‚æ•°è¦æ±‚ <code>pytest</code> å°†å†™å…¥åˆ° <code>stdout</code> çš„å†…å®¹ç»™æ‰“å°å‡ºæ¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; pytest property_based_testing.py -s
</span></span><span class="line"><span class="cl"><span class="o">=======================================</span> <span class="nb">test</span> session <span class="nv">starts</span> <span class="o">=======================================</span>
</span></span><span class="line"><span class="cl">platform darwin -- Python 3.12.6, pytest-8.3.3, pluggy-1.5.0
</span></span><span class="line"><span class="cl">rootdir: /Users/ramsayleung/code/python/test_technique
</span></span><span class="line"><span class="cl">plugins: hypothesis-6.115.0
</span></span><span class="line"><span class="cl">collected <span class="m">1</span> item
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">property_based_testing.py
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">O
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Â¶
</span></span><span class="line"><span class="cl"><span class="se">\Ã¥</span>ñ¢„Â«
</span></span><span class="line"><span class="cl">ğ¥›—ÃbÃ³
</span></span><span class="line"><span class="cl">ğœ†®Ã¥
</span></span><span class="line"><span class="cl">ñ°˜°9
</span></span><span class="line"><span class="cl">gahó­¾”ğ›§
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">iò¼¯œ+Ã³Â»ò®©¸bñ•¨
</span></span><span class="line"><span class="cl">S!Ã•TÃ¥<span class="p">&amp;</span>ğ°µ©Ã­Â¤Ã½Ã¤Ã³Ã·F
</span></span><span class="line"><span class="cl">Ã¸Ã´yÂµ
</span></span><span class="line"><span class="cl">Ã„Âª
</span></span><span class="line"><span class="cl">sLz$Ã¯
</span></span><span class="line"><span class="cl">_ğ µˆ
</span></span><span class="line"><span class="cl">Ãœ
</span></span><span class="line"><span class="cl">A
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Róƒ·<span class="o">{</span>Â©Â¾
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Ã¬Ãµ
</span></span><span class="line"><span class="cl">   Ã¦ô‚›BÃ1*ô…„¢Ã«Ã³gğ®ˆÂ¼ ?ğ©“
</span></span><span class="line"><span class="cl">   Ã’Ã¶r @PPô¾‚Ã¶ñ³±ŠÃ»ÃÂ½Â¬HÃˆ6#
</span></span><span class="line"><span class="cl">   ağ£½—Â¶ó¿…Œğ§‘x~ó—œ¬éŸ¹Ã»Ã°ó´¯®#Zó…–«<span class="se">\Â©</span>ğ³–…Ã»f&gt;
</span></span><span class="line"><span class="cl">   i
</span></span><span class="line"><span class="cl">   ....
</span></span><span class="line"><span class="cl">   <span class="o">========================================</span> <span class="m">1</span> passed in 0.15s <span class="o">========================================</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸€å †éƒ½æ˜¯ä»€ä¹ˆå­—ç¬¦å‘¢, éƒ½ä¹±ç äº†ã€‚</p>
<p>æ¯•ç«Ÿæˆ‘ä»¬å‘Šè¯‰ <code>hypothesis</code> æ¡†æ¶çš„æ˜¯ï¼Œæˆ‘ä»¬å‚æ•°æ¥å—çš„æ ‡å‡†æ˜¯ä»»æ„çš„å­—ç¬¦ä¸²ï¼Œ <code>hypothesis</code> å°±éå¸¸å°½èŒåœ°å¸®æˆ‘ä»¬ç”Ÿæˆäº†å„ç§å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªæµ‹è¯•æ•°æ®é›†å¯æ¯”æˆ‘ä»¬è‡ªå·±æ‰‹å·¥æ„å»ºçš„èŒƒå›´å¤§å¾—å¤šï¼Œè¿™å°±æ˜¯ property based testing çš„ä¼˜åŠ¿æ‰€åœ¨.</p>
<p>ç¬¬äºŒç§æ–¹æ³•æ˜¯ä½¿ç”¨ <code>hypothesis</code> æ¡†æ¶æä¾›çš„å‘½ä»¤è¡Œå‚æ•° =&ndash;hypothesis-show-statistics=ï¼Œç”¨äºæ‰“å°ç»Ÿè®¡ä¿¡æ¯:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; pytest property_based_testing.py --hypothesis-show-statistics
</span></span><span class="line"><span class="cl"><span class="o">=======================================</span> <span class="nb">test</span> session <span class="nv">starts</span> <span class="o">=======================================</span>
</span></span><span class="line"><span class="cl">platform darwin -- Python 3.12.6, pytest-8.3.3, pluggy-1.5.0
</span></span><span class="line"><span class="cl">rootdir: /Users/ramsayleung/code/python/test_technique
</span></span><span class="line"><span class="cl">plugins: hypothesis-6.115.0
</span></span><span class="line"><span class="cl">collected <span class="m">1</span> item
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">property_based_testing.py .                                                                 <span class="o">[</span>100%<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">======================================</span> Hypothesis <span class="nv">Statistics</span> <span class="o">======================================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">property_based_testing.py::test_decode_inverts_encode:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">- during generate phase <span class="o">(</span>0.03 seconds<span class="o">)</span>:
</span></span><span class="line"><span class="cl">- Typical runtimes: &lt; 1ms, of which &lt; 1ms in data generation
</span></span><span class="line"><span class="cl">- <span class="m">100</span> passing examples, <span class="m">0</span> failing examples, <span class="m">0</span> invalid examples
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">- Stopped because settings.max_examples<span class="o">=</span><span class="nv">100</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">========================================</span> <span class="m">1</span> passed in 0.05s <span class="o">========================================</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šé¢è¿è¡Œäº† 100 æ¡æ•°æ®ï¼Œå¦‚æœä½ è§‰å¾—è¿˜æƒ³è·‘æ›´å¤šï¼Œå¯ä»¥é€šè¿‡ <code>settings</code> è£…é¥°å™¨æŒ‡å®šæ›´å¤š:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@settings</span><span class="p">(</span><span class="n">max_examples</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="quickcheck-and-proptest"><span class="section-num">4</span> Quickcheck &amp; Proptest</h2>
<p>è€Œåœ¨Rustç”Ÿæ€ï¼Œå°±æœ‰ä¸¤ä¸ª Property Based Testing çš„åº“ï¼Œä¸€ä¸ªæ˜¯ç”±Rustç¤¾åŒºçŸ¥åå¼€å‘è€…ï¼Œ<a href="https://github.com/BurntSushi/ripgrep">ripgrep</a>Â <sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>å’Œ regex åº“ä½œè€…ç§»æ¤è‡ª Haskell Quickcheck åº“çš„ <a href="https://github.com/BurntSushi/quickcheck">quickcheck</a>Â <sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup>(åå­—ä¹Ÿä¸€å¹¶ç§»æ¤äº†), å¦å¤–ä¸€ä¸ªæ˜¯æ€è·¯ç»§æ‰¿è‡ª Python Hypothesis çš„ <a href="https://github.com/proptest-rs/proptest">Proptest</a>Â <sup id="fnref:6"><a href="#fn:6" class="footnote-ref" role="doc-noteref">6</a></sup>(è¿™ä½ç›´æ¥ç”¨property based testingæŠ€æœ¯æ¥å‘½åäº†ï¼Œä¸å¾—ä¸è¯´ï¼Œå‘½åçœŸçš„æ˜¯é—¨è‰ºæœ¯)</p>
<p>ä¸¤è€…çš„ç¤¾åŒºæ¥å—åº¦éƒ½ç›¸å·®æ— å‡ (star, ä½¿ç”¨è€…æ•°é‡), è€Œåœ¨å…¬å¸å†…éƒ¨ï¼Œæˆ‘ä¹Ÿå‘ç° quickcheck å’Œ proptest éƒ½æœ‰äººç”¨ï¼Œåæˆ‘æ—è¾¹çš„Principle Engineer ç”¨çš„æ˜¯ proptest, è€Œå¦å¤–ä¸€ä¸ªç°åœ¨å’Œæˆ‘å…±äº‹çš„åŒäº‹ï¼Œå¥¹çš„ä¹‹å‰å›¢é˜Ÿç”¨çš„å°±æ˜¯ quickcheckï¼Œçœ‹åˆ°éƒ½åŠ¿å‡åŠ›æ•Œå˜›ã€‚</p>
<p>ç¿»å¼€ quickcheck å’Œ proptest çš„API æ–‡æ¡£ä¹‹åï¼Œæˆ‘å‘ç°æˆ‘æ›´å–œæ¬¢ quickcheck çš„æ¥å£é£æ ¼ï¼Œè™½è¯´å®ƒçš„æ´»è·ƒåº¦æ›´ä½ä¸€äº›ï¼Œæˆ‘æœ€åè¿˜æ˜¯é€‰æ‹©äº†ä½¿ç”¨ quickcheck.</p>
<p>ä¸‹é¢å°±æ¥ä»‹ç»ä¸€ä¸‹æˆ‘åœ¨Rustä¸Šä½¿ç”¨ quickcheck çš„å¿ƒå¾—:</p>
<p>å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªå¯ä»¥åè½¬åˆ—è¡¨çš„å‡½æ•° <code>reverse</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">reverse</span><span class="o">&lt;</span><span class="n">T</span>: <span class="nb">Clone</span><span class="o">&gt;</span><span class="p">(</span><span class="n">xs</span>: <span class="kp">&amp;</span><span class="p">[</span><span class="n">T</span><span class="p">])</span><span class="w"> </span>-&gt; <span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="fm">vec!</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">rev</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">clone</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">rev</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¯¹äºä»»æ„ç±»å‹çš„åˆ—è¡¨ï¼Œåè½¬ä¹‹åå†åè½¬çš„ç»“æœï¼Œè‚¯å®šæ˜¯å’ŒåŸç»“æœä¸€æ ·çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å£°æ˜æˆ‘ä»¬çš„æ ‡å‡†(specification), é‚£å°±æ˜¯ä»»æ„çš„åˆ—è¡¨ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œæ•´å‹åˆ—è¡¨æˆ–è€…æ˜¯å…¶ä»–çš„ç»“æ„ä½“åˆ—è¡¨:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="cp">#[cfg(test)]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">mod</span> <span class="nn">tests</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="n">quickcheck_macros</span>::<span class="n">quickcheck</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="k">crate</span>::<span class="n">reverse</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cp">#[quickcheck]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">double_reversal_is_identity_isize</span><span class="p">(</span><span class="n">xs</span>: <span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">isize</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">xs</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="o">&amp;</span><span class="n">reverse</span><span class="p">(</span><span class="o">&amp;</span><span class="n">xs</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cp">#[quickcheck]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">double_reversal_is_identity_string</span><span class="p">(</span><span class="n">xs</span>: <span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">xs</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="o">&amp;</span><span class="n">reverse</span><span class="p">(</span><span class="o">&amp;</span><span class="n">xs</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Rust çš„unit test æ˜¯ä¸æ”¯æŒå¸¦å‚æ•°çš„ï¼Œ=#[quickcheck]= è¿™ä¸ªå®å°±ä¼šè‡ªåŠ¨å°† <code>double_reversal_is_identity_isize</code> è½¬æ¢æˆ property based test case, è€Œå¾—ç›ŠäºRustçš„ç±»å‹ç³»ç»Ÿ, <code>quickcheck</code> å°±èƒ½æ¨æ–­å‡ºå…¥å‚å°±æ˜¯æˆ‘ä»¬å£°æ˜çš„æ ‡å‡† <code>Vec&lt;isze&gt;</code>, ä»»æ„ <code>isize</code> ç±»å‹çš„æ•°ç»„.</p>
<h3 id="struct-with-quickcheck"><span class="section-num">4.1</span> Struct with quickcheck</h3>
<p>å¦‚æœä¸Šé¢çš„ä¾‹å­è§‰å¾—è¿‡äºç®€å•çš„è¯ï¼Œç°åœ¨å°±è®©æˆ‘ä»¬çœ‹ä¸ªå¤æ‚ä¸€ç‚¹çš„ä¾‹å­, ä¸€ä¸ªç®€å•çš„å›¾ä¹¦ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒä¼šå‘˜ï¼Œå€Ÿä¹¦ï¼Œè¿˜ä¹¦åŠŸèƒ½ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">chrono</span>::<span class="p">{</span><span class="n">Duration</span><span class="p">,</span><span class="w"> </span><span class="n">NaiveDate</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">collections</span>::<span class="n">HashMap</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cp">#[derive(Debug, Clone, PartialEq)]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">struct</span> <span class="nc">Book</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">isbn</span>: <span class="nb">String</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">title</span>: <span class="nb">String</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">author</span>: <span class="nb">String</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">publication_year</span>: <span class="kt">u16</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cp">#[derive(Debug, Clone, PartialEq)]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">struct</span> <span class="nc">Member</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span>: <span class="kt">u32</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span>: <span class="nb">String</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">email</span>: <span class="nb">String</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cp">#[derive(Debug, Clone)]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">struct</span> <span class="nc">Loan</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">book_isbn</span>: <span class="nb">String</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">member_id</span>: <span class="kt">u32</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">due_date</span>: <span class="nc">NaiveDate</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cp">#[derive(Debug, Clone)]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">struct</span> <span class="nc">Library</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">books</span>: <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="n">Book</span><span class="o">&gt;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">members</span>: <span class="nc">HashMap</span><span class="o">&lt;</span><span class="kt">u32</span><span class="p">,</span><span class="w"> </span><span class="n">Member</span><span class="o">&gt;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">loans</span>: <span class="nb">Vec</span><span class="o">&lt;</span><span class="n">Loan</span><span class="o">&gt;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">current_date</span>: <span class="nc">NaiveDate</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">Library</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">new</span><span class="p">(</span><span class="n">current_date</span>: <span class="nc">NaiveDate</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">Self</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Library</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">books</span>: <span class="nc">HashMap</span>::<span class="n">new</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">members</span>: <span class="nc">HashMap</span>::<span class="n">new</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">loans</span>: <span class="nb">Vec</span>::<span class="n">new</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">current_date</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">add_book</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">book</span>: <span class="nc">Book</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span><span class="p">(),</span><span class="w"> </span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">books</span><span class="p">.</span><span class="n">contains_key</span><span class="p">(</span><span class="o">&amp;</span><span class="n">book</span><span class="p">.</span><span class="n">isbn</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nb">Err</span><span class="p">(</span><span class="s">&#34;Book with this ISBN already exists&#34;</span><span class="p">.</span><span class="n">to_string</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="bp">self</span><span class="p">.</span><span class="n">books</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">book</span><span class="p">.</span><span class="n">isbn</span><span class="p">.</span><span class="n">clone</span><span class="p">(),</span><span class="w"> </span><span class="n">book</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nb">Ok</span><span class="p">(())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">add_member</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">member</span>: <span class="nc">Member</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span><span class="p">(),</span><span class="w"> </span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">members</span><span class="p">.</span><span class="n">contains_key</span><span class="p">(</span><span class="o">&amp;</span><span class="n">member</span><span class="p">.</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nb">Err</span><span class="p">(</span><span class="s">&#34;Member with this ID already exists&#34;</span><span class="p">.</span><span class="n">to_string</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="bp">self</span><span class="p">.</span><span class="n">members</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">member</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">member</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nb">Ok</span><span class="p">(())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">loan_book</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">book_isbn</span>: <span class="kp">&amp;</span><span class="kt">str</span><span class="p">,</span><span class="w"> </span><span class="n">member_id</span>: <span class="kt">u32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span><span class="p">(),</span><span class="w"> </span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="bp">self</span><span class="p">.</span><span class="n">books</span><span class="p">.</span><span class="n">contains_key</span><span class="p">(</span><span class="n">book_isbn</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nb">Err</span><span class="p">(</span><span class="s">&#34;Book not found&#34;</span><span class="p">.</span><span class="n">to_string</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="bp">self</span><span class="p">.</span><span class="n">members</span><span class="p">.</span><span class="n">contains_key</span><span class="p">(</span><span class="o">&amp;</span><span class="n">member_id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nb">Err</span><span class="p">(</span><span class="s">&#34;Member not found&#34;</span><span class="p">.</span><span class="n">to_string</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">loans</span><span class="p">.</span><span class="n">iter</span><span class="p">().</span><span class="n">any</span><span class="p">(</span><span class="o">|</span><span class="n">loan</span><span class="o">|</span><span class="w"> </span><span class="n">loan</span><span class="p">.</span><span class="n">book_isbn</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">book_isbn</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nb">Err</span><span class="p">(</span><span class="s">&#34;Book is already on loan&#34;</span><span class="p">.</span><span class="n">to_string</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">due_date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">current_date</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Duration</span>::<span class="n">days</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">loans</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">Loan</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">book_isbn</span>: <span class="nc">book_isbn</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">member_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">due_date</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nb">Ok</span><span class="p">(())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">return_book</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">book_isbn</span>: <span class="kp">&amp;</span><span class="kt">str</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span><span class="p">(),</span><span class="w"> </span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="n">loans</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="n">iter</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="n">position</span><span class="p">(</span><span class="o">|</span><span class="n">loan</span><span class="o">|</span><span class="w"> </span><span class="n">loan</span><span class="p">.</span><span class="n">book_isbn</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">book_isbn</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="bp">self</span><span class="p">.</span><span class="n">loans</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">index</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nb">Ok</span><span class="p">(())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nb">Err</span><span class="p">(</span><span class="s">&#34;Book is not currently on loan&#34;</span><span class="p">.</span><span class="n">to_string</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>é€šè¿‡ä¸Šé¢çš„ç®€å•ä»£ç ï¼Œå°±å®ç°äº†æ–°å¢å›¾ä¹¦ï¼Œæ–°å¢ä¼šå‘˜ï¼Œå€Ÿä¹¦ï¼Œå’Œè¿˜ä¹¦åŠŸèƒ½ã€‚ç°åœ¨å°±è®©æˆ‘ä»¬æ¥ç»“åˆ <code>quickcheck</code> çš„ <code>Arbitrary</code> æ¥å£ï¼Œå®ç°ç”Ÿæˆä»»æ„çš„å›¾ä¹¦å’Œä¼šå‘˜ï¼Œä»¥ä¾¿ç”¨äºæµ‹è¯•:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">quickcheck</span>::<span class="p">{</span><span class="n">Arbitrary</span><span class="p">,</span><span class="w"> </span><span class="n">Gen</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">Arbitrary</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Book</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">arbitrary</span><span class="p">(</span><span class="n">g</span>: <span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">Gen</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">Self</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Book</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// isbnå¿…é¡»ä»¥`ISBN` å¼€å¤´ï¼Œåæ¥ä»»æ„çš„å¤§äºç­‰äº0ï¼Œå°äºuint32.max_value
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="c1">// çš„æ•´å‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="n">isbn</span>: <span class="nc">format</span><span class="o">!</span><span class="p">(</span><span class="s">&#34;ISBN-{}&#34;</span><span class="p">,</span><span class="w"> </span><span class="kt">u32</span>::<span class="n">arbitrary</span><span class="p">(</span><span class="n">g</span><span class="p">)),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">title</span>: <span class="nb">String</span>::<span class="n">arbitrary</span><span class="p">(</span><span class="n">g</span><span class="p">),</span><span class="w"> </span><span class="c1">// ä»»æ„çš„å­—ç¬¦ä¸²
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="n">author</span>: <span class="nb">String</span>::<span class="n">arbitrary</span><span class="p">(</span><span class="n">g</span><span class="p">),</span><span class="w"> </span><span class="c1">// ä»»æ„çš„å­—ç¬¦ä¸²
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="n">publication_year</span>: <span class="o">*</span><span class="n">g</span><span class="p">.</span><span class="n">choose</span><span class="p">(</span><span class="o">&amp;</span><span class="p">[</span><span class="mi">2014_</span><span class="k">u16</span><span class="p">,</span><span class="w"> </span><span class="mi">2022_</span><span class="k">u16</span><span class="p">,</span><span class="w"> </span><span class="mi">2025_</span><span class="k">u16</span><span class="p">]).</span><span class="n">unwrap</span><span class="p">(),</span><span class="w"> </span><span class="c1">// 2014,2022æˆ–2025å¹´å‡ºç‰ˆçš„ä¹¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">Arbitrary</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Member</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">arbitrary</span><span class="p">(</span><span class="n">g</span>: <span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">Gen</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">Self</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Member</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">id</span>: <span class="kt">u32</span>::<span class="n">arbitrary</span><span class="p">(</span><span class="n">g</span><span class="p">),</span><span class="w"> </span><span class="c1">// ä»»æ„å¤§äº0ï¼Œå°äºuint32.max_valueçš„æ•´å‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="n">name</span>: <span class="nb">String</span>::<span class="n">arbitrary</span><span class="p">(</span><span class="n">g</span><span class="p">),</span><span class="w"> </span><span class="c1">// ä»»æ„å­—ç¬¦ä¸²
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="c1">// ä»»æ„å­—ç¬¦å¼€å¤´, ä»¥@example.com ç»“å°¾çš„å­—ç¬¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="n">email</span>: <span class="nc">format</span><span class="o">!</span><span class="p">(</span><span class="s">&#34;{}@example.com&#34;</span><span class="p">,</span><span class="w"> </span><span class="nb">String</span>::<span class="n">arbitrary</span><span class="p">(</span><span class="n">g</span><span class="p">)),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ç°åœ¨å°±è®©æˆ‘ä»¬æ¥çœ‹ä¸‹å€ŸåŠ© quickcheck ç¼–å†™çš„ test case, æ³¨æ„å‚æ•°ä¸º <code>Book</code> å’Œ <code>Member</code> ç±»å‹çš„ case, quickcheck å°±ä¼šä»¥æˆ‘ä»¬ä¸Šé¢å®šä¹‰çš„æ ‡å‡†ï¼Œè‡ªåŠ¨ç»™æˆ‘ä»¬ç”Ÿæˆç¬¦åˆè§„å®šçš„ <code>Book</code> å’Œ <code>Member</code> å‚æ•°.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="cp">#[cfg(test)]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">mod</span> <span class="nn">tests</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="n">chrono</span>::<span class="n">NaiveDate</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="n">quickcheck_macros</span>::<span class="n">quickcheck</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="k">crate</span>::<span class="n">book</span>::<span class="n">Member</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="k">super</span>::<span class="p">{</span><span class="n">Book</span><span class="p">,</span><span class="w"> </span><span class="n">Library</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cp">#[quickcheck]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">adding_book_increases_book_count</span><span class="p">(</span><span class="n">book</span>: <span class="nc">Book</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Library</span>::<span class="n">new</span><span class="p">(</span><span class="n">NaiveDate</span>::<span class="n">from_ymd_opt</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">).</span><span class="n">unwrap</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">initial_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">library</span><span class="p">.</span><span class="n">books</span><span class="p">.</span><span class="n">len</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">library</span><span class="p">.</span><span class="n">add_book</span><span class="p">(</span><span class="n">book</span><span class="p">.</span><span class="n">clone</span><span class="p">()).</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">library</span><span class="p">.</span><span class="n">books</span><span class="p">.</span><span class="n">len</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">initial_count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">library</span><span class="p">.</span><span class="n">books</span><span class="p">.</span><span class="n">contains_key</span><span class="p">(</span><span class="o">&amp;</span><span class="n">book</span><span class="p">.</span><span class="n">isbn</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cp">#[quickcheck]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">cannot_loan_nonexistent_book</span><span class="p">(</span><span class="n">book_isbn</span>: <span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="n">member_id</span>: <span class="kt">u32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Library</span>::<span class="n">new</span><span class="p">(</span><span class="n">NaiveDate</span>::<span class="n">from_ymd_opt</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">).</span><span class="n">unwrap</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">library</span><span class="p">.</span><span class="n">loan_book</span><span class="p">(</span><span class="o">&amp;</span><span class="n">book_isbn</span><span class="p">,</span><span class="w"> </span><span class="n">member_id</span><span class="p">).</span><span class="n">is_err</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cp">#[quickcheck]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">can_return_loaned_book</span><span class="p">(</span><span class="n">book</span>: <span class="nc">Book</span><span class="p">,</span><span class="w"> </span><span class="n">member</span>: <span class="nc">Member</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Library</span>::<span class="n">new</span><span class="p">(</span><span class="n">NaiveDate</span>::<span class="n">from_ymd_opt</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">).</span><span class="n">unwrap</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">library</span><span class="p">.</span><span class="n">add_book</span><span class="p">(</span><span class="n">book</span><span class="p">.</span><span class="n">clone</span><span class="p">()).</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">library</span><span class="p">.</span><span class="n">add_member</span><span class="p">(</span><span class="n">member</span><span class="p">.</span><span class="n">clone</span><span class="p">()).</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">library</span><span class="p">.</span><span class="n">loan_book</span><span class="p">(</span><span class="o">&amp;</span><span class="n">book</span><span class="p">.</span><span class="n">isbn</span><span class="p">,</span><span class="w"> </span><span class="n">member</span><span class="p">.</span><span class="n">id</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">library</span><span class="p">.</span><span class="n">return_book</span><span class="p">(</span><span class="o">&amp;</span><span class="n">book</span><span class="p">.</span><span class="n">isbn</span><span class="p">).</span><span class="n">is_ok</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>é€šè¿‡ <code>quickcheck</code> æˆ‘ä»¬å°±å¯ä»¥åªä¸“æ³¨æµ‹è¯•é€»è¾‘ï¼Œå¯ä»¥å‡å®šæµ‹è¯•æ•°æ®é›†æ˜¯å®Œå¤‡çš„äº†ã€‚å¯èƒ½çœ‹åˆ° <code>Book</code> å’Œ <code>Member</code>, ä½ ä¼šè§‰å¾— quickcheck å¹¶æ²¡æœ‰åšå¤ªå¤šäº‹æƒ…ï¼Œä½ æ‰‹å·¥ä¹Ÿå¯ä»¥æ„é€ ã€‚</p>
<p>ä½†æ˜¯æˆ‘åœ¨çš„å®é™…å·¥ä½œä¸­ï¼Œæˆ‘å°±éœ€è¦æ„é€ ä¸€ä¸ªè¶…è¿‡23ä¸ªæˆå‘˜å˜é‡çš„ struct, å¤§éƒ¨åˆ†è¿˜æ˜¯ optional, ç„¶åéœ€è¦å°†è¿™ä¸ª struct å†™å…¥åˆ° parquet æ–‡ä»¶ï¼Œç„¶åå†æµ‹è¯•è¯»å–é€»è¾‘ã€‚
ä¸åŒæˆå‘˜å˜é‡çš„å€¼å¯å–çš„èŒƒå›´å®åœ¨å¤ªå¤šäº†ï¼Œå†å åŠ ä¸Š optional çš„å¯èƒ½æ€§ï¼Œæ„é€ æ•°æ®çš„ä»£ç å†™å¾—ç›¸å½“æ¶å¿ƒ.</p>
<p>æ‰€ä»¥æœ‰äº† quickcheck ä¹‹åï¼Œæˆ‘åªéœ€è¦ä¸ºè¿™ä¸ª struct å®ç° <code>Arbitrary</code> æ¥å£ï¼Œå‰©ä¸‹çš„å°±ç”± <code>quickcheck</code> æ›¿æˆ‘ç”Ÿæˆï¼Œæ‰€ä»¥æˆ‘ç›´æ¥å’ŒPEå¤§ä½¬è¯´:</p>
<blockquote>
<p>property test saves me life, now I couldn&rsquo;t live without it.</p></blockquote>
<h2 id="æ€»ç»“"><span class="section-num">5</span> æ€»ç»“</h2>
<p>æœ¬æ¥æƒ³æŠ’å‘æ„Ÿæƒ³å†™ç‚¹ç»“è¯­ï¼Œä½†æ˜¯çœ‹åˆ° Hypothesis ä½œè€…å†™çš„ <a href="https://hypothesis.readthedocs.io/en/latest/manifesto.html">The purpose of Hypothesis</a><sup id="fnref:7"><a href="#fn:7" class="footnote-ref" role="doc-noteref">7</a></sup> æ¥è¯´æ˜ä»–å¼€å‘çš„ Hypothesis çš„åŠ¨æœºï¼Œä»–çš„æ–‡ç« ç”šè‡³ç”¨æ¥ç»™è¿™ä¸ªã€Šæµ‹è¯•æŠ€èƒ½è¿›é˜¶ã€‹ç³»åˆ—æ€»ç»“éƒ½ç›¸å½“å¦¥å½“ã€‚</p>
<p>æˆ‘å°±è¯•ç¿»è¯‘ä¸‹ä»–æ–‡ç« çš„éƒ¨åˆ†æ®µè½, æ›´æ¨èé˜…è¯»åŸæ–‡ï¼Œå¯è°“æ˜¯ç”¨å¿ƒè‰¯è‹¦ï¼Œå­—å­—ç ç‘:</p>
<blockquote>
<p>è¯·å®¹æˆ‘ç‹‚å¦„ä¸€ä¸‹ï¼ŒHypothesis çš„ç›®æ ‡æ˜¯å¸Œæœ›å¯ä»¥è®©è¿™ä¸ªä¸–ç•Œè¿ˆè¿›åˆ°ä¸€ä¸ªå…¨æ–°ï¼Œç”±é«˜è´¨é‡è½¯ä»¶æ‰“é€ çš„æ–°ä¸–ä»£ã€‚</p>
<p>æ­£å¦‚äººä»¬æ‰€è¯´ï¼Œè½¯ä»¶æ­£åœ¨åå™¬æ•´ä¸ªä¸–ç•Œã€‚ä½†è½¯ä»¶æœ¬èº«å´å¾ˆçƒ‚ï¼Œå®ƒå……æ»¡bugï¼Œåˆä¸å®‰å…¨ï¼Œè¿˜ç»å¸¸è¢«è®¾è®¡å¾—å¾ˆçƒ‚ï¼Œè¿™æ ·çš„è½¯ä»¶å¯è°“æ˜¯ä¸‡æ¶ä¹‹æº.</p>
<p>è€Œè½¯ä»¶æµ‹è¯•çš„çŠ¶å†µç”šè‡³æ›´ç³Ÿç³•ï¼Œè™½ç„¶å¤§å®¶éƒ½è®¤åŒåº”è¯¥å¯¹ä»£ç è¿›è¡Œæµ‹è¯•ï¼Œä½†æ˜¯ä½ èƒ½é—®å¿ƒæ— æ„§åœ°è¯´ï¼Œä½ ç»æ‰‹è¿‡çš„ä»£ç éƒ½æœ‰è¢«å……åˆ†æµ‹è¯•ä¹ˆï¼Ÿ</p>
<p>é—®é¢˜åœ¨äºï¼Œå®åœ¨æ˜¯å¤ªéš¾å†™å‡ºå¥½çš„æµ‹è¯•äº†ï¼Œ
<strong><strong>ä½ å†™æµ‹è¯•ç”¨ä¾‹çš„æ—¶å€™ï¼Œé€šå¸¸æŒæœ‰å’Œä½ å†™ä»£ç æ—¶ä¸€æ ·çš„å‡è®¾ä¸è¯¯åŒºï¼Œä½ å†™çš„æµ‹è¯•ç”¨ä¾‹è‡ªç„¶æ— æ³•å‘ç°ä½ å½“åˆåŸ‹ä¸‹çš„bug</strong></strong> (ç²¾è¾Ÿ)</p>
<p>ä¸æ­¤åŒæ—¶ï¼Œæœ‰å„ç§å„æ ·è®©æµ‹è¯•å˜æˆæ›´å¥½çš„å·¥å…·å´åŸºæœ¬æ— äººä½¿ç”¨ï¼Œæœ€åˆçš„ Quickcheck æ˜¯1999å¹´æ¨å‡ºçš„ï¼Œä½†æ˜¯å¤§å¤šæ•°å¼€å‘è€…ç”šè‡³ä»æœªå¬è¯´è¿‡å®ƒï¼Œæ›´åˆ«æä½¿ç”¨äº†ï¼ˆå¼€å±±å§‹ç¥–çš„Quickcheckåœ¨GitHubåªæœ‰700å¤šä¸ªStarï¼Œå°±çŸ¥é“ä½œè€…æ‰€è¨€ä¸è™šï¼‰ã€‚
è™½ç„¶å…¶ä»–è¯­è¨€æœ‰äº›åŠæˆå“çš„å®ç°ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†éƒ½ä¸å€¼å¾—ä¸€è¯•ã€‚</p>
<p>è€Œ Hypothesis çš„ç›®æ ‡æ­£æ˜¯æ­£æœ¬æ¸…æºï¼ŒæŠŠå…ˆè¿›çš„æµ‹è¯•æŠ€æœ¯ä¼ é€’ç»™å¤§ä¼—ï¼Œå¹¶æä¾›ä¸€ä¸ªé«˜è´¨é‡çš„å®ç°ï¼Œè®©äººä»¬å¯ä»¥æ¥çº³å®ƒã€‚</p>
<p>å¸Œæœ›å¯ä»¥é›†ç™¾å®¶ä¹‹æ‰€é•¿ï¼Œé™„ä»¥ä¸ªäººå¾®è–„ä¹‹åŠ›ï¼Œè®©è½¯ä»¶æµ‹è¯•å˜å¾—æ›´å¥½ã€‚</p></blockquote>
<p>ç³»åˆ—æ–‡ç« :</p>
<ul>
<li><a href="https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%B8%80_%E8%BD%AF%E4%BB%B6%E8%B4%A8%E9%87%8F%E8%AE%A4%E7%9F%A5/">æµ‹è¯•æŠ€èƒ½è¿›é˜¶(ä¸€): è½¯ä»¶è´¨é‡è®¤çŸ¥</a></li>
<li><a href="https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%BA%8C_parameterized_tests/">æµ‹è¯•æŠ€èƒ½è¿›é˜¶(äºŒ): Parameterized Tests</a></li>
<li><a href="https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%B8%89_property_based_testing/">æµ‹è¯•æŠ€èƒ½è¿›é˜¶(ä¸‰): Property Based Testing</a></li>
</ul>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://en.wikipedia.org/wiki/QuickCheck">https://en.wikipedia.org/wiki/QuickCheck</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p><a href="https://hypothesis.works/">https://hypothesis.works/</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p><a href="https://en.wikipedia.org/wiki/Run-length_encoding">https://en.wikipedia.org/wiki/Run-length_encoding</a>&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p><a href="https://github.com/BurntSushi/ripgrep">https://github.com/BurntSushi/ripgrep</a>&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5">
<p><a href="https://github.com/BurntSushi/quickcheck">https://github.com/BurntSushi/quickcheck</a>&#160;<a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:6">
<p><a href="https://github.com/proptest-rs/proptest">https://github.com/proptest-rs/proptest</a>&#160;<a href="#fnref:6" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:7">
<p><a href="https://hypothesis.readthedocs.io/en/latest/manifesto.html">https://hypothesis.readthedocs.io/en/latest/manifesto.html</a>&#160;<a href="#fnref:7" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
]]></content:encoded>
    </item>
    <item>
      <title>æµ‹è¯•æŠ€èƒ½è¿›é˜¶(äºŒ): Parameterized Tests</title>
      <link>https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%BA%8C_parameterized_tests/</link>
      <pubDate>Sun, 13 Oct 2024 09:35:00 -0700</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%BA%8C_parameterized_tests/</guid>
      <description>&lt;h2 id=&#34;å‰è¨€&#34;&gt;&lt;span class=&#34;section-num&#34;&gt;1&lt;/span&gt; å‰è¨€&lt;/h2&gt;
&lt;p&gt;æµ‹è¯•æŠ€å·§å…·æœ‰æ™®é€‚æ€§ï¼Œå¤§å¤šæ˜¯ä¸è¯­è¨€æ— å…³çš„ï¼Œåªæ˜¯ä¸åŒè¯­è¨€çš„ç”Ÿæ€å¯èƒ½å¯¹æµ‹è¯•æŠ€æœ¯çš„æ”¯æŒå„ä¸ä¸€æ ·ï¼Œ
æ¯”å¦‚Pythonå’ŒJavaï¼ŒåŸºæœ¬ä»€ä¹ˆåº“éƒ½æœ‰ï¼Œè€ŒåƒC++ï¼Œæœ‰é¡ºæ‰‹çš„å•å…ƒæµ‹è¯•å’ŒMockåº“èƒ½ç”¨å°±å¾ˆä¸é”™äº†ã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<h2 id="å‰è¨€"><span class="section-num">1</span> å‰è¨€</h2>
<p>æµ‹è¯•æŠ€å·§å…·æœ‰æ™®é€‚æ€§ï¼Œå¤§å¤šæ˜¯ä¸è¯­è¨€æ— å…³çš„ï¼Œåªæ˜¯ä¸åŒè¯­è¨€çš„ç”Ÿæ€å¯èƒ½å¯¹æµ‹è¯•æŠ€æœ¯çš„æ”¯æŒå„ä¸ä¸€æ ·ï¼Œ
æ¯”å¦‚Pythonå’ŒJavaï¼ŒåŸºæœ¬ä»€ä¹ˆåº“éƒ½æœ‰ï¼Œè€ŒåƒC++ï¼Œæœ‰é¡ºæ‰‹çš„å•å…ƒæµ‹è¯•å’ŒMockåº“èƒ½ç”¨å°±å¾ˆä¸é”™äº†ã€‚</p>
<p>å› ä¸ºPythonæ¯”è¾ƒé€‚åˆå†™POC(proof of concept), è€Œæˆ‘æ—¥å¸¸å·¥ä½œçš„è¯­è¨€æ˜¯Java+Rustï¼Œæ‰€ä»¥æˆ‘ä¼šç©¿æ’ç€å¼•ç”¨è¿™ä¸‰ç§è¯­è¨€ã€‚</p>
<h2 id="parameterized-test"><span class="section-num">2</span> Parameterized Test</h2>
<p>åœ¨ä»‹ç» Parameterized Test ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆæ¥çœ‹ä¸ªç®€å•çš„è®¡ç®—ä»·æ ¼ä¸æŠ˜æ‰£çš„å‡½æ•°ï¼ˆå®é™…çš„ç”Ÿäº§ä»£ç è‚¯å®šä¼šæ›´å¤æ‚ï¼Œä½†æ˜¯èƒŒåçš„æ€è·¯æ˜¯ç›¸é€šçš„ï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">calculate_discount</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">discount_percentage</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">price</span> <span class="o">-</span> <span class="p">(</span><span class="n">price</span> <span class="o">*</span> <span class="n">discount_percentage</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é’ˆå¯¹è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šç¼–å†™å¤šä¸ª test case, æ¯”å¦‚ä»·æ ¼æ˜¯ 100, ç»™10%çš„æŠ˜æ‰£; ä»·æ ¼æ˜¯200, ç»™20%çš„æŠ˜æ‰£; ä»·æ ¼æ˜¯50, ç»™0çš„æŠ˜æ‰£ï¼›è¿˜æœ‰å¼‚å¸¸caseï¼Œæ¯”å¦‚ä»·æ ¼ä¸ºè´Ÿæ•°çš„æ—¶å€™ï¼Œæˆ–è€…æŠ˜æ‰£ä¸ºè´Ÿæ•°çš„æ—¶å€™.</p>
<h3 id="å•ä¸ª-test-case"><span class="section-num">2.1</span> å•ä¸ª test case</h3>
<p>å¯¹äºè¿™ä¹ˆå¤šçš„ case, ä¸€ä¸ªç®€å•ç²—æš´çš„æ–¹å¼å°±æ˜¯æŠŠæ‰€æœ‰çš„ case éƒ½å†™åœ¨ä¸€ä¸ª test case é‡Œï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pytest</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_calculate_discount</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># happy path</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">calculate_discount</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="mi">90</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">calculate_discount</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="o">==</span> <span class="mi">160</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">calculate_discount</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># unhappy path</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># assert calculate_discount(-2, 10)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># assert calculate_discount(10, -2)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½†æ˜¯è¿™æ ·çš„åšæ³•ä¸€èˆ¬æ˜¯ä¸æ¨èçš„ï¼ŒBest Practiceæ˜¯ä¸€ä¸ª test case åªæµ‹ä¸€ç§æƒ…å†µï¼Œå› ä¸ºå¦‚æœä¸€ä¸ª test case åŒ…å«å¤šä¸ªæµ‹è¯•æ¡ä»¶ï¼Œå¦‚æœ test case fail äº†ï¼Œé‚£ä¹ˆä¸çœ‹æºç æˆ–è€…å †æ ˆï¼Œä¸€èˆ¬è¿˜çœ‹ä¸å‡ºæ˜¯ä»€ä¹ˆ case å¤±è´¥äº†ï¼Œä¸å¥½æ’æŸ¥ã€‚</p>
<h3 id="å¤šä¸ª-test-case"><span class="section-num">2.2</span> å¤šä¸ª test case</h3>
<p>æ¨èåšæ³•å°±æ˜¯æ¯ä¸ªæµ‹è¯•æ¡ä»¶ä¸€ä¸ªå•ç‹¬çš„ test caseã€‚</p>
<p>å¦å¤–æˆ‘ä»¬é€šè¿‡test caseå‘ç°ä¸Šé¢çš„ä»£ç æ²¡æœ‰å¤„ç†å¼‚å¸¸æƒ…å†µï¼Œæˆ‘ä»¬ç°åœ¨è¦ä¼˜åŒ–ä¸‹æˆ‘ä»¬çš„ä»£ç ï¼Œå¢åŠ å¼‚å¸¸å¤„ç†é€»è¾‘(è¿™ä¸ªå°±æ˜¯TDDæ‰€æ¨å´‡çš„å¼€å‘å“²å­¦, test case å…ˆè¡Œï¼Œé€šè¿‡test caseå‘ç°é—®é¢˜ï¼Œè®©test case failæ‰ï¼Œç„¶åä¿®æ­£ä¸šåŠ¡é€»è¾‘ï¼Œtest caseå†è¿è¡Œé€šè¿‡).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pytest</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">calculate_discount</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">discount_percentage</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">price</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Price must be greater than zero: </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">discount_percentage</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Discount_percentage must be greater than zero: </span><span class="si">{</span><span class="n">discount_percentage</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">price</span> <span class="o">-</span> <span class="p">(</span><span class="n">price</span> <span class="o">*</span> <span class="n">discount_percentage</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TestClassCalculateDiscount</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># happy path</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">test_calculate_discount_with_10_discount_percentage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">assert</span> <span class="n">calculate_discount</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="mi">90</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">test_calculate_discount_with_20_discount_percentage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">assert</span> <span class="n">calculate_discount</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="o">==</span> <span class="mi">160</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">test_calculate_discount_with_0_discount_percentage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">assert</span> <span class="n">calculate_discount</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># unhappy path</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">test_calculate_discount_with_negative_price</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">assert</span> <span class="n">calculate_discount</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">test_calculate_discount_with_negative_discount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">assert</span> <span class="n">calculate_discount</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»£ç çš„ç¡®æ˜¯æ•´æ´æ˜“è¯»äº†ï¼Œä½†è¯è™½å¦‚æ­¤ï¼Œæˆ‘ä»¬è¦å¤šå†™äº†å¾ˆå¤šçš„ test case.</p>
<p>å¦‚æœ <code>calculate_discount</code> å˜å¾—æ›´å¤æ‚ï¼Œæˆ‘ä»¬è¦å†™çš„ test case è‚¯å®šæ˜¯æ›´å¤šæ›´å¤æ‚ï¼Œæ€»ä¸èƒ½éƒ½ copy-paste test caseå§ã€‚</p>
<h3 id="parameterized-test"><span class="section-num">2.3</span> Parameterized Test</h3>
<p>è¯é¢˜å°±å›åˆ° Parameterized Test äº†, å®ƒå°±æ˜¯ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ï¼Œå®ƒå¯ä»¥è®©ä½ ç”¨ä¸åŒçš„æµ‹è¯•æ•°æ®é›†ä¼šè¿è¡Œç›¸åŒçš„æµ‹è¯•é€»è¾‘.
è¿˜æ˜¯ä»¥ä¸Šé¢çš„ä»£ç ä¸ºä¾‹å­ï¼Œä½ ä¼šå‘ç° <code>test_calculate_discount_with_10_discount_percentage</code> å’Œ <code>test_calculate_discount_with_20_discount_percentage</code> çš„æµ‹è¯•é€»è¾‘æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œä½†åªæ˜¯æ•°æ®é›†ä¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ Parameterized Test æ¥ä¼˜åŒ–ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pytest</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TestClassCalculateDiscount</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Parameterized test for valid cases (happy path)</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@pytest.mark.parametrize</span><span class="p">(</span><span class="s2">&#34;price, discount, expected&#34;</span><span class="p">,</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">160</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">test_calculate_discount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">discount</span><span class="p">,</span> <span class="n">expected</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">assert</span> <span class="n">calculate_discount</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">discount</span><span class="p">)</span> <span class="o">==</span> <span class="n">expected</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Parameterized test for invalid cases (unhappy path)</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@pytest.mark.parametrize</span><span class="p">(</span><span class="s2">&#34;price, discount&#34;</span><span class="p">,</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>   <span class="c1"># Invalid price</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>    <span class="c1"># Invalid discount percentage</span>
</span></span><span class="line"><span class="cl">    <span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">test_calculate_discount_invalid_cases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">discount</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">calculate_discount</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">discount</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…¶å®å°±æ˜¯æŠŠæµ‹è¯•é€»è¾‘å’Œæ•°æ®è¿›è¡Œäº†åˆ†ç¦»ï¼Œåé¢éœ€è¦æµ‹è¯•æ–°çš„æ•°æ®é›†ï¼Œåªéœ€è¦å‘æ•°æ®é›†é‡Œé¢æ·»åŠ æ•°æ®å³å¯ã€‚</p>
<p>ç”±æ­¤å¯è§ï¼Œä½¿ç”¨ Parameterized Test æœ‰å‡ ä¸ªæ˜¾è€Œæ˜“è§çš„å¥½å¤„ï¼š</p>
<p>é¦–å…ˆæ˜¯å‡å°‘ä»£ç å†—ä½™ï¼Œä¸éœ€è¦ç±»ä¼¼çš„ä»£ç  copy-paste å¾ˆå¤šæ¬¡ï¼›å…¶æ¬¡æ˜¯æ–¹ä¾¿æåˆ°æµ‹è¯•è¦†ç›–ç‡ï¼Œè¿™ä¸ªåœ¨ä¸Šé¢çš„ä¾‹å­å¯èƒ½ä¸æ˜æ˜¾ï¼Œæˆ‘ä»¬å¯ä»¥å†ä¿®æ”¹ä¸€ä¸‹ <code>calculate_discount</code> å‡½æ•°ï¼Œå¢åŠ ä¸¤ä¸ªåˆ†æ”¯ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">calculate_discount</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">discount_percentage</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">price</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Price must be greater than zero: </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">discount_percentage</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Discount_percentage must be greater than zero: </span><span class="si">{</span><span class="n">discount_percentage</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">price</span> <span class="o">&gt;</span> <span class="mi">50000</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">price</span> <span class="o">-</span> <span class="p">(</span><span class="n">price</span> <span class="o">*</span> <span class="p">(</span><span class="n">discount_percentage</span> <span class="o">*</span> <span class="mf">1.15</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">price</span> <span class="o">&gt;</span> <span class="mi">100000</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">price</span> <span class="o">-</span> <span class="p">(</span><span class="n">price</span> <span class="o">*</span> <span class="p">(</span><span class="n">discount_percentage</span> <span class="o">*</span> <span class="mf">1.18</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">price</span> <span class="o">-</span> <span class="p">(</span><span class="n">price</span> <span class="o">*</span> <span class="n">discount_percentage</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»·æ ¼è¶…è¿‡50000, åœ¨å·²æœ‰æŠ˜æ‰£åŸºç¡€ä¸Šï¼Œå†é¢å¤–ç»™æŠ˜æ‰£çš„15%ä½œä¸ºæŠ˜æ‰£ï¼›ä»·æ ¼è¶…è¿‡100000ï¼Œåœ¨å·²æœ‰æŠ˜æ‰£çš„åŸºç¡€ä¸Šï¼Œå†é¢å¤–ç»™æŠ˜æ‰£çš„18%ä½œä¸ºæŠ˜æ‰£. å¦‚æœè¦è¦†ç›–è¿™ä¸¤ä¸ªæ–°çš„åˆ†æ”¯ï¼Œåªéœ€è¦åœ¨æ•°æ®é›†ä¸Šæ·»åŠ å¤§äº50000 å’Œå¤§äº100000çš„æ•°æ®é›†ï¼Œå°±å¯ä»¥ç›´æ¥è¦†ç›–åˆ°äº†.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@pytest.mark.parametrize</span><span class="p">(</span><span class="s2">&#34;price, discount, expected&#34;</span><span class="p">,</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">160</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">50001</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">44250.885</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">100001</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">88500.885</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_calculate_discount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">discount</span><span class="p">,</span> <span class="n">expected</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">calculate_discount</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">discount</span><span class="p">)</span> <span class="o">==</span> <span class="n">expected</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åæµ‹è¯•è¿™æ®µä»£ç çš„æ—¶å€™ï¼Œæˆ‘åˆå‘ç°ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼Œè¿™é‡Œçš„ä»·æ ¼å˜æˆæµ®ç‚¹æ•°åï¼Œæ²¡æœ‰ä½œå°æ•°ç‚¹åå‡ ä½çš„å–æ•´ã€‚</p>
<p>ï¼ˆå¯¹äºè¿™æ ·ç®€å•çš„å‡½æ•°ï¼Œä¹Ÿèƒ½ä¸æ–­åœ°é€šè¿‡å†™ test case å‘ç°æ–°é—®é¢˜ï¼Œè¿™æ— ç–‘å°±æ˜¯ test case æœ€å¤§çš„ä»·å€¼æ‰€åœ¨äº†ï¼‰</p>
<p>ä½¿ç”¨ Parameterized Test è¿˜å¯ä»¥æé«˜æµ‹è¯•ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œè¿™éƒ¨åˆ†å†…å®¹è¿˜æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œå°±ä¸å±•å¼€äº†ã€‚</p>
<h3 id="junit"><span class="section-num">2.4</span> Junit</h3>
<p>åœ¨Javaçš„æµ‹è¯•ç”Ÿæ€ä¸­ï¼ŒJunitæ˜¯æ¯«æ— ç–‘é—®çš„é¾™å¤´å¤§å“¥ï¼Œè€Œåœ¨Junit5 ï¼ŒJunitä¹Ÿå¼•å…¥äº†å¯¹ Parameterized Test çš„æ”¯æŒï¼Œé€šè¿‡ <code>@ParameterizedTest</code> è¿™ä¸ªæšä¸¾å°±å¯ä»¥å°†æŸä¸ª test case æ ‡æ³¨æˆ Parameterized Test, é€šè¿‡ <code>@ValueSource</code> ä¼ å…¥å¾…æµ‹è¯•æ•°æ®é›†ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Numbers</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isOdd</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">2</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@ParameterizedTest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@ValueSource</span><span class="p">(</span><span class="n">ints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">1</span><span class="p">,</span><span class="w"> </span><span class="n">3</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">3</span><span class="p">,</span><span class="w"> </span><span class="n">15</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="p">.</span><span class="na">MAX_VALUE</span><span class="p">})</span><span class="w"> </span><span class="c1">// six numbers</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kt">void</span><span class="w"> </span><span class="nf">isOdd_ShouldReturnTrueForOddNumbers</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Numbers</span><span class="p">.</span><span class="na">isOdd</span><span class="p">(</span><span class="n">number</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™åªæ˜¯æœ€åŸºæœ¬çš„ç”¨æ³•ï¼ŒJunitè¿˜æ”¯æŒé€šè¿‡å‡½æ•°ï¼Œæšä¸¾ï¼ŒCSVæ ¼å¼ç”šè‡³æ–‡ä»¶æ¥ä¼ å…¥å¾…æµ‹è¯•æ•°æ®é›†ï¼Œå¯è°“æ˜¯åŒ…ç½—ä¸‡æœ‰ï¼Œå…·ä½“çš„ç”¨æ³•å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š<a href="https://www.baeldung.com/parameterized-tests-junit-5">Guide to JUnit 5 Parameterized Tests</a><sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> å’Œ <a href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-parameterized-tests">Junitå®˜æ–¹æ–‡æ¡£</a>Â <sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup></p>
<h3 id="rstest-and-test-case"><span class="section-num">2.5</span> rstest &amp; test_case</h3>
<p>Rust ä¹Ÿæœ‰å¯¹Parameterized Testæ”¯æŒçš„åº“ï¼Œä¸€ä¸ªå°±æ˜¯ <a href="https://github.com/la10736/rstest"><code>rstest</code></a><sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>, å¦å¤–ä¸€ä¸ªå°±æ˜¯ <a href="https://github.com/frondeus/test-case"><code>test_case</code></a>Â <sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>, ä¸¤è€…éƒ½å¯¹ Parameterized Test æœ‰è¾ƒå¥½çš„æ”¯æŒï¼Œåœ¨å…¬å¸çš„ä»£ç åº“ä¸­ï¼Œä¸¤è€…æˆ‘éƒ½è§è¿‡æœ‰é¡¹ç›®åœ¨ä½¿ç”¨ï¼Œè€Œæˆ‘åœ¨å·¥ä½œä¸­ä½¿ç”¨çš„æ˜¯ <code>rstest</code>, å› ä¸ºå®ƒçš„åŠŸèƒ½æ›´åŠ å¼ºå¤§ï¼Œç»´æŠ¤è€…ä¹Ÿæ›´åŠ æ´»è·ƒ.</p>
<h2 id="æ€»ç»“"><span class="section-num">3</span> æ€»ç»“</h2>
<p>åœ¨äº†è§£ Parameterized Test ä¹‹å‰ï¼Œæˆ‘çš„æ¯ä¸ªCRåŸºæœ¬éƒ½æœ‰ test case è¦†ç›–ï¼Œä½†æ˜¯åæˆ‘æ—è¾¹ Principle Engineer å·¨ä½¬ review æˆ‘ä»£ç çš„æ—¶å€™ï¼Œæ€»ä¼šè¯´æˆ‘çš„ test case å¤ª verbose å’Œ heavy, æˆ‘åœ¨æƒ³test caseå¤šè¿˜ä¸å¥½å˜›ï¼Œæˆ‘çš„ code coverage éƒ½è¶…è¿‡80%äº†.</p>
<p>ç„¶è€Œä»–çš„æ„æ€æ˜¯ï¼Œä¸æ˜¯è¯´æˆ‘çš„ test case æ²¡æœ‰è¦†ç›–åˆ°ä»£ç ï¼Œæˆ‘100è¡Œçš„å˜æ›´ï¼Œé™„ä¸Š200è¡Œçš„ test case ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œåªä¸è¿‡æˆ‘çš„test caseå¤§å¤šåªæ˜¯æ•°æ®ä¸ä¸€æ ·ï¼Œæµ‹è¯•é€»è¾‘åŸºæœ¬ç›¸åŒï¼Œèƒ½å¦æŠ½è±¡ä¸‹ï¼Œå‡å°‘ä¸‹code redundancy, ç„¶åå°±å¼ºçƒˆå»ºè®®æˆ‘å»çœ‹ä¸‹ <code>Parameterized Test</code> ä»¥åŠ <code>Property Based Test</code>.</p>
<p>å¤§ä½¬çš„ç¡®ä¸€é’ˆè§è¡€ï¼Œæˆ‘çš„ test case å¤§å¤šæ˜¯å¤åˆ¶å·²æœ‰çš„ test case, ä¿®æ”¹ä¸‹å‡½æ•°åï¼Œå†åŠ åŠ å‡å‡æ”¹ä¸‹æ•°æ®é›†ã€‚</p>
<p>ç»ä»–æŒ‡ç‚¹ï¼Œåœ¨äº†è§£ <code>Parameterized Test</code> ä¹‹åï¼Œæˆ‘çš„ç¡®å†ä¹Ÿæ²¡æœ‰å¤åˆ¶ test caseï¼Œæ¯æ¬¡CRçš„test caseä¹Ÿæ›´ç²¾ç®€äº†ï¼ŒCRä¹Ÿæ›´å®¹æ˜“é€šè¿‡äº†.</p>
<p>è€Œä»–æåˆ°çš„ <code>Property Based Test</code> åˆ™æ˜¯ä¸€é¡¹æ›´å¼ºå¤§çš„æµ‹è¯•æŠ€æœ¯ï¼Œä¸‹å›å†åˆ†è§£äº†ã€‚</p>
<p>ç³»åˆ—æ–‡ç« :</p>
<ul>
<li><a href="https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%B8%80_%E8%BD%AF%E4%BB%B6%E8%B4%A8%E9%87%8F%E8%AE%A4%E7%9F%A5/">æµ‹è¯•æŠ€èƒ½è¿›é˜¶(ä¸€): è½¯ä»¶è´¨é‡è®¤çŸ¥</a></li>
<li><a href="https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%BA%8C_parameterized_tests/">æµ‹è¯•æŠ€èƒ½è¿›é˜¶(äºŒ): Parameterized Tests</a></li>
<li><a href="https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%B8%89_property_based_testing/">æµ‹è¯•æŠ€èƒ½è¿›é˜¶(ä¸‰): Property Based Testing</a></li>
</ul>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://www.baeldung.com/parameterized-tests-junit-5">https://www.baeldung.com/parameterized-tests-junit-5</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p><a href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-parameterized-tests">https://junit.org/junit5/docs/current/user-guide/#writing-tests-parameterized-tests</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p><a href="https://github.com/la10736/rstest">https://github.com/la10736/rstest</a>&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p><a href="https://github.com/frondeus/test-case">https://github.com/frondeus/test-case</a>&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
]]></content:encoded>
    </item>
    <item>
      <title>æµ‹è¯•æŠ€èƒ½è¿›é˜¶(ä¸€): è½¯ä»¶è´¨é‡è®¤çŸ¥</title>
      <link>https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%B8%80_%E8%BD%AF%E4%BB%B6%E8%B4%A8%E9%87%8F%E8%AE%A4%E7%9F%A5/</link>
      <pubDate>Sat, 12 Oct 2024 10:30:00 -0700</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%B8%80_%E8%BD%AF%E4%BB%B6%E8%B4%A8%E9%87%8F%E8%AE%A4%E7%9F%A5/</guid>
      <description>&lt;h2 id=&#34;å‰è¨€&#34;&gt;&lt;span class=&#34;section-num&#34;&gt;1&lt;/span&gt; å‰è¨€&lt;/h2&gt;
&lt;p&gt;æœ€è¿‘å‡ ä¸ªæœˆéƒ½åœ¨èµ¶ä¸ªéå¸¸é‡è¦é¡¹ç›®ï¼ŒåŸºæœ¬æ¯å¤©æˆ–æ¯å‡ å¤©éƒ½è¦æäº¤CRï¼Œè€Œå› ä¸ºæ¯ä¸ªCRéƒ½è¦é™„ä¸Šå¯¹åº”çš„ test case, æ‰€ä»¥è¿™æ®µæ—¶é—´å†™äº†éå¸¸å¤šçš„ test case, åˆåœ¨åæˆ‘æ—è¾¹çš„ Principal Engineer å·¨ä½¬èº«ä¸Šå­¦åˆ°äº†å¾ˆå¤šæœ‰ç”¨çš„æµ‹è¯•æŠ€å·§ï¼Œæ‰€ä»¥å°±æƒ³å†™ä¸ªç³»åˆ—æ–‡ç« æ€»ç»“å’Œåˆ†äº«æˆ‘æ‰€å­¦åˆ°çš„æ–°æŠ€èƒ½ã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<h2 id="å‰è¨€"><span class="section-num">1</span> å‰è¨€</h2>
<p>æœ€è¿‘å‡ ä¸ªæœˆéƒ½åœ¨èµ¶ä¸ªéå¸¸é‡è¦é¡¹ç›®ï¼ŒåŸºæœ¬æ¯å¤©æˆ–æ¯å‡ å¤©éƒ½è¦æäº¤CRï¼Œè€Œå› ä¸ºæ¯ä¸ªCRéƒ½è¦é™„ä¸Šå¯¹åº”çš„ test case, æ‰€ä»¥è¿™æ®µæ—¶é—´å†™äº†éå¸¸å¤šçš„ test case, åˆåœ¨åæˆ‘æ—è¾¹çš„ Principal Engineer å·¨ä½¬èº«ä¸Šå­¦åˆ°äº†å¾ˆå¤šæœ‰ç”¨çš„æµ‹è¯•æŠ€å·§ï¼Œæ‰€ä»¥å°±æƒ³å†™ä¸ªç³»åˆ—æ–‡ç« æ€»ç»“å’Œåˆ†äº«æˆ‘æ‰€å­¦åˆ°çš„æ–°æŠ€èƒ½ã€‚</p>
<h2 id="why"><span class="section-num">2</span> Why</h2>
<p>æœ‰ä¸ªå¾ˆè‘—åçš„æ€è€ƒæ–¹å¼ï¼Œå«é»„é‡‘åœˆæ³•åˆ™, ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯å¯¹äºæŸä»¶äº‹æ‰¾åˆ°Whyï¼ŒHowï¼ŒWhatï¼š</p>
<p>æˆ‘ä¸ºä»€ä¹ˆè¦åšï¼Œæˆ‘æ€ä¹ˆåšï¼Œåšè¿™ä»¶äº‹çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>æ‰€ä»¥æˆ‘å°±å…ˆæ¥èŠèŠä¸ºä»€ä¹ˆè¦å†™æµ‹è¯•caseï¼Œæˆ–è€…è¯´ä¸ºä»€ä¹ˆæ˜¯è½¯ä»¶å¼€å‘å†™æµ‹è¯•caseï¼Œåç»­çš„æ–‡ç« å†æ¥èŠèŠHow.</p>
<h2 id="è½¯ä»¶è´¨é‡æ–‡åŒ–"><span class="section-num">3</span> è½¯ä»¶è´¨é‡æ–‡åŒ–</h2>
<p>å…³äºè½¯ä»¶å·¥ç¨‹å¸ˆæ¥å†™æµ‹è¯• case, æœ€æœ‰åçš„åº”è¯¥æ˜¯Googleï¼Œä»–ä»¬å°±æ˜¯æ¨å´‡ç”±è½¯ä»¶å·¥ç¨‹å¸ˆæ¥å†™æµ‹è¯•caseï¼Œè€Œä»–ä»¬çš„æµ‹è¯•æ–‡åŒ–å·²ç»æˆä¸ºè°·æ­Œçš„å·¥ç¨‹æ–‡åŒ–çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚</p>
<p>Googleçš„å·¥ç¨‹å¸ˆä¹Ÿå‰åå†™äº†ä¸¤æœ¬ä¹¦æ¥å¸ƒé“ä»–ä»¬çš„æµ‹è¯•æ–‡åŒ–/å·¥ç¨‹æ–‡åŒ–, ä¹Ÿéå¸¸æ¨èé˜…è¯»:</p>
<ul>
<li><a href="https://book.douban.com/subject/25742200/">Googleè½¯ä»¶æµ‹è¯•ä¹‹é“</a>Â <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></li>
<li><a href="https://book.douban.com/subject/35838155/">Googleè½¯ä»¶å·¥ç¨‹</a>Â <sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup></li>
</ul>
<p>æ¯•ä¸šä»¥åå¾…è¿‡å‡ å®¶å¤§å…¬å¸ï¼Œè¿™å‡ å®¶å…¬å¸çš„æ–‡åŒ–å„æœ‰ä¸åŒï¼Œä½†å°±æˆ‘æ‰€ä¾›èŒè¿‡çš„éƒ¨é—¨è€Œè¨€ï¼Œå¯¹äºæµ‹è¯•ï¼Œä»–ä»¬éƒ½æœ‰ç€ç›¸åŒçš„è§‚ç‚¹ï¼š
ä¸åº”è¯¥ä¹Ÿä¸ä¼šæœ‰æ‰€è°“çš„æµ‹è¯•å·¥ç¨‹å¸ˆï¼Œæ¯ä¸ªè½¯ä»¶å¼€å‘éƒ½åº”è¯¥ä¸ºè‡ªå·±çš„ä»£ç ç¼–å†™æµ‹è¯•ï¼Œå¹¶ä¿è¯è´¨é‡.</p>
<p>å…¶ä¸­å¾®ä¿¡æ”¯ä»˜åŸºæœ¬å°±æ˜¯åœ¨è·µè¡Œã€ŠGoogleè½¯ä»¶æµ‹è¯•ä¹‹é“ã€‹çš„ç†å¿µï¼Œæ¨å¹¿å¾®ä¿¡æ”¯ä»˜è‡ªå·±çš„æµ‹è¯•æ–‡åŒ–ï¼Œå¼ºè°ƒæµ‹è¯•å·¦ç§°ï¼Œé¢å‘æµ‹è¯•è®¾è®¡ç­‰ç­‰ã€‚</p>
<p>Amazon å†…éƒ¨çš„æµ‹è¯•æ–‡åŒ–ä¹Ÿæ˜¯å’ŒGoogle ç›¸å½“ç±»ä¼¼ï¼Œåªæ˜¯è¿œæ²¡æœ‰Googleå‡ºå.</p>
<p>ä¸çŸ¥é“æ˜¯å› ä¸ºAmazonçš„æµ‹è¯•æ–‡åŒ–æ˜¯å—Googleæ‰€å½±å“, è®²ç©¶å…ˆæ¥ååˆ°, ä¸»å®¢åˆ†æ˜; è¿˜æ˜¯Amazonçš„å¼€æºé¡¹ç›®æˆ–è€…æŠ€æœ¯å½±å“åŠ›æ²¡æœ‰Googleé«˜ï¼Œå¯¼è‡´Amazon å·¥ç¨‹æ–‡åŒ–æ²¡æœ‰Googleå‡ºåï¼Œåˆæˆ–æ˜¯å› ä¸ºAmazonå·¥ç¨‹å¸ˆåœ¨è¡€æ±—å·¥å‚æ‰“å·¥ï¼Œå¿™ç€èµ¶éœ€æ±‚ï¼Œæ²¡æœ‰æ—¶é—´å†™ä¹¦å¸ƒé“, æ‰€ä»¥ä¸ä¸ºäººæ‰€çŸ¥å‘¢.</p>
<p>è¿™ç§æ–‡åŒ–èƒŒåï¼Œæ˜¯å¯¹è½¯ä»¶å¼€å‘ä¸è´¨é‡æµ‹è¯•å¯†ä¸å¯åˆ†çš„è®¤çŸ¥ï¼š</p>
<h3 id="èŒè´£"><span class="section-num">3.1</span> èŒè´£</h3>
<p>é¦–å…ˆï¼Œæ¯ä¸ªå·¥ç¨‹å¸ˆï¼Œéƒ½åº”è¯¥ä¸ºä»–ä»¬çš„ä»£ç ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œ
è¿™ä¸ªå·¥ä½œæœ¬èº«å°±æ˜¯ç ”å‘æµç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œè€Œè´¨é‡ä¿éšœåˆæ˜¯è½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸéå¸¸å…³é”®çš„ä¸€æ­¥ï¼Œ
å¦‚æœå†™å‡ºæ¥çš„åŠŸèƒ½å……æ»¡é—®é¢˜ï¼Œè¿™æ ·çš„åŠŸèƒ½å†å¤šï¼Œå¼€å‘å¾—å†å¿«åˆæœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ã€‚</p>
<h3 id="ci-cd"><span class="section-num">3.2</span> CI/CD</h3>
<p>æ‰€ä»¥æˆ‘ç°åœ¨æ‰€åœ¨S3éƒ¨é—¨è€Œè¨€ï¼Œè¦æ±‚æ¯ä¸ªCRéƒ½è¦æœ‰å¯¹åº”çš„æµ‹è¯•ç”¨ä¾‹æ¥ä¿è¯CRä»£ç çš„è´¨é‡ï¼Œå› ä¸ºä»£ç åˆå¹¶åˆ°ä¸»å¹²ä¹‹åï¼Œ
å°±ä¼šè¢« Continuous Deployment è‡ªåŠ¨éƒ¨ç½²ä¸Šçº¿ï¼Œæ‰€ä»¥è¦æ±‚æ¯ä¸ªæåˆ°çš„CRéƒ½æ˜¯ production-readyçš„</p>
<p>è½¯ä»¶å·¥ç¨‹å¸ˆè‡ªå·±ç¼–å†™æµ‹è¯•é…åˆCI/CDå°±å¯ä»¥æ›´æ—©æ›´å¿«åœ°å‘ç°é—®é¢˜ï¼Œå¹¶ä¸”ç”±è½¯ä»¶å·¥ç¨‹å¸ˆå¿«é€Ÿå®Œæˆä¿®å¤, é™ä½åé¦ˆå‘¨æœŸ, æé«˜å¼€å‘æ•ˆç‡.</p>
<h3 id="æˆæœ¬"><span class="section-num">3.3</span> æˆæœ¬</h3>
<p>å…¶æ¬¡ï¼Œæ²Ÿé€šæ˜¯æœ‰æˆæœ¬çš„ï¼Œå¦‚æœå­˜åœ¨æµ‹è¯•å·¥ç¨‹å¸ˆï¼Œè½¯ä»¶å·¥ç¨‹å¸ˆå°±è¦ç»™æµ‹è¯•å·¥ç¨‹å¸ˆäº¤å¾…æ¸…æ¥šä¸šåŠ¡åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Œ
è¿™æ¬¡çš„æ”¹åŠ¨è¦æµ‹ä»€ä¹ˆåŠŸèƒ½ï¼Œé¢„æœŸç»“æœæ˜¯ä»€ä¹ˆï¼Œæ²Ÿé€šæˆæœ¬å°±ç›¸å½“é«˜ï¼Œä½ å¯èƒ½è¿˜éœ€è¦é€šè¿‡æ–‡æ¡£æˆ–è€…å·¥å•å°†æµ‹è¯•å†…å®¹å‘ˆç°ç»™æµ‹è¯•å·¥ç¨‹å¸ˆã€‚</p>
<p>å¦‚æœè½¯ä»¶å·¥ç¨‹å¸ˆéƒ½èƒ½æŠŠè¿™äº›ä¸œè¥¿è§£é‡Šæ¸…æ¥šï¼Œé‚£ä¸ºä»€ä¹ˆä¸è‡ªå·±æŠŠæµ‹è¯•ç”¨ä¾‹å†™å®Œå‘¢, ä½•å¿…åŠ³å¿ƒåŠ³åŠ›å»å†™å·¥å•å‘¢ï¼Ÿ</p>
<h3 id="é¢å‘æµ‹è¯•è®¾è®¡"><span class="section-num">3.4</span> é¢å‘æµ‹è¯•è®¾è®¡</h3>
<p>è™½ç„¶Test-Driven Development(TDD)çš„å¼€å‘ç†å¿µä¸ä¸€å®šæ‰€æœ‰äººéƒ½è®¤åŒ, ä½†æ˜¯è®©è½¯ä»¶å¼€å‘å·¥ç¨‹å¸ˆæ¥ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œèƒ½è®©è½¯ä»¶å·¥ç¨‹å¸ˆæœ‰æµ‹è¯•å…ˆè¡Œï¼Œè®¾è®¡æµ‹è¯•å‹å¥½æ¥å£çš„è®¤çŸ¥, åè¿‡æ¥åˆä¼šå¯¹å…¶æ¥å£è®¾è®¡èƒ½åŠ›æœ‰æ–°çš„è¦æ±‚.</p>
<h3 id="æ•æ·å¼€å‘"><span class="section-num">3.5</span> æ•æ·å¼€å‘</h3>
<p>æ€»ç»“ä¸‹æ¥ï¼Œè®©è½¯ä»¶å·¥ç¨‹å¸ˆå¯¹è´¨é‡è´Ÿè´£ï¼Œè‡ªå·±ç¼–å†™æµ‹è¯•ç”¨ä¾‹, æ˜¯ç¡®ä¿å›¢é˜Ÿèƒ½æ•æ·å¼€å‘(move fast), åˆèƒ½ç¡®ä¿è½¯ä»¶è´¨é‡çš„å…³é”®æ‰‹æ®µ</p>
<h2 id="æ€»ç»“"><span class="section-num">4</span> æ€»ç»“</h2>
<p>æ¯ä¸ªäººå¯¹äºæµ‹è¯•æŠ€å·§çš„è®¤çŸ¥å¹¶ä¸ä¸€æ ·ï¼Œåƒå•å…ƒæµ‹è¯•ï¼Œé›†æˆæµ‹è¯•è¿™ç±»æµ‹è¯•ï¼Œ
åœ¨æˆ‘ä¸ªäººè®¤çŸ¥é‡Œï¼Œæ˜¯å±äºæ¯ä¸ªè½¯ä»¶å·¥ç¨‹å¸ˆéƒ½éœ€è¦æŒæ¡çš„åŸºç¡€æŠ€èƒ½ï¼Œå°±ä¸åœ¨ã€Œè¿›é˜¶ã€ä¹‹åˆ—ã€‚</p>
<p>è€Œåƒæ··æ²Œæµ‹è¯•(Chaos Monkey) è¿™æ ·çš„æµ‹è¯•, è‡ªç„¶å±äºè¿›é˜¶æµ‹è¯•çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯å› ä¸ºå…¶ä¸å…¬å¸çš„åŸºç¡€æ¶æ„å¼ºè€¦åˆ;</p>
<p>åœ¨å¾®ä¿¡æ”¯ä»˜çš„æ—¶å€™ï¼ŒåŒç»„çš„ä¸€ä½åŒäº‹å°±ä¸“é¡¹è´Ÿè´£å…ˆé©±ææ•´ä¸ªå¾®ä¿¡æ”¯ä»˜çš„æ··æ²Œæµ‹è¯•ï¼Œ
å‰åæäº†1å¹´åŠè¿˜åœ¨å¼€å‘ï¼Œéƒ½æ˜¯å’Œè¿ç»´å›¢é˜Ÿä»¥åŠåŸºç¡€ç»„ä»¶å›¢é˜Ÿå¯†åˆ‡åˆä½œæ¥å¼€å‘æ··æ²Œæµ‹è¯•åŠŸèƒ½çš„ï¼Œ
æ— æ³•ç”¨ç¤ºä¾‹ä»£ç æ¥ç›´è§‚å‘ˆç°ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šåˆ—å…¥è¿™ä¸ªç³»åˆ—ã€‚</p>
<p>è¿™ç³»åˆ—æ–‡ç« æ›´ä¸“æ³¨äºæ—¥å¸¸å¼€å‘ä¸­ï¼Œæ¯ä¸ªè½¯ä»¶å·¥ç¨‹å¸ˆéƒ½æœ‰æœºä¼šç”¨ä¸Šçš„æµ‹è¯•æŠ€å·§.</p>
<p>ç³»åˆ—æ–‡ç« :</p>
<ul>
<li><a href="https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%B8%80_%E8%BD%AF%E4%BB%B6%E8%B4%A8%E9%87%8F%E8%AE%A4%E7%9F%A5/">æµ‹è¯•æŠ€èƒ½è¿›é˜¶(ä¸€): è½¯ä»¶è´¨é‡è®¤çŸ¥</a></li>
<li><a href="https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%BA%8C_parameterized_tests/">æµ‹è¯•æŠ€èƒ½è¿›é˜¶(äºŒ): Parameterized Tests</a></li>
<li><a href="https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%B8%89_property_based_testing/">æµ‹è¯•æŠ€èƒ½è¿›é˜¶(ä¸‰): Property Based Testing</a></li>
</ul>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://book.douban.com/subject/25742200/">https://book.douban.com/subject/25742200/</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p><a href="https://book.douban.com/subject/35838155/">https://book.douban.com/subject/35838155/</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
]]></content:encoded>
    </item>
    <item>
      <title>How to fool the Jacoco â—œâ—¡â€¾</title>
      <link>https://ramsayleung.github.io/zh/post/2019/%E5%A6%82%E4%BD%95%E5%88%B7pojo%E7%B1%BB%E7%9A%84%E5%8F%98%E6%9B%B4%E8%A1%8C%E8%A6%86%E7%9B%96%E7%8E%87/</link>
      <pubDate>Thu, 14 Mar 2019 11:14:00 -0700</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2019/%E5%A6%82%E4%BD%95%E5%88%B7pojo%E7%B1%BB%E7%9A%84%E5%8F%98%E6%9B%B4%E8%A1%8C%E8%A6%86%E7%9B%96%E7%8E%87/</guid>
      <description>&lt;p&gt;åˆ·POJOç±»çš„å˜æ›´è¡Œè¦†ç›–ç‡&lt;/p&gt;
&lt;h2 id=&#34;åå°„å¤§æ³•å¥½&#34;&gt;&lt;span class=&#34;section-num&#34;&gt;1&lt;/span&gt; åå°„å¤§æ³•å¥½&lt;/h2&gt;
&lt;h3 id=&#34;èƒŒæ™¯&#34;&gt;&lt;span class=&#34;section-num&#34;&gt;1.1&lt;/span&gt; èƒŒæ™¯&lt;/h3&gt;
&lt;p&gt;ä¼—æ‰€å‘¨çŸ¥ï¼Œèš‚èšå¯¹ä»£ç è´¨é‡è¦æ±‚å¾ˆé«˜ï¼Œè´¨é‡çº¢çº¿å…¶ä¸­ä¸€é¡¹æŒ‡æ ‡å°±æ˜¯å˜æ›´è¡Œè¦†ç›–ç‡ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ çš„å˜æ›´è¡Œè¦†ç›–ç‡æ²¡æœ‰è¾¾åˆ°80%ï¼Œæµ‹è¯•åŒå­¦æ˜¯ä¸ä¼šå…è®¸ä½ ä¸Šæµ‹è¯•ç¯å¢ƒçš„ï¼ˆå¦‚æœå¯¹æ­¤æœ‰æ‰€ä¸æ»¡ï¼Œæµ‹è¯•åŒå­¦å°±ä¼šè¿‡æ¥æ¶ä½ )ã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>åˆ·POJOç±»çš„å˜æ›´è¡Œè¦†ç›–ç‡</p>
<h2 id="åå°„å¤§æ³•å¥½"><span class="section-num">1</span> åå°„å¤§æ³•å¥½</h2>
<h3 id="èƒŒæ™¯"><span class="section-num">1.1</span> èƒŒæ™¯</h3>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œèš‚èšå¯¹ä»£ç è´¨é‡è¦æ±‚å¾ˆé«˜ï¼Œè´¨é‡çº¢çº¿å…¶ä¸­ä¸€é¡¹æŒ‡æ ‡å°±æ˜¯å˜æ›´è¡Œè¦†ç›–ç‡ã€‚</p>
<p>å¦‚æœä½ çš„å˜æ›´è¡Œè¦†ç›–ç‡æ²¡æœ‰è¾¾åˆ°80%ï¼Œæµ‹è¯•åŒå­¦æ˜¯ä¸ä¼šå…è®¸ä½ ä¸Šæµ‹è¯•ç¯å¢ƒçš„ï¼ˆå¦‚æœå¯¹æ­¤æœ‰æ‰€ä¸æ»¡ï¼Œæµ‹è¯•åŒå­¦å°±ä¼šè¿‡æ¥æ¶ä½ )ã€‚</p>
<p>ä¸ºäº†æé«˜ä»£ç è´¨é‡ï¼Œè¿™é¡¹è¦æ±‚å€’æ˜¯æ— å¯åšéï¼Œå˜æ›´çš„ä»£ç é€»è¾‘éœ€è¦å……åˆ†çš„æµ‹è¯•ï¼›</p>
<p>ä½†æ˜¯å¦‚æœæˆ‘æ–°å¢äº†ä¸€å †çš„POJOç±»ï¼Œåªæ˜¯ä¸ºäº†é€»è¾‘æ¨¡å‹ï¼Œå˜æ›´è¡Œä¹Ÿä¼šå˜å¾—éå¸¸å¯è§‚ã€‚</p>
<p>ä¸ºäº†è¦†ç›–è¿™äº›POJOç±»çš„å˜æ›´ï¼Œä½ å…ä¸äº†ä¼šæµ‹è¯•ä¸€å †çš„Getter/Setter
æ–¹æ³•ï¼š</p>

<figure>
    
    
    <input type="checkbox" id="zoomCheck-e2b64" hidden>
    <label for="zoomCheck-e2b64">
    
    
    <img class="zoomCheck" loading="lazy" src="https://raw.githubusercontent.com/ramsayleung/images/master/20191104102036.png"
         alt="Figure 1: getter/setter"/> 
    
    
    </label><figcaption>
            <p><span class="figure-number">Figure 1: </span>getter/setter</p>
        </figcaption>
</figure>

<p>(çº¢è‰²æ˜¯æŒ‡æ²¡æœ‰è¦†ç›–åˆ°çš„å˜æ›´è¡Œ)</p>
<h3 id="åå°„"><span class="section-num">1.2</span> åå°„</h3>
<p>å¦‚æœä¸ºäº†å˜æ›´è¡Œè¦†ç›–äº†ï¼Œæˆ‘è¦å†™ä¸Šä¸€å †çš„Getter/Setter æ–¹æ³•æµ‹è¯•ç”¨ä¾‹ï¼Œæµ‹è¯•ç”¨ä¾‹ä¹Ÿåªæ˜¯å•çº¯è°ƒç”¨ä¸€ä¸‹æ–¹æ³•ï¼Œæœªå…è¿‡äºç—›è‹¦ï¼Œèƒ½å¦å·ä¸ªæ‡’ï¼Œè§£å†³è¦†ç›–ç‡é—®é¢˜ï¼Œä¹Ÿä¸éœ€æ‰‹å†™è¿™äº›æ²¡å•¥ç”¨çš„æµ‹è¯•ç”¨ä¾‹.</p>
<p>ä½†æ˜¯ä¸€æ—¶é—´æ²¡æœ‰æƒ³åˆ°è§£å†³æ–¹æ³•ï¼Œæˆ‘å°±ä¸€è¾¹å†™è¿™äº›æ²¡å•¥ç”¨çš„ç”¨ä¾‹ï¼Œä¸€è¾¹æ€è€ƒï¼Œçªç„¶å‘ç°äº†è§„å¾‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="n">SomeType</span><span class="w"> </span><span class="nf">getXxxx</span><span class="p">(){}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setXxxx</span><span class="p">(</span><span class="n">SomeType</span><span class="w"> </span><span class="n">Xxx</span><span class="p">){}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="n">SomeType</span><span class="w"> </span><span class="nf">getYyy</span><span class="p">(){}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setYyyy</span><span class="p">(</span><span class="n">SomeType</span><span class="w"> </span><span class="n">Yyyy</span><span class="p">){}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰€æœ‰è¿™äº›æ–¹æ³•éƒ½æ˜¯çš„å‰ç¼€éƒ½æ˜¯ <code>set/get</code> (çœŸ.åºŸè¯)ï¼Œå¦‚æœæˆ‘èƒ½è·å–ä¸€ä¸ªPojoç±»æ‰€æœ‰çš„æ–¹æ³•ï¼Œç„¶åå¾ªç¯æ‰§è¡Œæ‰€æœ‰ä»¥ <code>get/set</code> å¼€å¤´çš„æ–¹æ³•ï¼Œä¸å°±ä¸ç”¨æ‰‹åŠ¨å†™æ–¹æ³•äº†ä¹ˆ?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MerchantBusiModelTest</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="n">LOGGER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">ModelUtils</span><span class="p">.</span><span class="na">class</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * getç±»å‹æ–¹æ³•çš„å‰ç¼€
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">GET_METHOD_PREFIX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;get&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * setç±»å‹æ–¹æ³•çš„å‰ç¼€
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">SET_METHOD_PREFIX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;set&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">MerchantBusiModel</span><span class="w"> </span><span class="n">merchantBusiModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MerchantBusiModel</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Test</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">testModel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Method</span><span class="o">[]</span><span class="w"> </span><span class="n">methods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">merchantBusiModel</span><span class="p">.</span><span class="na">getClass</span><span class="p">().</span><span class="na">getDeclaredMethods</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Method</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">methods</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Modifier</span><span class="p">.</span><span class="na">isPublic</span><span class="p">(</span><span class="n">method</span><span class="p">.</span><span class="na">getModifiers</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">method</span><span class="p">.</span><span class="na">getName</span><span class="p">().</span><span class="na">startsWith</span><span class="p">(</span><span class="n">GET_METHOD_PREFIX</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Object</span><span class="o">[</span><span class="n">method</span><span class="p">.</span><span class="na">getParameterCount</span><span class="p">()</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">method</span><span class="p">.</span><span class="na">invoke</span><span class="p">(</span><span class="n">merchantBusiModel</span><span class="p">,</span><span class="w"> </span><span class="n">parameters</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">LoggerUtil</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="n">LOGGER</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;è°ƒç”¨æ–¹æ³•, method: {}.{}&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                                    </span><span class="n">merchantBusiModel</span><span class="p">.</span><span class="na">getClass</span><span class="p">().</span><span class="na">getSimpleName</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                                    </span><span class="n">method</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IllegalAccessException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">LoggerUtil</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="n">LOGGER</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;è°ƒç”¨æ–¹æ³•å¼‚å¸¸, method: {}.{}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                                    </span><span class="n">merchantBusiModel</span><span class="p">.</span><span class="na">getClass</span><span class="p">().</span><span class="na">getName</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                                    </span><span class="n">method</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InvocationTargetException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">LoggerUtil</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="n">LOGGER</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;è°ƒç”¨æ–¹æ³•å¼‚å¸¸, method: {}.{}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                                    </span><span class="n">merchantBusiModel</span><span class="p">.</span><span class="na">getClass</span><span class="p">().</span><span class="na">getName</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                                    </span><span class="n">method</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ ·å¾ˆå¿«å°±æŠŠ=MerchantBusiModel=æ‰€æœ‰çš„getæ–¹æ³•æ‰§è¡Œäº†(set
æ–¹æ³•ä¹ŸåŒç†å•¦)ï¼Œè°ƒç”¨ç»“æœå¦‚ä¸‹:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">19/03/14 10:46:32 WARN util.ModelUtils: (,N,20190314104632162,-,,,-,-,-,)[è°ƒç”¨æ–¹æ³•, method: MerchantBusiModel.getMcc]
</span></span><span class="line"><span class="cl">19/03/14 10:46:32 WARN util.ModelUtils: (,N,20190314104632256,-,,,-,-,-,)[è°ƒç”¨æ–¹æ³•, method: MerchantBusiModel.getOutMerchantId]
</span></span><span class="line"><span class="cl">19/03/14 10:46:32 WARN util.ModelUtils: (,N,20190314104632256,-,,,-,-,-,)[è°ƒç”¨æ–¹æ³•, method: MerchantBusiModel.getMerchantName]
</span></span><span class="line"><span class="cl">19/03/14 10:46:32 WARN util.ModelUtils: (,N,20190314104632256,-,,,-,-,-,)[è°ƒç”¨æ–¹æ³•, method: MerchantBusiModel.getMerhantType]
</span></span><span class="line"><span class="cl">19/03/14 10:46:32 WARN util.ModelUtils: (,N,20190314104632256,-,,,-,-,-,)[è°ƒç”¨æ–¹æ³•, method: MerchantBusiModel.getDealType]
</span></span><span class="line"><span class="cl">19/03/14 10:46:32 WARN util.ModelUtils: (,N,20190314104632257,-,,,-,-,-,)[è°ƒç”¨æ–¹æ³•, method: MerchantBusiModel.getAlias]
</span></span><span class="line"><span class="cl">19/03/14 10:46:32 WARN util.ModelUtils: (,N,20190314104632257,-,,,-,-,-,)[è°ƒç”¨æ–¹æ³•, method: MerchantBusiModel.getLegalPerson]
</span></span><span class="line"><span class="cl">19/03/14 10:46:32 WARN util.ModelUtils: (,N,20190314104632257,-,,,-,-,-,)[è°ƒç”¨æ–¹æ³•, method: MerchantBusiModel.getPrincipalCertType]
</span></span><span class="line"><span class="cl">çœç•¥ä¸€å¤§ç‰‡ç±»ä¼¼çš„è¾“å‡ºï¼Œçœç‚¹ç¯‡å¹…
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="org-dot-reflections-dot-reflections"><span class="section-num">1.3</span> org.reflections.Reflections</h3>
<p>é€šè¿‡åå°„ï¼Œå°±å¾ˆå®Œç¾åœ°è§£å†³äº†POJOç±»çš„å˜æ›´è¡Œè¦†ç›–ç‡é—®é¢˜äº†ï¼Œåæ­£POJOç±»éƒ½æ˜¯Getter/Setter æ–¹æ³•ï¼Œæˆ‘çš„åå°„æ–¹æ³•èƒ½æŠŠå®ƒä»¬å…¨è¦†ç›–ä¸Šå•¦ (à¹‘&gt;â—¡&lt;à¹‘) .</p>
<p>å¾ˆå¿«ï¼Œæˆ‘å°±é‡åˆ°äº†å¦å¤–çš„ä¸€ä¸ªé—®é¢˜:
åƒ <code>MerchantBusiModel</code> è¿™æ ·çš„Modelç±»æœ‰åå‡ äºŒåä¸ªï¼Œéš¾é“æ¯ä¸ªModelæˆ‘éƒ½éœ€è¦å†™ä¸€ä¸ª <code>XxxModelTest</code> çš„æµ‹è¯•ç±»ä¹ˆï¼Ÿ</p>
<p>ä¹Ÿå®åœ¨æ˜¯å¤ªç—›è‹¦äº†ï¼Œä¹Ÿå¤ªä¸ä¼˜é›…äº†(å…¶å®æ˜¯æˆ‘æ‡’)ï¼Œèƒ½ä¸èƒ½è‡ªåŠ¨æŠŠæ‰€æœ‰çš„Modelç±»æ‰«å‡ºæ¥ï¼Œç„¶åå¾ªç¯æ‰§è¡Œæ¯ä¸ªModelçš„Getter/Setteræ–¹æ³•å‘¢ï¼Ÿ</p>
<p>å› ä¸ºè¿™äº›Modeléƒ½æ˜¯ç»§æ‰¿ä¸€ä¸ªç»Ÿä¸€çš„åŸºç±»=BaseBusiModel=, èƒ½å¦æŠŠè¿™ä¸ªåŸºç±»çš„æ‰€æœ‰å­ç±»æå‡ºæ¥ï¼Œè¿™æ ·å°±å¯ä»¥å¼€å¿ƒåœ°ç”¨åå°„è§£å†³é—®é¢˜äº†.</p>
<p>è°ƒç ”ä¸€ç•ªä¹‹åå‘ç°ï¼ŒJdk çš„åå°„æ–¹å¼ä¸æ”¯æŒéå†çˆ¶ç±»æ‰€æœ‰å­ç±»çš„æ–¹æ³•ï¼Œè¿™åšæ³•è¡Œä¸é€šé˜¿!!!</p>
<p>åœ¨æˆ‘éƒ½å‡ ä¹è¦æ”¾å¼ƒï¼Œè¦æ‰‹å†™æ‰€æœ‰ModelTestçš„æ—¶å€™ï¼Œæˆ‘åœ¨StackOverFlowä¸Šé¢æ‰¾åˆ°äº† <a href="https://github.com/ronmamo/reflections">reflections</a> è¿™ç¬¬ä¸‰æ–¹åŒ…ï¼Œå‘ç°è¿™ä¸ªåŒ…éå¸¸å¼ºå¤§(niubility), å¯ä»¥è·å–åŸºç±»çš„å­ç±»æˆ–è€…æ¥å£çš„å®ç°ç±»:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Reflections</span><span class="w"> </span><span class="n">reflections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Reflections</span><span class="p">(</span><span class="s">&#34;my.project&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Class</span><span class="o">&lt;?</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">SomeType</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">subTypes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reflections</span><span class="p">.</span><span class="na">getSubTypesOf</span><span class="p">(</span><span class="n">SomeType</span><span class="p">.</span><span class="na">class</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ç®€ç›´äº†ã€‚</p>
<p>åœ¨è¿™â€ç‰›åŒ…â€çš„å¸®åŠ©ä¸‹ï¼ŒæˆåŠŸå®ç°äº†æ‰«ææŸä¸ªpackageä¸‹é¢æ‰€æœ‰åŸºç±»çš„å®ç°ç±»çš„æ–¹æ³•, æˆ‘çš„ç”¨ä¾‹æœ‰æ•‘äº†:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ModelTest</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="n">LOGGER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">ConvertorTest</span><span class="p">.</span><span class="na">class</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">PACKAGE_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;xxx.xxx.core.service.v1.busimodel&#34;</span><span class="p">;</span><span class="w"> </span><span class="c1">// modelæ‰€æœ‰çš„åŒ…</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Test</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">testModel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Reflections</span><span class="w"> </span><span class="n">reflections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Reflections</span><span class="p">(</span><span class="n">PACKAGE_NAME</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Class</span><span class="o">&lt;?</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">BaseBusiModel</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">classes</span><span class="w"> </span><span class="o">=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">reflections</span><span class="p">.</span><span class="na">getSubTypesOf</span><span class="p">(</span><span class="n">BaseBusiModel</span><span class="p">.</span><span class="na">class</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;?</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">BaseBusiModel</span><span class="o">&gt;</span><span class="w"> </span><span class="n">clazz</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">classes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Modifier</span><span class="p">.</span><span class="na">isAbstract</span><span class="p">(</span><span class="n">clazz</span><span class="p">.</span><span class="na">getModifiers</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">continue</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">BaseBusiModel</span><span class="w"> </span><span class="n">modelInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">modelInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clazz</span><span class="p">.</span><span class="na">newInstance</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IllegalAccessException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">LoggerUtil</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="n">LOGGER</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;è°ƒç”¨æ–¹æ³•IllegalAccessExceptionå¼‚å¸¸, clazz: {}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                                </span><span class="n">clazz</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InstantiationException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">LoggerUtil</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="n">LOGGER</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;è°ƒç”¨æ–¹æ³•InstantiationExceptionnå¼‚å¸¸, clazz: {}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                                </span><span class="n">clazz</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">ModelUtils</span><span class="p">.</span><span class="na">invokeGetAndSetMethod</span><span class="p">(</span><span class="n">modelInstance</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><code>ModelUtils.invokeGetAndSetMethod(modelInstance);</code> è¿™ä¸ªé™æ€æ–¹æ³•å°±æ˜¯ä¸Šä¸€èŠ‚åå°„æ–¹æ³•çš„å®Œæ•´å¯ç”¨ç‰ˆ:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ModelUtils</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="n">LOGGER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">ModelUtils</span><span class="p">.</span><span class="na">class</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * getç±»å‹æ–¹æ³•çš„å‰ç¼€
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">GET_METHOD_PREFIX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;get&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * getç±»å‹æ–¹æ³•çš„å‰ç¼€
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">SET_METHOD_PREFIX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;set&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * è°ƒç”¨clazz å¯¹è±¡çš„æ‰€æœ‰get, setæ–¹æ³•
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param clazz
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">invokeGetAndSetMethod</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">clazz</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">invokeMethodWithPrefix</span><span class="p">(</span><span class="n">GET_METHOD_PREFIX</span><span class="p">,</span><span class="w"> </span><span class="n">clazz</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">invokeMethodWithPrefix</span><span class="p">(</span><span class="n">SET_METHOD_PREFIX</span><span class="p">,</span><span class="w"> </span><span class="n">clazz</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * é€šè¿‡æ–¹æ³•å‰ç¼€è°ƒç”¨æ–¹æ³•
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param prefix
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param instance
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">invokeMethodWithPrefix</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">prefix</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">instance</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Method</span><span class="o">[]</span><span class="w"> </span><span class="n">methods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">instance</span><span class="p">.</span><span class="na">getClass</span><span class="p">().</span><span class="na">getDeclaredMethods</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Method</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">methods</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Modifier</span><span class="p">.</span><span class="na">isPublic</span><span class="p">(</span><span class="n">method</span><span class="p">.</span><span class="na">getModifiers</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">method</span><span class="p">.</span><span class="na">getName</span><span class="p">().</span><span class="na">startsWith</span><span class="p">(</span><span class="n">prefix</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Object</span><span class="o">[</span><span class="n">method</span><span class="p">.</span><span class="na">getParameterCount</span><span class="p">()</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">method</span><span class="p">.</span><span class="na">invoke</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span><span class="w"> </span><span class="n">parameters</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IllegalAccessException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">LoggerUtil</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="n">LOGGER</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;è°ƒç”¨æ–¹æ³•å¼‚å¸¸, method: {}.{}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                                    </span><span class="n">instance</span><span class="p">.</span><span class="na">getClass</span><span class="p">().</span><span class="na">getName</span><span class="p">(),</span><span class="w"> </span><span class="n">method</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InvocationTargetException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">LoggerUtil</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="n">LOGGER</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;è°ƒç”¨æ–¹æ³•å¼‚å¸¸, method: {}.{}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                                    </span><span class="n">instance</span><span class="p">.</span><span class="na">getClass</span><span class="p">().</span><span class="na">getName</span><span class="p">(),</span><span class="w"> </span><span class="n">method</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ€»ç»“"><span class="section-num">1.4</span> æ€»ç»“</h3>
<ol>
<li>Reflections åŒ…æ˜¯çœŸçš„å¼ºï¼Œæœ‰ç©ºè¦å»çœ‹ä¸€ä¸‹æºç </li>
<li>æ‡’æƒ°æ˜¯ç¨‹åºå‘˜çš„ç¬¬ä¸€ç”Ÿäº§åŠ›, è¿™è¯çœŸä¸æ˜¯æˆ‘ç¼–çš„ï¼Œæ˜¯Perl è¯­è¨€ä¹‹çˆ¶ Larry Wall è¯´çš„</li>
<li>åŠ äº†å…¶ä»–ä¸¤ä¸ªç±»ä¼¼åŠŸèƒ½çš„åå°„æµ‹è¯•ç±»ï¼Œæˆ‘çš„å˜æ›´è¡Œè¦†ç›–ç‡æš´å¢30%
(å¯ä»¥çœ‹å‡ºæˆ‘è¿™æ¬¡çš„å˜æ›´ä¸»è¦æ˜¯æ–°å¢æ¨¡å‹å’Œå·¥å…·ç±»ï¼Œè¿™æ ·åå°„æ‰èƒ½è°ƒç”¨è§„å¾‹æ€§ä»£ç )</li>
<li>Javaå¤§æ³•å¥½ï¼ŒJavaä¸–ç•Œé‚£ä¹ˆå¤§ï¼Œè¿˜éœ€è¦æˆ‘å¥½å¥½æ¢ç´¢.</li>
</ol>
<div class="qr-container" center>
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" class="qr-container" width="160px" height="160px" center="t" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
]]></content:encoded>
    </item>
    <item>
      <title>Spock ä¸€ä¸ªä¼˜é›…çš„Groovy/Javaæµ‹è¯•æ¡†æ¶</title>
      <link>https://ramsayleung.github.io/zh/post/2017/spock/</link>
      <pubDate>Tue, 11 Apr 2017 00:00:00 -0700</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2017/spock/</guid>
      <description>an introduction about spock</description>
      <content:encoded><![CDATA[<p>å› ä¸ºéœ€è¦ç¼–å†™ RESTful api æµ‹è¯•çš„ç¼˜æ•…ï¼Œé‡æ‹¾äº† Spock è¿™ä¸ªé€‚ç”¨äº Groovy/Java çš„æµ‹è¯•
æ¡†æ¶ï¼Œé¡ºä¾¿æŠŠä»¥å‰å†™çš„ä¸€ç¯‡æ—§æ–‡æ•´ç†äº†ä¸€ä¸‹ï¼Œæƒå½“é‡æ¸©ã€‚</p>
<h2 id="å…³äº-spock"><span class="section-num">1</span> å…³äº Spock</h2>
<p>Spock æ˜¯ä¸€ä¸ªé€‚ç”¨äº Java(Groovy) çš„ä¸€ä¸ªä¼˜é›…å¹¶ä¸”å…¨é¢çš„æµ‹è¯•æ¡†æ¶, è¯´ Spock å…¨é¢ï¼Œæ˜¯
å› ä¸º Spock é›†æˆäº†ç°æœ‰çš„ Java æµ‹è¯•åº“ï¼›è‡³äºä¸ºä»€ä¹ˆèµç¾ Spock ä¼˜é›…ï¼Œé˜…è¯»å®Œå…¨æ–‡ä½ å°±ä¼š
æœ‰ä½“ä¼šçš„äº†</p>

<figure>
    
    
    <input type="checkbox" id="zoomCheck-68519" hidden>
    <label for="zoomCheck-68519">
    
    
    <img class="zoomCheck" loading="lazy" src="http://ww3.sinaimg.cn/large/cd613764jw1f71jlmu3hpj20i70eemy7.jpg"/> 
    
    
    </label>
</figure>

<p>å› ä¸ºåŸºäº Groovy, ä½¿å¾— Spock å¯ä»¥æ›´å®¹æ˜“åœ°å†™å‡ºè¡¨è¾¾èƒ½åŠ›æ›´å¼ºçš„æµ‹è¯•ç”¨ä¾‹ã€‚åˆå› ä¸ºå®ƒå†…ç½®
äº† Junit Runner, æ‰€ä»¥ Spock å…¼å®¹å¤§éƒ¨åˆ†çš„ IDEï¼Œæµ‹è¯•å·¥å…·ï¼Œå’ŒæŒç»­é›†æˆæœåŠ¡å™¨ã€‚æ¥ä¸‹æ¥
å°±ä»‹ç»ä¸€ä¸‹ Spock çš„ç‰¹æ€§</p>
<h2 id="spock-ç‰¹æ€§"><span class="section-num">2</span> Spock ç‰¹æ€§</h2>
<ol>
<li>å†…ç½®æ”¯æŒ mocking stubbingï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°æ¨¡æ‹Ÿå¤æ‚çš„ç±»çš„è¡Œä¸º</li>
<li>Spock å®ç°äº† BDD èŒƒå¼(behavior-driven development)</li>
<li>ä¸ç°æœ‰çš„ Build å·¥å…·é›†æˆï¼Œå¯ä»¥ç”¨æ¥æµ‹è¯•åç«¯ä»£ç ï¼ŒWeb é¡µé¢ç­‰ç­‰</li>
<li>å…¼å®¹æ€§å¼ºï¼Œå†…ç½® Junit Runner, å¯ä»¥åƒè¿è¡Œ Junit é‚£æ ·è¿è¡Œ Spockï¼Œç”šè‡³å¯ä»¥åœ¨åŒä¸€ä¸ªé¡¹
ç›®é‡Œé¢åŒæ—¶ä½¿ç”¨ä¸¤ç§æµ‹è¯•æ¡†æ¶</li>
<li>å–é•¿è¡¥çŸ­ï¼Œå¸æ”¶äº†ç°æœ‰æ¡†æ¶çš„ä¼˜ç‚¹ï¼Œå¹¶åŠ ä»¥æ”¹è¿›</li>
<li>Spock ä»£ç é£æ ¼ç®€çŸ­ï¼Œæ˜“è¯»ï¼Œè¡¨è¾¾æ€§å¼ºï¼Œæ‰©å±•æ€§å¼ºï¼Œè¿˜æœ‰æ›´æ¸…æ™°æ˜¾ç¤º bug</li>
</ol>
<h2 id="ä¸ºä»€ä¹ˆæ˜¯-spock"><span class="section-num">3</span> ä¸ºä»€ä¹ˆæ˜¯ Spock</h2>
<p>Spock ä¼¼ä¹æœ‰å¾ˆå¤šä¸é”™çš„ç‰¹æ€§ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆæœ‰ Junit è¿™ä¸ªé‚£ä¹ˆå¼ºå¤§çš„æµ‹è¯•æ¡†æ¶, è¿˜è¦å»
ä½¿ç”¨ Spock å‘¢? ç”šè‡³å¯ä»¥ç”¨ Spock æ¥ä»£æ›¿ Junit å‘¢? ä¸‹é¢å°±ç”¨ä¸€äº›ç®€å•çš„ä¾‹å­æ¥è¯ é‡Š
ä¸€ä¸‹Spock çš„å¼ºå¤§. ä»¥ä¸€ä¸ªç®€å•çš„åŠ æ³•ä¸ºä¾‹ï¼š</p>

<figure>
    
    
    <input type="checkbox" id="zoomCheck-f453b" hidden>
    <label for="zoomCheck-f453b">
    
    
    <img class="zoomCheck" loading="lazy" src="http://ww1.sinaimg.cn/large/cd613764jw1f71jm5dserj20ek04kmxc.jpg"/> 
    
    
    </label>
</figure>

<p>Junit çš„æµ‹è¯•ç”¨ä¾‹</p>

<figure>
    
    
    <input type="checkbox" id="zoomCheck-06dc9" hidden>
    <label for="zoomCheck-06dc9">
    
    
    <img class="zoomCheck" loading="lazy" src="http://ww4.sinaimg.cn/large/cd613764jw1f71jmipwsmj20hy07xabc.jpg"/> 
    
    
    </label>
</figure>

<p>Spock çš„æµ‹è¯•ç”¨ä¾‹</p>

<figure>
    
    
    <input type="checkbox" id="zoomCheck-d6974" hidden>
    <label for="zoomCheck-d6974">
    
    
    <img class="zoomCheck" loading="lazy" src="http://ww2.sinaimg.cn/large/cd613764gw1f71jn4vlzoj20nn09vmym.jpg"/> 
    
    
    </label>
</figure>

<p>æ˜¯å¦è§‰å¾—è€³ç›®ä¸€æ–°å‘¢? å› ä¸º Spock æ”¯æŒä»¥ç±»äººç±»è¯­è¨€çš„å½¢å¼æ¥å®šä¹‰æ–¹æ³•å, æ‰€ä»¥å¯¹æ¯”
Junit çš„æµ‹è¯•ç”¨ä¾‹, ä½ ä¼šå‘ç° Spock çš„æµ‹è¯•ç”¨ä¾‹, åªéœ€å‡½æ•°å, å°±å¯ä»¥æ¸…æ™°äº†è§£è¿™ä¸ªæµ‹
è¯•çš„ç”¨é€”</p>
<p>æ¥ä¸‹æ¥, å†å†™ä¸€ä¸ªä¹˜æ³•çš„ç±», ç„¶åäººä¸ºåœ°åŠ å…¥ä¸€ä¸ª Bug, å†çœ‹çœ‹ Junit å’Œ Spock çš„è¡¨ç°</p>

<figure>
    
    
    <input type="checkbox" id="zoomCheck-17957" hidden>
    <label for="zoomCheck-17957">
    
    
    <img class="zoomCheck" loading="lazy" src="http://ww1.sinaimg.cn/large/cd613764gw1f71jnieycnj20lz047dfz.jpg"/> 
    
    
    </label>
</figure>

<p>å¦‚æœæµ‹è¯• fail, ä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µå‘¢?</p>

<figure>
    
    
    <input type="checkbox" id="zoomCheck-92281" hidden>
    <label for="zoomCheck-92281">
    
    
    <img class="zoomCheck" loading="lazy" src="http://ww1.sinaimg.cn/large/cd613764gw1f71jnxh6wtj20sq0gpdic.jpg"/> 
    
    
    </label>
</figure>


<figure>
    
    
    <input type="checkbox" id="zoomCheck-c7b17" hidden>
    <label for="zoomCheck-c7b17">
    
    
    <img class="zoomCheck" loading="lazy" src="http://ww2.sinaimg.cn/large/cd613764jw1f71job6us9j20p308iq42.jpg"/> 
    
    
    </label>
</figure>

<p>æ˜¾è€Œæ˜“è§ï¼ŒJunit åªæ˜¯æ˜¾ç¤ºäº†ç»“æœä¸ç­‰ï¼Œå´æ²¡åŠæ³•ç©¶ç«Ÿåˆ¤æ–­æ˜¯åŠ æ³•è¿˜æ˜¯ä¹˜æ³•å‡ºç°äº† bugï¼Œ
ä½†æ˜¯ Spock å°±å¾ˆæ¸…æ™°åœ°ç»™å‡ºäº†ç­”æ¡ˆã€‚ä¸éš¾çœ‹å‡º Spock çš„è¯­æ³•æ›´åŠ ç®€æ´, ä¼˜é›…; æ­¤å¤–, å¾—
ç›Šäº Spock ç‹¬ç‰¹çš„å‘½åæ–¹å¼ï¼Œåªéœ€æŸ¥çœ‹å‡½æ•°åå­—ä¾¿å¯ä»¥äº†è§£æµ‹è¯•ç”¨ä¾‹çš„ç›®çš„ï¼Œæ— éœ€é¢å¤–
çš„æ³¨é‡Šã€‚è€Œè¿™åªæ˜¯ Spock å’Œ Junit çš„ä¸€éƒ¨åˆ†å·®å¼‚ï¼Œå…¶ä»–çš„å·®å¼‚ï¼Œæ¥ä¸‹æ¥ä¼šç»§ç»­è¯´æ˜ã€‚</p>
<h2 id="spock-è¯­æ³•"><span class="section-num">4</span> Spock è¯­æ³•</h2>
<h3 id="specification"><span class="section-num">4.1</span> Specification</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">MyFirstSpecification</span><span class="w"> </span><span class="n">extend</span><span class="w"> </span><span class="n">Specification</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//fields</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//fixture methods</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//feature methods</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//helper methods</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Specification æ˜¯æŒ‡ä¸€ä¸ªç»§æ‰¿äº <strong>spock.lang.Specification</strong> çš„ä¸€ä¸ª Groovy ç±». è€Œ
Specification çš„åå­—ä¸€èˆ¬æ˜¯è·Ÿç³»ç»Ÿæˆ–è€…ä¸šåŠ¡é€»è¾‘æœ‰å…³çš„ç»„åˆè¯ï¼Œä¾‹å¦‚ä¹‹å‰çš„AdderSpec</p>
<h3 id="fields"><span class="section-num">4.2</span> Fields</h3>
<p>å®ä¾‹åŒ–ä¸€ä¸ªç±»</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="kt">def</span> <span class="n">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ClassUnderSpecification</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="kt">def</span> <span class="n">coll</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Collaborator</span><span class="o">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="feature-methods"><span class="section-num">4.3</span> Feature Methods</h3>
<p>Feature Methods æŒ‡å…·ä½“çš„æµ‹è¯•ç”¨ä¾‹æ–¹æ³•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="kt">def</span> <span class="s2">&#34;pushing an element on the stack&#34;</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl"><span class="c1">// blocks go here
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="fixture-methods"><span class="section-num">4.4</span> Fixture Methods</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="kt">def</span> <span class="nf">setup</span><span class="o">()</span> <span class="o">{}</span>          <span class="c1">// run before every feature method
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">def</span> <span class="nf">cleanup</span><span class="o">()</span> <span class="o">{}</span>        <span class="c1">// run after every feature method
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">def</span> <span class="nf">setupSpec</span><span class="o">()</span> <span class="o">{}</span>     <span class="c1">// run before the first feature method
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">def</span> <span class="nf">cleanupSpec</span><span class="o">()</span> <span class="o">{}</span>   <span class="c1">// run after the last feature method
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å…³äº Fixture Methods çš„ä½œç”¨ï¼Œç¬”è€…å¼•ç”¨ä¸€ä¸‹å®˜æ–¹æ–‡æ¡£çš„ä¸€æ®µè¯</p>
<blockquote>
<p>Fixture methods are responsible for setting up and cleaning up the environment in
which feature methods are run. Usually itâ€™s a good idea to use a fresh fixture for
every feature method, which is what the setup() and cleanup() methods are for.
All fixture methods are optional.</p></blockquote>
<p>ç®€è€Œè¨€ä¹‹ï¼Œ <strong>Fixture methodr</strong> æ˜¯è¿›è¡Œåˆå§‹åŒ–æˆ–è€…æ”¶å°¾å·¥ä½œçš„ã€‚ä¸ºäº†æ›´å¥½åœ°ç†è§£ Spock
çš„ç‰¹æ€§ï¼Œå¯ä»¥ç”¨ Spock å’Œ Junit è¿›è¡Œæ¯”è¾ƒï¼Œ(å›¾æˆªè‡ªå®˜ç½‘)</p>

<figure>
    
    
    <input type="checkbox" id="zoomCheck-42389" hidden>
    <label for="zoomCheck-42389">
    
    
    <img class="zoomCheck" loading="lazy" src="http://ww4.sinaimg.cn/large/cd613764jw1f71josjimij20sl0g7jsr.jpg"/> 
    
    
    </label>
</figure>

<p>ä»¥ä¸Šå°±æ˜¯ Spock çš„åŸºæœ¬ç”¨æ³•ï¼Œ ä¹Ÿåªèƒ½è¯´æ˜¯ä¸­è§„ä¸­çŸ©ï¼Œéš¾è¨€æƒŠè‰³ã€‚é‚£ä¹ˆï¼Œæ¥ä¸‹æ¥ä»‹ç»çš„
å°±æ˜¯ Spock <strong>killer</strong> çº§åˆ«çš„ç‰¹æ€§äº†</p>
<h3 id="blocks"><span class="section-num">4.5</span> Blocks</h3>
<p>å…³äº Blocks çš„ç”¨æ³•ï¼Œ è¿™é‡Œå¼•ç”¨å®˜ç½‘çš„ä¸€æ®µè¯</p>
<blockquote>
<p>Spock has built-in support for implementing each of the conceptual phases of a
feature method. To this end, feature methods are structured into so-called blocks.
Blocks start with a label, and extend to the beginning of the next block, or the
end of the method. There are six kinds of blocks: setup, when, then, expect,
cleanup, and where blocks</p></blockquote>
<p>ç®€è€Œè¨€ä¹‹ï¼Œ è¿™äº›å†…ç½®çš„åŠŸèƒ½å¼ºå¤§çš„ blocks, å°±æ˜¯å¸®åŠ©å¼€å‘è€…ç¼–å†™å•å…ƒæµ‹è¯•çš„è¯­æ³•ç³–</p>

<figure>
    
    
    <input type="checkbox" id="zoomCheck-3c3ed" hidden>
    <label for="zoomCheck-3c3ed">
    
    
    <img class="zoomCheck" loading="lazy" src="http://ww2.sinaimg.cn/large/cd613764jw1f71jpaxv52j20uv095q40.jpg"/> 
    
    
    </label>
</figure>

<p>ä¸‹é¢å°±äº†è§£ä¸€ä¸‹ä¸åŒ Block çš„åŠŸèƒ½</p>
<h4 id="the-given-block"><span class="section-num">4.5.1</span> The <strong>given</strong>: block</h4>
<p><strong>given</strong>: åº”è¯¥åŒ…å«æ‰€æœ‰çš„åˆå§‹åŒ–æ¡ä»¶æˆ–è€…åˆå§‹åŒ–ç±»ï¼Œä¾‹å¦‚ä½ å¯ä»¥æŠŠè¦æµ‹è¯•çš„ç±»çš„å®ä¾‹åŒ–æ”¾åœ¨
<strong>given</strong>. æ€»è€Œè¨€ä¹‹ï¼Œ <strong>given</strong> å°±æ˜¯æ”¾ç½®æ‰€æœ‰å•å…ƒæµ‹è¯•å¼€å§‹å‰çš„å‡†å¤‡å·¥ä½œçš„åœ°æ–¹</p>
<h4 id="the-setup-block"><span class="section-num">4.5.2</span> The <strong>setup</strong>: block</h4>
<p><strong>setup</strong>: ç¬”è€…ä¸ªäººç†è§£åŠŸèƒ½è·Ÿ <strong>given</strong> å¾ˆç›¸ä¼¼ï¼Œæ‰€ä»¥åˆå§‹åŒ–çš„æ—¶å€™å¯ä»¥äºŒé€‰ä¸€(ç¬”è€…
ä¸ªäººæ¨èç”¨ givenï¼Œå› ä¸ºè¿™æ ·æ›´ç¬¦åˆ BDD èŒƒå¼)</p>
<h4 id="the-when-blcok"><span class="section-num">4.5.3</span> The <strong>when</strong>: blcok</h4>
<p><strong>when</strong>: æ˜¯ Spock æµ‹è¯•ä¸­æœ€é‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œè¿™é‡Œæ”¾ç½®çš„å°±æ˜¯ä½ è¦æµ‹è¯•çš„ä»£ç ï¼Œå’Œä½ å¦‚
ä½•æµ‹è¯•çš„ç”¨ä¾‹ï¼Œè¿™é‡Œçš„æµ‹è¯•ä»£ç åº”è¯¥å°½å¯èƒ½åœ°çŸ­ã€‚æœ‰ç»éªŒçš„ Spock ç”¨æˆ·å¯ä»¥ç›´æ¥çœ‹
<strong>when</strong>: block å°±äº†è§£æµ‹è¯•æµç¨‹äº†</p>
<h4 id="the-then-block"><span class="section-num">4.5.4</span> The <strong>then</strong>: block</h4>
<p><strong>then</strong>: block åŒ…å«éšå¼çš„æ–­è¨€, è¡¥å……ä¸€ä¸‹ï¼ŒSpock æ˜¯æ²¡æœ‰ assert è¿™ä¸ªæ–­è¨€å‡½æ•°çš„ï¼Œ
Spock ä½¿ç”¨çš„æ˜¯ assertion, ç¬”è€…ä¸ªäººç†è§£æˆè¿™æ˜¯ä¸€ç§éšå¼çš„æ–­è¨€ã€‚æ¦‚æ‹¬æ¥è¯´, <strong>then</strong>
å°±æ˜¯æ”¾ç½®ä½ é¢„æœŸæµ‹è¯•ç»“æœçš„åœ°æ–¹ã€‚</p>
<p>ç°åœ¨å·²ç»æŠŠ given-when-then ç²—ç•¥åœ°è§£é‡Šäº†ä¸€ä¸‹, ç°åœ¨å°±é€šè¿‡ä»£ç é˜è¿°å…·ä½“çš„ç”¨æ³•.
é¦–å…ˆç¡®å®šä¸€ä¸‹éœ€æ±‚; å‡è®¾ç°åœ¨è¦æµ‹è¯•ä¸€ä¸ªé€šè¿‡ç½‘ç«™æ¥é”€å”®ç”µè„‘çš„ç”µå•†å¹³å°, å¦‚ä¸‹å›¾ (å›¾
æˆªè‡ª java_test_with_spock ä¸€ä¹¦)</p>

<figure>
    
    
    <input type="checkbox" id="zoomCheck-c59ec" hidden>
    <label for="zoomCheck-c59ec">
    
    
    <img class="zoomCheck" loading="lazy" src="http://ww1.sinaimg.cn/large/cd613764gw1f71jyfgad2j20t90alq3n.jpg"/> 
    
    
    </label>
</figure>

<p>ç„¶é€šè¿‡æ¨¡æ‹Ÿç”¨æˆ·æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦, ä»¥å±•ç¤º Spock çš„ç”¨æ³•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Product</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">price</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">weight</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Basket</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addProduct</span><span class="p">(</span><span class="n">Product</span><span class="w"> </span><span class="n">product</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">addProduct</span><span class="p">(</span><span class="n">product</span><span class="p">,</span><span class="n">1</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addProduct</span><span class="p">(</span><span class="n">Product</span><span class="w"> </span><span class="n">product</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">times</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">//some code about business</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getCurrentWeight</span><span class="p">(){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">//</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getProductTypesCount</span><span class="p">(){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">//</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åç¼–å†™ Spock çš„æµ‹è¯•ç”¨ä¾‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="kt">def</span> <span class="s2">&#34;A basket with one product has equal weight&#34;</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">given:</span> <span class="s2">&#34;an empty basket and a Tv&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">Product</span> <span class="n">tv</span><span class="o">=</span><span class="k">new</span> <span class="n">Product</span><span class="o">(</span><span class="nl">name:</span><span class="s2">&#34;bravia&#34;</span><span class="o">,</span><span class="nl">price:</span><span class="mi">1200</span><span class="o">,</span><span class="nl">weight:</span><span class="mi">18</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Basket</span> <span class="n">basket</span><span class="o">=</span><span class="k">new</span> <span class="n">Basket</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">when:</span><span class="s2">&#34;user wants to buy the TV&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">basket</span><span class="o">.</span><span class="na">addProduct</span><span class="o">(</span><span class="n">tv</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">then:</span><span class="s2">&#34;basket weight is equal to the TV&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">basket</span><span class="o">.</span><span class="na">currentWeight</span><span class="o">==</span><span class="n">tv</span><span class="o">.</span><span class="na">weight</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç°åœ¨å¯¹ Spock æœ‰ä¸€ä¸ªåˆæ­¥çš„è®¤è¯†äº†ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ given-when-then è¿™ &ldquo;ä¸‰æ¿æ–§&rdquo; æ¥å†™
ä¸€äº›é€»è¾‘ä¸æ˜¯éå¸¸å¤æ‚çš„æµ‹è¯•ç”¨ä¾‹äº†ã€‚</p>
<h4 id="the-and-block"><span class="section-num">4.5.5</span> The <strong>and</strong>: block</h4>
<p><strong>and</strong>: å®ƒçš„ç”¨æ³•æœ‰ç‚¹åƒè¯­æ³•ç³–ï¼Œå®ƒè‡ªå·±æœ¬èº«æ˜¯æ²¡æœ‰ä»€ä¹ˆåŠŸèƒ½ï¼Œå®ƒåªæ˜¯æ‹¿æ¥æ‰©å±•å…¶ä»–çš„
åŠŸèƒ½çš„. ç”¨ä¸Šé¢çš„ä¾‹å­æ¥è§£é‡Šä¸€ä¸‹ç”¨æ³•:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="kt">def</span> <span class="s2">&#34;A basket with one product has equal weight&#34;</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">given:</span> <span class="s2">&#34;an empty basket &#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">Basket</span> <span class="n">basket</span><span class="o">=</span><span class="k">new</span> <span class="n">Basket</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">and:</span> <span class="s2">&#34;several products&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">Product</span> <span class="n">tv</span><span class="o">=</span><span class="k">new</span> <span class="n">Product</span><span class="o">(</span><span class="nl">name:</span><span class="s2">&#34;bravia&#34;</span><span class="o">,</span><span class="nl">price:</span><span class="mi">1200</span><span class="o">,</span><span class="nl">weight:</span><span class="mi">18</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Product</span> <span class="n">camera</span><span class="o">=</span><span class="k">new</span> <span class="n">Product</span><span class="o">(</span><span class="nl">name:</span><span class="s2">&#34;panasonic&#34;</span><span class="o">,</span><span class="nl">price:</span><span class="mi">350</span><span class="o">,</span><span class="nl">weight:</span><span class="mi">2</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Product</span> <span class="n">hifi</span><span class="o">=</span><span class="k">new</span> <span class="n">Product</span><span class="o">(</span><span class="nl">name:</span><span class="s2">&#34;jvc&#34;</span><span class="o">,</span><span class="nl">price:</span><span class="mi">600</span><span class="o">,</span><span class="nl">weight:</span><span class="mi">5</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">when:</span><span class="s2">&#34;user wants to buy the TV abd the camera and the hifi&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">basket</span><span class="o">.</span><span class="na">addProduct</span><span class="o">(</span><span class="n">tv</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="n">basket</span><span class="o">.</span><span class="na">addProduct</span><span class="o">(</span><span class="n">camera</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="n">basket</span><span class="o">.</span><span class="na">addProduct</span><span class="o">(</span><span class="n">hifi</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">then:</span><span class="s2">&#34;basket weight is equal to all product weight&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">basket</span><span class="o">.</span><span class="na">currentWeight</span><span class="o">==(</span><span class="n">tv</span><span class="o">.</span><span class="na">weight</span><span class="o">+</span><span class="n">camera</span><span class="o">.</span><span class="na">weight</span><span class="o">+</span><span class="n">hifi</span><span class="o">.</span><span class="na">weight</span><span class="err">ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œgiven å’Œ and éƒ½ç”¨æ¥è¿›è¡Œç±»åˆå§‹åŒ–ï¼Œåªæ˜¯æ ¹æ® Basket å’Œ
Product ç±»å‹è¿›è¡Œäº†ç»†åˆ†ã€‚å¦‚ä¸‹å›¾</p>

<figure>
    
    
    <input type="checkbox" id="zoomCheck-aecb9" hidden>
    <label for="zoomCheck-aecb9">
    
    
    <img class="zoomCheck" loading="lazy" src="http://ww1.sinaimg.cn/large/cd613764jw1f71jq4hwjlj20wt0e10uv.jpg"/> 
    
    
    </label>
</figure>

<p>ä½¿ç”¨ <strong>and</strong> block å¯ä»¥ä»£ç ç»“æ„æ›´ç®€æ´ä¼˜é›…. æ­¤å¤–, å¦‚æœ <strong>and</strong> æ˜¯ç´§è·Ÿåœ¨ <strong>when</strong> å
é¢, é‚£ä¹ˆ <strong>and</strong> å°±æ®æœ‰å’Œ <strong>when</strong> block ä¸€æ ·çš„åŠŸèƒ½ï¼Œä¾æ­¤ç±»æ¨</p>
<h4 id="the-expect-block"><span class="section-num">4.5.6</span> The <strong>expect</strong>: block</h4>
<p><strong>expect</strong> æ˜¯ä¸€ä¸ªå¾ˆå¼ºå¤§çš„ç‰¹æ€§ï¼Œå®ƒç”¨å¾ˆå¤šç§ç”¨æ³•ï¼Œæœ€å¸¸ç”¨çš„ç”¨æ³•å°±æ˜¯æŠŠ
given-when-then éƒ½ç»“åˆèµ·æ¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="kt">def</span> <span class="s2">&#34;An empty basket has no weight&#34;</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">expect:</span><span class="s2">&#34;zero weight when nothing is added&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="nf">Basket</span><span class="o">().</span><span class="na">currentWeight</span><span class="o">==</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ–è€…æ˜¯ä»¥ä¸‹è¿™ç§å½¢å¼</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="kt">def</span> <span class="s2">&#34;An empty basket has no weight(alternative)&#34;</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">given:</span><span class="s2">&#34;an empty basket&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">Basket</span> <span class="n">basket</span><span class="o">=</span><span class="k">new</span> <span class="n">Basket</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">expect:</span><span class="s2">&#34;that the weight is 0&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">basket</span><span class="o">.</span><span class="na">currentWeight</span><span class="o">==</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åˆæˆ–è€…ç”¨ <strong>expect</strong> æå‰è¿›è¡Œæ¡ä»¶åˆ¤æ–­</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="kt">def</span> <span class="s2">&#34;A basket with two products weights as their sum (precondition)&#34;</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">given:</span> <span class="s2">&#34;an empty basket, a TV and a camera&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">Product</span> <span class="n">tv</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Product</span><span class="o">(</span><span class="nl">name:</span><span class="s2">&#34;bravia&#34;</span><span class="o">,</span><span class="nl">price:</span><span class="mi">1200</span><span class="o">,</span><span class="nl">weight:</span><span class="mi">18</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Product</span> <span class="n">camera</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Product</span><span class="o">(</span><span class="nl">name:</span><span class="s2">&#34;panasonic&#34;</span><span class="o">,</span><span class="nl">price:</span><span class="mi">350</span><span class="o">,</span><span class="nl">weight:</span><span class="mi">2</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Basket</span> <span class="n">basket</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Basket</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">expect:</span><span class="s2">&#34;that nothing should be inside&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">basket</span><span class="o">.</span><span class="na">currentWeight</span> <span class="o">==</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">basket</span><span class="o">.</span><span class="na">productTypesCount</span> <span class="o">==</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* expect: block performs
</span></span></span><span class="line"><span class="cl"><span class="cm"> intermediate assertions*/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">when:</span> <span class="s2">&#34;user wants to buy the TV and the camera&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">basket</span><span class="o">.</span><span class="na">addProduct</span> <span class="n">tv</span>
</span></span><span class="line"><span class="cl"><span class="n">basket</span><span class="o">.</span><span class="na">addProduct</span> <span class="n">camera</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">then:</span> <span class="s2">&#34;basket weight is equal to both camera and tv&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">basket</span><span class="o">.</span><span class="na">currentWeight</span> <span class="o">==</span> <span class="o">(</span><span class="n">tv</span><span class="o">.</span><span class="na">weight</span> <span class="o">+</span> <span class="n">camera</span><span class="o">.</span><span class="na">weight</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* then: block examines
</span></span></span><span class="line"><span class="cl"><span class="cm"> the final result*/</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šé¢é‚£ä¸ªä¾‹å­æ˜¯åœ¨æ·»åŠ äº§å“ä¹‹å‰æ£€æŸ¥åˆå§‹åŒ–æ¡ä»¶ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œèƒ½æ›´å®¹æ˜“çœ‹å‡ºæ˜¯å“ªé‡Œæµ‹è¯• fail</p>
<h4 id="the-clean-block"><span class="section-num">4.5.7</span> The <strong>clean</strong>: block</h4>
<p>clean å°±ç›¸å½“äºåœ¨æ‰€æœ‰çš„æµ‹è¯•ç»“æŸä»¥åæ‰§è¡Œçš„æ“ä½œï¼Œä¾‹å¦‚ï¼Œå¦‚æœåœ¨æµ‹è¯•ä¸­æ–°å»ºäº† IO æµï¼Œ
å°±å¯ä»¥åœ¨ clean é‡Œé¢å…³é—­ IO æµï¼Œé‚£æ ·å°±å¯ä»¥ä¿è¯ä»£ç çš„æ­£ç¡®æ€§äº†</p>
<h3 id="spock-killer-future"><span class="section-num">4.6</span> Spock killer future</h3>
<p>ç¡®å®šéœ€æ±‚:ï¼ˆä¾‹å­æ¥è‡ª Java_test_with_spock ä¸€ä¹¦ï¼‰ï¼Œå‡è®¾æœ‰ä¸€ä¸ªæ ¸ååº”å †ï¼Œè¿™ä¸ªååº”
å †çš„ç³»ç»Ÿç»„æˆï¼š</p>
<ul>
<li>
<p>å¤šä¸ªçƒŸé›¾æ„Ÿåº”å™¨(è¾“å…¥)</p>
</li>
<li>
<p>3 ä¸ªè¾å°„æ„Ÿåº”å™¨(è¾“å…¥)</p>
</li>
<li>
<p>ç°åœ¨çš„å‹åŠ›å€¼(è¾“å…¥</p>
</li>
<li>
<p>æŠ¥è­¦å™¨(è¾“å‡º)</p>
</li>
<li>
<p>ç–æ•£å‘½ä»¤(è¾“å‡º)</p>
</li>
<li>
<p>é€šçŸ¥æ“ä½œå‘˜å…³é—­ååº”å †(è¾“å‡º)
ç³»ç»Ÿå¦‚å›¾</p>

    <figure>
        
        
        <input type="checkbox" id="zoomCheck-9e46c" hidden>
        <label for="zoomCheck-9e46c">
        
        
        <img class="zoomCheck" loading="lazy" src="http://ww1.sinaimg.cn/large/cd613764jw1f71jsj8fqqj20vt0jlmzt.jpg"/> 
        
        
        </label>
    </figure>

<p>ç³»ç»Ÿç›¸å…³è®¾å®š:</p>
</li>
<li>
<p>å¦‚æœå‹åŠ›å€¼è¶…è¿‡ 150ï¼ŒæŠ¥è­¦å™¨æŠ¥è­¦</p>
</li>
<li>
<p>å¦‚æœ 2 ä¸ªæˆ–è€…æ›´å¤šçš„çƒŸé›¾æ„Ÿåº”å™¨è¢«è§¦å‘ï¼Œé‚£ä¹ˆæŠ¥è­¦å™¨æŠ¥è­¦ï¼Œé€šçŸ¥æ“ä½œå‘˜å…³é—­ååº”å †</p>
</li>
<li>
<p>å¦‚æœè¾å°„å€¼è¶…è¿‡ 100ï¼Œè­¦æŠ¥å™¨æŠ¥è­¦ï¼Œé€šçŸ¥æ“ä½œå‘˜å…³é—­ååº”å †ï¼Œå¹¶é©¬ä¸Šç–æ•£äººç¾¤</p>
</li>
</ul>
<p>è¾“å…¥è¾“å‡ºå¯¹åº”å…³ç³»</p>

<figure>
    
    
    <input type="checkbox" id="zoomCheck-0b659" hidden>
    <label for="zoomCheck-0b659">
    
    
    <img class="zoomCheck" loading="lazy" src="http://ww4.sinaimg.cn/large/cd613764jw1f71jtabh47j20tm0k976p.jpg"/> 
    
    
    </label>
</figure>

<p>ç°åœ¨ï¼Œå‡å¦‚ç”¨ Junit æ¥å†™æµ‹è¯•ç”¨ä¾‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@RunWith</span><span class="p">(</span><span class="n">Parameterized</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">NuclearReactorTest</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">triggeredFireSensors</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Float</span><span class="o">&gt;</span><span class="w"> </span><span class="n">radiationDataReadings</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">pressure</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">expectedAlarmStatus</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">expectedShutdownCommand</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">expectedMinutesToEvacuate</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="nf">NuclearReactorTest</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">pressure</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">triggeredFireSensors</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Float</span><span class="o">&gt;</span><span class="w"> </span><span class="n">radiationDataReadings</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">expectedAlarmStatus</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="kt">boolean</span><span class="w"> </span><span class="n">expectedShutdownCommand</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">expectedMinutesToEvacuate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">triggeredFireSensors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">triggeredFireSensors</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">radiationDataReadings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">radiationDataReadings</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">pressure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pressure</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">expectedAlarmStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expectedAlarmStatus</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">expectedShutdownCommand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expectedShutdownCommand</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">expectedMinutesToEvacuate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expectedMinutesToEvacuate</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Test</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">nuclearReactorScenario</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">NuclearReactorMonitor</span><span class="w"> </span><span class="n">nuclearReactorMonitor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">NuclearReactorMonitor</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">nuclearReactorMonitor</span><span class="p">.</span><span class="na">feedFireSensorData</span><span class="p">(</span><span class="n">triggeredFireSensors</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">nuclearReactorMonitor</span><span class="p">.</span><span class="na">feedRadiationSensorData</span><span class="p">(</span><span class="n">radiationDataReadings</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">nuclearReactorMonitor</span><span class="p">.</span><span class="na">feedPressureInBar</span><span class="p">(</span><span class="n">pressure</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">NuclearReactorStatus</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nuclearReactorMonitor</span><span class="p">.</span><span class="na">getCurrentStatus</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">assertEquals</span><span class="p">(</span><span class="s">&#34;Expected no alarm&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">expectedAlarmStatus</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">status</span><span class="p">.</span><span class="na">isAlarmActive</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">assertEquals</span><span class="p">(</span><span class="s">&#34;No notifications&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">expectedShutdownCommand</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">status</span><span class="p">.</span><span class="na">isShutDownNeeded</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">assertEquals</span><span class="p">(</span><span class="s">&#34;No notifications&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">expectedMinutesToEvacuate</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">status</span><span class="p">.</span><span class="na">getEvacuationMinutes</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Parameters</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Collection</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">[]&gt;</span><span class="w"> </span><span class="nf">data</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Arrays</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Object</span><span class="o">[][]</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">{</span><span class="w"> </span><span class="n">150</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Float</span><span class="o">&gt;</span><span class="p">(),</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">1</span><span class="w"> </span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">{</span><span class="w"> </span><span class="n">150</span><span class="p">,</span><span class="w"> </span><span class="n">1</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Float</span><span class="o">&gt;</span><span class="p">(),</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">1</span><span class="w"> </span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">{</span><span class="w"> </span><span class="n">150</span><span class="p">,</span><span class="w"> </span><span class="n">3</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Float</span><span class="o">&gt;</span><span class="p">(),</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">1</span><span class="w"> </span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">{</span><span class="w"> </span><span class="n">150</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="n">110</span><span class="p">.</span><span class="na">4f</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">.</span><span class="na">3f</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">.</span><span class="na">0f</span><span class="p">),</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="n">1</span><span class="w"> </span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">{</span><span class="w"> </span><span class="n">150</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="n">45</span><span class="p">.</span><span class="na">3f</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">.</span><span class="na">3f</span><span class="p">,</span><span class="w"> </span><span class="n">47</span><span class="p">.</span><span class="na">7f</span><span class="p">),</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">1</span><span class="w"> </span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">{</span><span class="w"> </span><span class="n">155</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="n">0</span><span class="p">.</span><span class="na">0f</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">.</span><span class="na">0f</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">.</span><span class="na">0f</span><span class="p">),</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="o">-</span><span class="n">1</span><span class="w"> </span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">{</span><span class="w"> </span><span class="n">170</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="n">0</span><span class="p">.</span><span class="na">0f</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">.</span><span class="na">0f</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">.</span><span class="na">0f</span><span class="p">),</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="n">3</span><span class="w"> </span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">{</span><span class="w"> </span><span class="n">180</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="n">110</span><span class="p">.</span><span class="na">4f</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">.</span><span class="na">3f</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">.</span><span class="na">0f</span><span class="p">),</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="n">1</span><span class="w"> </span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">{</span><span class="w"> </span><span class="n">500</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="n">110</span><span class="p">.</span><span class="na">4f</span><span class="p">,</span><span class="w"> </span><span class="n">300f</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">.</span><span class="na">0f</span><span class="p">),</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="n">1</span><span class="w"> </span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">{</span><span class="w"> </span><span class="n">30</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="n">110</span><span class="p">.</span><span class="na">4f</span><span class="p">,</span><span class="w"> </span><span class="n">1000f</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">.</span><span class="na">0f</span><span class="p">),</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="n">1</span><span class="w"> </span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">{</span><span class="w"> </span><span class="n">155</span><span class="p">,</span><span class="w"> </span><span class="n">4</span><span class="p">,</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="n">0</span><span class="p">.</span><span class="na">0f</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">.</span><span class="na">0f</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">.</span><span class="na">0f</span><span class="p">),</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="o">-</span><span class="n">1</span><span class="w"> </span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">{</span><span class="w"> </span><span class="n">170</span><span class="p">,</span><span class="w"> </span><span class="n">1</span><span class="p">,</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="n">45</span><span class="p">.</span><span class="na">3f</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">.</span><span class="na">3f</span><span class="p">,</span><span class="w"> </span><span class="n">47</span><span class="p">.</span><span class="na">7f</span><span class="p">),</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="n">3</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å„ç§è¾“å…¥è¾“å‡ºæ•°æ®ä»¥åŠ getter setter è€¦åˆåœ¨ä¸€èµ·ï¼Œä»£ç å˜å¾—éš¾è¯»èµ·æ¥. æ­¤å¤–ï¼Œé™¤äº†å¯
è¯»æ€§ï¼Œ è¿˜æœ‰æ›´ä¸¥é‡çš„é—®é¢˜ï¼Œå‡å¦‚éœ€æ±‚è¦å¢åŠ ä¸€ä¸ªè¾“å…¥æˆ–è€…å¢åŠ ä¸€ä¸ªè¾“å‡ºå‘¢ï¼Œ å°±åªèƒ½æ”¹
å˜æ•°æ®ç»“æ„ï¼Œ è¿™æ ·çš„ä»£ç çœŸçš„éš¾ä»¥ç»´æŠ¤ã€‚ä¸çŸ¥é“ Spock çš„è¡¨ç°åˆå¦‚ä½•å‘¢ï¼Ÿ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">NuclearReactorSpec</span> <span class="kd">extends</span> <span class="n">spock</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Specification</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">def</span> <span class="s2">&#34;Complete test of all nuclear scenarios&#34;</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nl">given:</span> <span class="s2">&#34;a nuclear reactor and sensor data&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">NuclearReactorMonitor</span> <span class="n">nuclearReactorMonitor</span> <span class="o">=</span><span class="k">new</span> <span class="n">NuclearReactorMonitor</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nl">when:</span> <span class="s2">&#34;we examine the sensor data&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">nuclearReactorMonitor</span><span class="o">.</span><span class="na">feedFireSensorData</span><span class="o">(</span><span class="n">fireSensors</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">nuclearReactorMonitor</span><span class="o">.</span><span class="na">feedRadiationSensorData</span><span class="o">(</span><span class="n">radiation</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">nuclearReactorMonitor</span><span class="o">.</span><span class="na">feedPressureInBar</span><span class="o">(</span><span class="n">pressure</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">NuclearReactorStatus</span> <span class="n">status</span> <span class="o">=</span> <span class="n">nuclearReactorMonitor</span><span class="o">.</span><span class="na">getCurrentStatus</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nl">then:</span> <span class="s2">&#34;we act according to safety requirements&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">status</span><span class="o">.</span><span class="na">alarmActive</span> <span class="o">==</span> <span class="n">alarm</span>
</span></span><span class="line"><span class="cl">    <span class="n">status</span><span class="o">.</span><span class="na">shutDownNeeded</span> <span class="o">==</span> <span class="n">shutDown</span>
</span></span><span class="line"><span class="cl">    <span class="n">status</span><span class="o">.</span><span class="na">evacuationMinutes</span> <span class="o">==</span> <span class="n">evacuation</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nl">where:</span> <span class="s2">&#34;possible nuclear incidents are:&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">pressure</span> <span class="o">|</span> <span class="n">fireSensors</span> <span class="o">|</span> <span class="n">radiation</span>             <span class="o">||</span> <span class="n">alarm</span> <span class="o">|</span> <span class="n">shutDown</span> <span class="o">|</span> <span class="n">evacuation</span>
</span></span><span class="line"><span class="cl">    <span class="mi">150</span>      <span class="o">|</span> <span class="mi">0</span>           <span class="o">|</span> <span class="o">[]</span>                    <span class="o">||</span> <span class="kc">false</span> <span class="o">|</span> <span class="kc">false</span>    <span class="o">|</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="mi">150</span>      <span class="o">|</span> <span class="mi">1</span>           <span class="o">|</span> <span class="o">[]</span>                    <span class="o">||</span> <span class="kc">true</span>  <span class="o">|</span> <span class="kc">false</span>    <span class="o">|</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="mi">150</span>      <span class="o">|</span> <span class="mi">3</span>           <span class="o">|</span> <span class="o">[]</span>                    <span class="o">||</span> <span class="kc">true</span>  <span class="o">|</span> <span class="kc">true</span>     <span class="o">|</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="mi">150</span>      <span class="o">|</span> <span class="mi">0</span>           <span class="o">|</span> <span class="o">[</span><span class="mf">110.4f</span> <span class="o">,</span><span class="mf">0.3f</span><span class="o">,</span> <span class="mf">0.0f</span><span class="o">]</span>  <span class="o">||</span> <span class="kc">true</span>  <span class="o">|</span> <span class="kc">true</span>     <span class="o">|</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="mi">150</span>      <span class="o">|</span> <span class="mi">0</span>           <span class="o">|</span> <span class="o">[</span><span class="mf">45.3f</span> <span class="o">,</span><span class="mf">10.3f</span><span class="o">,</span> <span class="mf">47.7f</span><span class="o">]</span> <span class="o">||</span> <span class="kc">false</span> <span class="o">|</span> <span class="kc">false</span>    <span class="o">|</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="mi">155</span>      <span class="o">|</span> <span class="mi">0</span>           <span class="o">|</span> <span class="o">[</span><span class="mf">0.0f</span> <span class="o">,</span><span class="mf">0.0f</span><span class="o">,</span> <span class="mf">0.0f</span><span class="o">]</span>    <span class="o">||</span> <span class="kc">true</span>  <span class="o">|</span> <span class="kc">false</span>    <span class="o">|</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="mi">170</span>      <span class="o">|</span> <span class="mi">0</span>           <span class="o">|</span> <span class="o">[</span><span class="mf">0.0f</span> <span class="o">,</span><span class="mf">0.0f</span><span class="o">,</span> <span class="mf">0.0f</span><span class="o">]</span>    <span class="o">||</span> <span class="kc">true</span>  <span class="o">|</span> <span class="kc">true</span>     <span class="o">|</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">    <span class="mi">180</span>      <span class="o">|</span> <span class="mi">0</span>           <span class="o">|</span> <span class="o">[</span><span class="mf">110.4f</span> <span class="o">,</span><span class="mf">0.3f</span><span class="o">,</span> <span class="mf">0.0f</span><span class="o">]</span>  <span class="o">||</span> <span class="kc">true</span>  <span class="o">|</span> <span class="kc">true</span>     <span class="o">|</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="mi">500</span>      <span class="o">|</span> <span class="mi">0</span>           <span class="o">|</span> <span class="o">[</span><span class="mf">110.4f</span> <span class="o">,</span><span class="mi">300</span><span class="n">f</span><span class="o">,</span> <span class="mf">0.0f</span><span class="o">]</span>  <span class="o">||</span> <span class="kc">true</span>  <span class="o">|</span> <span class="kc">true</span>     <span class="o">|</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="mi">30</span>       <span class="o">|</span> <span class="mi">0</span>           <span class="o">|</span> <span class="o">[</span><span class="mf">110.4f</span> <span class="o">,</span><span class="mi">1000</span><span class="n">f</span><span class="o">,</span> <span class="mf">0.0f</span><span class="o">]</span> <span class="o">||</span> <span class="kc">true</span>  <span class="o">|</span> <span class="kc">true</span>     <span class="o">|</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="mi">155</span>      <span class="o">|</span> <span class="mi">4</span>           <span class="o">|</span> <span class="o">[</span><span class="mf">0.0f</span> <span class="o">,</span><span class="mf">0.0f</span><span class="o">,</span> <span class="mf">0.0f</span><span class="o">]</span>    <span class="o">||</span> <span class="kc">true</span>  <span class="o">|</span> <span class="kc">true</span>     <span class="o">|</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="mi">170</span>      <span class="o">|</span> <span class="mi">1</span>           <span class="o">|</span> <span class="o">[</span><span class="mf">45.3f</span> <span class="o">,</span><span class="mf">10.3f</span><span class="o">,</span> <span class="mf">47.7f</span><span class="o">]</span> <span class="o">||</span> <span class="kc">true</span>  <span class="o">|</span> <span class="kc">true</span>     <span class="o">|</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é™¤äº†ä¸Šé¢æåŠçš„ given-when-then èŒƒå¼å¤–ï¼Œè¿˜å¤šäº†ä¸€ä¸ªä¹‹å‰æ²¡è§è¿‡çš„ where blockã€‚ç°
åœ¨å°±æ¥è®¤è¯†ä¸€ä¸‹ Spock çš„ killer ç‰¹æ€§. å¯ä»¥çœ‹åˆ° Spock çš„è¾“å…¥è¾“å‡ºå‚æ•°éƒ½ä¿å­˜åœ¨ç±»
ä¼¼è¡¨æ ¼çš„æ•°æ®ç»“æ„ï¼Œå…¶å®è¿™æ˜¯ Spock çš„ Parameterized testsï¼Œè€Œåœ¨ <strong>||</strong> ç¬¦å·å·¦è¾¹çš„
æ˜¯è¾“å…¥ï¼Œå³è¾¹çš„è¾“å‡ºï¼Œæ¯ä¸€åˆ—å¼€å§‹éƒ½æ˜¯è¯¥å‚æ•°çš„å±æ€§åï¼Œè¿™æ ·å°±å¯ä»¥å¾ˆä¾¿æ·åœ°åœ¨ <strong>then</strong>
åˆ¤æ–­è¾“å‡ºç»“æœæ˜¯å¦ç¬¦åˆé¢„æœŸç»“æœ. è€Œæ•°æ®æ·»åŠ æˆ–è€…å‡å°‘è¾“å…¥å‚æ•°æˆ–è€…è¾“å‡ºç»“æœçš„æ“ä½œï¼Œ
åªéœ€åœ¨ <strong>where</strong> block é‡Œé¢å¯¹åº”åœ°æ·»åŠ æˆ–è€…å‡å°‘å…·ä½“çš„å‚æ•°ï¼Œæ•´ä¸ªæ“ä½œä¸€ç›®äº†ç„¶. å‚æ•°
çš„æ–°å¢æˆ–è€…ç§»é™¤ä¹Ÿå¾ˆå®¹æ˜“åœ°å®ç°</p>
<h2 id="ç»“è¯­"><span class="section-num">5</span> ç»“è¯­</h2>
<p>ç¬”è€…åœ¨é¡¹ç›®ä¸­æ­£æ˜¯ä½¿ç”¨ Spock ç¼–å†™æµ‹è¯•ï¼Œ æˆ–è®¸å¯¹æ¯” Junit, Spock åœ¨æµè¡Œåº¦æ–¹é¢è¿˜éš¾è€Œ
æœ›å…¶é¡¹èƒŒ, ä½†æ˜¯ç»¼åˆå¤šæ–¹è€ƒè™‘ï¼ŒSpock çœŸçš„å€¼å¾—ä¸€è¯•ï¼Œå…¼ä¹‹ Groovy è¯­è¨€çš„è¯­æ³•åŠ æˆï¼Œå°±
æœ‰ä¸€ç§åœ¨ä½¿ç”¨è„šæœ¬ç¼–å†™ Java çš„æ„Ÿè§‰ (å¥½å§ï¼Œç¬”è€…çŸ¥é“ Groovy å°±æ˜¯åŸºäº jvm çš„è„šæœ¬)ï¼Œ
æ— éœ€å†ä¸º Java å•°å—¦çš„è¯­æ³•è€Œçƒ¦æ¼ã€‚æ­¤å¤– Spockè¿˜æœ‰å¾ˆå¤šå¾ˆå¼ºå¤§çš„åŠŸèƒ½ï¼Œä¾‹å¦‚å†…ç½®çš„
Mocking Stubbing (Junit éœ€è¦ç¬¬ä¸‰æ–¹åº“æ”¯æŒ), è¿˜æœ‰æ”¯æŒä¼ä¸šçº§åº”ç”¨ï¼ŒSpring, Spring
boot, å’Œ Restful service æµ‹è¯•ç­‰ã€‚æ›´å¤šçš„ç”¨æ³•ï¼Œå°±è¦æŸ¥é˜…å®˜æ–¹æ–‡æ¡£äº†</p>
<div class="qr-container" center>
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" class="qr-container" width="160px" height="160px" center="t" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
<h2 id="å‚è€ƒ"><span class="section-num">6</span> å‚è€ƒ</h2>
<ul>
<li><a href="https://www.amazon.com/Java-Testing-Spock-Konstantinos-Kapelonis/dp/1617292532">Java Testing with Spock</a></li>
<li><a href="http://spockframework.org/spock/docs/1.1-rc-3/index.html">Spock Framework Reference Documentation</a></li>
</ul>
]]></content:encoded>
    </item>
  </channel>
</rss>
