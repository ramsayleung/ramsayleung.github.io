<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Eshell on è¿‡æ²³å’</title>
    <link>https://ramsayleung.github.io/zh/tags/eshell/</link>
    <description>Recent content in Eshell on è¿‡æ²³å’</description>
    <image>
      <title>è¿‡æ²³å’</title>
      <url>https://ramsayleung.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E</url>
      <link>https://ramsayleung.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E</link>
    </image>
    <generator>Hugo -- 0.146.7</generator>
    <language>zh</language>
    <copyright>See this site&amp;rsquo;s source code here, licensed under GPLv3 Â·</copyright>
    <lastBuildDate>Thu, 09 Jan 2025 19:20:26 -0800</lastBuildDate>
    <atom:link href="https://ramsayleung.github.io/zh/tags/eshell/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Eshellå®ç°fzfçš„å†å²å‘½ä»¤æœç´¢åŠŸèƒ½</title>
      <link>https://ramsayleung.github.io/zh/post/2017/search_eshell_history_like_fzf/</link>
      <pubDate>Sun, 17 Dec 2017 15:46:00 -0800</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2017/search_eshell_history_like_fzf/</guid>
      <description>&lt;h2 id=&#34;å‰è¨€&#34;&gt;&lt;span class=&#34;section-num&#34;&gt;1&lt;/span&gt; å‰è¨€&lt;/h2&gt;
&lt;p&gt;ç›®æ ‡: åœ¨=Eshell=ä¸­åƒåœ¨bash/zshä¸­ä½¿ç”¨=fzf=é‚£èˆ¬æœç´¢å†å²å‘½ä»¤&lt;/p&gt;
&lt;h2 id=&#34;fzf&#34;&gt;&lt;span class=&#34;section-num&#34;&gt;2&lt;/span&gt; fzf&lt;/h2&gt;
&lt;p&gt;æˆ‘çš„ä¸»åŠ›Shell æ˜¯Eshell, ä½†æ˜¯å¹³æ—¶æˆ‘ä¹Ÿä¼šç”¨Zsh, è€Œ&lt;a href=&#34;https://github.com/junegunn/fzf&#34;&gt;fzf&lt;/a&gt; æ˜¯ä¸€ä¸ªéå¸¸å¥½ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äº†=fzf=æœç´¢å†å²å‘½ä»¤:&lt;/p&gt;</description>
      <content:encoded><![CDATA[<h2 id="å‰è¨€"><span class="section-num">1</span> å‰è¨€</h2>
<p>ç›®æ ‡: åœ¨=Eshell=ä¸­åƒåœ¨bash/zshä¸­ä½¿ç”¨=fzf=é‚£èˆ¬æœç´¢å†å²å‘½ä»¤</p>
<h2 id="fzf"><span class="section-num">2</span> fzf</h2>
<p>æˆ‘çš„ä¸»åŠ›Shell æ˜¯Eshell, ä½†æ˜¯å¹³æ—¶æˆ‘ä¹Ÿä¼šç”¨Zsh, è€Œ<a href="https://github.com/junegunn/fzf">fzf</a> æ˜¯ä¸€ä¸ªéå¸¸å¥½ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äº†=fzf=æœç´¢å†å²å‘½ä»¤:</p>

<figure>
    
    
    <input type="checkbox" id="zoomCheck-ae06a" hidden>
    <label for="zoomCheck-ae06a">
    
    
    <img class="zoomCheck" loading="lazy" src="https://i.imgur.com/pPMxauw.gif"
         alt="Figure 1: fzf"/> 
    
    
    </label><figcaption>
            <p><span class="figure-number">Figure 1: </span>fzf</p>
        </figcaption>
</figure>

<h2 id="eshell"><span class="section-num">3</span> Eshell</h2>
<p>æˆ‘æ—¥å¸¸çš„æ“ä½œåŸºæœ¬éƒ½æ˜¯åœ¨ Eshell ä¸Šé¢è¿›è¡Œçš„ï¼Œä¸è¿‡ Eshell æ˜¯æ²¡åŠæ³•ç›´æ¥åƒ Bash é‚£æ ·è°ƒç”¨ =fzf=æ¥æŸ¥æ‰¾å‘½ä»¤å†å²çš„ï¼Œæ‰€ä»¥æˆ‘å¸Œæœ›æŠŠè¿™ä¸ªåŠŸèƒ½è¿ç§»åˆ°åˆ°Eshell ä¸Šé¢æ¥ã€‚</p>
<p>æˆ‘åœ¨ Emacs ä½¿ç”¨çš„è¡¥å…¨æ¡†æ¶æ˜¯ <code>Ivy/Counsel</code>,å®ƒæœ‰ä¸€ä¸ª <code>counsel-esh-history=çš„å‘½ä»¤å¯ä»¥ä½¿ç”¨ =Ivy</code> æ¥æœç´¢å‘½ä»¤ï¼Œä½†æ˜¯æ²¡åŠæ³•ä½¿ç”¨ç”¨æˆ·å·²ç»è¾“å…¥çš„å†…å®¹æ¥è¿‡æ»¤å‘½ä»¤ï¼Œæ‰€ä»¥æˆ‘å°±åœ¨è‡ªå·±æŠ˜è…¾äº†ä¸€ä¸ª</p>
<p><code>counsel-esh-history</code> å‘½ä»¤ã€‚æ•ˆæœå¦‚ä¸‹ï¼š</p>

<figure>
    
    
    <input type="checkbox" id="zoomCheck-a5648" hidden>
    <label for="zoomCheck-a5648">
    
    
    <img class="zoomCheck" loading="lazy" src="https://i.imgur.com/3tvGDzW.gif"
         alt="Figure 2: æ„Ÿè§‰å¾ˆä¸é”™å˜› :)"/> 
    
    
    </label><figcaption>
            <p><span class="figure-number">Figure 2: </span>æ„Ÿè§‰å¾ˆä¸é”™å˜› :)</p>
        </figcaption>
</figure>

<h2 id="æºä»£ç "><span class="section-num">4</span> æºä»£ç </h2>
<p>å¾—ç›Šäº =Ivy=å¼ºå¤§çš„å†…ç½®å‡½æ•°, åŠŸèƒ½å®ç°èµ·æ¥ç›¸å½“ä¾¿åˆ©ï¼Œå®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lisp" data-lang="lisp"><span class="line"><span class="cl"><span class="p">(</span><span class="nb">defun</span> <span class="nv">samray/esh-history</span> <span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="s">&#34;Interactive search eshell history.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nf">require</span> <span class="ss">&#39;em-hist</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nv">save-excursion</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nv">start-pos</span> <span class="p">(</span><span class="nv">eshell-bol</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="nv">end-pos</span> <span class="p">(</span><span class="nv">point-at-eol</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="nv">input</span> <span class="p">(</span><span class="nv">buffer-substring-no-properties</span> <span class="nv">start-pos</span> <span class="nv">end-pos</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nv">command</span> <span class="p">(</span><span class="nv">ivy-read</span> <span class="s">&#34;Command: &#34;</span>
</span></span><span class="line"><span class="cl">                                <span class="p">(</span><span class="nv">delete-dups</span>
</span></span><span class="line"><span class="cl">                                 <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nf">&gt;</span> <span class="p">(</span><span class="nv">ring-size</span> <span class="nv">eshell-history-ring</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                                   <span class="p">(</span><span class="nv">ring-elements</span> <span class="nv">eshell-history-ring</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">                                <span class="ss">:preselect</span> <span class="nv">input</span>
</span></span><span class="line"><span class="cl">                                <span class="ss">:action</span> <span class="nf">#&#39;</span><span class="nv">ivy-completion-in-region-action</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">             <span class="p">(</span><span class="nv">cursor-move</span> <span class="p">(</span><span class="nf">length</span> <span class="nv">command</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="nv">kill-region</span> <span class="p">(</span><span class="nf">+</span> <span class="nv">start-pos</span> <span class="nv">cursor-move</span><span class="p">)</span> <span class="p">(</span><span class="nf">+</span> <span class="nv">end-pos</span> <span class="nv">cursor-move</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="p">)))</span>
</span></span><span class="line"><span class="cl">  <span class="c1">;; move cursor to eol</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nv">end-of-line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»£ç ä¸æ˜¯å¾ˆå¤æ‚, ä¸»è¦åŠŸèƒ½æ˜¯è·å–ç”¨æˆ·è¾“å…¥çš„å‘½ä»¤, ç„¶åæŠŠæ‰€æœ‰çš„å†å²å‘½ä»¤è¯»å–å‡ºæ¥,æœ€åä½¿ç”¨=ivy-read=å†…ç½®çš„=ivy-completion-in-region-action=åŠŸèƒ½, ç”¨ç”¨æˆ·çš„è¾“å…¥çš„å‘½ä»¤ä¸å†å²å‘½ä»¤è¿›è¡ŒåŒ¹é…, ç”±ç”¨æˆ·é€‰æ‹©æœ€ç»ˆçš„å‘½ä»¤.</p>
<p>=ivy-read=æ˜¯Emacså†…ç½®=completing-read=çš„å‡½æ•°çš„å¼ºåŒ–, å…³äº=ivy-read=å…·ä½“ç”¨æ³•å¯ä»¥å‚è€ƒæ–‡æ¡£<a href="https://oremacs.com/swiper/#getting-started">ivy-read</a>.</p>
<h2 id="æ€»ç»“"><span class="section-num">5</span> æ€»ç»“</h2>
<p>æœ€å, æˆ‘ä¹Ÿé¡ºä¾¿æŠŠä»£ç åˆ†äº«åˆ° <a href="https://www.reddit.com/r/emacs/comments/7k54px/snippet_share_make_eshell_search_command_history/">Emacsç¤¾åŒº</a>, è€Œ <a href="https://github.com/manateelazycat">manateelazycat</a>ä¹ŸæŠŠè¿™æ®µä»£ç çš„åŠŸèƒ½åŠ å…¥åˆ°<a href="https://github.com/manateelazycat/aweshell/commit/ecaddac98b87f881910dbee8b51a98f00b6d9d5d">aweshell</a>, Oh yeah !</p>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
]]></content:encoded>
    </item>
    <item>
      <title>Eshellæç¤ºç¬¦ä¼˜åŒ–</title>
      <link>https://ramsayleung.github.io/zh/post/2017/tweak_eshell_prompt/</link>
      <pubDate>Wed, 07 Jun 2017 00:00:00 -0700</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2017/tweak_eshell_prompt/</guid>
      <description>Tweak with Emacs shell prompt</description>
      <content:encoded><![CDATA[<h2 id="å‘ç°å¸…æ°”çš„æç¤ºç¬¦"><span class="section-num">1</span> å‘ç°å¸…æ°”çš„æç¤ºç¬¦</h2>
<p>è¿‘æ—¥ï¼Œæˆ‘åœ¨æµè§ˆ <a href="https://www.reddit.com/r/emacs/comments/6f0rkz/my_fancy_eshell_prompt/">Reddit</a> çš„æ—¶å€™ï¼Œå‘ç°äº†ä¸€ä½ Emacs ç”¨æˆ·æŠŠä»–çš„ Eshell æç¤ºç¬¦ä¿®æ”¹å¾—å¾ˆå¸…ï¼Œå¦‚å›¾ï¼š</p>
<p><a href="/ox-hugo/eshell_prompt.png"><img loading="lazy" src="/ox-hugo/eshell_prompt.png"></a>
æœ¬ç€æ‹¿æ¥ä¸»ä¹‰çš„æƒ³æ³•ï¼Œæˆ‘å°±ç›´æ¥æŠŠè¿™ä½å°å“¥çš„ä»£ç æ·»åŠ åˆ°äº†æˆ‘çš„é…ç½®æ–‡ä»¶é‡Œé¢ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-elisp" data-lang="elisp"><span class="line"><span class="cl"><span class="p">(</span><span class="nb">setq</span> <span class="nv">eshell-prompt-function</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nb">lambda</span> <span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="nf">concat</span>
</span></span><span class="line"><span class="cl">         <span class="p">(</span><span class="nf">propertize</span> <span class="s">&#34;â”Œâ”€[&#34;</span> <span class="ss">&#39;face</span> <span class="o">`</span><span class="p">(</span><span class="nb">:foreground</span> <span class="s">&#34;green&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">         <span class="p">(</span><span class="nf">propertize</span> <span class="p">(</span><span class="nf">user-login-name</span><span class="p">)</span> <span class="ss">&#39;face</span> <span class="o">`</span><span class="p">(</span><span class="nb">:foreground</span> <span class="s">&#34;red&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">         <span class="p">(</span><span class="nf">propertize</span> <span class="s">&#34;@&#34;</span> <span class="ss">&#39;face</span> <span class="o">`</span><span class="p">(</span><span class="nb">:foreground</span> <span class="s">&#34;green&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">         <span class="p">(</span><span class="nf">propertize</span> <span class="p">(</span><span class="nf">system-name</span><span class="p">)</span> <span class="ss">&#39;face</span> <span class="o">`</span><span class="p">(</span><span class="nb">:foreground</span> <span class="s">&#34;blue&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">         <span class="p">(</span><span class="nf">propertize</span> <span class="s">&#34;]â”€â”€[&#34;</span> <span class="ss">&#39;face</span> <span class="o">`</span><span class="p">(</span><span class="nb">:foreground</span> <span class="s">&#34;green&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">         <span class="p">(</span><span class="nf">propertize</span> <span class="p">(</span><span class="nf">format-time-string</span> <span class="s">&#34;%H:%M&#34;</span> <span class="p">(</span><span class="nf">current-time</span><span class="p">))</span> <span class="ss">&#39;face</span> <span class="o">`</span><span class="p">(</span><span class="nb">:foreground</span> <span class="s">&#34;yellow&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">         <span class="p">(</span><span class="nf">propertize</span> <span class="s">&#34;]â”€â”€[&#34;</span> <span class="ss">&#39;face</span> <span class="o">`</span><span class="p">(</span><span class="nb">:foreground</span> <span class="s">&#34;green&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">         <span class="p">(</span><span class="nf">propertize</span> <span class="p">(</span><span class="nf">concat</span> <span class="p">(</span><span class="nv">eshell/pwd</span><span class="p">))</span> <span class="ss">&#39;face</span> <span class="o">`</span><span class="p">(</span><span class="nb">:foreground</span> <span class="s">&#34;white&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">         <span class="p">(</span><span class="nf">propertize</span> <span class="s">&#34;]\n&#34;</span> <span class="ss">&#39;face</span> <span class="o">`</span><span class="p">(</span><span class="nb">:foreground</span> <span class="s">&#34;green&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">         <span class="p">(</span><span class="nf">propertize</span> <span class="s">&#34;â””â”€&gt;&#34;</span> <span class="ss">&#39;face</span> <span class="o">`</span><span class="p">(</span><span class="nb">:foreground</span> <span class="s">&#34;green&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">         <span class="p">(</span><span class="nf">propertize</span> <span class="p">(</span><span class="nb">if</span> <span class="p">(</span><span class="nf">=</span> <span class="p">(</span><span class="nf">user-uid</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span> <span class="s">&#34; # &#34;</span> <span class="s">&#34; $ &#34;</span><span class="p">)</span> <span class="ss">&#39;face</span> <span class="o">`</span><span class="p">(</span><span class="nb">:foreground</span> <span class="s">&#34;green&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">         <span class="p">)))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ•ˆæœè‡ªç„¶æ˜¯å¾ˆ sexy.</p>
<h2 id="ä¸åŸæœ‰æç¤ºç¬¦å†²çª"><span class="section-num">2</span> ä¸åŸæœ‰æç¤ºç¬¦å†²çª</h2>
<p>ä½†æ˜¯æˆ‘åŸæ¥ä½¿ç”¨çš„ <a href="https://github.com/kaihaosw/eshell-prompt-extras">eshell-prompt-extra</a> çš„æ•ˆæœå°±è¢«è¦†ç›–äº†ã€‚è€Œ <code>eshell_prompt_extra</code> å¯ä»¥æä¾›çš„é¢å¤–ä¿¡æ¯éå¸¸å¤šï¼ŒåŒ…æ‹¬ï¼šgit, python virtualenv, ä»¥åŠè¿œç¨‹ç™»å½•æ—¶çš„ä¸»æœºä¿¡æ¯ï¼Œå¦‚å›¾ï¼š</p>

<figure><a href="/ox-hugo/eshell_extra_prompt.png">
    
    
    <input type="checkbox" id="zoomCheck-0fac0" hidden>
    <label for="zoomCheck-0fac0">
    
    
    <img class="zoomCheck" loading="lazy" src="/ox-hugo/eshell_extra_prompt.png"/> 
    
    
    </label></a>
</figure>

<p>å¦‚æœç”¨ä¸Šè¿™ä¸ª sexy çš„æç¤ºç¬¦ï¼Œeshell-extra-prompt çš„é¢å¤–çš„ä¿¡æ¯å°±ä¸èƒ½æ˜¾ç¤ºï¼Œæ„Ÿè§‰å¥½äº:(</p>
<p>é±¼å’Œç†ŠæŒæˆ‘éƒ½æƒ³è¦ï¼Œä¼¼ä¹å¤ªè´ªå¿ƒäº†ï¼Ÿæ€ä¹ˆåŠï¼Œè‡ªå·±å»ä¿®æ”¹ <code>eshell_prompt_extra</code> çš„<a href="https://github.com/kaihaosw/eshell-prompt-extras/blob/master/eshell-prompt-extras.el">æºç </a> :).</p>
<h2 id="æŠ˜è…¾æºç "><span class="section-num">3</span> æŠ˜è…¾æºç </h2>
<p><code>eshell_prompt_extra</code> è¿™ä¸ªåŒ…æ³¨é‡ŠåŠ ä¸Šå…¨éƒ¨ä»£ç ä¹Ÿåªæ˜¯ 400 è¡Œï¼Œä»£ç ä¹Ÿå†™å¾—å¾ˆæ¸…æ™°. å…¶ä¸­å¤§éƒ¨ä»½æ˜¯è¾…åŠ©å‡½æ•°ï¼Œè€Œ Eshell çš„æç¤ºç¬¦æ•ˆæœæ˜¯é€šè¿‡ä¸¤ä¸ª eshell-theme å‡½æ•°æ¥å®ç°çš„ã€‚use-package çš„é…ç½®ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-elisp" data-lang="elisp"><span class="line"><span class="cl"><span class="p">(</span><span class="nb">use-package</span> <span class="nv">eshell-prompt-extras</span>
</span></span><span class="line"><span class="cl">  <span class="nb">:ensure</span> <span class="no">t</span>
</span></span><span class="line"><span class="cl">  <span class="nb">:load-path</span> <span class="s">&#34;~/Code/github/eshell-prompt-extras&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">:config</span> <span class="p">(</span><span class="nb">progn</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="nb">with-eval-after-load</span> <span class="s">&#34;esh-opt&#34;</span>
</span></span><span class="line"><span class="cl">              <span class="p">(</span><span class="nb">use-package</span> <span class="nv">virtualenvwrapper</span> <span class="nb">:ensure</span> <span class="no">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="p">(</span><span class="nv">venv-initialize-eshell</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="p">(</span><span class="nf">autoload</span> <span class="ss">&#39;epe-theme-lambda</span> <span class="s">&#34;eshell-prompt-extras&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="p">(</span><span class="nb">setq</span> <span class="nv">eshell-highlight-prompt</span> <span class="no">nil</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">eshell-prompt-function</span> <span class="ss">&#39;epe-theme-lambda</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è€Œ <code>epe-theme-lambda</code> çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-elisp" data-lang="elisp"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nb">defun</span> <span class="nv">epe-theme-lambda</span> <span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="s">&#34;A eshell-prompt lambda theme.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nb">setq</span> <span class="nv">eshell-prompt-regexp</span> <span class="s">&#34;^[^#\nÎ»]*[#Î»] &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nf">concat</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">epe-remote-p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="p">(</span><span class="nv">epe-colorize-with-face</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nf">concat</span> <span class="p">(</span><span class="nv">epe-remote-user</span><span class="p">)</span> <span class="s">&#34;@&#34;</span> <span class="p">(</span><span class="nv">epe-remote-host</span><span class="p">)</span> <span class="s">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="ss">&#39;epe-remote-face</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nb">when</span> <span class="nv">epe-show-python-info</span>
</span></span><span class="line"><span class="cl">     <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nf">fboundp</span> <span class="ss">&#39;epe-venv-p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nb">and</span> <span class="p">(</span><span class="nv">epe-venv-p</span><span class="p">)</span> <span class="nv">venv-current-name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">         <span class="p">(</span><span class="nv">epe-colorize-with-face</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="nf">concat</span> <span class="s">&#34;(&#34;</span> <span class="nv">venv-current-name</span> <span class="s">&#34;) &#34;</span><span class="p">)</span> <span class="ss">&#39;epe-venv-face</span><span class="p">))))</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nb">let</span> <span class="p">((</span><span class="nv">f</span> <span class="p">(</span><span class="nb">cond</span> <span class="p">((</span><span class="nf">eq</span> <span class="nv">epe-path-style</span> <span class="ss">&#39;fish</span><span class="p">)</span> <span class="ss">&#39;epe-fish-path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                  <span class="p">((</span><span class="nf">eq</span> <span class="nv">epe-path-style</span> <span class="ss">&#39;single</span><span class="p">)</span> <span class="ss">&#39;epe-abbrev-dir-name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                  <span class="p">((</span><span class="nf">eq</span> <span class="nv">epe-path-style</span> <span class="ss">&#39;full</span><span class="p">)</span> <span class="ss">&#39;abbreviate-file-name</span><span class="p">))))</span>
</span></span><span class="line"><span class="cl">     <span class="p">(</span><span class="nv">epe-colorize-with-face</span> <span class="p">(</span><span class="nf">funcall</span> <span class="nv">f</span> <span class="p">(</span><span class="nv">eshell/pwd</span><span class="p">))</span> <span class="ss">&#39;epe-dir-face</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">epe-git-p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="p">(</span><span class="nf">concat</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nv">epe-colorize-with-face</span> <span class="s">&#34;:&#34;</span> <span class="ss">&#39;epe-dir-face</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nv">epe-colorize-with-face</span>
</span></span><span class="line"><span class="cl">       <span class="p">(</span><span class="nf">concat</span> <span class="p">(</span><span class="nv">epe-git-branch</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="nv">epe-git-dirty</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="nv">epe-git-untracked</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="nb">let</span> <span class="p">((</span><span class="nv">unpushed</span> <span class="p">(</span><span class="nv">epe-git-unpushed-number</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">                 <span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nf">=</span> <span class="nv">unpushed</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                   <span class="p">(</span><span class="nf">concat</span> <span class="s">&#34;:&#34;</span> <span class="p">(</span><span class="nf">number-to-string</span> <span class="nv">unpushed</span><span class="p">)))))</span>
</span></span><span class="line"><span class="cl">       <span class="ss">&#39;epe-git-face</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nv">epe-colorize-with-face</span> <span class="s">&#34; Î»&#34;</span> <span class="ss">&#39;epe-symbol-face</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nv">epe-colorize-with-face</span> <span class="p">(</span><span class="nb">if</span> <span class="p">(</span><span class="nf">=</span> <span class="p">(</span><span class="nf">user-uid</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span> <span class="s">&#34;#&#34;</span> <span class="s">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                           <span class="ss">&#39;epe-sudo-symbol-face</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="s">&#34; &#34;</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»£ç ä¸»è¦é€»è¾‘æ˜¯è°ƒç”¨ä¹‹å‰å®šä¹‰çš„è¾…åŠ©å‡½æ•°ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦æ˜¾ç¤º git, python, è¿œç¨‹ä¸»æœºç­‰ä¿¡æ¯ï¼Œç„¶åå¯¹ç›¸åº”çš„æç¤ºç¬¦è¿›è¡Œæ‹¼æ¥ã€‚</p>
<p>è€Œå…¶ä¸­å‡ºç°å¾—æ¯”è¾ƒé¢‘ç¹çš„ <code>epe-colorize-with-face</code> å°±æ˜¯ä½œè€…å®šä¹‰çš„ä¸€ä¸ªå®(macro), ç”¨æ¥æ˜¾ç¤ºå­—ç¬¦ä¸²ä»¥åŠå¯¹åº”çš„ face(å…¶å®å°±æ˜¯ä¸åŒçš„é¢œè‰²å•¦). çœ‹æ‡‚äº†ä»£ç å°±å¥½åŠäº†ï¼Œç°åœ¨å°±å¯ä»¥è‡ªå·±æ·»åŠ ä¸€ä¸ª Eshell ä¸»é¢˜ã€‚</p>
<h3 id="å®šä¹‰æ‰€éœ€çš„-face"><span class="section-num">3.1</span> å®šä¹‰æ‰€éœ€çš„ face</h3>
<p>å› ä¸ºæˆ‘éœ€è¦æ˜¾ç¤ºçš„ face(é¢œè‰²), <code>eshell-extra-prompt</code> å¹¶æ²¡æœ‰å®šä¹‰ï¼Œæ‰€ä»¥å°±åªå¥½è‡ªå·±åŠ¨æ‰‹å•¦ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-elisp" data-lang="elisp"><span class="line"><span class="cl"><span class="p">(</span><span class="nb">defface</span> <span class="nv">epe-pipeline-delimiter-face</span>
</span></span><span class="line"><span class="cl">  <span class="o">&#39;</span><span class="p">((</span><span class="no">t</span> <span class="nb">:foreground</span> <span class="s">&#34;green&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="s">&#34;Face for pipeline theme delimiter.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">:group</span> <span class="ss">&#39;epe</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nb">defface</span> <span class="nv">epe-pipeline-user-face</span>
</span></span><span class="line"><span class="cl">  <span class="o">&#39;</span><span class="p">((</span><span class="no">t</span> <span class="nb">:foreground</span> <span class="s">&#34;red&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="s">&#34;Face for user in pipeline theme.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">:group</span> <span class="ss">&#39;epe</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nb">defface</span> <span class="nv">epe-pipeline-host-face</span>
</span></span><span class="line"><span class="cl">  <span class="o">&#39;</span><span class="p">((</span><span class="no">t</span> <span class="nb">:foreground</span> <span class="s">&#34;blue&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="s">&#34;Face for host in pipeline theme.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">:group</span> <span class="ss">&#39;epe</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nb">defface</span> <span class="nv">epe-pipeline-time-face</span>
</span></span><span class="line"><span class="cl">  <span class="o">&#39;</span><span class="p">((</span><span class="no">t</span> <span class="nb">:foreground</span> <span class="s">&#34;yellow&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="s">&#34;Face for time in pipeline theme.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">:group</span> <span class="ss">&#39;epe</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åå°±æ˜¯æŒ‰ç€åŸæœ‰çš„ Eshell æç¤ºç¬¦æ¥ç»„è£…ä¸€ä¸ªæ–°çš„ Eshell ä¸»é¢˜äº†ï¼Œç„¶åæŠŠè¿™ä¸ªä¸»é¢˜å®šä¹‰æˆ pipeline (å…¶å®æ˜¯æˆ‘è‡ªå·±ä¹Ÿæ²¡æƒ³å‡ºæ¯”è¾ƒæ–°é¢–çš„åå­—å•¦):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-elisp" data-lang="elisp"><span class="line"><span class="cl"><span class="p">(</span><span class="nb">defun</span> <span class="nv">epe-theme-pipeline</span> <span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="s">&#34;A eshell-prompt theme with full path, smiliar to oh-my-zsh theme.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nb">setq</span> <span class="nv">eshell-prompt-regexp</span> <span class="s">&#34;^[^#\nÎ»]* Î»[#]* &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nf">concat</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nb">if</span> <span class="p">(</span><span class="nv">epe-remote-p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="p">(</span><span class="nb">progn</span>
</span></span><span class="line"><span class="cl">         <span class="p">(</span><span class="nf">concat</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="nv">epe-colorize-with-face</span> <span class="s">&#34;â”Œâ”€[&#34;</span> <span class="ss">&#39;epe-pipeline-delimiter-face</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="nv">epe-colorize-with-face</span> <span class="p">(</span><span class="nv">epe-remote-user</span><span class="p">)</span> <span class="ss">&#39;epe-pipeline-user-face</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="nv">epe-colorize-with-face</span> <span class="s">&#34;@&#34;</span> <span class="ss">&#39;epe-pipeline-delimiter-face</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="nv">epe-colorize-with-face</span> <span class="p">(</span><span class="nv">epe-remote-host</span><span class="p">)</span> <span class="ss">&#39;epe-pipeline-host-face</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">         <span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="p">(</span><span class="nb">progn</span>
</span></span><span class="line"><span class="cl">       <span class="p">(</span><span class="nf">concat</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="nv">epe-colorize-with-face</span> <span class="s">&#34;â”Œâ”€[&#34;</span> <span class="ss">&#39;epe-pipeline-delimiter-face</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="nv">epe-colorize-with-face</span> <span class="p">(</span><span class="nf">user-login-name</span><span class="p">)</span> <span class="ss">&#39;epe-pipeline-user-face</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="nv">epe-colorize-with-face</span> <span class="s">&#34;@&#34;</span> <span class="ss">&#39;epe-pipeline-delimiter-face</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="nv">epe-colorize-with-face</span> <span class="p">(</span><span class="nf">system-name</span><span class="p">)</span> <span class="ss">&#39;epe-pipeline-host-face</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">     <span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nf">concat</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nv">epe-colorize-with-face</span> <span class="s">&#34;]â”€â”€[&#34;</span> <span class="ss">&#39;epe-pipeline-delimiter-face</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nv">epe-colorize-with-face</span> <span class="p">(</span><span class="nf">format-time-string</span> <span class="s">&#34;%H:%M&#34;</span> <span class="p">(</span><span class="nf">current-time</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                            <span class="ss">&#39;epe-pipeline-time-face</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nv">epe-colorize-with-face</span> <span class="s">&#34;]â”€â”€[&#34;</span> <span class="ss">&#39;epe-pipeline-delimiter-face</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nv">epe-colorize-with-face</span> <span class="p">(</span><span class="nf">concat</span> <span class="p">(</span><span class="nv">eshell/pwd</span><span class="p">))</span> <span class="ss">&#39;epe-dir-face</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nv">epe-colorize-with-face</span>  <span class="s">&#34;]\n&#34;</span> <span class="ss">&#39;epe-pipeline-delimiter-face</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nv">epe-colorize-with-face</span> <span class="s">&#34;â””â”€&gt;&#34;</span> <span class="ss">&#39;epe-pipeline-delimiter-face</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nb">when</span> <span class="nv">epe-show-python-info</span>
</span></span><span class="line"><span class="cl">     <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nf">fboundp</span> <span class="ss">&#39;epe-venv-p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nb">and</span> <span class="p">(</span><span class="nv">epe-venv-p</span><span class="p">)</span> <span class="nv">venv-current-name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">         <span class="p">(</span><span class="nv">epe-colorize-with-face</span>
</span></span><span class="line"><span class="cl">          <span class="p">(</span><span class="nf">concat</span> <span class="s">&#34;(&#34;</span> <span class="nv">venv-current-name</span> <span class="s">&#34;) &#34;</span><span class="p">)</span> <span class="ss">&#39;epe-venv-face</span><span class="p">))))</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">epe-git-p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="p">(</span><span class="nf">concat</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nv">epe-colorize-with-face</span> <span class="s">&#34;:&#34;</span> <span class="ss">&#39;epe-dir-face</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nv">epe-colorize-with-face</span>
</span></span><span class="line"><span class="cl">       <span class="p">(</span><span class="nf">concat</span> <span class="p">(</span><span class="nv">epe-git-branch</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="nv">epe-git-dirty</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="nv">epe-git-untracked</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="nb">let</span> <span class="p">((</span><span class="nv">unpushed</span> <span class="p">(</span><span class="nv">epe-git-unpushed-number</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">                 <span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nf">=</span> <span class="nv">unpushed</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                   <span class="p">(</span><span class="nf">concat</span> <span class="s">&#34;:&#34;</span> <span class="p">(</span><span class="nf">number-to-string</span> <span class="nv">unpushed</span><span class="p">)))))</span>
</span></span><span class="line"><span class="cl">       <span class="ss">&#39;epe-git-face</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nv">epe-colorize-with-face</span> <span class="s">&#34; Î»&#34;</span> <span class="ss">&#39;epe-symbol-face</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nv">epe-colorize-with-face</span> <span class="p">(</span><span class="nb">if</span> <span class="p">(</span><span class="nf">=</span> <span class="p">(</span><span class="nf">user-uid</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span> <span class="s">&#34;#&#34;</span> <span class="s">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                           <span class="ss">&#39;epe-sudo-symbol-face</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="s">&#34; &#34;</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="æ€»ç»“"><span class="section-num">4</span> æ€»ç»“</h2>
<p>è¿™æ ·ä¸€ä¸ªæ–°çš„ Eshell ä¸»é¢˜å°±å®Œå·¥äº†ï¼Œç„¶åæˆ‘ç»™ <code>eshell-extra-prompt</code> å‘äº†ä¸€ä¸ª<a href="https://github.com/kaihaosw/eshell-prompt-extras/pull/16">Pull Request</a>, æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š</p>

<figure><a href="/ox-hugo/epe.png">
    
    
    <input type="checkbox" id="zoomCheck-45cf5" hidden>
    <label for="zoomCheck-45cf5">
    
    
    <img class="zoomCheck" loading="lazy" src="/ox-hugo/epe.png"/> 
    
    
    </label></a>
</figure>

<p>Enjoy Emacs, Enjor Tweaking :)</p>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
]]></content:encoded>
    </item>
    <item>
      <title>Shellç¥å™¨fasdä¸Eshellçš„ä¸æœŸè€Œé‡</title>
      <link>https://ramsayleung.github.io/zh/post/2017/fasd-meet-eshell/</link>
      <pubDate>Thu, 02 Mar 2017 00:00:00 -0800</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2017/fasd-meet-eshell/</guid>
      <description>An introduction about tweaking eshell with fasd</description>
      <content:encoded><![CDATA[<blockquote>
<p>fasd - quick access to files and directory</p></blockquote>
<p>ä¹‹å‰ä¸€ä½ Windows ç”¨æˆ·çœ‹åˆ°æˆ‘åœ¨ Shell ä¸‹é¢çš„æ“ä½œï¼Œä»–å¾ˆå¥‡æ€ªï¼Œè§‰å¾—æ˜æ˜å·²ç»æœ‰å›¾å½¢åŒ–ç•Œé¢ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ç”¨è¿™ç§å‘½ä»¤è¡Œå‘¢ï¼Œç›´æ¥ç”¨é¼ æ ‡ç‚¹å‡»ä¸å°±å¾ˆå¥½äº†ä¹ˆã€‚</p>
<p>æˆ‘è§‰å¾—å¾ˆéš¾ç›´æ¥è·Ÿä»–è§£é‡Šï¼Œå› ä¸ºä»–æ²¡æœ‰ç”¨è¿‡Linux/Unix,å®Œå…¨ä¸ç†Ÿæ‚‰å‘½ä»¤è¡Œï¼Œä¸çŸ¥é“å…¶å¼ºå¤§ä¹‹å¤„ï¼Œå…¶é«˜æ•ˆç‡æ˜¯å›¾å½¢åŒ–ç•Œé¢å®Œå…¨æ— æ³•æ¯”æ‹Ÿçš„(å½“ç„¶ï¼Œå‘½ä»¤è¡Œçš„å­¦ä¹ æˆæœ¬å’Œå­¦ä¹ æ›²çº¿è‚¯å®šæ¯”å›¾å‹åŒ–ç•Œé¢é«˜), So I live in terminal.</p>
<p>è€Œä»Šå¤©æˆ‘è¦ä»‹ç»çš„ç¥å™¨ fasd å°±æ˜¯å¯ä»¥è®©å‘½ä»¤è¡Œæ“ä½œå˜å¾—æ›´åŠ é«˜æ•ˆ</p>
<h2 id="fasd"><span class="section-num">1</span> Fasd</h2>
<p>åœ¨ Shell ä¸‹é¢æœ‰éå¸¸å¤šçš„å‘½ä»¤æ“ä½œæ˜¯ä¸æ–‡ä»¶å’Œç›®å½•ç›¸å…³çš„ï¼Œå¦‚æœä½ è¦è¿›å…¥åˆ°å¦å¤–ä¸€ä¸ªç›® å½•ä½ å¯ä»¥ä½¿ç”¨ç›¸å¯¹æˆ–è€…ç»å¯¹è·¯å¾„æ¥è®¿é—®è¯¥ç›®å½•ï¼Œä½†æ˜¯å¦‚æœè¿™æ˜¯ä¸€ä¸ªä¸å½“å‰ç›®å½•ä¸ç›¸å…³çš„ç›® å½•ä½ å°±åªèƒ½é€šè¿‡ç»å¯¹è·¯å¾„æ¥è®¿é—®ã€‚</p>
<p>ä»¥æˆ‘è‡ªå·±çš„ç›®å½•ä¸ºä¾‹ï¼Œå½“å‰ç›®å½•æ˜¯ <strong><em>home/samray</em>.emacs.d/elisp/</strong> ,æˆ‘å¸Œæœ›è®¿é—® <strong>Document</strong> ç›®å½•ä¸‹ä¸€ä¸ªçš„å­ç›®å½• <strong>Python</strong>, æˆ‘å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥è®¿é—®ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">cd</span> ~/Document/Programming/Python
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> /home/samray/Document/Programming/Python
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™å°±æ˜¯æˆ‘éœ€è¦çš„å‘½ä»¤ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡ <strong>tab</strong> è¿›è¡Œç›®å½•åçš„è¡¥å…¨ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯è§‰å¾—è¦è¾“å…¥çš„ä¸œè¥¿å¤ªå¤šäº†(æ­£å¦‚ Larry Wall æ‰€è¯´ï¼Œæ‡’æƒ°æ˜¯ç¨‹åºå‘˜çš„ç¾å¾·). ç„¶åï¼Œæˆ‘å‘ç°äº† <a href="https://github.com/clvv/fasd">Fasd </a>è¿™ä¸ªç¥å™¨ã€‚å®ƒå¯ä»¥è®©æˆ‘åªè¾“å…¥ <strong>Python</strong> å°±è¿›å…¥åˆ°æˆ‘æƒ³è®¿é—®çš„ <strong>Python</strong> ç›®å½•ï¼Œ</p>
<p>ç¥å¥‡å§ï¼:)</p>
<hr>
<p>Fasdä»¥è®¿é—®çš„é¢‘ç¹ç¨‹åº¦å’Œæœ€è¿‘æ˜¯å¦æœ‰è®¿é—®å¯¹æ–‡ä»¶å’Œç›®å½•åˆ†é…ä¼˜å…ˆçº§ï¼Œç„¶åé€šè¿‡åˆ¤æ–­å·²è®¿é—®çš„æ–‡ä»¶ä»¥åŠå…¶ä¼˜å…ˆçº§æ¥åˆ‡æ¢ç›®å½•æˆ–è€…æ‰“å¼€æ–‡ä»¶ï¼Œæ‰€ä»¥å¦‚æœä½ ä¹‹å‰å·²ç»è®¿é—®è¿‡æŸä¸ªç›®å½•.</p>
<p>é‚£ä¹ˆ ä½ å¾ˆå®¹æ˜“å°±å¯ä»¥åˆ‡æ¢åˆ°é‚£ä¸ªç›®å½•</p>
<h3 id="å¸¸ç”¨é€‰é¡¹"><span class="section-num">1.1</span> å¸¸ç”¨é€‰é¡¹</h3>
<ul>
<li>
<p><strong>-a(any)</strong>: åŒ¹é…æ–‡ä»¶å’Œç›®å½•</p>
</li>
<li>
<p><strong>-i(interactive)</strong>: ä»¥äº¤äº’çš„æ–¹å¼é€‰æ‹©æ–‡ä»¶æˆ–è€…ç›®å½•</p>
</li>
<li>
<p><strong>-s(show/search)</strong>: æŒ‰ç…§ä¼˜å…ˆçº§å±•ç¤ºæ–‡ä»¶æˆ–è€…ç›®å½•</p>
</li>
<li>
<p><strong>-e &lt;cmd&gt;</strong>:å¯¹åŒ¹é…çš„æ–‡ä»¶è°ƒç”¨å‘½ä»¤&lt;cmd&gt;</p>
</li>
<li>
<p><strong>-d</strong>:åªåŒ¹é…ç›®å½•</p>
</li>
<li>
<p><strong>-f</strong>:åªåŒ¹é…æ–‡ä»¶
Fasd æ–‡æ¡£è¿˜å»ºè®®ä½ ä¸º fasdçš„å‘½ä»¤é€‰é¡¹è®¾ç½®åˆ«å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">alias</span> <span class="nv">a</span><span class="o">=</span><span class="s1">&#39;fasd -a&#39;</span>        <span class="c1"># any</span>
</span></span><span class="line"><span class="cl"><span class="nb">alias</span> <span class="nv">s</span><span class="o">=</span><span class="s1">&#39;fasd -si&#39;</span>       <span class="c1"># show / search / select</span>
</span></span><span class="line"><span class="cl"><span class="nb">alias</span> <span class="nv">d</span><span class="o">=</span><span class="s1">&#39;fasd -d&#39;</span>        <span class="c1"># directory</span>
</span></span><span class="line"><span class="cl"><span class="nb">alias</span> <span class="nv">f</span><span class="o">=</span><span class="s1">&#39;fasd -f&#39;</span>        <span class="c1"># file</span>
</span></span><span class="line"><span class="cl"><span class="nb">alias</span> <span class="nv">sd</span><span class="o">=</span><span class="s1">&#39;fasd -sid&#39;</span>     <span class="c1"># interactive directory selection</span>
</span></span><span class="line"><span class="cl"><span class="nb">alias</span> <span class="nv">sf</span><span class="o">=</span><span class="s1">&#39;fasd -sif&#39;</span>     <span class="c1"># interactive file selection</span>
</span></span><span class="line"><span class="cl"><span class="nb">alias</span> <span class="nv">z</span><span class="o">=</span><span class="s1">&#39;fasd_cd -d&#39;</span>     <span class="c1"># cd, same functionality as j in autojump</span>
</span></span><span class="line"><span class="cl"><span class="nb">alias</span> <span class="nv">zz</span><span class="o">=</span><span class="s1">&#39;fasd_cd -d -i&#39;</span> <span class="c1"># cd with interactive selection</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ ·ä½ å°±å¯ä»¥é€šè¿‡ <strong>z some-dir</strong> ç›´æ¥è¿›å…¥åˆ°æŸä¸ªç›®å½•æˆ–è€… <strong>zz some-dir</strong> é€‰æ‹©è¿›å…¥æœ‰å¤šä¸ªåŒ¹é…çš„ç‰¹å®šç›®å½•ã€‚</p>
<p>Fasd è¿˜ä¼šåˆ¤æ–­åº”è¯¥æ˜¾ç¤ºæ‰€æœ‰çš„åŒ¹é…é€‰é¡¹æˆ–è€…æ˜¯ç›´æ¥é€‰æ‹©æœ€ä½³åŒ¹é…. ä¾‹å¦‚ä½ ä¹Ÿå¯ä»¥å°†fasdé…åˆ <em>subshell</em> ä½¿ç”¨ï¼Œä¾‹å¦‚æ‰“å¼€ <strong>foo</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">vim <span class="sb">`</span>f foo<span class="sb">`</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åˆæˆ–è€…æ‰“å¼€  <strong>/etc/rc.conf</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">vim <span class="sb">`</span>f rc conf<span class="sb">`</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="ä¾‹å­"><span class="section-num">1.2</span> ä¾‹å­</h3>
<p>ä½ å¯ä»¥å°†fasd é…åˆæ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨ï¼Œä¾‹å¦‚åˆ—ä¸¾ä»¥ <em>py</em> ç»“å°¾çš„æœ€è¿‘è®¿é—®çš„æ–‡ä»¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">f py$
</span></span></code></pre></td></tr></table>
</div>
</div><p>åˆæˆ–è€…ä½¿ç”¨Emacs æ‰“å¼€æœ€è¿‘é¢‘ç¹è®¿é—®çš„æ–‡ä»¶ <em>bar</em></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">f -e emacs bar
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="fasd-plus-eshell"><span class="section-num">2</span> Fasd +Eshell</h2>
<p>fasd çœŸçš„å¯ä»¥å¤§å¹…åº¦æé«˜æ•ˆç‡ï¼Œä½†æ˜¯æˆ‘æœ‰ç‚¹ä¸å¤ªæ»¡æ„çš„æ˜¯ï¼Œæˆ‘æ˜¯ä¸ª Emacser, æˆ‘çš„æ“ä½œåŸºæœ¬æ˜¯åœ¨ Emacs é‡Œå®Œæˆçš„ï¼Œè€Œæˆ‘åœ¨ Emacsé‡Œé¢ä½¿ç”¨çš„ shell æ˜¯ Eshell,Eshell ä¼¼ä¹ä¸èƒ½ä¸ fasd æ— ç¼ç»“åˆï¼Œä¼¼ä¹å¯ä»¥æŠ˜è…¾ä¸€ä¸‹ã€‚</p>
<hr>
<p><strong>z</strong> å’Œ <strong>zz</strong> å‘½ä»¤æ˜¯æ— æ³•åœ¨Eshell é‡Œé¢è¿è¡Œï¼Œå› ä¸º <strong>z</strong> æ˜¯ <strong>fasd_cd</strong> çš„åˆ«åï¼Œè€Œ*fasd_cd* æ˜¯ä¸€ä¸ªshell script å‡½æ•°ï¼ŒEshellæ— æ³•è¿è¡Œè¯¥å‡½æ•°ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">fasd_cd <span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">[</span> <span class="nv">$#</span> -le <span class="m">1</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">then</span>
</span></span><span class="line"><span class="cl">        fasd <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="nb">local</span> <span class="nv">_fasd_ret</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span>fasd -e <span class="s1">&#39;printf %s&#39;</span> <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span><span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">[</span> -z <span class="s2">&#34;</span><span class="nv">$_fasd_ret</span><span class="s2">&#34;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="k">return</span>
</span></span><span class="line"><span class="cl">        <span class="o">[</span> -d <span class="s2">&#34;</span><span class="nv">$_fasd_ret</span><span class="s2">&#34;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">cd</span> <span class="s2">&#34;</span><span class="nv">$_fasd_ret</span><span class="s2">&#34;</span> <span class="o">||</span> <span class="nb">printf</span> %s<span class="se">\n</span> <span class="s2">&#34;</span><span class="nv">$_fasd_ret</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Eshellæ— æ³•è¿è¡Œè¯¥å‡½æ•°ï¼Œå› ä¸ºEshellæ–‡æ¡£çš„åŒ®ä¹ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“å¦‚ä½•ç¼–å†™è·Ÿä¸Šé¢ä»£ç ç­‰ä»·çš„ &ldquo;Eshell script&rdquo;,æ‰€ä»¥å°±ç”¨ elisp å†™ä¸€æ®µåŒæ ·åŠŸèƒ½çš„å‡½æ•°å¥½äº†ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="line"><span class="cl"><span class="p">(</span><span class="nb">defun</span> <span class="nv">samray/eshell-fasd-z</span> <span class="p">(</span><span class="kp">&amp;rest</span> <span class="nv">args</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="s">&#34;Use fasd to change directory more effectively by passing ARGS.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nb">setq</span> <span class="nv">args</span> <span class="p">(</span><span class="nv">eshell-flatten-list</span> <span class="nv">args</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="p">(</span><span class="nb">let*</span> <span class="p">((</span><span class="nv">fasd</span> <span class="p">(</span><span class="nf">concat</span> <span class="s">&#34;fasd &#34;</span> <span class="p">(</span><span class="nf">car</span> <span class="nv">args</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">         <span class="p">(</span><span class="nv">fasd-result</span> <span class="p">(</span><span class="nv">shell-command-to-string</span> <span class="nv">fasd</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">         <span class="p">(</span><span class="nv">path</span> <span class="p">(</span><span class="nv">replace-regexp-in-string</span> <span class="s">&#34;\n$&#34;</span> <span class="s">&#34;&#34;</span> <span class="nv">fasd-result</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">         <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nv">eshell/cd</span> <span class="nv">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nv">eshell/echo</span> <span class="nv">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‡½æ•°åŠŸèƒ½å¾ˆå¿«å°±å†™å¥½äº†ï¼Œå®ç°äº† <strong>z</strong> çš„åŠŸèƒ½ï¼Œä½†æ˜¯åŸæ¥çš„ä»£ç ä¸€ç›´ä¸èƒ½æ­£å¸¸è¿è¡Œï¼ŒæŠ˜è…¾äº†ä¸€ä¸ªå¤šå°æ—¶éƒ½æ²¡è§£å†³ï¼Œè¾“å‡ºä»€ä¹ˆéƒ½æ­£å¸¸ï¼Œæœ€å debug å‘ç°æ˜¯å› ä¸ºæ˜¾ç¤ºçš„è·¯å¾„åé¢å¤šäº†ä¸€ä¸ªæ¢è¡Œç¬¦å³ <strong>/home/samray</strong> å˜æˆäº† <strong>/home/samray\n</strong>,è€Œè¾“å‡ºæ¢è¡Œç¬¦åˆä¸ä¼šæ˜¾ç¤ºï¼ŒçœŸ
çš„å‘ã€‚</p>
<p>æœ€åä¸ºå‘½ä»¤èµ‹äºˆåˆ«åå°±å¯ä»¥åƒåœ¨ <strong>zsh</strong> ä¸‹é‚£æ ·å·¥ä½œäº†ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">alias</span> z <span class="s1">&#39;samray/shell-fasd-z $1&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<p>æ›´å¤šçš„ç”¨æ³•å°±è¦æŸ¥é˜…å®˜æ–¹æ–‡æ¡£äº†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">man fasd
</span></span></code></pre></td></tr></table>
</div>
</div><p>Enjoy Emacs and Shell :)</p>
<p>å‚è€ƒï¼š
<a href="https://github.com/clvv/fasd">https://github.com/clvv/fasd</a></p>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
]]></content:encoded>
    </item>
    <item>
      <title>(ç¿»è¯‘)Mastering Eshell</title>
      <link>https://ramsayleung.github.io/zh/post/2017/master_eshell/</link>
      <pubDate>Tue, 28 Feb 2017 00:00:00 -0800</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2017/master_eshell/</guid>
      <description>An complete instroduction about Eshell</description>
      <content:encoded><![CDATA[<p>Emacs æ”¯æŒè‹¥å¹²ç§shell,ä½†æ˜¯å°±åŠŸèƒ½ä¸°å¯Œåº¦ï¼Œä»¥åŠä¸Emacs çš„é›†æˆç¨‹åº¦è€Œè¨€ï¼Œ
æ— ä¸€èƒ½æœ›Eshellé¡¹èƒŒã€‚</p>
<p>Eshell æ˜¯ä¸€ä¸ªå®Œå…¨ç”±Emacs Lisp ç¼–å†™çš„shell,ä½†æ˜¯ä¸è¦ä»¥ä¸ºè¿™æ ·Eshellåœ¨åŠŸèƒ½ä¸Šå°±ä¼šå…ˆå¤©ä¸è¶³ï¼Œå®ƒèƒ½ä»£æ›¿ç»å¤§éƒ¨åˆ†GNUæ ¸å¿ƒåŠŸèƒ½é›†å’ŒBourne shellå®¶æ—çš„å‘½ä»¤ä»¥åŠç›¸å…³ç‰¹æ€§ã€‚</p>
<p>æ­¤å¤–ï¼Œé€šè¿‡ç”¨Emacs Lisp é‡å†™äº†ç±»ä¼¼ <code>ls</code> å’Œ <code>cp</code> ç­‰å¸¸ç”¨å‘½ä»¤ï¼Œä½¿Eshell å¯ä»¥æˆä¸ºçœŸæ­£çš„è·¨å¹³å°Shell.</p>
<p>ä½†æ˜¯ï¼ŒEshell æœ‰ä¸€ä¸ªå¾ˆå¤§çš„ä¸è¶³ï¼Œé‚£å°±æ˜¯Eshell ä¸¥é‡ç¼ºä¹æ–‡æ¡£ä¸ä¹‹å½¢æˆé²œæ˜å¯¹æ¯”çš„æ˜¯ï¼ŒEmacs åŠå…¶ç”Ÿæ€éƒ½æ‹¥æœ‰ä¸°å¯Œçš„æ–‡æ¡£</p>
<h2 id="overview">Overview</h2>
<p>ä¸Emacs ä¸­çš„å…¶ä»–shell ä¸ä¸€æ ·çš„æ˜¯ï¼ŒEshell ä¸æ˜¯ç»§æ‰¿é»˜è®¤ä¸çš„å­è¿›ç¨‹è¿›è¡Œäº¤äº’çš„ <code>comint-mode</code>
å› ä¸ºEshell ä¸æ˜¯ä¸€ä¸ªå­è¿›ç¨‹ï¼Œæ‰€ä»¥å®ƒå°±æ²¡æœ‰å¿…è¦ä½¿ç”¨ <code>comint-mode</code> äº†ï¼›ä¸è¿‡ä¼¼ä¹è¿™æ˜¯ä»¶
å¥½äº‹ï¼Œå› ä¸ºè¿™æ„å‘³ç€ <code>comint-mode</code> çš„ä¾‹ç¨‹å’Œé’©å­æ˜¯ä¸ä¼šä½œç”¨äºEshell çš„ã€‚</p>
<p>æ­¤å¤–ï¼Œå‡ ä¹æ‰€æœ‰ <code>comint-mode</code> çš„å¸¸ç”¨å‘½ä»¤ï¼Œéƒ½åœ¨Eshell ä¸­é‡æ–°å®ç°äº†ï¼Œå¹¶ä¸”ä½¿ç”¨ç›¸åŒçš„æŒ‰é”®ç»‘å®š.</p>
<p>å½“ç„¶ï¼Œä¹Ÿæœ‰ä¸ºæ•°ä¸å¤šçš„æŒ‰é”®ç»‘å®šæ²¡æœ‰è¿ç§»åˆ°Eshell,ä¾‹å¦‚åœ¨Eshll ä¸­æœç´¢å†å²å‘½ä»¤çš„=comint-history-isearch-backward-regexp= æ˜¯ç»‘å®šåˆ°äº† <code>M-r</code>,
è€ŒåŸæ¥shellä¸­ç›¸åŒåŠŸèƒ½çš„å‘½ä»¤çš„æŒ‰é”®å°±æ˜¯ <code>C-r</code> Eshell å¯ä»¥åœ¨æ‰€æœ‰çš„å¹³å°éƒ½æ­£å¸¸å·¥ä½œ.</p>
<p>å…¶å®å’ŒEshell çœŸæ­£è¿›è¡Œäº¤äº’çš„æ˜¯ä¸€ä¸ªé€šç”¨çš„ä¸­é—´ä»¶(å³ Emacs Lisp/C çš„ä¸€ä¸ªåº“),è€Œè¯¥ä¸­é—´ä»¶åˆä¼šè·Ÿä½ çš„æ“ä½œç³»ç»Ÿè¿›è¡Œé€šä¿¡ï¼Œå¤„ç†ä¾‹å¦‚å¤åˆ¶æ–‡ä»¶ ç­‰ç›¸å…³æ“ä½œã€‚</p>
<p>æ­¤å¤–ï¼Œè¿™ä¸ªä¸­é—´ä»¶ç”šè‡³æ”¯æŒåœ¨Eshell ä¸­ä½¿ç”¨ <code>Tramp</code> çš„ç‰¹æ€§, ç”±äºEmacs æ˜¯è¡€ç»Ÿçº¯æ­£çš„Unix äº§ç‰©ï¼ŒEshell æ˜¯å¯ä»¥é‡ç°ä¾‹å¦‚bash ç­‰ä¼ ç»ŸUnix shell ä»¥åŠ å…¶ä»–GNU å·¥å…·é“¾çš„åŒæ ·åŠŸèƒ½çš„ã€‚</p>
<p>æ­¤å¤–ï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯Windows,ä½ åº”è¯¥æ„Ÿåˆ°åº†å¹¸ï¼Œå› ä¸ºä½ å†ä¹Ÿä¸ç”¨æŠ˜è…¾ <code>cygwin</code> ,ä¹Ÿä¸éœ€è¦ä¸ºè·¨å¹³å°ç§»æ¤Emacs è€Œæ‹…å¿§ä¾èµ–é—®é¢˜ã€‚</p>
<p>äº‹å®ä¸Šï¼Œå¯¹æ¯”=cygwin= çš„bash,åœ¨å¾ˆå¤šæ–¹é¢ï¼ŒEshell å¯¹Windows çš„æ”¯æŒæ˜¯åšå¾—æ›´å¥½æ»´ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä½ ä¸å†éœ€è¦ <code>/cygdrive/c</code> æ¥æ‰©å±•ç›¸åº”çš„åŠŸèƒ½ï¼Œå› ä¸ºEshell è‡ªèº«å°±æ”¯æŒWindows/MS-DOS çš„è·¯å¾„
(æ‰€ä»¥ <code>cd D:</code> æˆ–è€… <code>D:</code> åŒæ ·éƒ½å¯ä»¥è¿›å…¥D ç›˜)</p>
<p>è™½ç„¶Eshell æœ‰å¾ˆå¤šå¥½å¤„ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯è¦åˆ—å‡ºé‚£äº›è®©äººä»¬å¾ˆå›°æƒ‘çš„è§‚ç‚¹(æˆ–è€…è¯´æ˜¯è¯¯è§£):</p>
<ul>
<li>Eshell ä¸æ˜¯ä¸€ä¸ªç»ˆç«¯æ¨¡æ‹Ÿå™¨ï¼Œå®ƒä¸æ˜¯è·Ÿshell è¿›è¡Œé€šä¿¡ï¼Œäº‹å®ä¸Šï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªshell. å®ƒåšçš„æ‰€æœ‰å·¥ä½œï¼Œæ— è®ºæ˜¯åœ¨å±å¹•å±•ç¤ºæ•°æ®ï¼Œè¿˜æ˜¯è·å–ç›®å½•é‡Œé¢çš„ä¿¡æ¯ï¼Œå®ƒéƒ½æ˜¯é€šè¿‡Emacs å®ç°çš„ï¼Œç„¶åEmacsä¼šå†è·Ÿä½ çš„æ“ä½œç³»ç»Ÿè¿›è¡Œé€šä¿¡</li>
<li>ç”±äºEshell è·Ÿå…¶ä»–è¿›ç¨‹é€šä¿¡çš„æ–¹å¼ (ç‰¹åˆ«æ˜¯å¼‚æ­¥é€šä¿¡),æ‰€ä»¥å¯èƒ½å¯¼è‡´å®ƒçš„ç¼“å†²åŒº(Buffers) å’Œå…¶ä»–ä¸­æ–­æ“ä½œå‡ºç°é—®é¢˜</li>
<li>Eshell æ— æ³•ç›´æ¥æ”¯æŒäº¤äº’å‘½ä»¤ (æŒ‰ç…§Eshell çš„è¯´æ³•ï¼Œå«åšâ€œå¯è§†åŒ–å‘½ä»¤â€),ä¾‹å¦‚top ,æ‰€ä»¥ä½ ä¸€å®šè¦å‘Šè¯‰Eshllåº”åœ¨å•ç‹¬çš„ <code>ansi-term</code> å®ä¾‹è¿è¡Œæ­¤ç±»å‘½ä»¤</li>
<li>å®ƒä¸æ˜¯ <code>bash</code> æˆ–è€… <code>zsh</code>,æ›´ä¸æ˜¯ <code>csh</code>,æ‰€ä»¥ä¸è¦åƒæ“ä½œå®ƒä»¬é‚£æ ·æ“ä½œEshell å³ä½¿Eshell è·Ÿå®ƒä»¬çœŸçš„å¾ˆåƒã€‚å› æ­¤ï¼Œå¦‚æœä½ æƒ³æ›´åŠ é«˜æ•ˆåœ°ä½¿ç”¨Eshell,ä½ æœ€å¥½æŠŠå®ƒå½“ä½œä¸€ä¸ªä¸ä¸€æ ·çš„shell</li>
</ul>
<h2 id="commands">Commands</h2>
<p>Eshell æ˜¯å¯ä»¥è°ƒç”¨å‡ ä¹æ‰€æœ‰çš„å·²åŠ è½½çš„elisp å‡½æ•°çš„ï¼›è¿™ç§çµæ´»æ€§æ˜¯å…¶å®ƒshell æ— æ³•æƒ³è±¡çš„ä¹Ÿæ˜¯å®ƒä»¬åŠ›æ‰€ä¸èƒ½åŠçš„ã€‚</p>
<p>äº‹å®ä¸Šï¼Œè¿™ç§åœ¨shell é‡Œé¢è·Ÿelisp å‡½æ•°ç»“åˆçš„ç©æ³•ç†åº”å¾—åˆ°æ›´å¤šäººçš„æ”¯æŒå’Œæ¨å´‡ï¼Œå› ä¸ºå®ƒçœŸçš„å¾ˆé…·(å½“ç„¶ä¹Ÿå¾ˆæœ‰ç”¨).å‡å¦‚ä½ æƒ³åœ¨Emacs é‡Œé¢æ‰“å¼€ <code>foobar.txt</code> ,ä½ åªéœ€è°ƒç”¨ <code>find-file foobar.txt</code>,Eshell å°±ä¼šè°ƒç”¨å¯¹åº”çš„ <code>(find-file &quot;foobar.txt&quot;)</code> ,å¹¶ä¸ºä½ æ‰“å¼€æ–‡ä»¶</p>
<h2 id="technical-details">Technical Details</h2>
<p>æ‰€æœ‰è¢«Eshell æ‰§è¡Œçš„å‘½ä»¤éƒ½æœ‰ä¸€ä¸ªæ‰§è¡Œçš„é¡ºåºï¼Œè¿™æ˜¯å¿…éœ€ä¼ é€’ç»™Emacs çš„æœ‰åºåˆ—è¡¨ï¼Œ
å› ä¸ºè¿™ä¸ªåˆ—è¡¨å†³å®šäº†Eshell çš„å“ªä¸€éƒ¨åˆ†åº”è¯¥å¤„ç†è¯¥å‘½ä»¤çš„ã€‚</p>
<p>å¦‚æœè¯¥åˆ—è¡¨ä¸­æ²¡æœ‰æ‰¾åˆ°å¯ä»¥æ‰§è¡Œä½ çš„æ“ä½œçš„å‡½æ•°æˆ–è€…å¯¹åº”å‘½ä»¤ï¼Œä½ ä¼šè¢«å‘ŠçŸ¥ï¼Œä½ è¾“å…¥çš„æ˜¯æ— æ•ˆå‘½ä»¤</p>
<p>å‡è®¾ ä½ æƒ³è°ƒç”¨ <code>cp</code> å‘½ä»¤ï¼Œè°ƒç”¨é¡ºåºå¦‚ä¸‹ï¼š</p>
<ol>
<li>å®Œæ•´çš„è·¯å¾„ (å³ <code>/bin/cp</code>),åœ¨ <code>/bin</code> ç›®å½•ä¸‹æ‰§è¡Œ <code>cp</code></li>
<li>å¯»æ‰¾å‘½ä»¤çš„å‰ç¼€ï¼Œ <em>eshell-explict-command-char</em> (é»˜è®¤å€¼æ˜¯ &ldquo;=&rdquo;),å¦‚æœæœ‰å‰ç¼€çš„è¯,é‚£ä¹ˆï¼Œåœ¨æœç´¢è·¯å¾„å¯»æ‰¾å¯¹åº”çš„å‘½ä»¤</li>
<li>å¯»æ‰¾shell å‘½ä»¤çš„åˆ«å (<code>alias</code> å‘½ä»¤)</li>
<li>åœ¨æœç´¢è·¯å¾„å¯»æ‰¾ <code>cp</code> ,å³ <code>$PATH</code> (æˆ–è€… <code>eshell-path-env</code>) å®šä¹‰çš„è·¯å¾„</li>
<li>å¯»æ‰¾å«åš <code>cp</code> çš„Lisp å‡½æ•° æˆ–è€… å« <code>eshell/cp</code> çš„elisp å‡½æ•°</li>
</ol>
<p>å˜é‡ <code>eshell-prefer-lisp-functions</code> è®©å†…éƒ¨çš„elisp å‡½æ•°è°ƒç”¨è¦å…ˆäºå¤–éƒ¨è°ƒç”¨ï¼Œè¿™æ„å‘³ç€ï¼Œå½“è¯¥å˜é‡å€¼ä¸º <code>t</code> çš„æ—¶å€™ï¼ŒEshell ä¼š <code>æœ€å…ˆ</code> è°ƒç”¨elisp å‡½æ•°ï¼Œè€Œä¸æ˜¯ =æœ€å=æ‰è°ƒç”¨ï¼›</p>
<p>ä½†æ˜¯ï¼Œå½“å‘½ä»¤å‰ç¼€(å³ <em>eshll-explicit-command-char</em>)è¢«æŒ‡å®šï¼Œè¯¥å˜é‡ä¼šè¢«å¿½ç•¥</p>
<h2 id="built-in-commands">Built-in Commands</h2>
<p>Eshell æœ‰å¾ˆå¤šå¾ˆå¥½ç”¨çš„é€šè¿‡Emacs-Lisp é‡å†™çš„å‘½ä»¤ï¼Œè¿™äº›å‘½ä»¤å®ç°äº†ç»å¤§éƒ¨åˆ†GNU æ ¸å¿ƒå·¥å…·é›†
æˆ–è€…ä½ æ‰€é’Ÿçˆ±çš„shell çš„ç‰¹æ€§ï¼Œæ‰€ä»¥è¿™äº›å‘½ä»¤è¢«ç§°ä¸º&quot;Alias functions&quot;(åˆ«åå‡½æ•°).</p>
<p>ä½†æ˜¯Eshell å¹¶ä¸æ˜¯å…¨ç›˜æ¨¡æ‹Ÿå…¶ä»–Shell çš„åŠŸèƒ½ç‰¹æ€§ï¼Œå¦‚æœä½ ä¼ é€’äº†ä¸€äº›å‚æ•°ï¼Œè¯•å›¾è°ƒç”¨Eshellæœªå®ç°çš„åŠŸèƒ½æ—¶ï¼ŒEshell ä¼šè‡ªåŠ¨è°ƒç”¨å¤–éƒ¨çš„å¯¹åº”çš„å‘½ä»¤æ¥å®ç°ä½ æƒ³è¦çš„åŠŸèƒ½ (å½“ç„¶å‰ææ˜¯ä½ å·²ç»å®‰è£…è¯¥å‘½ä»¤)
ä¸‹é¢åˆ—å‡ºEshell å·²ç»é‡æ–°å®ç°çš„å‘½ä»¤ï¼š
<code>cat</code> , <code>cp</code> , <code>ls</code> , <code>cd</code> , <code>export</code> , <code>dirs</code> , <code>du</code> , <code>echo</code> , <code>env</code> , <code>kill</code>
<code>ln</code> , <code>mkdir</code> , <code>mv</code> , <code>alias</code> , <code>popd</code> , <code>pushd</code> , <code>pwd</code> , <code>rm</code> , <code>rmdir</code>
<code>time</code> , <code>umask</code>.
Eshell æ³¨é‡è·ŸåŸæœ‰çš„GNUå·¥å…·åŠŸèƒ½åŒæ­¥ï¼Œæ‰€ä»¥ä½ ä¸ç”¨æ‹…å¿ƒå› Eshell å‘½ä»¤è·Ÿå…¶ä»–åŸç”ŸShell å‘½ä»¤ä¸ä¸€è‡´è€Œå¯¼è‡´çš„é—®é¢˜</p>
<h2 id="command-interception">Command Interception</h2>
<p>Eshell æœ‰ä¸€ä¸ªå¾ˆcool çš„ç‰¹æ€§ï¼Œé‚£å°±æ˜¯æŸäº›å‘½ä»¤ä¼šè¢«æ‹¦æˆªå¹¶ä¸”ä¼ é€’ç»™Emacs.</p>
<p>è¿™ç§æœºåˆ¶å…è®¸ä½ è°ƒç”¨ä¸€ä¸ªå‘½ä»¤ä¾‹å¦‚ <code>man ls</code>,ä½†æ˜¯çœŸæ­£è°ƒç”¨å¤„ç†çš„æ˜¯Emacs å†…ç½®çš„ <code>man</code>.</p>
<p>æ­¤å¤–ï¼Œå¯¹äºä¹‹å‰æåŠçš„äº¤äº’å¼å‘½ä»¤è€Œè¨€ï¼Œè¿™ç§ç‰¹æ€§æ˜¯å¾ˆé‡è¦çš„ï¼Œå› ä¸ºEshell æ˜¯æ²¡æœ‰èƒ½åŠ›å¤„ç†è¯¥å‘½ä»¤çš„ã€‚</p>
<p>ä½†çœŸæ­£å±•ç°è¯¥ç‰¹æ€§å¨åŠ›çš„è¿˜æ˜¯é‚£ä¹ˆå¤æ‚çš„å‘½ä»¤ï¼Œä¾‹å¦‚ <code>grep</code> <code>diff</code>,å› ä¸ºEmacs æœ¬èº«å°±å†…ç½®äº†æ›´åŠ å¼ºå¤§çš„ <em>grep</em> å’Œ <em>diff</em> å·¥å…·ã€‚</p>
<p>è¿™ç§ç‰¹æ€§çœŸçœŸå®å®å±•ç¤ºäº†Eshell å¯¹æ¯”å…¶ä»–shell çš„å¼ºå¤§ä¹‹å¤„</p>
<p>ä¸‹åˆ—çš„å‘½ä»¤éƒ½ä¼šè¢«é‡å®šå‘åˆ°Emacså†…ç½®çš„åŠŸèƒ½å»ï¼š
<code>agrep</code> , <code>diff</code> , <code>egrep</code> , <code>fgrep</code> , <code>glimpse</code> , <code>grep</code> , <code>info</code> , <code>jobs</code>
<code>locate</code> , <code>man</code> , <code>occur</code> , <code>su</code> , <code>sudo</code> , <code>whoami</code>
<code>su</code> <code>sudo</code> <code>whoami</code> æ˜¯ä¸ <code>TRAMP</code> ç›¸å…³çš„å‘½ä»¤ï¼Œæ‰€ä»¥å¦‚æœä½ æ˜¯è¿æ¥åˆ°è¿œç¨‹shell çš„
è¿™äº›å‘½ä»¤ä¹Ÿæ˜¯å¯ä»¥æ­£å¸¸å·¥ä½œçš„</p>
<h2 id="subshells">Subshells</h2>
<p>ä½ å¯ä»¥ä½¿ç”¨ <code>$()</code> æ¥è°ƒç”¨å‘½ä»¤ï¼Œå¹¶ä¸”æŠŠå‘½ä»¤å¯¹åº”çš„è¾“å‡ºå½“ä½œæ¥ä¸‹æ¥å‘½ä»¤çš„å‚æ•°ï¼Œå°±å¥½åƒä½ åœ¨bash é‚£æ ·ä½¿ç”¨ã€‚</p>
<p>ä½†æ˜¯ä½ è¦è°¨è®°çš„ä¸€æ ·äº‹æƒ…å°±æ˜¯ä½ æ˜¯æ— æ³•ä½¿ç”¨åå¼•å· =``=æ¥ç”Ÿæˆä¸€ä¸ªsubshellçš„ã€‚</p>
<p>è™½ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨åƒè°ƒç”¨subshell çš„è¯­æ³•æ¥è°ƒç”¨æ ‡å‡†çš„elisp form: <code>(form ....)</code> æ³¨æ„æ²¡æœ‰äº† <code>$</code>,ä¸è¿‡æˆ‘å¹¶ä¸æ¨èè¿™ç§ç”¨æ³•ï¼Œå› ä¸ºå¾ˆå¤šæƒ…å†µï¼Œè¿™ç§ç”¨æ³•éƒ½æ˜¯ä¸è¡Œçš„</p>
<h2 id="useful-elisp-commands">Useful Elisp Commands</h2>
<p>Eshell æœ‰ä¸€å¥—å¯ä»¥è®©ä½ æ¯å¤©çš„ç”Ÿæ´»å˜å¾—æ›´ç¾å¥½çš„å¸®åŠ©å‡½æ•°(helper function), æ­¤å¤–ä½ å¯ä»¥åœ¨Eshellè°ƒç”¨å‡ ä¹æ‰€æœ‰çš„elisp å‡½æ•°ï¼Œè¿™å°±æ„å‘³ç€ï¼Œä½ æ‹¥æœ‰æ— ä¸Šçš„èƒ½åŠ›æ¥æ§åˆ¶ä½ çš„shell.</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä¼šåˆ—ä¸¾é‚£äº›ä¸ºEshell ä¸“é—¨ç¼–å†™çš„å‘½ä»¤å’Œä¸€äº›æˆ‘è§‰å¾—å¾ˆæœ‰ç”¨çš„å‘½ä»¤ã€‚</p>
<p>æˆ‘ä¹Ÿç¼–å†™äº†æŒºå¤šçš„elisp å‡½æ•°äº† (éƒ¨åˆ†æ˜¯ä¸“é—¨å†™ç»™Eshell,å…¶ä»–çš„å°±ä¸æ˜¯äº†)</p>
<h3 id="listify-args">listify ARGS</h3>
<p>å°†å­—ç¬¦ä¸²å‚æ•°è§£ææˆ elisp åˆ—è¡¨ç¬¦å·ï¼Œç„¶åæ‰“å°åˆ°å±å¹•ã€‚</p>
<p>è¯¥å‡½æ•°ä¸ä»…å¯ä»¥è§£æ POSIX ç±»å‹çš„å‚æ•°ï¼Œä¹Ÿå¯ä»¥è§£æ MS-DOS/Windows ç±»å‹å‚æ•°</p>
<h3 id="addpath-path">addpath PATH</h3>
<p>å°†å‚æ•° (å¿…é¡»æ˜¯æ–‡ä»¶è·¯å¾„) æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ <code>$PATH</code>,å¦‚æœæ²¡æœ‰å‚æ•°è¢«æŒ‡å®šçš„è¯ï¼Œé‚£ä¹ˆå°†åŸæœ‰çš„å˜é‡å€¼è¾“å‡ºåˆ°å±å¹•</p>
<h3 id="unset-env-var">unset ENV-VAR</h3>
<p>ç§»é™¤å·²æœ‰çš„ç¯å¢ƒå˜é‡</p>
<h3 id="find-file-file">find-file FILE</h3>
<p>æœç´¢æ–‡ä»¶FILE,ç„¶ååœ¨Emacs ä¸­æ‰“å¼€è¯¥æ–‡ä»¶ã€‚è¿™ä¸ªå‡½æ•°ä¸ <code>TRAMP</code> ç›¸å…³ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥è¿œç¨‹å·¥ä½œ</p>
<h3 id="dired-directory">dired DIRECTORY</h3>
<p>åœ¨ç›®å½• <code>DIRECTORY</code> ä¸‹æ‰“å¼€ä¸€ä¸ª dired ç¼“å†²åŒº</p>
<h3 id="calc-eval-expr">calc-eval EXPR</h3>
<p>åœ¨Emacs calculator æ‰§è¡Œè¯¥è¡¨è¾¾å¼ <code>EXPR</code></p>
<h3 id="upcase-str-downcase-str">upcase STR /downcase STR</h3>
<p>å­—ç¬¦ä¸² STR å¤§å°å†™è½¬æ¢</p>
<h3 id="vc-dir-directory">vc-dir DIRECTORY</h3>
<p>å±•ç¤ºåœ¨ç‰ˆæœ¬æ§åˆ¶ä¸‹çš„ç›®å½• <code>DIRECTORY</code> çš„çŠ¶æ€ï¼Œè·Ÿå¤§å¤šæ•°ç‰ˆæœ¬æ§åˆ¶å·¥å…·çš„ <code>status</code> å‘½ä»¤ç›¸åŒ</p>
<h3 id="ediff-files-file1-file2">ediff-files FILE1 FILE2</h3>
<p>ä½¿ç”¨Emacs çš„æ¯”è¾ƒå¼•æ“ (diff engine) ediff,å¯¹æ–‡ä»¶ <code>FILE1</code> <code>FILE2</code> è¿›è¡Œæ¯”è¾ƒ</p>
<h2 id="aliasing">Aliasing</h2>
<p>ä½ å¯ä»¥åƒåœ¨å…¶å®ƒä¸»æµçš„shell é‚£æ ·ç»™Eshellå‘½ä»¤èµ‹äºˆåˆ«åï¼Œæ“ä½œæ˜¯ä¸€æ ·æ»´ï¼Œæ­¤å¤–ï¼Œä½ ç”šè‡³å¯ä»¥æ··åˆä½¿ç”¨elisp å‡½æ•°å’ŒEshell å‘½ä»¤ã€‚</p>
<p><code>alias</code> å‘½ä»¤çš„æ ¼å¼æ˜¯ <code>alias alias-name definition</code> <code>definition</code> å¿…é¡»ç”±ä¸€å¯¹å•å¼•å· <code>''</code> åŒ…å›´ã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶å®ƒshell çš„å‚æ•°å¼•ç”¨å½¢å¼ï¼š</p>
<p>ä¾‹å¦‚ <code>$1</code> æŒ‡ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ <code>$2</code> æŒ‡ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¾æ­¤ç±»æ¨ï¼Œæˆ–è€… <code>$=</code> æŒ‡æ‰€æœ‰çš„å‚æ•°ã€‚
å½“å‚æ•°æ²¡æœ‰åœ¨ <code>definition</code> è¢«å¼•ç”¨ï¼ŒEshell ä¼šè‡ªåŠ¨æŠŠå‚æ•°æ·»åŠ åˆ°å‘½ä»¤çš„æœ«å°¾ï¼Œå¹¶æŠŠå‚æ•°å¿½ç•¥</p>
<p>å¦‚æœæƒ³ç§»é™¤ä¸€æ¡å‘½ä»¤çš„åˆ«åï¼Œåªéœ€ä¸å¯¹å˜é‡ <code>definition</code> èµ‹å€¼ (å³ <code>alias alias-name</code>) åˆ«åå°±ä¼šè¢«è‡ªåŠ¨ç§»é™¤ï¼Œå¦‚æœæƒ³åˆ—å‡ºæ‰€æœ‰çš„åˆ«åï¼Œåªéœ€è¾“å…¥ <code>alias</code></p>
<p>Eshell ä¼šæŠŠå‘½ä»¤çš„åˆ«ååŠå…¶å®šä¹‰å†™å…¥åˆ°å˜é‡ <code>eshell-aliases-file</code> ç„¶åç»Ÿä¸€è¢«å˜é‡ <code>Eshell-directory-name</code> ç®¡ç†ï¼›ç„¶ååˆ«åé»˜è®¤ä¼šè¢«ç»Ÿä¸€å†™å…¥åˆ° <code>~/.Eshell/alias</code>.</p>
<p>æ¯æ¬¡ä½ æ›´æ”¹ä¸€ä¸ªå‘½ä»¤åˆ«åï¼Œéƒ½ä¼šé‡å¤ä¸Šé¢çš„æµç¨‹, å¦å¤–ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„ç‰¹æ€§å°±æ˜¯åˆ«åè‡ªåŠ¨ä¿®æ­£ (<em>auto-correcting aliasing</em>),
å¦‚æœä½ è¾“å…¥ ä¸€ä¸ªæ— æ•ˆçš„å‘½ä»¤å¤ªå¤šæ¬¡ (å˜é‡ <code>eshll-bad-command-tolerance</code> è¡¨ç¤ºè§¦å‘è‡ªåŠ¨æ›´æ­£çš„æœ€ä½ æ¬¡æ•°ï¼Œé»˜è®¤å€¼ä¸º3),Eshellä¼šä¸ºä½ çœŸæ­£æƒ³æ‰§è¡Œçš„å‘½ä»¤æä¾›åˆ«å.</p>
<p>ä¾‹å¦‚ä½ æƒ³è¾“å…¥çš„æ˜¯ <code>cp</code> ä½†æ˜¯è¾“å…¥äº†å¤ªå¤šæ¬¡çš„ <code>co</code>,æ‰€ä»¥ä¸‹æ¬¡ä½ è¾“å…¥ <code>co</code> çš„æ—¶å€™ï¼ŒEshell å°±ä¼šè‡ªåŠ¨æ‰§è¡Œ <code>cp</code>.</p>
<p>å½“ç„¶ï¼Œå¦‚æœä½ ä¸å–œæ¬¢è¿™ç§ç‰¹æ€§çš„è¯ï¼Œä½ å¯ä»¥æŠŠæœ€ä½æ¬¡æ•°è®¾å¾—å¾ˆå¤§</p>
<h3 id="useful-examples">Useful Examples</h3>
<p>è®©æˆ‘ä»¬æŠŠé•¿é•¿çš„ <code>find-file</code> å‘½ä»¤æ˜ å°„åˆ°æ›´é¡ºæ‰‹çš„åˆ«å <code>ff</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">alias</span> ff <span class="s1">&#39;find-file $1&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æŠŠ <code>dired</code> æ˜ å°„åˆ° <code>d</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">alias</span> d <span class="s1">&#39;dired $1&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="visual-commands">Visual Commands</h2>
<p>æœ‰ä¸€äº›å¯¹Eshell è€Œè¨€æ˜¯å¤ªå¤æ‚çš„å‘½ä»¤ï¼ŒEshell æ˜¯æ— æ³•ç›´æ¥æ˜¾ç¤ºçš„ï¼Œæ‰€ä»¥éœ€è¦ç‰¹æ®Šçš„å¤„ç†</p>
<p>ä¾‹å¦‚ <code>top</code> ,æ˜¯æ— æ³•ä¸ä¸€äº›å“‘ç»ˆç«¯(dumb terminal)ä¸€èµ·æ­£å¸¸å·¥ä½œçš„ã€‚</p>
<p>ä¸ºäº†ä½¿è¿™äº›å‘½ä»¤æ­£å¸¸å·¥ä½œï¼ŒEshell ä¼šè¿è¡Œä¸€ä¸ªç»ˆç«¯æ¨¡æ‹Ÿå™¨ <code>term</code> æ¥æ‰§è¡Œè¿™äº›çš„å‘½ä»¤ (å³è¢«ç§°ä¸ºå¯è§†åŒ–çš„å‘½ä»¤)</p>
<p>å¦‚æœä½ æƒ³ä¿®æ”¹å¯è§†åŒ–å‘½ä»¤çš„åˆ—è¡¨ï¼Œä½ å¯ä»¥ä¿®æ”¹å˜é‡ <code>eshell-visual-commands</code></p>
<h2 id="command-history">Command History</h2>
<p>Eshell æœ‰åŠŸèƒ½ä¸°å¯Œçš„å‘½ä»¤è¡Œå†å²æœºåˆ¶ï¼Œä½†æ˜¯å› ä¸ºEshell ä¸æ˜¯ç»§æ‰¿ <code>comint-mode</code> çš„</p>
<p>æ‰€ä»¥ <code>comint-mode</code> ä¸å†å²ç›¸å…³çš„åŠŸèƒ½ï¼ŒEshell æ˜¯æ²¡æ³•ç”¨çš„ï¼Œä¸è¿‡å®ƒç»å¤§éƒ¨ä»½çš„åŠŸèƒ½éƒ½å·²ç»åœ¨Eshell é‡æ–°å®ç°äº†</p>
<h3 id="m-r-m-s">M-r /M-s</h3>
<p>å‘å‰æˆ–è€…å‘åæœç´¢å‘½ä»¤ï¼Œæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼</p>
<h3 id="m-p-m-n">M-p/M-n</h3>
<p>åœ¨å†å²å‘½ä»¤åˆ—è¡¨ä¸­å‰è¿›æˆ–è€…åé€€</p>
<h3 id="c-p-c-n">C-p/C-n</h3>
<p>Eshellä¸Šä¸€æ¡å‘½ä»¤æˆ–è€…ä¸‹ä¸€æ¡å‘½ä»¤</p>
<h3 id="c-c-m-r-c-c-m-s">C-c M-r /C-c M-s</h3>
<p>å›åˆ°ä¸Šä¸€æ¡/ä¸‹ä¸€æ¡å†å²å‘½ä»¤ï¼Œå†å²å‘½ä»¤å¿…é¡»ä¸ç°åœ¨çš„å‘½ä»¤è¾“å…¥ä¸€è‡´ã€‚</p>
<p>ä¾‹å¦‚ç°åœ¨çš„è¾“å…¥æ˜¯ï¼š
<code>ls</code> ,é‚£ä¹ˆå›åˆ°çš„ä¸Šä¸€æ¡ /ä¸‹ä¸€æ¡å†å²å‘½ä»¤å¿…é¡»æ˜¯ <code>ls</code>,æˆ–è€…ä»¥ <code>ls</code> å¼€å¤´çš„å‘½ä»¤ï¼Œå¦‚ <code>lsmod</code></p>
<p>ä¸è¶³çš„æ˜¯ï¼Œæ–°çš„ç»è¿‡ä¿®æ”¹çš„å‘½ä»¤ <code>comint-history-isearch-backward-regexp</code> (åœ¨ <code>comint</code> é”®ç»‘å®šæ˜¯ <code>M-r</code>)åœ¨Eshll æ˜¯æ— æ³•ä½¿ç”¨çš„ï¼Œå› ä¸ºEshell ä¸æ˜¯ç»§æ‰¿äº <code>comint</code> (æ‰€ä»¥åœ¨å‡çº§ä¸­è¢«å¿½ç•¥äº†)</p>
<h2 id="history-interaction">History Interaction</h2>
<p>åƒbash å’Œå…¶å®ƒshell é‚£æ ·ï¼ŒEshell ä¹Ÿæ”¯æŒå†å²çš„ä¿®æ”¹å’Œäº¤äº’ã€‚</p>
<p>å¦‚æœæƒ³è¦çŸ¥é“å†å²äº¤äº’æ˜¯æ€ä¹ˆæ“ä½œçš„ï¼Œä½ å°±éœ€è¦å›å»ç¿»ä¸€ä¸‹ bash çš„æ‰‹å†Œäº†ã€‚æ¥ä¸‹æ¥æˆ‘ä¼šæ€»ç»“ä¸€ä¸‹Eshell å¤§éƒ¨ä»½çš„å†å²äº¤äº’ç”¨æ³•</p>
<h3 id="ef9fcd">!!</h3>
<p>é‡å¤ä¸Šä¸€æ¡å‘½ä»¤</p>
<h3 id="ls">!ls</h3>
<p>é‡å¤ä¸Šä¸€æ¡ä»¥ <code>ls</code> å¼€å¤´çš„å‘½ä»¤</p>
<h3 id="ls">!?ls</h3>
<p>é‡å¤ä¸Šä¸€æ¡åŒ…å« <code>ls</code> çš„å‘½ä»¤</p>
<h3 id="ls-n">!ls:n</h3>
<p>ä»ä¸Šä¸€æ¡ä»¥ <code>ls</code> å¼€å¤´çš„å‘½ä»¤æˆªå–ç¬¬nä¸ªå‚æ•°</p>
<h3 id="ls-tab">!ls&lt;tab&gt;</h3>
<p>ä½¿ç”¨å‘½ä»¤è¡¥å…¨ï¼Œæ˜¾ç¤ºè¡¥å…¨ç»“æœä¸­åŒ…å« <code>ls</code> çš„å‘½ä»¤</p>
<h3 id="old-new">^old^new</h3>
<p>å¿«é€Ÿæ›¿æ¢ï¼Œå¯¹äºä¸Šä¸€æ¡å‘½ä»¤ï¼Œä½¿ç”¨ <code>old</code> æ¥ä»£æ›¿å‘½ä»¤ä¸­çš„ <code>new</code> (å¤‡æ³¨ï¼šä¼¼ä¹æœ‰Bug)</p>
<h3 id="792e5b">$_</h3>
<p>è¿”å›ä¸Šä¸€æ¡æ‰§è¡Œçš„å‘½ä»¤çš„æœ€åä¸€ä¸ªå‚æ•°</p>
<p>Eshll ä¹Ÿæ”¯æŒbash å†å²ä¿®æ”¹(ä¾‹å¦‚ !!:s/old/new/),å¦‚æœä½ æƒ³äº†è§£æ›´å¤šçš„ä¿¡æ¯ï¼Œ
<a href="https://www.gnu.org/software/bash/manual/bash.html#History-Interaction">the bash reference on history interaction</a> å¯ä»¥å‘Šè¯‰ä½ ä½ æƒ³çŸ¥é“çš„ä¸œè¥¿</p>
<h2 id="commandline-interaction">Commandline Interaction</h2>
<h2 id="the-eshell-prompt">The Eshell Prompt</h2>
<p>ä½ å¯ä»¥é€šè¿‡ä¿®æ”¹å˜é‡ <code>eshell-prompt-function</code> æ¥è‡ªå®šä¹‰Eshell çš„æç¤ºç¬¦ï¼›è¯¥å˜é‡
æœ‰ä¸€ä¸ªå‡½æ•°å®šä¹‰äº†Eshell å‘½ä»¤è¡Œæç¤ºç¬¦åº”è¯¥åŒ…å«çš„å†…å®¹ã€‚</p>
<p>é€šè¿‡ç”¨elisp æ¥ç®¡ç†Eshell å‘½ä»¤è¡Œæç¤ºç¬¦çš„é…ç½®ï¼Œä½ å°±å¯ä»¥å®ç°ä½ æƒ³è¦çš„ä»»ä½•ç‰¹æ€§ã€‚</p>
<p>ä½ éœ€è¦æ³¨æ„çš„äº‹æƒ…å°±æ˜¯ï¼šä½ éœ€è¦å‘Šè¯‰Eshell,å‘½ä»¤è¡Œæç¤ºç¬¦é•¿ä»€ä¹ˆæ ·å­ï¼Œæ‰€ä»¥ä½ å¿…é¡»ä¿®æ”¹å˜é‡ <code>eshell-prompt-regexp</code>
,é‚£æ · Eshell å°±ä¼šçŸ¥é“ä½ æƒ³è¦çš„æç¤ºç¬¦é•¿ä»€ä¹ˆæ ·å­äº†</p>
<h2 id="the-commandline">The Commandline</h2>
<p>Eshell å¯ä»¥ä½¿ç”¨åæ–œæ  <code>\</code> æ¥è½¬ä¹‰æ–°è¡Œï¼Œä»¥åŠåŸºæœ¬çš„å¤šè¡Œè¾“å…¥ã€‚</p>
<p>å¦å¤–ä¸€ä¸ªè¾“å…¥å¤šè¡Œçš„æ–‡å­¦å­—ç¬¦ä¸² (literal string)çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨å•å¼•å·ï¼šè¾“å…¥ä¸€ä¸ªå•å¼•å·ï¼Œç„¶åå›è½¦ï¼Œ
æ¥ç€ä½ å°±å¯ä»¥è¾“å…¥ä½ æƒ³è¾“å…¥çš„å†…å®¹ï¼Œæœ€åç”¨å¦å¤–ä¸€ä¸ªå•å¼•å·ç»“æŸè¾“å…¥ã€‚</p>
<p>å¦‚æœä½ ä½¿ç”¨åŒå¼•å·çš„è¯ï¼ŒEshell ä¼šè‡ªåŠ¨å±•å¼€ subshell å‘½ä»¤å¹¶ä¸”å±•å¼€ç›¸åº”çš„å˜é‡å¾—ç›ŠäºEshell çš„è°ƒç”¨æœºåˆ¶ï¼Œä½ ç”šè‡³å¯ä»¥å›å»ç»§ç»­ä¿®æ”¹å¼•å·é‡Œé¢çš„æ–‡æœ¬ã€‚</p>
<p>å½“ä½ æƒ³å›å»ä¿®æ”¹ä½ ä¸å–œæ¬¢çš„å†…å®¹ï¼Œè®©Eshellåƒä½ é¢„æœŸé‚£æ ·å·¥ä½œçš„æ—¶å€™ï¼Œä½ å°±ä¼šè§‰å¾—è¿™ç§ç‰¹æ€§çœŸçš„ç›¸å½“
æœ‰ç”¨</p>
<h2 id="useful-keybindings">Useful Keybindings</h2>
<p>Eshell åšäº†å¾ˆå¤šä¸Eamcs è¿›è¡Œäº¤äº’çš„åŠŸèƒ½çš„æ”¹è¿›ï¼Œè€Œä¸”ï¼Œè¿™äº›æ”¹è¿›è¶³ä»¥å½±å“ä½ çš„ç”Ÿæ´»
è´¨é‡ï¼Œè®©æˆ‘ä¸ºä½ ä¸€ä¸€é“æ¥ï¼š</p>
<h3 id="c-c-m-b">C-c M-b</h3>
<p>å°†å·²ç»æŸä¸ªç¼“å†²åŒºçš„åå­—æ’å…¥åˆ°å½“å‰å…‰æ ‡</p>
<h3 id="c-c-m-i">C-c M-i</h3>
<p>å°†å·²ç»æŸä¸ªè¿›ç¨‹çš„åå­—æ’å…¥åˆ°å½“å‰å…‰æ ‡</p>
<h3 id="c-c-m-v">C-c M-v</h3>
<p>å°†ä¸€ä¸ªç¯å¢ƒå˜é‡çš„åå­—æ’å…¥åˆ°å½“å‰å…‰æ ‡</p>
<h3 id="c-c-m-d">C-c M-d</h3>
<p>åœ¨ç›´æ¥è¾“å…¥å’Œå»¶è¿Ÿè¾“å…¥(å›è½¦ç¡®è®¤)ä¹‹é—´åˆ‡æ¢ (å¯¹ä¸èƒ½ä¸æ¥æºäºå…¶ä»–ç¼“å†²åŒºçš„è¾“å…¥æ­£å¸¸å·¥ä½œ
çš„å‘½ä»¤æ¥è¯´å°±å¾ˆæœ‰ç”¨äº†)</p>
<h2 id="argument-predicates">Argument Predicates</h2>
<p>å‚æ•°è°“è¯æ˜¯ä¸€ä¸ªå¾ˆæ“…é•¿è¿‡æ»¤æ–‡ä»¶ï¼Œç”šè‡³elispåˆ—è¡¨çš„å·¥å…·ã€‚</p>
<p>Eshellçš„è°“è¯è¯­æ³•æ˜¯å‚ç…§zsh çš„ï¼Œæ‰€ä»¥å¦‚æœä½ ç†Ÿæ‚‰zshçš„å‚æ•°è°“è¯ï¼Œä½ ä¹Ÿå¯ä»¥ä»¥åŒæ ·çš„æ–¹å¼æ¥ä½¿ç”¨Eshell.</p>
<p>ä¸Eshell ç»å¤§éƒ¨åˆ†è¿¥å¼‚çš„æ˜¯ï¼Œå‚æ•°è°“è¯æ˜¯æœ‰è¯¦ç»†çš„æ–‡æ¡£çš„ã€‚ä½ å¯ä»¥é€šè¿‡è¾“å…¥ <code>eshell-display-predicate-help</code></p>
<p>æˆ–è€… <code>eshell-display-modifier-help</code> æ¥æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£å‚æ•°è°“è¯ç”¨æ¥è¿‡æ»¤æœ‰ç›¸åŒæ¨¡å¼çš„æ–‡ä»¶æ˜¯å¾ˆæœ‰ç”¨ï¼Œä½ ä¸éœ€å†èŠ±è´¹é¢å¤–çš„æ—¶é—´æ¥ä½¿ç”¨è¯¸å¦‚ <code>find</code> <code>ls</code> æ­¤ç±»å‘½ä»¤ã€‚</p>
<p>è™½ç„¶æœ‰å¸®åŠ©æ‰‹å†Œï¼Œä½†æ˜¯æ‰‹å†Œè¿˜æ˜¯å¾ˆç®€å•ï¼Œä¸å°½äººæ„ï¼Œæ‰€ä»¥æˆ‘è‡ªå·±æ€»ç»“äº†ä¸€äº›ç”¨æ³•æ¥å¸®åŠ©è¯»è€…äº†è§£ç›¸å…³ç‰¹æ€§ã€‚</p>
<p>ä½†æ˜¯æœ€å¥½çš„å­¦ä¹ æ–¹æ³•è¿˜æ˜¯å¤šå°è¯•ï¼Œå¤šå‡ºé”™ï¼Œå¤šæ€»ç»“</p>
<h3 id="syntax-reference">Syntax Reference</h3>
<p>æˆ‘å°±ä¸æŠŠé‚£ä¹ˆå¤šçš„è°“è¯å’Œä¿®é¥°ç¬¦ä¸€ä¸€åˆ—å‡ºæ¥äº†ï¼Œå› ä¸ºEshell çš„æ‰‹å†Œå·²ç»ä½œäº†å¾ˆè¯¦ç»†çš„è§£é‡Šäº†ï¼Œä½ éœ€è¦åšçš„å°±æ˜¯è‡ªå·±æŸ¥çœ‹</p>
<h3 id="globbing">Globbing</h3>
<p>Eshell çš„åŒ¹é…æ¨¡å¼å’Œå…¶ä»–å¸¸ç”¨shell çš„æ˜¯åŸºæœ¬ä¸€è‡´æ»´ï¼šshell ä¼šæ‰©å±•æ–‡ä»¶å’Œè·¯å¾„çš„åŒ¹é… æ¨¡å¼ï¼Œç„¶åå°†åŒ¹é…åçš„åˆ—è¡¨å½“ä½œå‚æ•°ä¼ é€’ç»™ç›¸åº”çš„å‘½ä»¤ï¼Œä¾‹å¦‚ <code>ls</code>.</p>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ ä¸€èµ·ä½¿ç”¨ <code>find</code> å’Œ <code>xargs</code> å‘½ä»¤çš„æ—¶å€™ï¼Œæœ€å¥½è¦æŠŠ <code>-print0</code> ä¼ é€’ç»™ <code>find</code> å¹¶ä¸”æŠŠ <code>-0</code>
ä¼ é€’ç»™ <code>xargs</code>.</p>
<p>å› ä¸ºå¦‚æœä½ ä¸è¿™æ ·åšçš„è¯ï¼Œæ–‡ä»¶åæˆ–è€…è·¯å¾„åä¸­çš„ç‰¹æ®Šå­—ç¬¦æˆ–è€…ç©ºæ ¼å°±ä¼š è®© <code>xargs</code> ä¸çŸ¥é“å¦‚ä½•æ­£ç¡®åœ°å¤„ç†ã€‚é€šè¿‡ä½¿ç”¨ <code>NUL</code> å­—ç¬¦ä½œä¸ºåˆ†éš”ç¬¦ï¼Œä¿è¯å­—ç¬¦å¯ä»¥è¢«æ­£ç¡®åœ°æ ‡è®°ï¼Œå¹¶ä¸”æ–‡ä»¶ä¸­ç´§è·Ÿç€ <code>/</code> çš„ <code>NUL</code> å­—ç¬¦ä¼šè¢«æ ‡è®°ä¸ºæ— æ•ˆå­—ç¬¦</p>
<h3 id="elisp-lists">Elisp Lists</h3>
<p>å¦‚æœä½ æŠŠEshell çš„åˆ—è¡¨ç†è§£æˆè¾“å‡ºçš„ <code>form</code> çš„elispåˆ—è¡¨ï¼Œä½ ä¼šå‘ç°ç†è§£èµ·æ¥å˜å¾—å®¹æ˜“å› ä¸ºäº‹å®ä¸ŠEshell æ˜¯å¯ä»¥é€šè¿‡Elisp æ¥å¤„ç†åˆ—è¡¨çš„ï¼Œè€Œå¤„ç†åˆ—è¡¨æ°æ°æ˜¯Lisp æ“…é•¿çš„ä¸œè¥¿æœ€ç®€å•çš„æ¨¡å¼æ‰©å±•å°±æ˜¯ <code>echo *</code>,è¯¥å‘½ä»¤ä¼šæŠŠå½“å‰æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰åŒ¹é…çš„æ–‡ä»¶ä»¥åˆ—è¡¨çš„å½¢å¼ æ‰“å°å‡ºæ¥ã€‚</p>
<p>å› ä¸ºï¼Œæ­£å¦‚æˆ‘å…ˆå‰æåŠçš„é‚£æ ·ï¼Œé€šé…ç¬¦æ‰©å±•æ˜¯åŒæ­¥ä¸€è‡´è¿›è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘å¯ä»¥åœ¨ åœ¨ä½¿ç”¨ <code>*</code> çš„åŒæ—¶å†ä½¿ç”¨å¦å¤–ä¸€ä¸ªä¿®é¥°ç¬¦ã€‚</p>
<p>ä¾‹å¦‚: æˆ‘ä»¬æŠŠå½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åå˜æˆå¤§å†™çš„å½¢å¼ï¼Œå¹¶ä»¥åˆ—è¡¨çš„å½¢å¼æ‰“å°å‡ºæ¥ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/ $ <span class="nb">echo</span> *<span class="o">(</span>:U<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span><span class="s2">&#34;BAR&#34;</span> <span class="s2">&#34;BIN/&#34;</span> <span class="s2">&#34;DEV/&#34;</span> <span class="s2">&#34;ETC/&#34;</span> <span class="s2">&#34;FOO&#34;</span> <span class="s2">&#34;HOME/&#34;</span> <span class="s2">&#34;LIB/&#34;</span> <span class="s2">&#34;TMP/&#34;</span> <span class="s2">&#34;USR/&#34;</span> <span class="s2">&#34;VAR/&#34;</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯·æ³¨æ„ï¼Œæˆ‘æ˜¯æ€æ ·åœ¨ä½¿ç”¨æ¨¡å¼æ‰©å±•çš„åŒæ—¶ä½¿ç”¨ <code>()</code>.è¿™å¯¹æ‹¬å·å¯ä»¥è®©ä½ ä½¿ç”¨å‚æ•°ä¿®é¥°ç¬¦æˆ–è€… æ˜¯è°“è¯ã€‚</p>
<p>ä¿®é¥°ç¬¦æ˜¯å¯ä»¥ä¿®é¥°ä½ çš„ç»“æœåˆ—è¡¨çš„(å¾ˆæƒŠè®¶å§).</p>
<p>ä¿®é¥°ç¬¦æ€»æ˜¯ä»¥å†’å· <code>:</code> å¼€å¤´æ»´ï¼Œ è€Œè°“è¯å´ä¸ä¸€æ ·ã€‚</p>
<p>æˆ‘ä¼šå±•ç¤ºå¦å¤–ä¸€ä¸ªä¾‹å­ï¼Œè¿™æ¬¡è¿™ä¸ªä¾‹å­æˆ‘ä¼šä½¿ç”¨è°“è¯æ¥è¿‡æ»¤ç›®å½•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/ $ <span class="nb">echo</span> *<span class="o">(</span>^/<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span><span class="s2">&#34;bar&#34;</span> <span class="s2">&#34;foo&#34;</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸ª <code>^</code> åœ¨ä¸Šé¢çš„å‘½ä»¤çš„ä½œç”¨ï¼Œæ˜¯è·Ÿåœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ä¸€æ ·ï¼Œç”¨ä½œå–åï¼Œè€Œæ–œæ çš„ä½œç”¨ <code>/</code>
æ˜¯åªä»£è¡¨ç›®å½•ï¼Œæ‰€ä»¥ä¸Šé¢çš„ä½œç”¨å°±æ˜¯æ‰“å°æ‰€æœ‰æ–‡ä»¶</p>
<p>å¯¹äºä¿®é¥°ç¬¦å’Œè°“è¯ï¼Œæˆ‘ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨æ¨¡å¼æ‰©å±•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/ $ <span class="nb">echo</span> <span class="o">(</span><span class="s2">&#34;foo&#34;</span> <span class="s2">&#34;bar&#34;</span> <span class="s2">&#34;baz&#34;</span> <span class="s2">&#34;foo&#34;</span><span class="o">)(</span>:gs/foo/blarg<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span><span class="s2">&#34;blarg&#34;</span> <span class="s2">&#34;bar&#34;</span> <span class="s2">&#34;baz&#34;</span> <span class="s2">&#34;blarg&#34;</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ¬¡æˆ‘æ˜¯æŠŠæ‰€æœ‰çš„ <code>foo</code> ä»£æ›¿ä¸º <code>blarg</code>.</p>
<p>ä½ å¯ä»¥å‘ç°è¯­æ³•æ˜¯ç›¸åŒçš„ï¼Œåªæ˜¯è¿™æ¬¡æˆ‘ä¸æ˜¯ä½¿ç”¨æ¨¡å¼åŒ¹é…æ¥è·å–æ–‡ä»¶åˆ—è¡¨ï¼Œè€Œæ˜¯ç›´æ¥è¾“å…¥æ–‡ä»¶çš„åˆ—è¡¨.</p>
<p>ä½¿ç”¨å‚æ•°è°“è¯å’Œä¿®é¥°ç¬¦çš„å¥½å¤„æ˜¯ä½ å¤§å¤§å‡å°‘äº†è¾“å…¥çš„å‘½ä»¤è¡Œæ•°é‡ï¼Œå› ä¸ºç”¨è°“è¯å¯ä»¥å¤„ç†æƒé™ ï¼Œå±ä¸»ï¼Œæ–‡ä»¶å±æ€§ï¼Œç”šè‡³æ›´å¤šæ–¹é¢çš„é—®é¢˜</p>
<h3 id="adding-new-modifiers-and-predicates">Adding New Modifiers and Predicates</h3>
<p>ä½ ä¹Ÿå¯ä»¥æ·»åŠ è‡ªå·±çš„è°“è¯ (<code>eshell-predicate-alist</code>)æˆ–è€…ä¿®é¥°ç¬¦ (<code>eshell-modifier-alist</code>):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="line"><span class="cl"><span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">&#39;eshell-modifier-alist</span> <span class="o">&#39;</span><span class="p">(</span><span class="sc">?X</span> <span class="o">.</span> <span class="o">&#39;</span><span class="p">(</span><span class="nb">lambda</span><span class="p">(</span><span class="nv">lst</span><span class="p">)(</span><span class="nf">mapcar</span> <span class="ss">&#39;rot13</span> <span class="nv">lst</span><span class="p">))))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ‘å·²ç»å°† <code>rot13</code> ç»‘å®šåˆ° <code>X</code> äº†ï¼Œæ›¿æ¢ç»“æœå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/ $ <span class="nb">echo</span> <span class="o">(</span><span class="s2">&#34;foo&#34;</span> <span class="s2">&#34;bar&#34;</span> <span class="s2">&#34;baz&#34;</span><span class="o">)(</span>:X<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span><span class="s2">&#34;sbb&#34;</span> <span class="s2">&#34;one&#34;</span> <span class="s2">&#34;onm&#34;</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="plan-9-smart-shell">Plan 9 Smart Shell</h2>
<p>Eshell æœ‰ä¸€ä¸ª <code>Plan 9</code> ç»ˆç«¯çš„å¼±åŒ–ç‰ˆï¼Œå«åš <strong>the Eshell smart display</strong>.</p>
<p>Eshell çš„æ™ºèƒ½å±•ç¤º(smart display)æ„å‘³ç€å®ƒæ”¹è¿›äº†æ‰€æœ‰é»‘å®¢æ‰€ä¹ æƒ¯çš„ <strong>è¾“å…¥ï¼è¿è¡Œï¼ä¿®æ”¹</strong> å·¥ä½œæµç¨‹ã€‚</p>
<p>æ™ºèƒ½å±•ç¤ºç‰¹åˆ«ä¹‹å¤„åœ¨äºï¼ŒEshell çš„å…‰æ ‡ä¸ä¼šåƒæ™®é€šçš„shellé‚£æ ·ï¼Œè½åœ¨ä½ è¿è¡Œ
çš„å‘½ä»¤çš„è¾“å‡ºåé¢ï¼›</p>
<p>ç›¸åï¼Œå…‰æ ‡çš„ä½ç½®ä¼šä¿æŒåœ¨ä½ è¾“å…¥å‘½ä»¤çš„ä½ç½®ï¼Œè®©ä½ å¯ä»¥é€šè¿‡ <code>M-p</code> <code>M-n</code> æˆ–è€…å…¶ä»–ä¿®æ”¹å†å²çš„å‘½ä»¤æ›´å®¹æ˜“åœ°ä¿®æ”¹ä½ è¾“å…¥çš„å‘½ä»¤.</p>
<p>å¦‚æœä½ å¯ç”¨äº† <code>smart display</code> æ¨¡å¼ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨ <code>SPC</code> å‘ä¸‹ç¿»é¡µï¼Œæˆ–è€…ä½¿ç”¨ <code>BACKSPACE</code>
å‘ä¸Šç¿»é¡µæ¥æŸ¥çœ‹é‚£äº›é•¿æ—¶é—´è¿è¡Œçš„å‘½ä»¤çš„è¾“å‡ºã€‚</p>
<p>å¦‚æœä½ æŒ‰ä¸‹äº†ä»»ä½•å…¶å®ƒçš„æŒ‰é”®ï¼Œå…‰æ ‡ä¼šç›´æ¥è·³åˆ°ä½ ç¼“å†²åŒºçš„ç»“å°¾ï¼Œå°±å¥½åƒä½ æ²¡æœ‰å¯ç”¨ <code>smart display</code> è¿è¡Œå‘½ä»¤æ—¶é‚£æ ·</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœEshell æ£€æµ‹åˆ°ä½ æƒ³å›é¡¾æœ€åä¸€æ¡æ‰§è¡Œçš„å‘½ä»¤æ—¶ï¼ŒEshell ä¼šå¾ˆè´´å¿ƒåœ°å¸®ä½ å›é¡¾çš„ï¼Œä½†æ˜¯ï¼Œå¦‚æœä½ æ²¡æœ‰è¿™æ ·çš„è¡Œä¸ºï¼ŒEshell çš„å…‰æ ‡ä¼šç›´æ¥è·³è½¬åˆ°ç¼“å†²åŒºçš„ç»“å°¾.</p>
<p>è¿™ä¹ˆçœ‹æ¥ï¼ŒEshellçœŸçš„å¾ˆæ™ºèƒ½ï¼Œè€Œä¸”å®ƒä¹Ÿæœ‰ä¸€äº›è®¾ç½®å¯ä»¥è®©ä½ å¾®è°ƒç›¸å…³çš„è¡Œä¸ºã€‚</p>
<p>ä½ ä¼šå‘ç°æ™ºèƒ½æ˜¾ç¤º (smart display)çœŸçš„éå¸¸æœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯ä½ å¯ä»¥é€šè¿‡ç§»åŠ¨æŒ‰é”®å°±èƒ½ä¿®æ”¹</p>
<p>åˆšåˆšæ‰§è¡Œè¿‡çš„å‘½ä»¤ï¼›ä¾‹å¦‚ä¿®æ”¹æ‹¼å†™é”™è¯¯çš„å‘½ä»¤æˆ–è€…æ˜¯ç»™ç›¸åº”çš„å‘½ä»¤æ·»åŠ å‚æ•°, æ™ºèƒ½æ˜¾ç¤ºè¿˜å¯ä»¥è¢«è®¾ç½®æˆå½“å‘½ä»¤æˆåŠŸæ‰§è¡Œæ—¶ï¼Œä¸ä½¿ç”¨æ‰©å±•çš„ <code>edit mode</code>;å¹¶ä¸”éšè—å‘½ä»¤è¾“å‡º, å°±å¥½åƒä½ æ‰§è¡Œ <code>chown</code> é‚£æ ·ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯æˆ‘å–œæ¬¢çš„ç©æ³•ï¼Œå¦‚æœä½ ä¹Ÿæƒ³è¯•è¯•è¿™ç§ç©æ³•ï¼Œä½ å¯ä»¥æŠŠä¸‹é¢çš„elisp ä»£ç æ·»åŠ åˆ°ä½ çš„ <code>.emacs</code> æ–‡ä»¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="line"><span class="cl"><span class="p">(</span><span class="nb">require</span> <span class="ss">&#39;eshell</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nb">require</span> <span class="ss">&#39;em-smart</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nb">setq</span> <span class="nv">eshell-where-to-jump</span> <span class="ss">&#39;begin</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nb">setq</span> <span class="nv">eshell-review-quick-commands</span> <span class="no">nil</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nb">setq</span> <span class="nv">eshell-smart-space-goes-to-end</span> <span class="no">t</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æœEshell å·²ç»è¢«åˆå§‹åŒ–(å³ä½ å·²ç»åœ¨Emacsè¿è¡Œäº†ä¸€ä¸ªEshellå®ä¾‹),é‚£æ ·çš„è¯ï¼Œè¿è¡Œ
ä¸Šé¢çš„ä»£ç æ˜¯ä¸ä¼šèµ·ä½œç”¨çš„ã€‚</p>
<p>ä½ å¿…é¡»åœ¨Eshell é‡Œé¢æŒ‰ä¸‹ <code>M-:</code> ç„¶åè¾“å…¥ <code>(shell-smart-initialize)</code> ,æˆ–è€…ç›´æ¥é‡å¯Emacs
æ™ºèƒ½æ˜¾ç¤ºçœŸçš„æ˜¯éå¸¸æœ‰ç”¨çš„ç‰¹æ€§ï¼Œä½†æ˜¯ä½ ä¸€æ—¶åŠåˆ»æ˜¯å¾ˆéš¾å®Œå…¨é¢†ä¼šå…¶å…¨éƒ¨çš„ç²¾å¦™ä¹‹å¤„æ»´ã€‚</p>
<p>ä½ ç›´æ¥è¾“å…¥ä¸€ä¸ªå‘½ä»¤ï¼ŒEshellçš„å…‰æ ‡å°±ä¼šè·³è½¬åˆ°ç¼“å†²åŒºçš„ç»“å°¾ï¼Œæ‰€ä»¥ä½ ä¼šè§‰å¾—å…‰æ ‡ä¼¼ä¹æœ¬æ¥å°±åœ¨é‚£é‡Œ</p>
<h2 id="redirection">Redirection</h2>
<p>Eshell çš„é‡å®šå‘è·Ÿå…¶å®ƒshell çš„å·¥ä½œæ–¹å¼åŸºæœ¬æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯ï¼Œæœ‰ä¸€é¡¹éå¸¸é‡è¦çš„å·®å¼‚å°±æ˜¯Eshell å¿…é¡»æ¨¡æ‹Ÿå¯èƒ½ä¸å­˜åœ¨çš„ä¼ªè®¾å¤‡ï¼Œä¾‹å¦‚Windows å¹³å°ä¸Šçš„ <code>/dev/null</code> å…¶å®æ˜¯ <code>NUL</code></p>
<p>å¦å¤–ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„åœ°æ–¹å°±æ˜¯ï¼šè™½ç„¶Eshell æ”¯æŒé‡å®šå‘ï¼Œä½†æ˜¯åªæ˜¯æ”¯æŒè¾“å‡ºé‡å®šå‘ï¼Œæ˜¯ ä¸æ”¯æŒè¾“å…¥é‡å®šå‘çš„ã€‚</p>
<p>ä¸ºäº†é¿å…è·³è¿›è¾“å…¥é‡å®šå‘è¿™ä¸ªå‘ï¼Œä½ æœ€å¥½ä½¿ç”¨ç®¡é“ã€‚</p>
<p>é‡å®šå‘åˆ°æ ‡å‡†è¾“å…¥ æ ‡å‡†è¾“å‡ºï¼Œæ ‡å‡†é”™è¯¯éƒ½æ˜¯å¯ä»¥æ­£å¸¸å·¥ä½œçš„ï¼Œæ­¤å¤–ï¼Œä½ ä¹Ÿå¯ä»¥é‡å®šå‘åˆ°å¤šä¸ªç›®æ ‡ï¼Œå¾ˆä¸é”™çš„ç‰¹æ€§å§</p>
<h2 id="to-emacs">To Emacs</h2>
<p>å› ä¸ºEshell åœ¨å†…éƒ¨ç”¨Elispé‡æ–°å®ç°äº†å„ç§ä¼ªè®¾å¤‡ï¼Œæ‰€ä»¥ä¹Ÿå°±æ— éœ€è·ŸUnix çš„è®¾å¤‡æ–‡ä»¶æ‰“äº¤é“äº†ï¼Œç”šè‡³ï¼Œå¯ä»¥ç”¨Elispå®ç°è‡ªå·±çš„ä¼ªè®¾å¤‡ã€‚</p>
<p>ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­å°±æ˜¯ï¼Œä½ å¯ä»¥æŠŠé‡å®šå‘åˆ°ä¸€ä¸ªä½ é€‰æ‹©çš„ç¼“å†²åŒºï¼Œç”¨ä¸‹é¢çš„å‘½ä»¤å°±èƒ½å®ç°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/ $ cat mylog.log &gt;&gt; <span class="c1">#&lt;buffer *scratch*&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä¹‹å‰æåˆ°çš„å¿«æ·é”® <code>C-c M-b</code> å°±æ˜¯å¯ä»¥æŠŠä¸€ä¸ªé€‰å®šçš„ç¼“å†²åŒºçš„åå­—æ’å…¥åˆ°å…‰æ ‡å‰</p>
<p>æ­¤å¤–ï¼Œä½ ä¹Ÿå¯ä»¥æŠŠè¾“å‡ºç›´æ¥é‡å®šå‘åˆ°Elisp çš„ç¬¦å·(ä¸è¿‡æ³¨æ„ï¼Œä¸è¦æ‰§è¡Œé”™è¯¯çš„è®¾ç½®)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/ $ <span class="nb">echo</span> foo bar baz &gt; <span class="c1">#&#39;myvar</span>
</span></span><span class="line"><span class="cl">/ $ <span class="nb">echo</span> <span class="k">$(</span>cadr myvar<span class="k">)</span>
</span></span><span class="line"><span class="cl">bar
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æœä½ å°†å˜é‡ <code>eshell-buffer-shorthand</code> è®¾ç½®ä¸º <code>t</code> çš„è¯ã€‚</p>
<p>ä½ å°±å¯ä»¥ä½¿ç”¨ç¼“å†²åŒºçš„é€Ÿè®°å, ä¾‹å¦‚ <code>#'*scratch*'</code>,ä½†æ˜¯ä½ å°±ä¸èƒ½ç›´æ¥é‡å®šå‘åˆ°Elisp çš„ç¬¦å·äº†</p>
<h2 id="to-pseudo-devices">To Pseudo-Devices</h2>
<p>Eshell é‡æ–°å®ç°äº†ä»¥ä¸‹çš„ä¼ªè®¾å¤‡ï¼š</p>
<h3 id="dev-eshell">/dev/eshell</h3>
<p>ä»¥äº¤äº’çš„æ–¹å¼ï¼ŒæŠŠç»“æœè¾“å‡ºåˆ°Eshell</p>
<h3 id="dev-null">/dev/null</h3>
<p>æŠŠç»“æœè¾“å‡ºåˆ° <code>NULL</code> è®¾å¤‡</p>
<h3 id="dev-clip">/dev/clip</h3>
<p>æŠŠç»“æœè¾“å‡ºåˆ°å‰ªåˆ‡æ¿</p>
<h3 id="dev-kill">/dev/kill</h3>
<p>æŠŠç»“æœè¾“å‡ºåˆ° <code>kill ring</code></p>
<p>è·Ÿé€šç”¨çš„shell ä¸€æ ·ï¼Œä½¿ç”¨ <code>&gt;</code> ä»£è¡¨è¦†ç›–(æˆ–è€…æ–°å»º);ä½¿ç”¨ <code>&gt;&gt;</code> ä»£è¡¨è¿½åŠ </p>
<h3 id="to-custom-virtual-target">To custom virtual target</h3>
<p>ä½ é€šè¿‡ä¿®æ”¹å˜é‡ <code>eshell-virtual-targets</code> åˆ›å»ºè‡ªå·±çš„å¯è§†åŒ–ç›®æ ‡(å³å­˜å‚¨ä½ æƒ³åˆ›å»ºçš„ ä¼ªè®¾å¤‡çš„åå­—çš„ä¸€ä¸ªåˆ—è¡¨),ä»¥åŠä¿®æ”¹ä»£è¡¨é‡å®šå‘è¡Œä¸º(å³è¦†ç›–æˆ–è¿½åŠ æˆ–æ’å…¥)çš„å‡½æ•° <code>mode</code></p>
<h2 id="tramp">TRAMP</h2>
<p>Eshell å¯ä»¥å¾ˆå¥½åœ°æ”¯æŒTRAMP,è¿™æ„å‘³ç€å¦‚æœEshell æ‰€åœ¨çš„ç›®å½•æ˜¯åœ¨è¿œç¨‹æœåŠ¡å™¨çš„è¯ï¼Œ åƒ <code>su</code> <code>sudo</code> <code>whoami</code> è¿™æ ·çš„å‘½ä»¤ä¼šè‡ªåŠ¨ä½œç”¨åœ¨è¿œç¨‹æœåŠ¡å™¨</p>
<p>æƒ³ç›´æ¥ä½¿ç”¨TRAMP,ä½ å¯ä»¥åƒä½¿ç”¨ <code>C-x C-f</code> å¯»æ‰¾æ–‡ä»¶é‚£æ ·è¾“å…¥TRAMPçš„å‘½ä»¤ç¬¦ï¼Œç„¶åä½ å°±å¯ä»¥ä½¿ç”¨TRAMP äº†ã€‚</p>
<p>è™½ç„¶ä½ ä¼šè§‰å¾—Eshellé‡Œé¢ä½¿ç”¨TRAMPæœ‰ç‚¹å¥‡æ€ªï¼Œä½†æ˜¯ä½ çš„ç¡®å¾—åˆ°äº† ä¸€ä¸ªTRAMPçš„è¿œç¨‹shell,ä¸æ˜¯ä¹ˆï¼Ÿ</p>
<p>æ­¤å¤–ï¼Œä½ ä¸åº”æŠŠTRAMPå±€é™åœ¨ä½¿ç”¨è¿œç¨‹shell, ä½ å¯ä»¥åœ¨æœ¬åœ° ä½¿ç”¨ <code>sudo</code> å’Œ <code>su</code> å‘½ä»¤çš„</p>
<p>æœ‰å…³TRAMP çš„æ›´è¯¦ç»†çš„ç”¨æ³•ï¼Œæˆ‘æ€»ç»“åœ¨äº†å¦å¤–ä¸€ç¯‡æ–‡ç« ï¼Œä¸è¿‡å¦‚æœä½ è¿«ä¸åŠå¾…æƒ³äº†è§£æ›´å¤š
æœ‰å…³TRAMPçš„ç”¨æ³•ï¼Œ<a href="http://www.gnu.org/software/tramp/">å®˜æ–¹æ‰‹å†Œ</a> æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©</p>
<h2 id="startup-scripts">Startup Scripts</h2>
<p>è·Ÿå…¶å®ƒçš„shell ä¸€æ ·ï¼ŒEshell ä¹Ÿæ”¯æŒ <code>login</code> å’Œ <code>profile</code> çš„é…ç½®æ–‡ä»¶ã€‚</p>
<p><code>login</code> å’Œ <code>profile</code> é…ç½®æ–‡ä»¶çš„ç»å¯¹è·¯å¾„åˆ†åˆ«ä¿å­˜åœ¨å˜é‡ <code>eshell-login-script</code> å’Œ <code>eshell-rc-script</code>
ä¸è¿‡é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸Šè¿°ä¸¤ä¸ªé…ç½®æ–‡ä»¶éƒ½ä¿å­˜åœ¨ <code>~/.eshell/</code>.</p>
<p>é¡ºä¾¿è¯´ä¸€ä¸‹ï¼ŒEshellçš„é…ç½®æ–‡ä»¶ä¹Ÿæ˜¯ä½¿ç”¨ <code>#</code> æ¥æ³¨é‡Šå˜é‡å’Œè¯­å¥çš„</p>
<h2 id="more-customization">More Customization</h2>
<p>å¦‚æœä½ æƒ³æŠ˜è…¾çš„è¯ï¼ŒEshell æœ‰æˆç™¾ä¸Šåƒçš„é€‰é¡¹ä¾›ä½ é€‰æ‹©ã€‚</p>
<p>å¦‚æœä½ æƒ³é…ç½®Eshell çš„è¯ï¼ŒæŒ‰ä¸‹ <code>M-x</code> ç„¶åè¾“å…¥ <code>customize-group</code> å›è½¦ï¼Œç„¶åè¾“å…¥ <code>eshell</code> å›è½¦ç¡®è®¤</p>
<h2 id="conclusion">Conclusion</h2>
<p>é¢ï¼Œæˆ‘è§‰å¾—æˆ‘å·²ç»æ€»ç»“äº†Eshell çš„å¤§éƒ¨ä»½ç”¨æ³•äº†ï¼Œå¸Œæœ›ä½ å¯ä»¥åœ¨å…¶ä¸­å‘ç°ä¹è¶£ã€‚</p>
<p>å› ä¸ºä¸Emacs çš„ç´§å¯†ç»“åˆï¼ŒEshell æœ‰äº†å„ç§å„æ ·çªå‡ºå¥½ç”¨çš„ç‰¹æ€§ï¼Œä½†æ˜¯ä½ éœ€è¦ç†è§£çš„æ˜¯ï¼ŒEshell çš„è¯ç”Ÿä¸æ˜¯
ä¸ºäº†å…¨ç›˜å–ä»£bash æˆ–è€…å…¶å®ƒä½ å–œæ¬¢çš„ç»ˆç«¯æ¨¡æ‹Ÿå™¨ï¼Œå®ƒåªæ˜¯å¸Œæœ›åœ¨Emacs é‡Œé¢å°±å¯ä»¥å®Œæˆæˆ‘ä»¬
æ—¥å¸¸å¿…éœ€çš„å‘½ä»¤è¡Œæ“ä½œã€‚</p>
<p>å¦‚æœä½ è¦è¿è¡Œå¾ˆå¤šäº¤äº’å¼çš„å‘½ä»¤ï¼ŒEshell å°±å¯èƒ½ä¸æ˜¯å¾ˆæœ‰ç”¨äº† å› ä¸ºä¸ºäº†è¿è¡Œä½ è¾“å…¥çš„æ¯ä¸€æ¡å¯è§†åŒ–å‘½ä»¤ï¼ŒEshell éƒ½ä¼šåœ¨Emacs é‡Œé¢å¯åŠ¨ä¸€ä¸ªæ–°çš„ç»ˆç«¯æ¨¡æ‹Ÿå™¨ã€‚</p>
<p>Eshell æœ‰TRAMPæ”¯æŒï¼Œè‡ªå®šä¹‰ä¼ªè®¾å¤‡ï¼Œè¢–ççš„elisp REPLå’Œå¾ˆå¤šéå¸¸æœ‰ç”¨çš„å‘½ä»¤ï¼Œä¾‹å¦‚å¯¹ä½ æ‰“å¼€çš„æ–‡ä»¶æˆ–è€…ç›®å½•ï¼Œè°ƒç”¨ <code>find-file</code> æˆ–è€… <code>dired</code>.æ­£æ˜¯è¿™ç§ç§æœ‰ç”¨çš„ç‰¹æ€§ï¼Œ è®©Eshell æˆä¸ºæˆ‘å·¥å…·ç®±é‡Œé¢ä¸€ä¸ªéå¸¸å¯é çš„å·¥å…·ã€‚</p>
<p>åŸæ–‡åœ°å€ <a href="https://www.masteringemacs.org/article/complete-guide-mastering-eshell">Mastering Eshell</a> ,åœ¨ä¸‹ç¿»è¯‘æ°´å¹³æœ‰é™ï¼Œå¦‚æœ‰é”™è¯¯ï¼Œè¿˜æœ›æŒ‡å‡º</p>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
]]></content:encoded>
    </item>
  </channel>
</rss>
