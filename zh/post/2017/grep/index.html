<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Linux/Unix Shell 二三事之过滤器grep | 菠萝油与天光墟</title>
<meta name=keywords content="shell,linux,grep"><meta name=description content="an introduction about grep"><meta name=author content="Ramsay Leung"><link rel=canonical href=https://ramsayleung.github.io/zh/post/2017/grep/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.756d16b9d1a19b0d7274ca93e0428bf24ca10b144104611c6875be78291ca07b.css integrity="sha256-dW0WudGhmw1ydMqT4EKL8kyhCxRBBGEcaHW+eCkcoHs=" rel="preload stylesheet" as=style><link rel=icon href=https://ramsayleung.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ramsayleung.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ramsayleung.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://ramsayleung.github.io/apple-touch-icon.png><link rel=mask-icon href=https://ramsayleung.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://ramsayleung.github.io/zh/post/2017/grep/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css integrity=sha384-5TcZemv2l/9On385z///+d7MSYlvIEw9FuZTIdZ14vJLqWphw7e7ZPuOiCHJcFCP crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js integrity=sha384-cMkvdD8LoxVzGF/RPUKAcvmm49FQ0oxwDF3BGKtDXcEc+T1b2N+teh/OJfpU0jr6 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js integrity=sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-9MG65HQHEL"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-9MG65HQHEL")}</script><meta property="og:url" content="https://ramsayleung.github.io/zh/post/2017/grep/"><meta property="og:site_name" content="菠萝油与天光墟"><meta property="og:title" content="Linux/Unix Shell 二三事之过滤器grep"><meta property="og:description" content="an introduction about grep"><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2017-03-13T00:00:00-07:00"><meta property="article:modified_time" content="2025-01-09T17:37:12-08:00"><meta property="article:tag" content="Shell"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Command_line"><meta property="og:image" content="https://ramsayleung.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ramsayleung.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Linux/Unix Shell 二三事之过滤器grep"><meta name=twitter:description content="an introduction about grep"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ramsayleung.github.io/zh/post/"},{"@type":"ListItem","position":2,"name":"Linux/Unix Shell 二三事之过滤器grep","item":"https://ramsayleung.github.io/zh/post/2017/grep/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Linux/Unix Shell 二三事之过滤器grep","name":"Linux\/Unix Shell 二三事之过滤器grep","description":"an introduction about grep","keywords":["shell","linux","grep"],"articleBody":"文本三剑客之 Grep\ngrep - print lines matching a pattern\n今天我想聊聊 grep 这个命令；据说，有Unix/Linux 的地方就会有 grep, 这个可能是安装得最广泛的命令之一；那么 grep 是用来干什么的呢？\ngrep 其实是用来在文件中搜索特定内容或者模式的工具(配合正则表达式“食用”，味道更佳 :))现在就来一起看看*grep* 的用法\n1 基本用法 1.1 基础用法 现在假设有一个简单的文本文件(双城记开头)tinytale.txt,内容如下\nit was the best of times it was the worst of times it was the age of wisdom it was age of foolishness it was the epoch of belief it was the epoch of incredulity it was the season of light it was the season of darkness IT WAS THE SPRING OF HOPE IT WAS THE WINTER OF DESPAIRE\n现在开始介绍 grep 的基本用法： grep 的基本用法很简单的，假设我想要搜索单词 darkness\n1 grep darkness /tmp/tinytale.txt 输出如下：\n1 it was the season of light it was the season of darkness 1.2 结合正则表达式 默认情况下， grep 是开启正则表达式的模式的，所以你可以直接在文件搜索中使用 正则表达式。现在在文件中搜索以字母 e 开头后接三个字符，然后以 h 结尾的单词：\n1 grep \"e...h\" /tmp/tinytale.txt 输出如下：\n1 it was the epoch of belief it was the epoch of incredulity 可以看到，正则表达式匹配了 epoch 这个单词。正则表达式的威力无与伦比的，把 grep*和正则表达式结合起来可以更好地发挥 *grep 这个工具的潜力；而本文主要是介绍 grep, 更多有关正则表达式的用法不细讲了\n1.3 统计出现的次数 有时，如果你需要统计某种模式或者某个单词出现的个数，你会发现 grep 非常有用；\n要实现该功能，只需给 grep 添加 -c 参数；例如统计单词 the 出现的个数：\n1 grep -c the /tmp/tinytale.txt 结果输出如下：\n1 4 文本中包含4个 the\n1.4 忽略大小写 前面提到， grep 默认是使用正则表达式来搜索文件的，所以 grep 是区分大小写的；\n如果你想修改 grep 的默认行为来忽略大小写，你可以添加 -i 参数\n1 grep -i the /tmp/tinytale.txt 输出结果如下：\n1 2 3 4 5 it was the best of times it was the worst of times it was the age of wisdom it was age of foolishness it was the epoch of belief it was the epoch of incredulity it was the season of light it was the season of darkness IT WAS THE SPRING OF HOPE IT WAS THE WINTER OF DESPAIRE 可以发现 THE 也是可以被 grep 搜索到的；但是如果没有添加 -i ,你只会看到4行输出。\n当然你可以在正则表达式里面添加忽略大小写的模式，只是直接添加 -i 会简单很多。\n2 搜索多个文件 上面搜索的都只是单个文件，而 grep 可以让你同时搜索多个文件；现在就来看看怎么搜索多个文件吧。\n下面两种写法结果都是一样的，但是我个人推崇第一种，因为可以输入更少一些内容 :)\n1 grep belief /tmp/{tinytale.txt,tale.txt} 1 grep belief /tmp/tinytale.txt /tmp/tale.txt 输出结果如下：\n1 2 3 4 5 6 7 tinytale.txt:it was the epoch of belief it was the epoch of incredulity tale.txt:it was the epoch of belief it was the epoch of incredulity tale.txt:pains of by rearing her in the belief that her father was dead tale.txt:this was no passive belief but an active weapon which they flashed tale.txt:belief in solomon deducting a mere trifle for this slight mistake tale.txt:you will bear testimony to what i have said and to your belief in it tale.txt:herself into the show of a belief that they would soon be reunited 可以看到， grep 把匹配到单词的那一行内容和对应的文件都显示出来了，你就可以很方便地看到搜索结果，并知道匹配单词的来源。\n如果你也像我这样，不想输入那么多的内容，你可以使用正则表达式匹配所有的文本文件，如下：\n1 grep belief /tmp/*.txt 输出结果也会跟上面一致 (假设你 tmp 目录下只有两个文本文件); 我告诉*grep* 搜索*/tmp* 下所有的 .txt 文件。\n2.1 递归搜索 你也可以使用 grep 递归搜索目录；你只需在指定目录后，添加 -R , grep 就会 递归搜索指定目录的所有子目录。我已经把当前目录切换到 /tmp:\n1 grep -R \"belief\" . 输出结果如下：\n1 2 3 4 5 6 7 ./tale.txt:it was the epoch of belief it was the epoch of incredulity ./tale.txt:pains of by rearing her in the belief that her father was dead ./tale.txt:this was no passive belief but an active weapon which they flashed ./tale.txt:belief in solomon deducting a mere trifle for this slight mistake ./tale.txt:you will bear testimony to what i have said and to your belief in it ./tale.txt:herself into the show of a belief that they would soon be reunited ./tinytale.txt:it was the epoch of belief it was the epoch of incredulity 结果展示了一系列在当前目录和子目录匹配 belief 的文件。此外你也可以排除掉某些你 不需要搜索的文件，例如有一个 foo.xml 的文件，里面也可能会有 belief 这个单词， 但是你就是不想搜索这个文件，或者全部的 .xml 文件，你可以这么玩：\n1 grep -R --exclude=\"*.xml\" \"belief\" . 3 在标准输入搜索 grep 也是过滤器，所以 grep 自然而然具有处理标准输入输出的能力了；处理其他命令的输出结果也是 grep 非常常用的场景之一。假设你现在的 vim 突然卡顿，挂了:),你想要 kill 掉 vim 的进程，你可以：\n1 ps -e|grep vim 结果输出如下：\n1 samray 21939 1 0 19:42 ? 00:00:00 gvim 其中第一条记录就是你想要搜索的进程了，你运行 kill 21939 就可以杀掉 vim 的进程了；因为我系统的是图型化界面的 vim, 所以是 gvim.\n正如我之前的文章提到的那样，单纯的过滤器的用处似乎不大，但是如果结合起来就会威力无穷至于，如何结合，就需要慢慢探索了。\n4 反向搜索 现在执行的搜索都是匹配搜索，即将匹配的内容显示出来，而 grep 还有反向搜索的功能 (invert Searches)就是将不包含有指定模式的内容显示出来。\n该功能在用来修改有很多注释的配置文件时特别有用；例如常用的服务器软件 nginx 的配置文件是默认是含有很多注释的，如下\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 #user www-data; worker_processes auto; pid /run/nginx.pid; include /etc/nginx/modules-enabled/*.conf; events { worker_connections 1024; # multi_accept on; } http { ## # Basic Settings ## sendfile on; tcp_nopush on; tcp_nodelay on; keepalive_timeout 65; types_hash_max_size 2048; # server_tokens off; # server_names_hash_bucket_size 64; # server_name_in_redirect off; include /etc/nginx/mime.types; default_type application/octet-stream; ## # SSL Settings ## ssl_protocols TLSv1 TLSv1.1 TLSv1.2; # Dropping SSLv3, ref: POODLE ssl_prefer_server_ciphers on; ## # Logging Settings ## log_format main '$remote_addr - $remote_user [$time_local] \"$request\" $status $bytes_sent \"$http_referer\" \"$http_user_agent\" \"$gzip_ratio\"'; access_log /var/log/nginx/access.log; error_log /var/log/nginx/error.log; ## # Gzip Settings ## gzip on; gzip_disable \"msie6\"; # gzip_vary on; # gzip_proxied any; # gzip_comp_level 6; # gzip_buffers 16 8k; # gzip_http_version 1.1; # gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript; ## # Virtual Host Configs ## include /etc/nginx/conf.d/*.conf; include /etc/nginx/sites-enabled/*; ignore_invalid_headers on; client_header_timeout 240; client_body_timeout 240; send_timeout 240; client_max_body_size 100m; proxy_buffer_size 128k; proxy_buffers 8 128k; upstream tomcat_server{ server 127.0.0.1:8080 fail_timeout=0; } upstream gunicorn_server{ server 127.0.0.1:5000 fail_timeout=0; } server{ server_name 127.0.0.1; listen 443; # ssl on; # ssl_certificate /etc/letsencrypt/live/samray.ren/fullchain.pem; # ssl_certificate_key /etc/letsencrypt/live/samray.ren/privkey.pem; location / { # Forward SSL so that Tomcat knows what to do proxy_set_header X-Forwarded-Host $host; proxy_set_header X-Forwarded-Server $host; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_pass http://tomcat_server; proxy_set_header X-Forwarded-Proto https; proxy_redirect off; proxy_connect_timeout 240; proxy_send_timeout 240; proxy_read_timeout 240; } location /test{ return 402; } location /weixin { # try_files $uri @proxy_to_app; return 402; } location @proxy_to_app { proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header Host $http_host; proxy_redirect off; proxy_pass http://gunicorn_server; } } } #mail { #\t# See sample authentication script at: #\t# http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript # #\t# auth_http localhost/auth.php; #\t# pop3_capabilities \"TOP\" \"USER\"; #\t# imap_capabilities \"IMAP4rev1\" \"UIDPLUS\"; # #\tserver { #\tlisten localhost:110; #\tprotocol pop3; #\tproxy on; #\t} # #\tserver { #\tlisten localhost:143; #\tprotocol imap; #\tproxy on; #\t} #} 里面实在有太多的注释了，虽说是很好的参考，但是看多了会感觉很碍眼，所以你希望可以有一份没有注释的配置文件，你就可以使用 grep 和参数 -v:\n1 egrep -v \"#|^$\" /etc/nginx/nginx.conf \u003e/tmp/nging.conf 结果如下：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 worker_processes auto; pid /run/nginx.pid; include /etc/nginx/modules-enabled/*.conf; events { worker_connections 1024; } http { sendfile on; tcp_nopush on; tcp_nodelay on; keepalive_timeout 65; types_hash_max_size 2048; include /etc/nginx/mime.types; default_type application/octet-stream; ssl_prefer_server_ciphers on; log_format main '$remote_addr - $remote_user [$time_local] \"$request\" $status $bytes_sent \"$http_referer\" \"$http_user_agent\" \"$gzip_ratio\"'; access_log /var/log/nginx/access.log; error_log /var/log/nginx/error.log; gzip on; gzip_disable \"msie6\"; include /etc/nginx/conf.d/*.conf; include /etc/nginx/sites-enabled/*; ignore_invalid_headers on; client_header_timeout 240; client_body_timeout 240; send_timeout 240; client_max_body_size 100m; proxy_buffer_size 128k; proxy_buffers 8 128k; upstream tomcat_server{ server 127.0.0.1:8080 fail_timeout=0; } upstream gunicorn_server{ server 127.0.0.1:5000 fail_timeout=0; } server{ server_name 127.0.0.1; listen 443; location / { proxy_set_header X-Forwarded-Host $host; proxy_set_header X-Forwarded-Server $host; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_pass http://tomcat_server; proxy_set_header X-Forwarded-Proto https; proxy_redirect off; proxy_connect_timeout 240; proxy_send_timeout 240; proxy_read_timeout 240; } location /test{ return 402; } location /weixin { return 402; } location @proxy_to_app { proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header Host $http_host; proxy_redirect off; proxy_pass http://gunicorn_server; } } } egrep 是 grep 的扩展，你也可以通过 -E 使用扩展功能。就这样，你就可以得到一份很“干净”的配置文件了。\n5 小结 在以前 grep 是 hacker 工具箱里面审查源代码必不可少的工具之一，但是随着技术的发展，似乎对比其他同类型的工具， grep 的性能已经难尽人意，特别是对比 ag 这个搜索神器；\n虽说很多人都已经转移到了 ag 阵营，但是因为 grep 被广泛预装到各类的Linux/Unix 机器，所以 grep 还是使用得很广泛滴。\n更多 grep 的用法就需要查询手册了：\n1 man grep Enjoy Shell :)\n公号同步更新，欢迎关注👻 ","wordCount":"2709","inLanguage":"zh","image":"https://ramsayleung.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2017-03-13T00:00:00-07:00","dateModified":"2025-01-09T17:37:12-08:00","author":{"@type":"Person","name":"Ramsay Leung"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ramsayleung.github.io/zh/post/2017/grep/"},"publisher":{"@type":"Organization","name":"菠萝油与天光墟","logo":{"@type":"ImageObject","url":"https://ramsayleung.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ramsayleung.github.io/zh/ accesskey=h title="Home (Alt + H)"><img src=https://ramsayleung.github.io/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://ramsayleung.github.io/en/ title=English aria-label=English>En</a></li></ul></div></div><ul id=menu><li class=dropdown><a href=https://ramsayleung.github.io/zh/categories/ title="系列 "><span>系列 ▾</span></a><div class="menu-more-content dropdown-content"><a href=https://ramsayleung.github.io/zh/categories/%E5%BE%97%E5%A4%B1%E6%84%9F%E6%82%9F/ title=得失感悟><span>得失感悟
</span></a><a href=https://ramsayleung.github.io/zh/categories/%E6%97%85%E5%8A%A0%E7%BB%8F%E5%8E%86 title=旅加经历><span>旅加经历
</span></a><a href=https://ramsayleung.github.io/zh/categories/%E5%B7%A5%E4%BD%9C%E6%B5%81/ title=我的工作流><span>我的工作流
</span></a><a href=https://ramsayleung.github.io/zh/categories/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6/ title=测试技能进阶><span>测试技能进阶
</span></a><a href=https://ramsayleung.github.io/zh/categories/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B%E5%B8%88%E7%9A%84%E8%BD%AF%E6%8A%80%E8%83%BD%E6%8C%87%E5%8C%97/ title=软件工程师的软技能指北><span>软件工程师的软技能指北
</span></a><a href=https://ramsayleung.github.io/zh/categories/reinvent-%E9%87%8D%E6%96%B0%E9%80%A0%E8%BD%AE%E5%AD%90%E7%B3%BB%E5%88%97 title=Reinvent-重新造轮子系列><span>Reinvent-重新造轮子系列</span></a></div></li><li><a href=https://ramsayleung.github.io/zh/archives/ title=归档><span>归档</span></a></li><li><a href=https://ramsayleung.github.io/zh/search/ title=搜索><span>搜索</span></a></li><li><a href=https://ramsayleung.github.io/zh/tags/ title=标签><span>标签</span></a></li><li><a href=https://ramsayleung.github.io/zh/about_me_zh/ title=关于><span>关于</span></a></li><li><a href=https://ramsayleung.github.io/zh/index.xml title=RSS><span>RSS</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://ramsayleung.github.io/zh/>主页</a>&nbsp;»&nbsp;<a href=https://ramsayleung.github.io/zh/post/>Posts</a></div><h1 class="post-title entry-hint-parent">Linux/Unix Shell 二三事之过滤器grep</h1><div class=post-description>an introduction about grep</div><div class=post-quote><blockquote><p>想象力比知识更重要! 因为知识是有限的, 而想象力概括着世界的一切, 推动着进步, 并且是知识进化的源泉。</p><cite>— 爱因斯坦</cite></blockquote></div><hr class=post-separator><div class=post-meta><span title='2017-03-13 00:00:00 -0700 -0700'>三月 13, 2017</span>&nbsp;·&nbsp;6 分钟&nbsp;·&nbsp;2709 字&nbsp;|&nbsp;<a href=https://github.com/ramsayleung/ramsayleung.github.io/blob/master/content/post/2017/grep.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#基本用法><span class=section-num>1</span> 基本用法</a><ul><li><a href=#基础用法><span class=section-num>1.1</span> 基础用法</a></li><li><a href=#结合正则表达式><span class=section-num>1.2</span> 结合正则表达式</a></li><li><a href=#统计出现的次数><span class=section-num>1.3</span> 统计出现的次数</a></li><li><a href=#忽略大小写><span class=section-num>1.4</span> 忽略大小写</a></li></ul></li><li><a href=#搜索多个文件><span class=section-num>2</span> 搜索多个文件</a><ul><li><a href=#递归搜索><span class=section-num>2.1</span> 递归搜索</a></li></ul></li><li><a href=#在标准输入搜索><span class=section-num>3</span> 在标准输入搜索</a></li><li><a href=#反向搜索><span class=section-num>4</span> 反向搜索</a></li><li><a href=#小结><span class=section-num>5</span> 小结</a></li></ul></nav></div></details></div><div class=post-content><p>文本三剑客之 Grep</p><blockquote><p>grep - print lines matching a pattern</p></blockquote><p>今天我想聊聊 <strong>grep</strong> 这个命令；据说，有Unix/Linux 的地方就会有 <strong>grep</strong>, 这个可能是安装得最广泛的命令之一；那么 <strong>grep</strong> 是用来干什么的呢？</p><p>grep 其实是用来在文件中搜索特定内容或者模式的工具(配合正则表达式“食用”，味道更佳 :))现在就来一起看看*grep* 的用法</p><h2 id=基本用法><span class=section-num>1</span> 基本用法<a hidden class=anchor aria-hidden=true href=#基本用法>#</a></h2><h3 id=基础用法><span class=section-num>1.1</span> 基础用法<a hidden class=anchor aria-hidden=true href=#基础用法>#</a></h3><p>现在假设有一个简单的文本文件(双城记开头)tinytale.txt,内容如下</p><blockquote><p>it was the best of times it was the worst of times
it was the age of wisdom it was age of foolishness
it was the epoch of belief it was the epoch of incredulity
it was the season of light it was the season of darkness
IT WAS THE SPRING OF HOPE IT WAS THE WINTER OF DESPAIRE</p></blockquote><p>现在开始介绍 <strong>grep</strong> 的基本用法： <strong>grep</strong> 的基本用法很简单的，假设我想要搜索单词 <strong>darkness</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>grep darkness /tmp/tinytale.txt
</span></span></code></pre></td></tr></table></div></div><p>输出如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>it was the season of light it was the season of darkness
</span></span></code></pre></td></tr></table></div></div><h3 id=结合正则表达式><span class=section-num>1.2</span> 结合正则表达式<a hidden class=anchor aria-hidden=true href=#结合正则表达式>#</a></h3><p>默认情况下， <strong>grep</strong> 是开启正则表达式的模式的，所以你可以直接在文件搜索中使用
正则表达式。现在在文件中搜索以字母 <strong>e</strong> 开头后接三个字符，然后以 <strong>h</strong> 结尾的单词：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>grep <span class=s2>&#34;e...h&#34;</span> /tmp/tinytale.txt
</span></span></code></pre></td></tr></table></div></div><p>输出如下：</p><blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>it was the epoch of belief it was the epoch of incredulity
</span></span></code></pre></td></tr></table></div></div></blockquote><p>可以看到，正则表达式匹配了 <strong>epoch</strong> 这个单词。正则表达式的威力无与伦比的，把 <strong>grep*和正则表达式结合起来可以更好地发挥 *grep</strong> 这个工具的潜力；而本文主要是介绍 <strong>grep</strong>, 更多有关正则表达式的用法不细讲了</p><h3 id=统计出现的次数><span class=section-num>1.3</span> 统计出现的次数<a hidden class=anchor aria-hidden=true href=#统计出现的次数>#</a></h3><p>有时，如果你需要统计某种模式或者某个单词出现的个数，你会发现 <strong>grep</strong> 非常有用；</p><p>要实现该功能，只需给 <strong>grep</strong> 添加 <strong>-c</strong> 参数；例如统计单词 <strong>the</strong> 出现的个数：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>grep -c the /tmp/tinytale.txt
</span></span></code></pre></td></tr></table></div></div><p>结果输出如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>4
</span></span></code></pre></td></tr></table></div></div><p>文本中包含4个 <strong>the</strong></p><h3 id=忽略大小写><span class=section-num>1.4</span> 忽略大小写<a hidden class=anchor aria-hidden=true href=#忽略大小写>#</a></h3><p>前面提到， <strong>grep</strong> 默认是使用正则表达式来搜索文件的，所以 <strong>grep</strong> 是区分大小写的；</p><p>如果你想修改 <strong>grep</strong> 的默认行为来忽略大小写，你可以添加 <strong>-i</strong> 参数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>grep -i the /tmp/tinytale.txt
</span></span></code></pre></td></tr></table></div></div><p>输出结果如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>it was the best of times it was the worst of times
</span></span><span class=line><span class=cl>it was the age of wisdom it was age of foolishness
</span></span><span class=line><span class=cl>it was the epoch of belief it was the epoch of incredulity
</span></span><span class=line><span class=cl>it was the season of light it was the season of darkness
</span></span><span class=line><span class=cl>IT WAS THE SPRING OF HOPE IT WAS THE WINTER OF DESPAIRE
</span></span></code></pre></td></tr></table></div></div><p>可以发现 <strong>THE</strong> 也是可以被 grep 搜索到的；但是如果没有添加 <strong>-i</strong> ,你只会看到4行输出。</p><p>当然你可以在正则表达式里面添加忽略大小写的模式，只是直接添加 <strong>-i</strong> 会简单很多。</p><h2 id=搜索多个文件><span class=section-num>2</span> 搜索多个文件<a hidden class=anchor aria-hidden=true href=#搜索多个文件>#</a></h2><p>上面搜索的都只是单个文件，而 grep 可以让你同时搜索多个文件；现在就来看看怎么搜索多个文件吧。</p><p>下面两种写法结果都是一样的，但是我个人推崇第一种，因为可以输入更少一些内容 :)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>grep belief /tmp/<span class=o>{</span>tinytale.txt,tale.txt<span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>grep belief /tmp/tinytale.txt /tmp/tale.txt
</span></span></code></pre></td></tr></table></div></div><p>输出结果如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>tinytale.txt:it was the epoch of belief it was the epoch of incredulity
</span></span><span class=line><span class=cl>tale.txt:it was the epoch of belief it was the epoch of incredulity
</span></span><span class=line><span class=cl>tale.txt:pains of by rearing her in the belief that her father was dead
</span></span><span class=line><span class=cl>tale.txt:this was no passive belief but an active weapon which they flashed
</span></span><span class=line><span class=cl>tale.txt:belief in solomon deducting a mere trifle for this slight mistake
</span></span><span class=line><span class=cl>tale.txt:you will bear testimony to what i have said and to your belief in it
</span></span><span class=line><span class=cl>tale.txt:herself into the show of a belief that they would soon be reunited
</span></span></code></pre></td></tr></table></div></div><p>可以看到， <strong>grep</strong> 把匹配到单词的那一行内容和对应的文件都显示出来了，你就可以很方便地看到搜索结果，并知道匹配单词的来源。</p><p>如果你也像我这样，不想输入那么多的内容，你可以使用正则表达式匹配所有的文本文件，如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>grep belief /tmp/*.txt
</span></span></code></pre></td></tr></table></div></div><p>输出结果也会跟上面一致 (假设你 <strong><em>tmp</em></strong> 目录下只有两个文本文件); 我告诉*grep* 搜索*/tmp* 下所有的 <strong>.txt</strong> 文件。</p><h3 id=递归搜索><span class=section-num>2.1</span> 递归搜索<a hidden class=anchor aria-hidden=true href=#递归搜索>#</a></h3><p>你也可以使用 <strong>grep</strong> 递归搜索目录；你只需在指定目录后，添加 <strong>-R</strong> , <strong>grep</strong> 就会
递归搜索指定目录的所有子目录。我已经把当前目录切换到 <strong>/tmp</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>grep -R <span class=s2>&#34;belief&#34;</span> .
</span></span></code></pre></td></tr></table></div></div><p>输出结果如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>./tale.txt:it was the epoch of belief it was the epoch of incredulity
</span></span><span class=line><span class=cl>./tale.txt:pains of by rearing her in the belief that her father was dead
</span></span><span class=line><span class=cl>./tale.txt:this was no passive belief but an active weapon which they flashed
</span></span><span class=line><span class=cl>./tale.txt:belief in solomon deducting a mere trifle for this slight mistake
</span></span><span class=line><span class=cl>./tale.txt:you will bear testimony to what i have said and to your belief in it
</span></span><span class=line><span class=cl>./tale.txt:herself into the show of a belief that they would soon be reunited
</span></span><span class=line><span class=cl>./tinytale.txt:it was the epoch of belief it was the epoch of incredulity
</span></span></code></pre></td></tr></table></div></div><p>结果展示了一系列在当前目录和子目录匹配 <strong>belief</strong> 的文件。此外你也可以排除掉某些你
不需要搜索的文件，例如有一个 <strong>foo.xml</strong> 的文件，里面也可能会有 <strong>belief</strong> 这个单词，
但是你就是不想搜索这个文件，或者全部的 <strong>.xml</strong> 文件，你可以这么玩：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>grep -R --exclude<span class=o>=</span><span class=s2>&#34;*.xml&#34;</span> <span class=s2>&#34;belief&#34;</span> .
</span></span></code></pre></td></tr></table></div></div><h2 id=在标准输入搜索><span class=section-num>3</span> 在标准输入搜索<a hidden class=anchor aria-hidden=true href=#在标准输入搜索>#</a></h2><p><strong>grep</strong> 也是过滤器，所以 <strong>grep</strong> 自然而然具有处理标准输入输出的能力了；处理其他命令的输出结果也是 <strong>grep</strong> 非常常用的场景之一。假设你现在的 <strong>vim</strong> 突然卡顿，挂了:),你想要 <strong>kill</strong> 掉 <strong>vim</strong> 的进程，你可以：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ps -e<span class=p>|</span>grep vim
</span></span></code></pre></td></tr></table></div></div><p>结果输出如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>samray   21939     1  0 19:42 ?        00:00:00 gvim
</span></span></code></pre></td></tr></table></div></div><p>其中第一条记录就是你想要搜索的进程了，你运行 <strong>kill 21939</strong> 就可以杀掉 vim 的进程了；因为我系统的是图型化界面的 vim, 所以是 gvim.</p><hr><p>正如我之前的文章提到的那样，单纯的过滤器的用处似乎不大，但是如果结合起来就会威力无穷至于，如何结合，就需要慢慢探索了。</p><h2 id=反向搜索><span class=section-num>4</span> 反向搜索<a hidden class=anchor aria-hidden=true href=#反向搜索>#</a></h2><p>现在执行的搜索都是匹配搜索，即将匹配的内容显示出来，而 <strong>grep</strong> 还有反向搜索的功能 (invert Searches)就是将不包含有指定模式的内容显示出来。</p><p>该功能在用来修改有很多注释的配置文件时特别有用；例如常用的服务器软件 <strong>nginx</strong> 的配置文件是默认是含有很多注释的，如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cfg data-lang=cfg><span class=line><span class=cl><span class=c1>#user www-data;</span>
</span></span><span class=line><span class=cl><span class=na>worker_processes auto;</span>
</span></span><span class=line><span class=cl><span class=na>pid /run/nginx.pid;</span>
</span></span><span class=line><span class=cl><span class=na>include /etc/nginx/modules-enabled/*.conf;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>events {</span>
</span></span><span class=line><span class=cl><span class=na>worker_connections 1024;</span>
</span></span><span class=line><span class=cl><span class=c1># multi_accept on;</span>
</span></span><span class=line><span class=cl><span class=na>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>http {</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>##</span>
</span></span><span class=line><span class=cl><span class=c1># Basic Settings</span>
</span></span><span class=line><span class=cl><span class=c1>##</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>sendfile on;</span>
</span></span><span class=line><span class=cl><span class=na>tcp_nopush on;</span>
</span></span><span class=line><span class=cl><span class=na>tcp_nodelay on;</span>
</span></span><span class=line><span class=cl><span class=na>keepalive_timeout 65;</span>
</span></span><span class=line><span class=cl><span class=na>types_hash_max_size 2048;</span>
</span></span><span class=line><span class=cl><span class=c1># server_tokens off;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># server_names_hash_bucket_size 64;</span>
</span></span><span class=line><span class=cl><span class=c1># server_name_in_redirect off;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>include /etc/nginx/mime.types;</span>
</span></span><span class=line><span class=cl><span class=na>default_type application/octet-stream;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>##</span>
</span></span><span class=line><span class=cl><span class=c1># SSL Settings</span>
</span></span><span class=line><span class=cl><span class=c1>##</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>ssl_protocols TLSv1 TLSv1.1 TLSv1.2; # Dropping SSLv3, ref: POODLE</span>
</span></span><span class=line><span class=cl><span class=na>ssl_prefer_server_ciphers on;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>##</span>
</span></span><span class=line><span class=cl><span class=c1># Logging Settings</span>
</span></span><span class=line><span class=cl><span class=c1>##</span>
</span></span><span class=line><span class=cl><span class=na>log_format main &#39;$remote_addr - $remote_user [$time_local] &#34;$request&#34; $status $bytes_sent &#34;$http_referer&#34; &#34;$http_user_agent&#34; &#34;$gzip_ratio&#34;&#39;;</span>
</span></span><span class=line><span class=cl><span class=na>access_log /var/log/nginx/access.log;</span>
</span></span><span class=line><span class=cl><span class=na>error_log /var/log/nginx/error.log;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>##</span>
</span></span><span class=line><span class=cl><span class=c1># Gzip Settings</span>
</span></span><span class=line><span class=cl><span class=c1>##</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>gzip on;</span>
</span></span><span class=line><span class=cl><span class=na>gzip_disable &#34;msie6&#34;;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># gzip_vary on;</span>
</span></span><span class=line><span class=cl><span class=c1># gzip_proxied any;</span>
</span></span><span class=line><span class=cl><span class=c1># gzip_comp_level 6;</span>
</span></span><span class=line><span class=cl><span class=c1># gzip_buffers 16 8k;</span>
</span></span><span class=line><span class=cl><span class=c1># gzip_http_version 1.1;</span>
</span></span><span class=line><span class=cl><span class=c1># gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>##</span>
</span></span><span class=line><span class=cl><span class=c1># Virtual Host Configs</span>
</span></span><span class=line><span class=cl><span class=c1>##</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>include /etc/nginx/conf.d/*.conf;</span>
</span></span><span class=line><span class=cl><span class=na>include /etc/nginx/sites-enabled/*;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>ignore_invalid_headers on;</span>
</span></span><span class=line><span class=cl><span class=na>client_header_timeout 240;</span>
</span></span><span class=line><span class=cl><span class=na>client_body_timeout 240;</span>
</span></span><span class=line><span class=cl><span class=na>send_timeout 240;</span>
</span></span><span class=line><span class=cl><span class=na>client_max_body_size 100m;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_buffer_size 128k;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_buffers 8 128k;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>upstream tomcat_server{</span>
</span></span><span class=line><span class=cl><span class=na>server 127.0.0.1:8080 fail_timeout</span><span class=o>=</span><span class=s>0;</span>
</span></span><span class=line><span class=cl><span class=na>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>upstream gunicorn_server{</span>
</span></span><span class=line><span class=cl><span class=na>server 127.0.0.1:5000 fail_timeout</span><span class=o>=</span><span class=s>0;</span>
</span></span><span class=line><span class=cl><span class=na>}</span>
</span></span><span class=line><span class=cl><span class=na>server{</span>
</span></span><span class=line><span class=cl><span class=na>server_name 127.0.0.1;</span>
</span></span><span class=line><span class=cl><span class=na>listen 443;</span>
</span></span><span class=line><span class=cl><span class=c1># ssl on;</span>
</span></span><span class=line><span class=cl><span class=c1># ssl_certificate /etc/letsencrypt/live/samray.ren/fullchain.pem;</span>
</span></span><span class=line><span class=cl><span class=c1># ssl_certificate_key /etc/letsencrypt/live/samray.ren/privkey.pem;</span>
</span></span><span class=line><span class=cl><span class=na>location / {</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Forward SSL so that Tomcat knows what to do</span>
</span></span><span class=line><span class=cl><span class=na>proxy_set_header X-Forwarded-Host $host;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_set_header X-Forwarded-Server $host;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_pass http://tomcat_server;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_set_header X-Forwarded-Proto https;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>proxy_redirect off;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_connect_timeout      240;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_send_timeout         240;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_read_timeout         240;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>location /test{</span>
</span></span><span class=line><span class=cl><span class=na>return 402;</span>
</span></span><span class=line><span class=cl><span class=na>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>location /weixin {</span>
</span></span><span class=line><span class=cl><span class=c1># try_files $uri @proxy_to_app;</span>
</span></span><span class=line><span class=cl><span class=na>return 402;</span>
</span></span><span class=line><span class=cl><span class=na>}</span>
</span></span><span class=line><span class=cl><span class=na>location @proxy_to_app {</span>
</span></span><span class=line><span class=cl><span class=na>proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_set_header Host $http_host;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_redirect off;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_pass http://gunicorn_server;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>}</span>
</span></span><span class=line><span class=cl><span class=na>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#mail {</span>
</span></span><span class=line><span class=cl><span class=c1>#	# See sample authentication script at:</span>
</span></span><span class=line><span class=cl><span class=c1>#	# http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#	# auth_http localhost/auth.php;</span>
</span></span><span class=line><span class=cl><span class=c1>#	# pop3_capabilities &#34;TOP&#34; &#34;USER&#34;;</span>
</span></span><span class=line><span class=cl><span class=c1>#	# imap_capabilities &#34;IMAP4rev1&#34; &#34;UIDPLUS&#34;;</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#	server {</span>
</span></span><span class=line><span class=cl><span class=c1>#		listen     localhost:110;</span>
</span></span><span class=line><span class=cl><span class=c1>#		protocol   pop3;</span>
</span></span><span class=line><span class=cl><span class=c1>#		proxy      on;</span>
</span></span><span class=line><span class=cl><span class=c1>#	}</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#	server {</span>
</span></span><span class=line><span class=cl><span class=c1>#		listen     localhost:143;</span>
</span></span><span class=line><span class=cl><span class=c1>#		protocol   imap;</span>
</span></span><span class=line><span class=cl><span class=c1>#		proxy      on;</span>
</span></span><span class=line><span class=cl><span class=c1>#	}</span>
</span></span><span class=line><span class=cl><span class=c1>#}</span>
</span></span></code></pre></td></tr></table></div></div><p>里面实在有太多的注释了，虽说是很好的参考，但是看多了会感觉很碍眼，所以你希望可以有一份没有注释的配置文件，你就可以使用 <strong>grep</strong> 和参数 <strong>-v</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>egrep -v <span class=s2>&#34;#|^</span>$<span class=s2>&#34;</span> /etc/nginx/nginx.conf &gt;/tmp/nging.conf
</span></span></code></pre></td></tr></table></div></div><p>结果如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cfg data-lang=cfg><span class=line><span class=cl><span class=na>worker_processes auto;</span>
</span></span><span class=line><span class=cl><span class=na>pid /run/nginx.pid;</span>
</span></span><span class=line><span class=cl><span class=na>include /etc/nginx/modules-enabled/*.conf;</span>
</span></span><span class=line><span class=cl><span class=na>events {</span>
</span></span><span class=line><span class=cl><span class=na>worker_connections 1024;</span>
</span></span><span class=line><span class=cl><span class=na>}</span>
</span></span><span class=line><span class=cl><span class=na>http {</span>
</span></span><span class=line><span class=cl><span class=na>sendfile on;</span>
</span></span><span class=line><span class=cl><span class=na>tcp_nopush on;</span>
</span></span><span class=line><span class=cl><span class=na>tcp_nodelay on;</span>
</span></span><span class=line><span class=cl><span class=na>keepalive_timeout 65;</span>
</span></span><span class=line><span class=cl><span class=na>types_hash_max_size 2048;</span>
</span></span><span class=line><span class=cl><span class=na>include /etc/nginx/mime.types;</span>
</span></span><span class=line><span class=cl><span class=na>default_type application/octet-stream;</span>
</span></span><span class=line><span class=cl><span class=na>ssl_prefer_server_ciphers on;</span>
</span></span><span class=line><span class=cl><span class=na>log_format main &#39;$remote_addr - $remote_user [$time_local] &#34;$request&#34; $status $bytes_sent &#34;$http_referer&#34; &#34;$http_user_agent&#34; &#34;$gzip_ratio&#34;&#39;;</span>
</span></span><span class=line><span class=cl><span class=na>access_log /var/log/nginx/access.log;</span>
</span></span><span class=line><span class=cl><span class=na>error_log /var/log/nginx/error.log;</span>
</span></span><span class=line><span class=cl><span class=na>gzip on;</span>
</span></span><span class=line><span class=cl><span class=na>gzip_disable &#34;msie6&#34;;</span>
</span></span><span class=line><span class=cl><span class=na>include /etc/nginx/conf.d/*.conf;</span>
</span></span><span class=line><span class=cl><span class=na>include /etc/nginx/sites-enabled/*;</span>
</span></span><span class=line><span class=cl><span class=na>ignore_invalid_headers on;</span>
</span></span><span class=line><span class=cl><span class=na>client_header_timeout 240;</span>
</span></span><span class=line><span class=cl><span class=na>client_body_timeout 240;</span>
</span></span><span class=line><span class=cl><span class=na>send_timeout 240;</span>
</span></span><span class=line><span class=cl><span class=na>client_max_body_size 100m;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_buffer_size 128k;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_buffers 8 128k;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>upstream tomcat_server{</span>
</span></span><span class=line><span class=cl><span class=na>server 127.0.0.1:8080 fail_timeout</span><span class=o>=</span><span class=s>0;</span>
</span></span><span class=line><span class=cl><span class=na>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>upstream gunicorn_server{</span>
</span></span><span class=line><span class=cl><span class=na>server 127.0.0.1:5000 fail_timeout</span><span class=o>=</span><span class=s>0;</span>
</span></span><span class=line><span class=cl><span class=na>}</span>
</span></span><span class=line><span class=cl><span class=na>server{</span>
</span></span><span class=line><span class=cl><span class=na>server_name 127.0.0.1;</span>
</span></span><span class=line><span class=cl><span class=na>listen 443;</span>
</span></span><span class=line><span class=cl><span class=na>location / {</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>proxy_set_header X-Forwarded-Host $host;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_set_header X-Forwarded-Server $host;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_pass http://tomcat_server;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_set_header X-Forwarded-Proto https;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_redirect off;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_connect_timeout      240;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_send_timeout         240;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_read_timeout         240;</span>
</span></span><span class=line><span class=cl><span class=na>}</span>
</span></span><span class=line><span class=cl><span class=na>location /test{</span>
</span></span><span class=line><span class=cl><span class=na>return 402;</span>
</span></span><span class=line><span class=cl><span class=na>}</span>
</span></span><span class=line><span class=cl><span class=na>location /weixin {</span>
</span></span><span class=line><span class=cl><span class=na>return 402;</span>
</span></span><span class=line><span class=cl><span class=na>}</span>
</span></span><span class=line><span class=cl><span class=na>location @proxy_to_app {</span>
</span></span><span class=line><span class=cl><span class=na>proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_set_header Host $http_host;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_redirect off;</span>
</span></span><span class=line><span class=cl><span class=na>proxy_pass http://gunicorn_server;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>}</span>
</span></span><span class=line><span class=cl><span class=na>}</span>
</span></span><span class=line><span class=cl><span class=na>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>egrep</strong> 是 <strong>grep</strong> 的扩展，你也可以通过 <strong>-E</strong> 使用扩展功能。就这样，你就可以得到一份很“干净”的配置文件了。</p><h2 id=小结><span class=section-num>5</span> 小结<a hidden class=anchor aria-hidden=true href=#小结>#</a></h2><p>在以前 <strong>grep</strong> 是 <strong>hacker</strong> 工具箱里面审查源代码必不可少的工具之一，但是随着技术的发展，似乎对比其他同类型的工具， <strong>grep</strong> 的性能已经难尽人意，特别是对比 <strong>ag</strong> 这个搜索神器；</p><p>虽说很多人都已经转移到了 <strong>ag</strong> 阵营，但是因为 <strong>grep</strong> 被广泛预装到各类的Linux/Unix 机器，所以 <strong>grep</strong> 还是使用得很广泛滴。</p><p>更多 <strong>grep</strong> 的用法就需要查询手册了：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>man grep
</span></span></code></pre></td></tr></table></div></div><p>Enjoy Shell :)</p><div center class=qr-container><img src=/ox-hugo/qrcode_gh_e06d750e626f_1.jpg alt=qrcode_gh_e06d750e626f_1.jpg width=160px height=160px center=t class=qr-container>
公号同步更新，欢迎关注👻</div></div><footer class=post-footer><ul class=post-tags><li><a href=https://ramsayleung.github.io/zh/tags/shell/>Shell</a></li><li><a href=https://ramsayleung.github.io/zh/tags/linux/>Linux</a></li><li><a href=https://ramsayleung.github.io/zh/tags/command_line/>Command_line</a></li></ul><nav class=paginav><a class=prev href=https://ramsayleung.github.io/zh/post/2017/port_scanner/><span class=title>« 上一页</span><br><span>Python多线程端口扫描器</span>
</a><a class=next href=https://ramsayleung.github.io/zh/post/2017/java8_file_io/><span class=title>下一页 »</span><br><span>Java读写文件小结</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Linux/Unix Shell 二三事之过滤器grep on x" href="https://x.com/intent/tweet/?text=Linux%2fUnix%20Shell%20%e4%ba%8c%e4%b8%89%e4%ba%8b%e4%b9%8b%e8%bf%87%e6%bb%a4%e5%99%a8grep&amp;url=https%3a%2f%2framsayleung.github.io%2fzh%2fpost%2f2017%2fgrep%2f&amp;hashtags=shell%2clinux%2ccommand_line"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Linux/Unix Shell 二三事之过滤器grep on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2framsayleung.github.io%2fzh%2fpost%2f2017%2fgrep%2f&amp;title=Linux%2fUnix%20Shell%20%e4%ba%8c%e4%b8%89%e4%ba%8b%e4%b9%8b%e8%bf%87%e6%bb%a4%e5%99%a8grep&amp;summary=Linux%2fUnix%20Shell%20%e4%ba%8c%e4%b8%89%e4%ba%8b%e4%b9%8b%e8%bf%87%e6%bb%a4%e5%99%a8grep&amp;source=https%3a%2f%2framsayleung.github.io%2fzh%2fpost%2f2017%2fgrep%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Linux/Unix Shell 二三事之过滤器grep on reddit" href="https://reddit.com/submit?url=https%3a%2f%2framsayleung.github.io%2fzh%2fpost%2f2017%2fgrep%2f&title=Linux%2fUnix%20Shell%20%e4%ba%8c%e4%b8%89%e4%ba%8b%e4%b9%8b%e8%bf%87%e6%bb%a4%e5%99%a8grep"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Linux/Unix Shell 二三事之过滤器grep on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2framsayleung.github.io%2fzh%2fpost%2f2017%2fgrep%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Linux/Unix Shell 二三事之过滤器grep on whatsapp" href="https://api.whatsapp.com/send?text=Linux%2fUnix%20Shell%20%e4%ba%8c%e4%b8%89%e4%ba%8b%e4%b9%8b%e8%bf%87%e6%bb%a4%e5%99%a8grep%20-%20https%3a%2f%2framsayleung.github.io%2fzh%2fpost%2f2017%2fgrep%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Linux/Unix Shell 二三事之过滤器grep on telegram" href="https://telegram.me/share/url?text=Linux%2fUnix%20Shell%20%e4%ba%8c%e4%b8%89%e4%ba%8b%e4%b9%8b%e8%bf%87%e6%bb%a4%e5%99%a8grep&amp;url=https%3a%2f%2framsayleung.github.io%2fzh%2fpost%2f2017%2fgrep%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Linux/Unix Shell 二三事之过滤器grep on ycombinator" href="https://news.ycombinator.com/submitlink?t=Linux%2fUnix%20Shell%20%e4%ba%8c%e4%b8%89%e4%ba%8b%e4%b9%8b%e8%bf%87%e6%bb%a4%e5%99%a8grep&u=https%3a%2f%2framsayleung.github.io%2fzh%2fpost%2f2017%2fgrep%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><section><h2>Comments</h2><div id=comments-giscus></div></section><script type=text/javascript>function getCurrentTheme(){return document.documentElement.getAttribute("data-theme")||document.body.classList.contains("dark")?"dark":"light"}function setGiscusTheme(e=!1){const s=e?"dark":"light";var n,t=document.querySelector(".giscus-frame");t&&(n=new URL(t.src),n.searchParams.set("theme",s),t.src=n.toString())}function loadComment(e=!1){const n="zh"=="zh",t=document.getElementById("comments-giscus");if(t!==null&&!t.hasAttribute("data-giscus-loaded")){console.log("Initial giscus load");const s=document.createElement("script");s.setAttribute("src","https://giscus.app/client.js"),s.setAttribute("data-repo","ramsayleung/comment"),s.setAttribute("data-repo-id","MDEwOlJlcG9zaXRvcnkzMDk2NjQ1NDk="),s.setAttribute("data-category","General"),s.setAttribute("data-category-id","DIC_kwDOEnUbJc4Cltnz"),s.setAttribute("data-mapping","pathname"),s.setAttribute("data-strict","0"),s.setAttribute("data-reactions-enabled","1"),s.setAttribute("data-emit-metadata","0"),s.setAttribute("data-input-position","bottom"),s.setAttribute("data-theme",e?"dark":"light"),s.setAttribute("crossorigin","anonymous"),s.setAttribute("data-lang",n?"zh-CN":"en"),s.setAttribute("async","true"),t.appendChild(s),t.setAttribute("data-giscus-loaded","true")}}let currentTheme=getCurrentTheme();loadComment(currentTheme==="dark");const themeObserver=new MutationObserver(e=>{e.forEach(e=>{if(e.type==="attributes"&&e.attributeName==="class"){const e=getCurrentTheme();e!==currentTheme&&(currentTheme=e,setGiscusTheme(currentTheme==="dark"))}})});themeObserver.observe(document.body,{attributes:!0,attributeFilter:["class"]})</script></article></main><footer class=footer><span>See this site&rsquo;s source code <a href=https://github.com/ramsayleung/ramsayleung.github.io>here</a>, licensed under GPLv3 ·</span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>