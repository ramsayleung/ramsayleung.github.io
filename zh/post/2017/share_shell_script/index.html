<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>脚本分享 | 自由庄园</title>
<meta name=keywords content="shell,linux,command_line,tool"><meta name=description content="share of my shell script snippet"><meta name=author content="Ramsay Leung"><link rel=canonical href=https://ramsayleung.github.io/zh/post/2017/share_shell_script/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.6a3b6ec91bc56af74a0792ef121157f4d1cdb82f23aa512b8eb93759b0aa3123.css integrity="sha256-ajtuyRvFavdKB5LvEhFX9NHNuC8jqlErjrk3WbCqMSM=" rel="preload stylesheet" as=style><link rel=icon href=https://ramsayleung.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ramsayleung.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ramsayleung.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://ramsayleung.github.io/apple-touch-icon.png><link rel=mask-icon href=https://ramsayleung.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://ramsayleung.github.io/zh/post/2017/share_shell_script/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-9MG65HQHEL"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-9MG65HQHEL",{anonymize_ip:!1})}</script><meta property="og:title" content="脚本分享"><meta property="og:description" content="share of my shell script snippet"><meta property="og:type" content="article"><meta property="og:url" content="https://ramsayleung.github.io/zh/post/2017/share_shell_script/"><meta property="og:image" content="https://ramsayleung.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="post"><meta property="article:published_time" content="2017-04-22T00:00:00-07:00"><meta property="article:modified_time" content="2025-01-09T20:51:33-08:00"><meta property="og:site_name" content="Ramsay's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ramsayleung.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="脚本分享"><meta name=twitter:description content="share of my shell script snippet"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ramsayleung.github.io/zh/post/"},{"@type":"ListItem","position":2,"name":"脚本分享","item":"https://ramsayleung.github.io/zh/post/2017/share_shell_script/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"脚本分享","name":"脚本分享","description":"share of my shell script snippet","keywords":["shell","linux","command_line","tool"],"articleBody":"分享一下平时工作生活中编写的一些脚本片段(一直更新). 适用于 OS X 和 Linux\n1 准备工作 因为我比较多的脚本都是基于 percol 这个神器，所以需要先安装 percol, 如果 不了解 percol 的话，可以翻看一下我之前的文章 Linux/Unix Shell 二三事之神器percol .\n我一般将写好的函数 source 命令添加到 Shell. 例如脚本函数都在一个叫 tool_function.sh 的文件里面，而我使用 Zsh, 则只需要在 .zshrc 添加一句语句：\n1 source /path/to/tool_function.sh 如果使用 Bash, 添加到 .bashrc 即可。\n2 有趣的脚本 2.1 SSH 免密码登录 SSH 基本就是登录远程服务器的标配了，只是每次登录服务器都要输入密码，未免太麻烦了(好吧，我拥有懒惰这个美德)，所以我决定配置 SSH 的免密码登录。代码如下：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 function config_ssh_login_key(){ if [ $# -lt 3 ];then echo \"Usage: $(basename $0) -u user -h hostname -p port\" kill -INT $$ fi #if public/private key doesn't exist ,generate public/private key if [ -f ~/.ssh/id_rsa ];then echo \"public/private key exists\" else ssh-keygen -t rsa fi while getopts :u:h:p: option do case \"$option\" in u) user=$OPTARG;; h) hostname=$OPTARG;; p) port=$OPTARG;; *) echo \"Unknown option:$option\";; esac done if [ -z \"$port\" ];then port=22 fi #check whether it is the first time to run this script and whether authorized_keys exists # ssh_host_and_user=\"$1@$2\" authorized_keys=\"$HOME/.ssh/authorized_keys\" read -r -s -p \"$user@$hostname's password:\" password if sshpass -pv $password ssh -p \"$port\" \"$user@$hostname\" test -e \"$authorized_keys\";then echo \"authorized key exists\" kill -INT $$ else sshpass -p $password ssh $user@$hostname -p $port \"mkdir -p ~/.ssh;chmod 0700 .ssh\" sshpass -p $password scp -P $port ~/.ssh/id_rsa.pub $user@$hostname:~/.ssh/authorized_keys # ssh-copy-id \"$user@$hostname -p $port\" fi } 基本做法就是生成一对公私密钥，然后把公钥发送到服务器。而脚本其他的部分就是判断密钥是否存在，修改密钥权限等工作。用法也很简单，假如你把以上脚本保存到了一个叫 config_ssh_login_key.sh 的文件：\n1 bash config_ssh_login_key.sh -h your-server-ip -u user -p 2222 当然，如果你按照我的前面提到的做法，用 source 命令引入脚本，你可以直接在命令行输入：\n1 config_ssh_login_key -u root -h your-server-ip 如果端口未指定，默认端口为 22\n2.2 生成若干位密钥 生成若干位的密钥是常见的需求，得益于 Linux/Unix 命令行强大的过滤器，所以只需把命令整理成脚本即可：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 # generate key function gkey(){ if [ -n \"$1\" ];then local length=\"$1\" else local length=32 fi OS_NAME=$(uname) if [ $OS_NAME = \"Darwin\" ]; then LC_CTYPE=C cat /dev/urandom |tr -cd \"[:alnum:]\"|head -c \"$length\";echo else cat /dev/urandom |tr -cd \"[:alnum:]\"|head -c \"$length\";echo fi } 用法：\n1 gkey 45 即生成一个45位字符的随机密钥，如果没有指定长度的话，默认是 32 位。因为 OS X和 Linux 的 tr 使用有差异，所以要处理一下\n2.3 复制命令行输出 有时可能需要复制某个命令的输出，一般的做法都是运行某个命令，用鼠标选中，然后复制。例如在生成密钥之后，需要复制到项目的配置文件。但是每次都要用鼠标，效率实在不高。这个功能其实可以脚本实现：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 OS_NAME=$(uname) function pclip() { if [ $OS_NAME = \"CYGWIN\" ]; then putclip \"$@\"; elif [ $OS_NAME = \"Darwin\" ]; then pbcopy \"$@\"; else if [ -x /usr/bin/xsel ]; then xsel -ib \"$@\"; else if [ -x /usr/bin/xclip ]; then xclip -selection c \"$@\"; else echo \"Neither xsel or xclip is installed!\" fi fi fi } 备注：这个脚本不是我原创，取自 陈斌 博客。\n在 Linux 运行这脚本需要先安装 xsel 或者是 xclip 命令。结合生成密钥的命令使用：\n1 gkey -28|pclip 这样，生成的密钥就被复制到系统上了。\n2.4 复制当前目录 有时候，我需要复制当前目录下某个文件的路径，但是无论是文件管理器，还是在Shell 中都要用鼠标选中然后复制指定文件的路径，效率不高且很不方便。所以我通过结合 percol 和上面提高的 pclip 函数改进了做法：\n1 2 3 4 5 6 function pwdf() { local current_dir=`pwd` local copied_file=`find $current_dir -type f -print |percol` echo -n $copied_file |pclip; } 只需在 Shell 中输入 pwdf, 然后选择需要复制的路径即可。 运行截图：\n\u003c2017-05-22 Mon\u003e Update\n2.5 判断 Unix 系统的版本 因为我经常需要在不同的 Unix 机器之间切换，例如工作用的 Mac OS X, 另外一台笔记本上的 Fedora, 还有一台工作站上的 Arch Linux, 以及各种发行版本的 VPS 等，在不同的发行版本或者系统之间切换，我希望我常用的工具也可以很轻易地移植到不同的发行版本上。\n但是不同的发行版本使用不同的包安装管理器，例如 OS X 上的 brew, Fedora 的 dnf, Centos 的 yum, Ubuntu 上的 apt-get 等等。如果可以通过使用脚本来实现根据不同的发行版本使用不同的包安装管理器安装软件，这样就省心很多。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 # GetOSVersion function GetOSVersion { # Figure out which vendor we are if [[ -x \"`which sw_vers 2\u003e/dev/null`\" ]]; then # OS/X os_VENDOR=`sw_vers -productName` elif [[ -x $(which lsb_release 2\u003e/dev/null) ]]; then os_VENDOR=$(lsb_release -i -s) if [[ \"Debian,Ubuntu,LinuxMint\" =~ $os_VENDOR ]]; then os_PACKAGE=\"deb\" elif [[ \"SUSE LINUX\" =~ $os_VENDOR ]]; then lsb_release -d -s | grep -q openSUSE if [[ $? -eq 0 ]]; then os_VENDOR=\"openSUSE\" fi elif [[ $os_VENDOR == \"openSUSE project\" ]]; then os_VENDOR=\"openSUSE\" elif [[ $os_VENDOR =~ Red.*Hat ]]; then os_VENDOR=\"Red Hat\" fi os_CODENAME=$(lsb_release -c -s) elif [[ -r /etc/redhat-release ]]; then # Red Hat Enterprise Linux Server release 5.5 (Tikanga) # Red Hat Enterprise Linux Server release 7.0 Beta (Maipo) # CentOS release 5.5 (Final) # CentOS Linux release 6.0 (Final) # Fedora release 16 (Verne) # XenServer release 6.2.0-70446c (xenenterprise) # Oracle Linux release 7 os_CODENAME=\"\" for r in \"Red Hat\" CentOS Fedora XenServer; do os_VENDOR=$r done if [ \"$os_VENDOR\" = \"Red Hat\" ] \u0026\u0026 [[ -r /etc/oracle-release ]]; then os_VENDOR=OracleLinux fi elif [[ -r /etc/SuSE-release ]]; then for r in openSUSE \"SUSE Linux\"; do if [[ \"$r\" = \"SUSE Linux\" ]]; then os_VENDOR=\"SUSE LINUX\" else os_VENDOR=$r fi os_VENDOR=\"\" done # If lsb_release is not installed, we should be able to detect Debian OS elif [[ -f /etc/debian_version ]] \u0026\u0026 [[ $(cat /proc/version) =~ \"Debian\" ]]; then os_VENDOR=\"Debian\" fi export os_VENDOR } 2.6 根据不同的发行版本安装软件 刚刚上面的脚本是为了准确判断出所有的 *nix 系统的，但是方便起见，也可以直接使用=uname= 命令\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 if [ \"$(uname)\" == \"Darwin\" ]; then # Do something under Mac OS X platform echo \"This is mac os\" # check if brew exists type brew\u003e/dev/null 2\u003e\u00261 || { echo \u003e\u00262 \" require brew but it's not installed. Aborting.\"; exit 1; } echo \"install htop\" brew install htop echo \"install ag\" brew install ag echo \"install httpie\" brew install httpie echo \"install fasd\" brew install fasd echo \"install tree\" brew install tree echo \"install shellcheck\" brew install shellcheck echo \"install guile\" brew install guile echo \"install proxychains-ng\" brew install proxychains-ng echo \"install pandoc\" brew install pandoc echo \"install markdown\" brew install markdown echo \"install cloc\" brew install cloc elif [ \"$(expr substr $(uname -s) 1 5)\" == \"Linux\" ]; then # Do something under GNU/Linux platform GetOSVersion if [ \"$os_VENDOR\" == \"Ubuntu\" ] || [[ \"$os_VENDOR\" == \"Debian\" ]] || [[ \"$os_VENDOR\" == \"LinuxMint\" ]]; then # install htop sudo apt-get install htop -y # install httpie sudo apt-get install httpie -y # install ag sudo apt-get install silversearcher-ag -y # install zeal sudo apt-get install zeal -y # install ncdu sudo apt-get install ncdu -y # install i3 sudo apt-get install i3 -y # install emacs (i could die without it) sudo apt-get install emacs -y # install vim sudo apt-get install vim -y # install tree sudo apt-get install tree -y # install shellcheck sudo apt-get install shellcheck -y # install guile (scheme compiler) sudo apt-get install guile -y # install source code pro font [ -d /usr/share/fonts/opentype ] || sudo mkdir /usr/share/fonts/opentype sudo git clone https://github.com/adobe-fonts/source-code-pro.git /usr/share/fonts/opentype/scp sudo fc-cache -f -v # install proxychains-ng sudo apt-get install proxychains-ng -y # install pandoc sudo apt-get install pandoc -y sudo apt-get install markdown -y sudo apt-get install cloc -y elif [ \"$os_VENDOR\" == \"Fedora\" ] || [[ \"$os_VENDOR\" == \"CentOS\" ]] || [[ \"$os_VENDOR\" == \"Korora\" ]]; then # install ag sudo yum install -y the_silver_searcher # install zeal sudo yum install -y zeal # install httpie sudo yum install -y httpie # install htop sudo yum install -y htop # install ncdu sudo yum install -y ncdu # install vim sudo yum install -y vim # install emacs sudo yum install -y emacs # install i3 sudo yum install -y i3 # install tree sudo yum install -y tree # install shellcheck sudo yum install ShellCheck -y # install guile sudo yum install guile -y # install source code pro font sudo yum install adobe-source-code-pro-fonts -y # install proxychains-ng sudo yum install proxychains-ng -y sudo yum install pandoc -y sudo yum install markdown -y # count line and space in code sudo yum install cloc -y elif [ \"$os_VENDOR\" == \"Arch\" ] ; then # install ag sudo pacman -S -y the_silver_searcher # install zeal sudo pacman -S -y zeal # install httpie sudo pacman -S -y httpie # install htop sudo pacman -S -y htop # install ncdu sudo pacman -S -y ncdu # install vim sudo pacman -S -y vim # install emacs sudo pacman -S -y emacs # install i3 sudo pacman -S -y i3 # install tree sudo pacman -S -y tree # install shellcheck sudo pacman -S ShellCheck -y # install guile sudo pacman -S guile -y # install source-code-pro font sudo pacman -S adobe-source-code-pro-fonts -y # install proxychains-ng sudo pacman -S proxychains-ng -y sudo pacman -S pandoc -y sudo pacman -S markdown -y sudo pacman -S ripgrep -y sudo pacman -S cloc -y fi elif [ \"$(expr substr $(uname -s) 1 10)\" == \"MINGW32_NT\" ]; then # Do something under 32 bits Windows NT platform echo \"This is 32-bit windows\" elif [ \"$(expr substr $(uname -s) 1 10)\" == \"MINGW64_NT\" ]; then # Do something under 64 bits Windows NT platform echo \"this is 64-bit windows\" fi 2.7 加密目录 每个人都会有需要只属于自己的东西，保护这些东西最好的办法就是对其进行加密：\n2.7.1 加密 使用 tar 和 openssl 对目录进行加密，先使用 tar 归档当前文件，然后使用 aes256 算法进行加密：\n1 tar -czf - * | openssl enc -e -aes256 -out encrypted.tar.gz 2.7.2 解密 把加密后的归档文件解密到当前命令：\n1 openssl enc -d -aes256 -in encrypted.tar.gz| tar xz -C $(pwd) ","wordCount":"2601","inLanguage":"zh","image":"https://ramsayleung.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2017-04-22T00:00:00-07:00","dateModified":"2025-01-09T20:51:33-08:00","author":{"@type":"Person","name":"Ramsay Leung"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ramsayleung.github.io/zh/post/2017/share_shell_script/"},"publisher":{"@type":"Organization","name":"自由庄园","logo":{"@type":"ImageObject","url":"https://ramsayleung.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ramsayleung.github.io/zh/ accesskey=h title="Home (Alt + H)"><img src=https://ramsayleung.github.io/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://ramsayleung.github.io/en/ title=English aria-label=English>En</a></li></ul></div></div><ul id=menu><li><a href=https://ramsayleung.github.io/zh/archives/ title=归档><span>归档</span></a></li><li class=dropdown><a href=https://ramsayleung.github.io/zh/categories/ title="系列 "><span>系列 ▾</span></a><div class="menu-more-content dropdown-content"><a href=https://ramsayleung.github.io/zh/categories/%E5%BE%97%E5%A4%B1%E6%84%9F%E6%82%9F/ title=得失感悟><span>得失感悟
</span></a><a href=https://ramsayleung.github.io/zh/categories/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6/ title=测试技能进阶><span>测试技能进阶
</span></a><a href=https://ramsayleung.github.io/zh/categories/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B%E5%B8%88%E7%9A%84%E8%BD%AF%E6%8A%80%E8%83%BD%E6%8C%87%E5%8C%97/ title=软件工程师的软技能指北><span>软件工程师的软技能指北
</span></a><a href=https://ramsayleung.github.io/zh/categories/%E5%B7%A5%E4%BD%9C%E6%B5%81/ title=我的工作流><span>我的工作流
</span></a><a href=https://ramsayleung.github.io/zh/categories/%E6%97%85%E5%8A%A0%E7%BB%8F%E5%8E%86 title=旅加经历><span>旅加经历</span></a></div></li><li><a href=https://ramsayleung.github.io/zh/search/ title=搜索><span>搜索</span></a></li><li><a href=https://ramsayleung.github.io/zh/tags/ title=标签><span>标签</span></a></li><li><a href=https://ramsayleung.github.io/zh/about_me_zh/ title=关于><span>关于</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://ramsayleung.github.io/zh/>主页</a>&nbsp;»&nbsp;<a href=https://ramsayleung.github.io/zh/post/>Posts</a></div><h1 class="post-title entry-hint-parent">脚本分享</h1><div class=post-description>share of my shell script snippet</div><div class=post-meta><span title='2017-04-22 00:00:00 -0700 -0700'>四月 22, 2017</span>&nbsp;·&nbsp;6 分钟&nbsp;·&nbsp;2601 字&nbsp;·&nbsp;Ramsay Leung&nbsp;|&nbsp;<a href=https://github.com/ramsayleung/ramsayleung.github.io/blob/master/content/post/2017/share_shell_script.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#准备工作><span class=section-num>1</span> 准备工作</a></li><li><a href=#有趣的脚本><span class=section-num>2</span> 有趣的脚本</a><ul><li><a href=#ssh-免密码登录><span class=section-num>2.1</span> SSH 免密码登录</a></li><li><a href=#生成若干位密钥><span class=section-num>2.2</span> 生成若干位密钥</a></li><li><a href=#复制命令行输出><span class=section-num>2.3</span> 复制命令行输出</a></li><li><a href=#复制当前目录><span class=section-num>2.4</span> 复制当前目录</a></li><li><a href=#判断-unix-系统的版本><span class=section-num>2.5</span> 判断 Unix 系统的版本</a></li><li><a href=#根据不同的发行版本安装软件><span class=section-num>2.6</span> 根据不同的发行版本安装软件</a></li><li><a href=#加密目录><span class=section-num>2.7</span> 加密目录</a></li></ul></li></ul></nav></div></details></div><div class=post-content><p>分享一下平时工作生活中编写的一些脚本片段(一直更新). 适用于 OS X 和 Linux</p><h2 id=准备工作><span class=section-num>1</span> 准备工作<a hidden class=anchor aria-hidden=true href=#准备工作>#</a></h2><p>因为我比较多的脚本都是基于 <code>percol</code> 这个神器，所以需要先安装 <code>percol</code>, 如果 不了解 <code>percol</code> 的话，可以翻看一下我之前的文章 <a href=https://ramsayleung.github.io/post/2017/percol/>Linux/Unix Shell 二三事之神器percol</a> .</p><p>我一般将写好的函数 source 命令添加到 Shell. 例如脚本函数都在一个叫 <code>tool_function.sh</code> 的文件里面，而我使用 Zsh, 则只需要在 <code>.zshrc</code> 添加一句语句：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nb>source</span> /path/to/tool_function.sh
</span></span></code></pre></td></tr></table></div></div><p>如果使用 Bash, 添加到 <code>.bashrc</code> 即可。</p><h2 id=有趣的脚本><span class=section-num>2</span> 有趣的脚本<a hidden class=anchor aria-hidden=true href=#有趣的脚本>#</a></h2><h3 id=ssh-免密码登录><span class=section-num>2.1</span> SSH 免密码登录<a hidden class=anchor aria-hidden=true href=#ssh-免密码登录>#</a></h3><p>SSH 基本就是登录远程服务器的标配了，只是每次登录服务器都要输入密码，未免太麻烦了(好吧，我拥有懒惰这个美德)，所以我决定配置 SSH 的免密码登录。代码如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=k>function</span> config_ssh_login_key<span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[</span> <span class=nv>$#</span> -lt <span class=m>3</span> <span class=o>]</span><span class=p>;</span><span class=k>then</span>
</span></span><span class=line><span class=cl>       <span class=nb>echo</span> <span class=s2>&#34;Usage: </span><span class=k>$(</span>basename <span class=nv>$0</span><span class=k>)</span><span class=s2> -u user -h hostname -p port&#34;</span>
</span></span><span class=line><span class=cl>       <span class=nb>kill</span> -INT <span class=nv>$$</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl>       <span class=c1>#if public/private key doesn&#39;t exist ,generate public/private key</span>
</span></span><span class=line><span class=cl>       <span class=k>if</span> <span class=o>[</span> -f ~/.ssh/id_rsa <span class=o>]</span><span class=p>;</span><span class=k>then</span>
</span></span><span class=line><span class=cl>          <span class=nb>echo</span> <span class=s2>&#34;public/private key exists&#34;</span>
</span></span><span class=line><span class=cl>          <span class=k>else</span>
</span></span><span class=line><span class=cl>              ssh-keygen -t rsa
</span></span><span class=line><span class=cl>       <span class=k>fi</span>
</span></span><span class=line><span class=cl>          <span class=k>while</span> <span class=nb>getopts</span> :u:h:p: option
</span></span><span class=line><span class=cl>          <span class=k>do</span>
</span></span><span class=line><span class=cl>              <span class=k>case</span> <span class=s2>&#34;</span><span class=nv>$option</span><span class=s2>&#34;</span> in
</span></span><span class=line><span class=cl>                  u<span class=o>)</span> <span class=nv>user</span><span class=o>=</span><span class=nv>$OPTARG</span><span class=p>;;</span>
</span></span><span class=line><span class=cl>                  h<span class=o>)</span> <span class=nv>hostname</span><span class=o>=</span><span class=nv>$OPTARG</span><span class=p>;;</span>
</span></span><span class=line><span class=cl>                  p<span class=o>)</span> <span class=nv>port</span><span class=o>=</span><span class=nv>$OPTARG</span><span class=p>;;</span>
</span></span><span class=line><span class=cl>                  *<span class=o>)</span> <span class=nb>echo</span> <span class=s2>&#34;Unknown option:</span><span class=nv>$option</span><span class=s2>&#34;</span><span class=p>;;</span>
</span></span><span class=line><span class=cl>              <span class=k>esac</span>
</span></span><span class=line><span class=cl>          <span class=k>done</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>          <span class=k>if</span> <span class=o>[</span> -z <span class=s2>&#34;</span><span class=nv>$port</span><span class=s2>&#34;</span> <span class=o>]</span><span class=p>;</span><span class=k>then</span>
</span></span><span class=line><span class=cl>             <span class=nv>port</span><span class=o>=</span><span class=m>22</span>
</span></span><span class=line><span class=cl>          <span class=k>fi</span>
</span></span><span class=line><span class=cl>             <span class=c1>#check whether it is the first time to run this script and whether authorized_keys exists</span>
</span></span><span class=line><span class=cl>             <span class=c1># ssh_host_and_user=&#34;$1@$2&#34;</span>
</span></span><span class=line><span class=cl>             <span class=nv>authorized_keys</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$HOME</span><span class=s2>/.ssh/authorized_keys&#34;</span>
</span></span><span class=line><span class=cl>             <span class=nb>read</span> -r -s -p <span class=s2>&#34;</span><span class=nv>$user</span><span class=s2>@</span><span class=nv>$hostname</span><span class=s2>&#39;s password:&#34;</span> password
</span></span><span class=line><span class=cl>             <span class=k>if</span> sshpass -pv <span class=nv>$password</span> ssh -p <span class=s2>&#34;</span><span class=nv>$port</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=nv>$user</span><span class=s2>@</span><span class=nv>$hostname</span><span class=s2>&#34;</span> <span class=nb>test</span> -e <span class=s2>&#34;</span><span class=nv>$authorized_keys</span><span class=s2>&#34;</span><span class=p>;</span><span class=k>then</span>
</span></span><span class=line><span class=cl>                <span class=nb>echo</span> <span class=s2>&#34;authorized key exists&#34;</span>
</span></span><span class=line><span class=cl>                <span class=nb>kill</span> -INT <span class=nv>$$</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span>
</span></span><span class=line><span class=cl>                    sshpass -p <span class=nv>$password</span> ssh  <span class=nv>$user</span>@<span class=nv>$hostname</span> -p <span class=nv>$port</span> <span class=s2>&#34;mkdir -p ~/.ssh;chmod 0700 .ssh&#34;</span>
</span></span><span class=line><span class=cl>                    sshpass -p <span class=nv>$password</span> scp -P <span class=nv>$port</span>  ~/.ssh/id_rsa.pub <span class=nv>$user</span>@<span class=nv>$hostname</span>:~/.ssh/authorized_keys
</span></span><span class=line><span class=cl>                    <span class=c1># ssh-copy-id &#34;$user@$hostname -p $port&#34;</span>
</span></span><span class=line><span class=cl>             <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>基本做法就是生成一对公私密钥，然后把公钥发送到服务器。而脚本其他的部分就是判断密钥是否存在，修改密钥权限等工作。用法也很简单，假如你把以上脚本保存到了一个叫 <code>config_ssh_login_key.sh</code> 的文件：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>bash config_ssh_login_key.sh -h your-server-ip -u user -p <span class=m>2222</span>
</span></span></code></pre></td></tr></table></div></div><p>当然，如果你按照我的前面提到的做法，用 source 命令引入脚本，你可以直接在命令行输入：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>config_ssh_login_key -u root -h your-server-ip
</span></span></code></pre></td></tr></table></div></div><p>如果端口未指定，默认端口为 22</p><h3 id=生成若干位密钥><span class=section-num>2.2</span> 生成若干位密钥<a hidden class=anchor aria-hidden=true href=#生成若干位密钥>#</a></h3><p>生成若干位的密钥是常见的需求，得益于 Linux/Unix 命令行强大的过滤器，所以只需把命令整理成脚本即可：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># generate key</span>
</span></span><span class=line><span class=cl><span class=k>function</span> gkey<span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[</span> -n <span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>&#34;</span> <span class=o>]</span><span class=p>;</span><span class=k>then</span>
</span></span><span class=line><span class=cl>       <span class=nb>local</span> <span class=nv>length</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>       <span class=k>else</span>
</span></span><span class=line><span class=cl>           <span class=nb>local</span> <span class=nv>length</span><span class=o>=</span><span class=m>32</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl>       <span class=nv>OS_NAME</span><span class=o>=</span><span class=k>$(</span>uname<span class=k>)</span>
</span></span><span class=line><span class=cl>       <span class=k>if</span> <span class=o>[</span> <span class=nv>$OS_NAME</span> <span class=o>=</span> <span class=s2>&#34;Darwin&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>           <span class=nv>LC_CTYPE</span><span class=o>=</span>C cat /dev/urandom <span class=p>|</span>tr -cd <span class=s2>&#34;[:alnum:]&#34;</span><span class=p>|</span>head -c <span class=s2>&#34;</span><span class=nv>$length</span><span class=s2>&#34;</span><span class=p>;</span><span class=nb>echo</span>
</span></span><span class=line><span class=cl>       <span class=k>else</span>
</span></span><span class=line><span class=cl>           cat /dev/urandom <span class=p>|</span>tr -cd <span class=s2>&#34;[:alnum:]&#34;</span><span class=p>|</span>head -c <span class=s2>&#34;</span><span class=nv>$length</span><span class=s2>&#34;</span><span class=p>;</span><span class=nb>echo</span>
</span></span><span class=line><span class=cl>       <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>用法：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>gkey <span class=m>45</span>
</span></span></code></pre></td></tr></table></div></div><p>即生成一个45位字符的随机密钥，如果没有指定长度的话，默认是 32 位。因为 OS X和 Linux 的 <code>tr</code> 使用有差异，所以要处理一下</p><h3 id=复制命令行输出><span class=section-num>2.3</span> 复制命令行输出<a hidden class=anchor aria-hidden=true href=#复制命令行输出>#</a></h3><p>有时可能需要复制某个命令的输出，一般的做法都是运行某个命令，用鼠标选中，然后复制。例如在生成密钥之后，需要复制到项目的配置文件。但是每次都要用鼠标，效率实在不高。这个功能其实可以脚本实现：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>OS_NAME</span><span class=o>=</span><span class=k>$(</span>uname<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=k>function</span> pclip<span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[</span> <span class=nv>$OS_NAME</span> <span class=o>=</span> <span class=s2>&#34;CYGWIN&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        putclip <span class=s2>&#34;</span><span class=nv>$@</span><span class=s2>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=o>[</span> <span class=nv>$OS_NAME</span> <span class=o>=</span> <span class=s2>&#34;Darwin&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        pbcopy <span class=s2>&#34;</span><span class=nv>$@</span><span class=s2>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>[</span> -x /usr/bin/xsel <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>            xsel -ib <span class=s2>&#34;</span><span class=nv>$@</span><span class=s2>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=o>[</span> -x /usr/bin/xclip <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>                xclip -selection c <span class=s2>&#34;</span><span class=nv>$@</span><span class=s2>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span>
</span></span><span class=line><span class=cl>                <span class=nb>echo</span> <span class=s2>&#34;Neither xsel or xclip is installed!&#34;</span>
</span></span><span class=line><span class=cl>            <span class=k>fi</span>
</span></span><span class=line><span class=cl>        <span class=k>fi</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>备注：这个脚本不是我原创，取自 <a href=http://blog.binchen.org/archive.html>陈斌</a> 博客。</p><p>在 Linux 运行这脚本需要先安装 xsel 或者是 xclip 命令。结合生成密钥的命令使用：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>gkey -28<span class=p>|</span>pclip
</span></span></code></pre></td></tr></table></div></div><p>这样，生成的密钥就被复制到系统上了。</p><h3 id=复制当前目录><span class=section-num>2.4</span> 复制当前目录<a hidden class=anchor aria-hidden=true href=#复制当前目录>#</a></h3><p>有时候，我需要复制当前目录下某个文件的路径，但是无论是文件管理器，还是在Shell 中都要用鼠标选中然后复制指定文件的路径，效率不高且很不方便。所以我通过结合 percol 和上面提高的 pclip 函数改进了做法：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=k>function</span> pwdf<span class=o>()</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>local</span> <span class=nv>current_dir</span><span class=o>=</span><span class=sb>`</span><span class=nb>pwd</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>    <span class=nb>local</span> <span class=nv>copied_file</span><span class=o>=</span><span class=sb>`</span>find <span class=nv>$current_dir</span> -type f -print <span class=p>|</span>percol<span class=sb>`</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> -n <span class=nv>$copied_file</span> <span class=p>|</span>pclip<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>只需在 Shell 中输入 <code>pwdf</code>, 然后选择需要复制的路径即可。
运行截图：</p><figure><img loading=lazy src=https://i.imgur.com/Ppkm2xV.gif></figure><hr><p><span class=timestamp-wrapper><span class=timestamp>&lt;2017-05-22 Mon> </span></span>Update</p><h3 id=判断-unix-系统的版本><span class=section-num>2.5</span> 判断 Unix 系统的版本<a hidden class=anchor aria-hidden=true href=#判断-unix-系统的版本>#</a></h3><p>因为我经常需要在不同的 Unix 机器之间切换，例如工作用的 Mac OS X, 另外一台笔记本上的 Fedora, 还有一台工作站上的 Arch Linux, 以及各种发行版本的 VPS 等，在不同的发行版本或者系统之间切换，我希望我常用的工具也可以很轻易地移植到不同的发行版本上。</p><p>但是不同的发行版本使用不同的包安装管理器，例如 OS X 上的 <code>brew</code>, Fedora 的 <code>dnf</code>, Centos 的 <code>yum</code>, Ubuntu 上的 <code>apt-get</code> 等等。如果可以通过使用脚本来实现根据不同的发行版本使用不同的包安装管理器安装软件，这样就省心很多。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># GetOSVersion</span>
</span></span><span class=line><span class=cl><span class=k>function</span> GetOSVersion <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Figure out which vendor we are</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[[</span> -x <span class=s2>&#34;`which sw_vers 2&gt;/dev/null`&#34;</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=c1># OS/X</span>
</span></span><span class=line><span class=cl>        <span class=nv>os_VENDOR</span><span class=o>=</span><span class=sb>`</span>sw_vers -productName<span class=sb>`</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=o>[[</span> -x <span class=k>$(</span>which lsb_release 2&gt;/dev/null<span class=k>)</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=nv>os_VENDOR</span><span class=o>=</span><span class=k>$(</span>lsb_release -i -s<span class=k>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>[[</span> <span class=s2>&#34;Debian,Ubuntu,LinuxMint&#34;</span> <span class=o>=</span>~ <span class=nv>$os_VENDOR</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>            <span class=nv>os_PACKAGE</span><span class=o>=</span><span class=s2>&#34;deb&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=o>[[</span> <span class=s2>&#34;SUSE LINUX&#34;</span> <span class=o>=</span>~ <span class=nv>$os_VENDOR</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>            lsb_release -d -s <span class=p>|</span> grep -q openSUSE
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=o>[[</span> <span class=nv>$?</span> -eq <span class=m>0</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>                <span class=nv>os_VENDOR</span><span class=o>=</span><span class=s2>&#34;openSUSE&#34;</span>
</span></span><span class=line><span class=cl>            <span class=k>fi</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=o>[[</span> <span class=nv>$os_VENDOR</span> <span class=o>==</span> <span class=s2>&#34;openSUSE project&#34;</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>            <span class=nv>os_VENDOR</span><span class=o>=</span><span class=s2>&#34;openSUSE&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=o>[[</span> <span class=nv>$os_VENDOR</span> <span class=o>=</span>~ Red.*Hat <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>            <span class=nv>os_VENDOR</span><span class=o>=</span><span class=s2>&#34;Red Hat&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>fi</span>
</span></span><span class=line><span class=cl>        <span class=nv>os_CODENAME</span><span class=o>=</span><span class=k>$(</span>lsb_release -c -s<span class=k>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=o>[[</span> -r /etc/redhat-release <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=c1># Red Hat Enterprise Linux Server release 5.5 (Tikanga)</span>
</span></span><span class=line><span class=cl>        <span class=c1># Red Hat Enterprise Linux Server release 7.0 Beta (Maipo)</span>
</span></span><span class=line><span class=cl>        <span class=c1># CentOS release 5.5 (Final)</span>
</span></span><span class=line><span class=cl>        <span class=c1># CentOS Linux release 6.0 (Final)</span>
</span></span><span class=line><span class=cl>        <span class=c1># Fedora release 16 (Verne)</span>
</span></span><span class=line><span class=cl>        <span class=c1># XenServer release 6.2.0-70446c (xenenterprise)</span>
</span></span><span class=line><span class=cl>        <span class=c1># Oracle Linux release 7</span>
</span></span><span class=line><span class=cl>        <span class=nv>os_CODENAME</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> r in <span class=s2>&#34;Red Hat&#34;</span> CentOS Fedora XenServer<span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>            <span class=nv>os_VENDOR</span><span class=o>=</span><span class=nv>$r</span>
</span></span><span class=line><span class=cl>        <span class=k>done</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$os_VENDOR</span><span class=s2>&#34;</span> <span class=o>=</span> <span class=s2>&#34;Red Hat&#34;</span> <span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=o>[[</span> -r /etc/oracle-release <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>            <span class=nv>os_VENDOR</span><span class=o>=</span>OracleLinux
</span></span><span class=line><span class=cl>        <span class=k>fi</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=o>[[</span> -r /etc/SuSE-release <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> r in openSUSE <span class=s2>&#34;SUSE Linux&#34;</span><span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=o>[[</span> <span class=s2>&#34;</span><span class=nv>$r</span><span class=s2>&#34;</span> <span class=o>=</span> <span class=s2>&#34;SUSE Linux&#34;</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>                <span class=nv>os_VENDOR</span><span class=o>=</span><span class=s2>&#34;SUSE LINUX&#34;</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span>
</span></span><span class=line><span class=cl>                <span class=nv>os_VENDOR</span><span class=o>=</span><span class=nv>$r</span>
</span></span><span class=line><span class=cl>            <span class=k>fi</span>
</span></span><span class=line><span class=cl>            <span class=nv>os_VENDOR</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>done</span>
</span></span><span class=line><span class=cl>        <span class=c1># If lsb_release is not installed, we should be able to detect Debian OS</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=o>[[</span> -f /etc/debian_version <span class=o>]]</span> <span class=o>&amp;&amp;</span> <span class=o>[[</span> <span class=k>$(</span>cat /proc/version<span class=k>)</span> <span class=o>=</span>~ <span class=s2>&#34;Debian&#34;</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=nv>os_VENDOR</span><span class=o>=</span><span class=s2>&#34;Debian&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl>    <span class=nb>export</span> os_VENDOR
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=根据不同的发行版本安装软件><span class=section-num>2.6</span> 根据不同的发行版本安装软件<a hidden class=anchor aria-hidden=true href=#根据不同的发行版本安装软件>#</a></h3><p>刚刚上面的脚本是为了准确判断出所有的 *nix 系统的，但是方便起见，也可以直接使用=uname= 命令</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=k>$(</span>uname<span class=k>)</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;Darwin&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=c1># Do something under Mac OS X platform</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;This is mac os&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># check if brew exists</span>
</span></span><span class=line><span class=cl>    <span class=nb>type</span> brew&gt;/dev/null 2&gt;<span class=p>&amp;</span><span class=m>1</span> <span class=o>||</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> &gt;<span class=p>&amp;</span><span class=m>2</span> <span class=s2>&#34; require brew but it&#39;s not installed.  Aborting.&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nb>exit</span> 1<span class=p>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;install htop&#34;</span>
</span></span><span class=line><span class=cl>    brew install htop
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;install ag&#34;</span>
</span></span><span class=line><span class=cl>    brew install ag
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;install httpie&#34;</span>
</span></span><span class=line><span class=cl>    brew install httpie
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;install fasd&#34;</span>
</span></span><span class=line><span class=cl>    brew install fasd
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;install tree&#34;</span>
</span></span><span class=line><span class=cl>    brew install tree
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;install shellcheck&#34;</span>
</span></span><span class=line><span class=cl>    brew install shellcheck
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;install guile&#34;</span>
</span></span><span class=line><span class=cl>    brew install guile
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;install proxychains-ng&#34;</span>
</span></span><span class=line><span class=cl>    brew install proxychains-ng
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;install pandoc&#34;</span>
</span></span><span class=line><span class=cl>    brew install pandoc
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;install markdown&#34;</span>
</span></span><span class=line><span class=cl>    brew install markdown
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;install cloc&#34;</span>
</span></span><span class=line><span class=cl>    brew install cloc
</span></span><span class=line><span class=cl><span class=k>elif</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=k>$(</span>expr substr <span class=k>$(</span>uname -s<span class=k>)</span> <span class=m>1</span> 5<span class=k>)</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;Linux&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=c1># Do something under GNU/Linux platform</span>
</span></span><span class=line><span class=cl>    GetOSVersion
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$os_VENDOR</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;Ubuntu&#34;</span> <span class=o>]</span> <span class=o>||</span> <span class=o>[[</span> <span class=s2>&#34;</span><span class=nv>$os_VENDOR</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;Debian&#34;</span> <span class=o>]]</span> <span class=o>||</span> <span class=o>[[</span> <span class=s2>&#34;</span><span class=nv>$os_VENDOR</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;LinuxMint&#34;</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=c1># install htop</span>
</span></span><span class=line><span class=cl>        sudo apt-get install htop -y
</span></span><span class=line><span class=cl>        <span class=c1># install httpie</span>
</span></span><span class=line><span class=cl>        sudo apt-get install httpie -y
</span></span><span class=line><span class=cl>        <span class=c1># install ag</span>
</span></span><span class=line><span class=cl>        sudo apt-get install  silversearcher-ag -y
</span></span><span class=line><span class=cl>        <span class=c1># install zeal</span>
</span></span><span class=line><span class=cl>        sudo apt-get install zeal -y
</span></span><span class=line><span class=cl>        <span class=c1># install ncdu</span>
</span></span><span class=line><span class=cl>        sudo apt-get install ncdu -y
</span></span><span class=line><span class=cl>        <span class=c1># install i3</span>
</span></span><span class=line><span class=cl>        sudo apt-get install i3 -y
</span></span><span class=line><span class=cl>        <span class=c1># install emacs (i could die without it)</span>
</span></span><span class=line><span class=cl>        sudo apt-get install emacs -y
</span></span><span class=line><span class=cl>        <span class=c1># install vim</span>
</span></span><span class=line><span class=cl>        sudo apt-get install vim -y
</span></span><span class=line><span class=cl>        <span class=c1># install tree</span>
</span></span><span class=line><span class=cl>        sudo apt-get install tree -y
</span></span><span class=line><span class=cl>        <span class=c1># install shellcheck</span>
</span></span><span class=line><span class=cl>        sudo apt-get install shellcheck -y
</span></span><span class=line><span class=cl>        <span class=c1># install guile (scheme compiler)</span>
</span></span><span class=line><span class=cl>        sudo apt-get install guile -y
</span></span><span class=line><span class=cl>        <span class=c1># install source code pro font</span>
</span></span><span class=line><span class=cl>        <span class=o>[</span> -d /usr/share/fonts/opentype <span class=o>]</span> <span class=o>||</span> sudo mkdir /usr/share/fonts/opentype
</span></span><span class=line><span class=cl>        sudo git clone https://github.com/adobe-fonts/source-code-pro.git /usr/share/fonts/opentype/scp
</span></span><span class=line><span class=cl>        sudo fc-cache -f -v
</span></span><span class=line><span class=cl>        <span class=c1># install proxychains-ng</span>
</span></span><span class=line><span class=cl>        sudo apt-get install proxychains-ng -y
</span></span><span class=line><span class=cl>        <span class=c1># install pandoc</span>
</span></span><span class=line><span class=cl>        sudo apt-get install pandoc -y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        sudo apt-get install markdown -y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        sudo apt-get install cloc -y
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=o>[</span>  <span class=s2>&#34;</span><span class=nv>$os_VENDOR</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;Fedora&#34;</span> <span class=o>]</span> <span class=o>||</span> <span class=o>[[</span> <span class=s2>&#34;</span><span class=nv>$os_VENDOR</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;CentOS&#34;</span> <span class=o>]]</span> <span class=o>||</span> <span class=o>[[</span> <span class=s2>&#34;</span><span class=nv>$os_VENDOR</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;Korora&#34;</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=c1># install ag</span>
</span></span><span class=line><span class=cl>        sudo yum install -y the_silver_searcher
</span></span><span class=line><span class=cl>        <span class=c1># install zeal</span>
</span></span><span class=line><span class=cl>        sudo yum install -y zeal
</span></span><span class=line><span class=cl>        <span class=c1># install httpie</span>
</span></span><span class=line><span class=cl>        sudo yum install -y httpie
</span></span><span class=line><span class=cl>        <span class=c1># install htop</span>
</span></span><span class=line><span class=cl>        sudo yum install -y htop
</span></span><span class=line><span class=cl>        <span class=c1># install ncdu</span>
</span></span><span class=line><span class=cl>        sudo yum install -y ncdu
</span></span><span class=line><span class=cl>        <span class=c1># install vim</span>
</span></span><span class=line><span class=cl>        sudo yum install -y vim
</span></span><span class=line><span class=cl>        <span class=c1># install emacs</span>
</span></span><span class=line><span class=cl>        sudo yum install -y emacs
</span></span><span class=line><span class=cl>        <span class=c1># install i3</span>
</span></span><span class=line><span class=cl>        sudo yum install -y i3
</span></span><span class=line><span class=cl>        <span class=c1># install tree</span>
</span></span><span class=line><span class=cl>        sudo yum install -y tree
</span></span><span class=line><span class=cl>        <span class=c1># install shellcheck</span>
</span></span><span class=line><span class=cl>        sudo yum install ShellCheck -y
</span></span><span class=line><span class=cl>        <span class=c1># install guile</span>
</span></span><span class=line><span class=cl>        sudo yum install guile -y
</span></span><span class=line><span class=cl>        <span class=c1># install source  code pro font</span>
</span></span><span class=line><span class=cl>        sudo yum install adobe-source-code-pro-fonts -y
</span></span><span class=line><span class=cl>        <span class=c1># install proxychains-ng</span>
</span></span><span class=line><span class=cl>        sudo yum install proxychains-ng -y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        sudo yum install pandoc -y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        sudo yum install markdown -y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># count line and space in code</span>
</span></span><span class=line><span class=cl>        sudo yum install cloc  -y
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=o>[</span>  <span class=s2>&#34;</span><span class=nv>$os_VENDOR</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;Arch&#34;</span> <span class=o>]</span> <span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=c1># install ag</span>
</span></span><span class=line><span class=cl>        sudo pacman -S -y the_silver_searcher
</span></span><span class=line><span class=cl>        <span class=c1># install zeal</span>
</span></span><span class=line><span class=cl>        sudo pacman -S -y zeal
</span></span><span class=line><span class=cl>        <span class=c1># install httpie</span>
</span></span><span class=line><span class=cl>        sudo pacman -S -y httpie
</span></span><span class=line><span class=cl>        <span class=c1># install htop</span>
</span></span><span class=line><span class=cl>        sudo pacman -S -y htop
</span></span><span class=line><span class=cl>        <span class=c1># install ncdu</span>
</span></span><span class=line><span class=cl>        sudo pacman -S -y ncdu
</span></span><span class=line><span class=cl>        <span class=c1># install vim</span>
</span></span><span class=line><span class=cl>        sudo pacman -S -y vim
</span></span><span class=line><span class=cl>        <span class=c1># install emacs</span>
</span></span><span class=line><span class=cl>        sudo pacman -S -y emacs
</span></span><span class=line><span class=cl>        <span class=c1># install i3</span>
</span></span><span class=line><span class=cl>        sudo pacman -S -y i3
</span></span><span class=line><span class=cl>        <span class=c1># install tree</span>
</span></span><span class=line><span class=cl>        sudo pacman -S -y tree
</span></span><span class=line><span class=cl>        <span class=c1># install shellcheck</span>
</span></span><span class=line><span class=cl>        sudo pacman -S ShellCheck -y
</span></span><span class=line><span class=cl>        <span class=c1># install guile</span>
</span></span><span class=line><span class=cl>        sudo pacman -S guile -y
</span></span><span class=line><span class=cl>        <span class=c1># install source-code-pro font</span>
</span></span><span class=line><span class=cl>        sudo pacman -S adobe-source-code-pro-fonts -y
</span></span><span class=line><span class=cl>        <span class=c1># install proxychains-ng</span>
</span></span><span class=line><span class=cl>        sudo pacman -S proxychains-ng -y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        sudo pacman -S pandoc -y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        sudo pacman -S markdown -y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        sudo pacman -S ripgrep -y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        sudo pacman -S cloc  -y
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=k>elif</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=k>$(</span>expr substr <span class=k>$(</span>uname -s<span class=k>)</span> <span class=m>1</span> 10<span class=k>)</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;MINGW32_NT&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=c1># Do something under 32 bits Windows NT platform</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;This is 32-bit windows&#34;</span>
</span></span><span class=line><span class=cl><span class=k>elif</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=k>$(</span>expr substr <span class=k>$(</span>uname -s<span class=k>)</span> <span class=m>1</span> 10<span class=k>)</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;MINGW64_NT&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=c1># Do something under 64 bits Windows NT platform</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;this is 64-bit windows&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=加密目录><span class=section-num>2.7</span> 加密目录<a hidden class=anchor aria-hidden=true href=#加密目录>#</a></h3><p>每个人都会有需要只属于自己的东西，保护这些东西最好的办法就是对其进行加密：</p><h4 id=加密><span class=section-num>2.7.1</span> 加密<a hidden class=anchor aria-hidden=true href=#加密>#</a></h4><p>使用 <code>tar</code> 和 <code>openssl</code> 对目录进行加密，先使用 <code>tar</code> 归档当前文件，然后使用
<code>aes256</code> 算法进行加密：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>tar -czf - * <span class=p>|</span> openssl enc -e -aes256 -out encrypted.tar.gz
</span></span></code></pre></td></tr></table></div></div><h4 id=解密><span class=section-num>2.7.2</span> 解密<a hidden class=anchor aria-hidden=true href=#解密>#</a></h4><p>把加密后的归档文件解密到当前命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>openssl enc -d -aes256 -in encrypted.tar.gz<span class=p>|</span> tar xz -C <span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://ramsayleung.github.io/zh/tags/shell/>shell</a></li><li><a href=https://ramsayleung.github.io/zh/tags/linux/>linux</a></li><li><a href=https://ramsayleung.github.io/zh/tags/command_line/>command_line</a></li><li><a href=https://ramsayleung.github.io/zh/tags/tool/>tool</a></li></ul><nav class=paginav><a class=prev href=https://ramsayleung.github.io/zh/post/2017/uuid/><span class=title>« 上一页</span><br><span>Java UUID 源码剖析</span>
</a><a class=next href=https://ramsayleung.github.io/zh/post/2017/spock/><span class=title>下一页 »</span><br><span>Spock 一个优雅的Groovy/Java测试框架</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share 脚本分享 on x" href="https://x.com/intent/tweet/?text=%e8%84%9a%e6%9c%ac%e5%88%86%e4%ba%ab&amp;url=https%3a%2f%2framsayleung.github.io%2fzh%2fpost%2f2017%2fshare_shell_script%2f&amp;hashtags=shell%2clinux%2ccommand_line%2ctool"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 脚本分享 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2framsayleung.github.io%2fzh%2fpost%2f2017%2fshare_shell_script%2f&amp;title=%e8%84%9a%e6%9c%ac%e5%88%86%e4%ba%ab&amp;summary=%e8%84%9a%e6%9c%ac%e5%88%86%e4%ba%ab&amp;source=https%3a%2f%2framsayleung.github.io%2fzh%2fpost%2f2017%2fshare_shell_script%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 脚本分享 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2framsayleung.github.io%2fzh%2fpost%2f2017%2fshare_shell_script%2f&title=%e8%84%9a%e6%9c%ac%e5%88%86%e4%ba%ab"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 脚本分享 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2framsayleung.github.io%2fzh%2fpost%2f2017%2fshare_shell_script%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 脚本分享 on whatsapp" href="https://api.whatsapp.com/send?text=%e8%84%9a%e6%9c%ac%e5%88%86%e4%ba%ab%20-%20https%3a%2f%2framsayleung.github.io%2fzh%2fpost%2f2017%2fshare_shell_script%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 脚本分享 on telegram" href="https://telegram.me/share/url?text=%e8%84%9a%e6%9c%ac%e5%88%86%e4%ba%ab&amp;url=https%3a%2f%2framsayleung.github.io%2fzh%2fpost%2f2017%2fshare_shell_script%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 脚本分享 on ycombinator" href="https://news.ycombinator.com/submitlink?t=%e8%84%9a%e6%9c%ac%e5%88%86%e4%ba%ab&u=https%3a%2f%2framsayleung.github.io%2fzh%2fpost%2f2017%2fshare_shell_script%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><section><h2>Comments</h2><div id=comments-giscus></div></section><script type=text/javascript>function getCurrentTheme(){return document.documentElement.getAttribute("data-theme")||document.body.classList.contains("dark")?"dark":"light"}function loadComment(e=!1){const s=URL.parse(window.location.href),n=s.pathname.split("/").filter(e=>e!=""),o=n.length>0&&n[0]=="zh",t=document.getElementById("comments-giscus");if(t!==null){t.innerHTML="";const n=document.createElement("script");n.setAttribute("src","https://giscus.app/client.js"),n.setAttribute("data-repo","ramsayleung/comment"),n.setAttribute("data-repo-id","MDEwOlJlcG9zaXRvcnkzMDk2NjQ1NDk="),n.setAttribute("data-category","General"),n.setAttribute("data-category-id","DIC_kwDOEnUbJc4Cltnz"),n.setAttribute("data-mapping","pathname"),n.setAttribute("data-strict","0"),n.setAttribute("data-reactions-enabled","1"),n.setAttribute("data-emit-metadata","0"),n.setAttribute("data-input-position","bottom"),n.setAttribute("data-theme",e?"dark":"light"),n.setAttribute("crossorigin","anonymous"),n.setAttribute("data-lang",o?"zh-CN":"en"),n.setAttribute("async","true"),t.appendChild(n)}}const isDarkMode=getCurrentTheme()==="dark";loadComment(isDarkMode);const themeObserver=new MutationObserver(e=>{e.forEach(e=>{if(e.type==="attributes"&&e.attributeName==="class"){const e=getCurrentTheme()==="dark";loadComment(e),console.log(`changing theme`)}})});themeObserver.observe(document.body,{attributes:!0,attributeFilter:["class"]})</script></article></main><footer class=footer><span>See this site&rsquo;s source code <a href=https://github.com/ramsayleung/ramsayleung.github.io>here</a>, licensed under GPLv3 ·</span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script>const images=Array.from(document.querySelectorAll(".post-content img"));images.forEach(e=>{mediumZoom(e,{margin:0,scrollOffset:40,container:null,template:null})})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>