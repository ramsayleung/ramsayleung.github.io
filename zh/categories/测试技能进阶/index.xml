<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>æµ‹è¯•æŠ€èƒ½è¿›é˜¶ on è¿‡æ²³å’</title>
    <link>https://ramsayleung.github.io/zh/categories/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6/</link>
    <description>Recent content in æµ‹è¯•æŠ€èƒ½è¿›é˜¶ on è¿‡æ²³å’</description>
    <image>
      <title>è¿‡æ²³å’</title>
      <url>https://ramsayleung.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E</url>
      <link>https://ramsayleung.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E</link>
    </image>
    <generator>Hugo -- 0.146.7</generator>
    <language>zh</language>
    <copyright>See this site&amp;rsquo;s source code here, licensed under GPLv3 Â·</copyright>
    <lastBuildDate>Wed, 15 Jan 2025 08:24:24 -0800</lastBuildDate>
    <atom:link href="https://ramsayleung.github.io/zh/categories/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>æµ‹è¯•æŠ€èƒ½è¿›é˜¶(ä¸‰): Property Based Testing</title>
      <link>https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%B8%89_property_based_testing/</link>
      <pubDate>Mon, 14 Oct 2024 09:37:00 -0700</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%B8%89_property_based_testing/</guid>
      <description>&lt;h2 id=&#34;å‰è¨€&#34;&gt;&lt;span class=&#34;section-num&#34;&gt;1&lt;/span&gt; å‰è¨€&lt;/h2&gt;
&lt;h3 id=&#34;test-caseçš„å±€é™&#34;&gt;&lt;span class=&#34;section-num&#34;&gt;1.1&lt;/span&gt; test caseçš„å±€é™&lt;/h3&gt;
&lt;p&gt;æƒ³è¦æ›´å¥½åœ°ç†è§£ä»€ä¹ˆæ˜¯ Property based testing, å°±æ¥å…ˆçœ‹ä¸‹å·²æœ‰ test case çš„å±€é™ï¼Œå†æ¥è§‚å¯Ÿå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨ä¹‹å‰&lt;a href=&#34;https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%BA%8C_parameterized_tests/&#34;&gt;ã€Šæµ‹è¯•æŠ€èƒ½è¿›é˜¶(äºŒ): Parameterized Testsã€‹&lt;/a&gt;ä¸­è®¡ç®—æŠ˜æ‰£çš„å‡½æ•°ä¸ºä¾‹ï¼š&lt;/p&gt;</description>
      <content:encoded><![CDATA[<h2 id="å‰è¨€"><span class="section-num">1</span> å‰è¨€</h2>
<h3 id="test-caseçš„å±€é™"><span class="section-num">1.1</span> test caseçš„å±€é™</h3>
<p>æƒ³è¦æ›´å¥½åœ°ç†è§£ä»€ä¹ˆæ˜¯ Property based testing, å°±æ¥å…ˆçœ‹ä¸‹å·²æœ‰ test case çš„å±€é™ï¼Œå†æ¥è§‚å¯Ÿå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ã€‚</p>
<p>ç”¨ä¹‹å‰<a href="https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%BA%8C_parameterized_tests/">ã€Šæµ‹è¯•æŠ€èƒ½è¿›é˜¶(äºŒ): Parameterized Testsã€‹</a>ä¸­è®¡ç®—æŠ˜æ‰£çš„å‡½æ•°ä¸ºä¾‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">calculate_discount</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">discount_percentage</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">price</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Price must be greater than zero: </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">discount_percentage</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Discount_percentage must be greater than zero: </span><span class="si">{</span><span class="n">discount_percentage</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">price</span> <span class="o">&gt;</span> <span class="mi">50000</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">price</span> <span class="o">-</span> <span class="p">(</span><span class="n">price</span> <span class="o">*</span> <span class="p">(</span><span class="n">discount_percentage</span> <span class="o">*</span> <span class="mf">1.15</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">price</span> <span class="o">&gt;</span> <span class="mi">100000</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">price</span> <span class="o">-</span> <span class="p">(</span><span class="n">price</span> <span class="o">*</span> <span class="p">(</span><span class="n">discount_percentage</span> <span class="o">*</span> <span class="mf">1.18</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">price</span> <span class="o">-</span> <span class="p">(</span><span class="n">price</span> <span class="o">*</span> <span class="n">discount_percentage</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å³ä½¿æˆ‘ä»¬ä½¿ç”¨äº† Parameterized Test, æŠŠæµ‹è¯•é€»è¾‘å’Œæµ‹è¯•æ•°æ®é›†ä½œäº†åˆ†ç¦»ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸¤ä¸ªç¼ºç‚¹ï¼š</p>
<ol>
<li>æˆ‘ä»¬çš„æµ‹è¯•æ•°æ®é›†è¿˜æ˜¯è¦æ‰‹å·¥æ„é€ ï¼Œå³ä½¿ç°åœ¨ä¸éœ€è¦å†™æ–°çš„ test case, æ‰‹å·¥æ„é€ æ•°æ®é›†è¿˜æ˜¯å¾ˆéº»çƒ¦</li>
<li>ç¬¬äºŒä¸ªé—®é¢˜æ›´ä¸¥é‡ï¼Œå°±æ˜¯æˆ‘ä»¬çš„æ„å»ºçš„æ•°æ®é›†å¯èƒ½ä¸æ˜¯å®Œå¤‡çš„ï¼Œå¦‚æœæ•°æ®é›†æ²¡æœ‰åŠæ³•è¦†ç›–æ‰€æœ‰çš„æ¡ä»¶åˆ†æ”¯ï¼Œé‚£æˆ‘ä»¬ä»ç„¶å¯èƒ½å‘ç°ä¸äº†ä»£ç ä¸­çš„Bug</li>
</ol>
<h2 id="property-based-testing"><span class="section-num">2</span> Property Based Testing</h2>
<p>è€Œ Property Based Testing å°±æ˜¯æƒ³è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®ƒå¸Œæœ›å¯ä»¥ç»“åˆäººè„‘å¯¹ç‰¹å®šé—®é¢˜åŸŸçš„ç†è§£å’Œæœºå™¨çš„è¿ç®—èƒ½åŠ›ï¼Œä½¿ç”¨æ›´å°‘çš„æ—¶é—´æ¥ç”Ÿæˆæ›´ä¼˜çš„æµ‹è¯•case.</p>
<p>Property Based Testing è¿™ä¸ªæ¦‚å¿µæ˜¯ç”± Haskell é¡¹ç›® <a href="https://en.wikipedia.org/wiki/QuickCheck">QuickCheck</a>Â <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>åœ¨1999å¹´å¼•å…¥çš„ï¼Œå®ƒçš„ç†å¿µæ˜¯ï¼Œç¨‹åºå‘˜åº”è¯¥åªå®šä¹‰æŸä¸ªæµ‹è¯•case, å‚æ•°éœ€è¦æ»¡è¶³çš„æ ‡å‡†(specification), ç„¶åç¨‹åºå°±ä¼šè‡ªåŠ¨ç”Ÿæˆå¤§é‡æ»¡è¶³è¿™ä¸ªæ ‡å‡†çš„éšæœºæ•°ï¼Œç”¨è¿™äº›éšæœºæ•°æ¥æµ‹è¯•è¿™ä¸ª test caseã€‚</p>
<p>è€Œå› ä¸ºæµ‹è¯•æ•°æ®æ˜¯éšæœºç”Ÿæˆçš„ï¼Œæ‰€ä»¥ä½ æ„æ–™ä¹‹å†…çš„æ•°æ®ï¼Œæˆ–è€…æ„æ–™ä¹‹å¤–çš„æ•°æ®éƒ½ä¼šè¢«ç”¨æ¥æµ‹è¯•ï¼Œ
æ—¢çœå»äº†è´¹æ—¶è´¹åŠ›æ„é€ ä¸åŒæ•°æ®ä½œæ•°æ®é›†æ¥æµ‹è¯•çš„çƒ¦æ¼ï¼Œåˆèƒ½ä¿è¯æ•°æ®é›†çš„å®Œå¤‡æ€§, ç»å¸¸å¯ä»¥å¸®åŠ©ä½ å‘ç°æ„æƒ³ä¸åˆ°çš„bug.</p>
<p>è¿™å°±æ˜¯å£°æ˜å¼å®šä¹‰çš„ä¸€ç§ï¼Œä½ åªéœ€è¦å£°æ˜ä½ æƒ³å¹²ä»€ä¹ˆ(ç”¨ä»€ä¹ˆæ ·çš„æ•°æ®æµ‹è¯•ä»€ä¹ˆå‡½æ•°)ï¼Œè€Œéå‘½ä»¤å¼å®šä¹‰ï¼ˆä½ éœ€è¦å®šä¹‰ä½ è¦æ€ä¹ˆåšï¼‰.</p>
<p>äººåŠ›åº”è¯¥æ˜¯å¾ˆçè´µï¼Œè€Œæœºå™¨çš„è®¡ç®—èµ„æºå´æ˜¯å¾ˆä¾¿å®œï¼Œåº”è¯¥è®©æœºå™¨ä»£æ›¿äººå»åšç”Ÿæˆæ•°æ®çš„äº‹ã€‚</p>
<p>ä¸¾ä¾‹æ¥è¯´, ä»¥ä¸Šé¢çš„ <code>calculate_discount</code> å‡½æ•°ä¸ºä¾‹ï¼Œå¦‚æœæˆ‘ä»¬å‘Šè¯‰ç¨‹åº, <code>price</code> å’Œ <code>discount_percentage</code> åº”è¯¥æ˜¯æ•´æ•°ï¼ˆspecificationï¼‰, é‚£ä¹ˆ Quickcheck å°±ä¼šç”Ÿæˆå„ç§æ•´æ•°, ä» Integer.Min åˆ° Integer.Max ä¸ç­‰ï¼Œç”¨æ¥æµ‹è¯•æˆ‘ä»¬çš„ç¨‹åº.</p>
<p>å¦‚æœè¿˜æ˜¯è§‰å¾—è¿™ä¸ªæ¦‚å¿µæ¯”è¾ƒæŠ½è±¡ï¼Œå¯ä»¥æ¥çœ‹ä¸‹å…·ä½“çš„ä¾‹å­ï¼š</p>
<h2 id="hypothesis"><span class="section-num">3</span> Hypothesis</h2>
<p>Python Property Based Testingçš„æµ‹è¯•æ¡†æ¶å« <a href="https://hypothesis.works/">Hypothesis </a><sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>(å‡æƒ³)ï¼Œè¿™ä¸ªé¡¹ç›®åå­—ä¹Ÿæ˜¯èµ·å¾—éå¸¸æœ‰æ°´å¹³ï¼Œç»“åˆProperty Based Testingçš„å“²å­¦ï¼Œå¯è°“ä¿¡é›…è¾¾.</p>
<p>å‡è®¾æˆ‘ä»¬ç°åœ¨è¦å®ç°ä¸€ä¸ªç®€å•çš„æ•°æ®å‹ç¼©çš„ç®—æ³•ï¼š <a href="https://en.wikipedia.org/wiki/Run-length_encoding">Run-length Encoding</a>Â <sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>(RLE)ï¼Œé€šå¸¸ç”¨äºå‹ç¼©åŒ…å«è¿ç»­é‡å¤æ•°æ®çš„åºåˆ—, è¿™ç§ç¼–ç æ–¹æ³•ç‰¹åˆ«é€‚ç”¨äºé‚£äº›æœ‰å¤§é‡é‡å¤å­—ç¬¦æˆ–å€¼çš„æ•°æ®.</p>
<p>å®ƒçš„åŸºæœ¬åŸç†æ˜¯ï¼š</p>
<ol>
<li>ç»Ÿè®¡è¿ç»­é‡å¤çš„æ•°æ®å…ƒç´ çš„æ•°é‡ã€‚</li>
<li>ç”¨ä¸€ä¸ªè®¡æ•°å€¼å’Œæ•°æ®å€¼çš„ç»„åˆæ¥æ›¿ä»£è¿™äº›é‡å¤çš„æ•°æ®ã€‚</li>
</ol>
<p>æ¯”å¦‚å­—ç¬¦ä¸²: <code>AABBBCCCC</code>, RLE ç¼–ç å: <code>2A3B4C</code>. <code>2A</code> è¡¨ç¤ºä¸¤ä¸ªè¿ç»­çš„ <code>A</code>, <code>3B</code> è¡¨ç¤ºä¸‰ä¸ªè¿ç»­çš„ <code>B</code>, <code>4C</code> è¡¨ç¤ºå››ä¸ªè¿ç»­çš„ <code>C</code> ã€‚</p>
<p>Pythonå®ç°å¦‚ä¸‹:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="n">input_string</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">prev</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">character</span> <span class="ow">in</span> <span class="n">input_string</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">character</span> <span class="o">!=</span> <span class="n">prev</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">prev</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">entry</span> <span class="o">=</span> <span class="p">(</span><span class="n">prev</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="n">prev</span> <span class="o">=</span> <span class="n">character</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">entry</span> <span class="o">=</span> <span class="p">(</span><span class="n">character</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">lst</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">character</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">q</span> <span class="o">+=</span> <span class="n">character</span> <span class="o">*</span> <span class="n">count</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">q</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æœæˆ‘ä»¬çš„ä»£ç å®ç°æ²¡æœ‰é—®é¢˜çš„è¯ï¼Œå¯¹äºä»»æ„çš„å­—ç¬¦ä¸²ï¼Œç¼–ç åçš„å­—ç¬¦ä¸²ï¼Œè§£ç åçš„ç»“æœåº”è¯¥å’ŒåŸæ¥çš„å­—ç¬¦ä¸²ä¸€è‡´çš„ï¼Œè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬çš„æµ‹è¯•é€»è¾‘:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">hypothesis</span> <span class="kn">import</span> <span class="n">given</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">hypothesis.strategies</span> <span class="kn">import</span> <span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@given</span><span class="p">(</span><span class="n">text</span><span class="p">())</span> <span class="c1"># å…¥å‚çš„æ ‡å‡†æ˜¯ï¼šä»»æ„çš„å­—ç¬¦ä¸²ï¼Œhypothesis æ¡†æ¶å°±ä¼šè‡ªåŠ¨ç”Ÿæˆéšæœºæ•°ï¼Œå¹¶è°ƒç”¨test_decode_inverts_encode</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_decode_inverts_encode</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">decode</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">==</span> <span class="n">s</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨ <code>pytest</code> è¿è¡Œä¸Šé¢çš„ç”¨ä¾‹ï¼Œç»“æœå¦‚ä¸‹:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; pytest property_based_testing.py
</span></span><span class="line"><span class="cl"><span class="o">===================================</span> <span class="nb">test</span> session <span class="nv">starts</span> <span class="o">====================================</span>
</span></span><span class="line"><span class="cl">platform darwin -- Python 3.12.6, pytest-8.3.3, pluggy-1.5.0
</span></span><span class="line"><span class="cl">rootdir: /Users/ramsayleung/code/python/test_technique
</span></span><span class="line"><span class="cl">plugins: hypothesis-6.115.0
</span></span><span class="line"><span class="cl">collected <span class="m">1</span> item
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">property_based_testing.py F                                                          <span class="o">[</span>100%<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">=========================================</span> <span class="nv">FAILURES</span> <span class="o">=========================================</span>
</span></span><span class="line"><span class="cl">________________________________ test_decode_inverts_encode ________________________________
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">@given<span class="o">(</span>text<span class="o">())</span>
</span></span><span class="line"><span class="cl">&gt;   def test_decode_inverts_encode<span class="o">(</span>s<span class="o">)</span>:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">property_based_testing.py:29:
</span></span><span class="line"><span class="cl">_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
</span></span><span class="line"><span class="cl">property_based_testing.py:30: in test_decode_inverts_encode
</span></span><span class="line"><span class="cl">assert decode<span class="o">(</span>encode<span class="o">(</span>s<span class="o">))</span> <span class="o">==</span> s
</span></span><span class="line"><span class="cl">_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">input_string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">def encode<span class="o">(</span>input_string<span class="o">)</span>:
</span></span><span class="line"><span class="cl"><span class="nv">count</span> <span class="o">=</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="nv">prev</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">lst</span> <span class="o">=</span> <span class="o">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> character in input_string:
</span></span><span class="line"><span class="cl">                 <span class="k">if</span> character !<span class="o">=</span> prev:
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> prev:
</span></span><span class="line"><span class="cl">                       <span class="nv">entry</span> <span class="o">=</span> <span class="o">(</span>prev, count<span class="o">)</span>
</span></span><span class="line"><span class="cl">                       lst.append<span class="o">(</span>entry<span class="o">)</span>
</span></span><span class="line"><span class="cl">                       <span class="nv">count</span> <span class="o">=</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">                       <span class="nv">prev</span> <span class="o">=</span> character
</span></span><span class="line"><span class="cl">                       <span class="k">else</span>:
</span></span><span class="line"><span class="cl">                       <span class="nv">count</span> <span class="o">+=</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">                       &gt;       <span class="nv">entry</span> <span class="o">=</span> <span class="o">(</span>character, count<span class="o">)</span>
</span></span><span class="line"><span class="cl">                       E       UnboundLocalError: cannot access <span class="nb">local</span> variable <span class="s1">&#39;character&#39;</span> where it is not associated with a value
</span></span><span class="line"><span class="cl">                       E       Falsifying example: test_decode_inverts_encode<span class="o">(</span>
</span></span><span class="line"><span class="cl">                           E           <span class="nv">s</span><span class="o">=</span><span class="s1">&#39;&#39;</span>,
</span></span><span class="line"><span class="cl">                           E       <span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                       property_based_testing.py:17: <span class="nv">UnboundLocalError</span>
</span></span><span class="line"><span class="cl">                       <span class="o">=================================</span> short <span class="nb">test</span> summary <span class="nv">info</span> <span class="o">==================================</span>
</span></span><span class="line"><span class="cl">                       FAILED property_based_testing.py::test_decode_inverts_encode - UnboundLocalError: cannot access <span class="nb">local</span> variable <span class="s1">&#39;character&#39;</span> where it is not associated ...
</span></span><span class="line"><span class="cl">                       <span class="o">====================================</span> <span class="m">1</span> failed in 0.14s <span class="o">=====================================</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°ï¼Œå½“ <code>input_string =''</code> æ˜¯ç©ºå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œ <code>encode</code> å‡½æ•°æŠ›å‡ºå¼‚å¸¸äº†ï¼Œè¯´ <code>character</code> å˜é‡æœªå®šä¹‰ã€‚åŸæ¥æ˜¯ <code>encode</code> å‡½æ•°æ²¡æœ‰å¯¹ç©ºå­—ç¬¦ä¸²è¿™ä¸ª corner case ä½œå¤„ç†ï¼Œé‚£ä¹ˆå°±åŠ ä¸ªåˆ¤æ–­æ¡ä»¶ï¼Œä¿®å¤ä¸€ä¸‹:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="n">input_string</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">input_string</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">prev</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">character</span> <span class="ow">in</span> <span class="n">input_string</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">character</span> <span class="o">!=</span> <span class="n">prev</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">prev</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">entry</span> <span class="o">=</span> <span class="p">(</span><span class="n">prev</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="n">prev</span> <span class="o">=</span> <span class="n">character</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">entry</span> <span class="o">=</span> <span class="p">(</span><span class="n">character</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">lst</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ—¢ç„¶æˆ‘ä»¬çŸ¥é“ç©ºå­—ç¬¦ä¸²æ˜¯ä¸ªç‰¹æ®Šçš„ case, å› ä¸º hypothesis ç”Ÿæˆçš„éƒ½æ˜¯ä»»æ„çš„éšæœºæ•°ï¼Œä¸ä¸€å®šæ¯æ¬¡éƒ½ä¼šæµ‹åˆ°ç©ºå­—ç¬¦ä¸²ï¼Œé‚£æˆ‘ä»¬å°±è‡ªå·±æŒ‡å®šä¸€ä¸ª case:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">hypothesis</span> <span class="kn">import</span> <span class="n">example</span><span class="p">,</span> <span class="n">given</span><span class="p">,</span> <span class="n">strategies</span> <span class="k">as</span> <span class="n">st</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@given</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nd">@example</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">)</span> <span class="c1"># æ‰‹å·¥æŒ‡å®šç©ºå­—ç¬¦ä¸²è¿™ä¸ª corner case</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_decode_inverts_encode</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">decode</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">==</span> <span class="n">s</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>pytest</code> é‡æ–°è¿è¡Œï¼Œæµ‹è¯•å°±é€šè¿‡äº†ã€‚ä½†æ˜¯ï¼Œå¯¹ <code>hypothesis</code> æ¡†æ¶è¿˜æ²¡æœ‰å»ºç«‹ä¿¡å¿ƒçš„ä½ æˆ‘å°±ä¸ç¡®å®šï¼Œå®ƒæ˜¯å¦çœŸçš„ç”Ÿæˆå¾ˆå¤šéšæœºæ¥è¿è¡Œè¿™ä¸ª test case å‘¢ï¼Ÿ</p>
<p>æœ‰ä¸¤ä¸ªæ–¹æ³•å¯ä»¥éªŒè¯ï¼š</p>
<p>æ–¹æ³•ä¸€ï¼šæœ€ç®€å•ç²—æš´çš„æ–¹å¼ï¼ŒæŠŠ <code>s</code> å˜é‡ç»™æ‰“å°å‡ºæ¥ï¼Œæ¯•ç«Ÿçœ¼è§ä¸ºå®:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@given</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nd">@example</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_decode_inverts_encode</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">decode</span><span class="p">(</span><span class="n">encode</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">==</span> <span class="n">s</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åé€šè¿‡ <code>pytest -s</code> å‚æ•°è¦æ±‚ <code>pytest</code> å°†å†™å…¥åˆ° <code>stdout</code> çš„å†…å®¹ç»™æ‰“å°å‡ºæ¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; pytest property_based_testing.py -s
</span></span><span class="line"><span class="cl"><span class="o">=======================================</span> <span class="nb">test</span> session <span class="nv">starts</span> <span class="o">=======================================</span>
</span></span><span class="line"><span class="cl">platform darwin -- Python 3.12.6, pytest-8.3.3, pluggy-1.5.0
</span></span><span class="line"><span class="cl">rootdir: /Users/ramsayleung/code/python/test_technique
</span></span><span class="line"><span class="cl">plugins: hypothesis-6.115.0
</span></span><span class="line"><span class="cl">collected <span class="m">1</span> item
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">property_based_testing.py
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">O
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Â¶
</span></span><span class="line"><span class="cl"><span class="se">\Ã¥</span>ñ¢„Â«
</span></span><span class="line"><span class="cl">ğ¥›—ÃbÃ³
</span></span><span class="line"><span class="cl">ğœ†®Ã¥
</span></span><span class="line"><span class="cl">ñ°˜°9
</span></span><span class="line"><span class="cl">gahó­¾”ğ›§
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">iò¼¯œ+Ã³Â»ò®©¸bñ•¨
</span></span><span class="line"><span class="cl">S!Ã•TÃ¥<span class="p">&amp;</span>ğ°µ©Ã­Â¤Ã½Ã¤Ã³Ã·F
</span></span><span class="line"><span class="cl">Ã¸Ã´yÂµ
</span></span><span class="line"><span class="cl">Ã„Âª
</span></span><span class="line"><span class="cl">sLz$Ã¯
</span></span><span class="line"><span class="cl">_ğ µˆ
</span></span><span class="line"><span class="cl">Ãœ
</span></span><span class="line"><span class="cl">A
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Róƒ·<span class="o">{</span>Â©Â¾
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Ã¬Ãµ
</span></span><span class="line"><span class="cl">   Ã¦ô‚›BÃ1*ô…„¢Ã«Ã³gğ®ˆÂ¼ ?ğ©“
</span></span><span class="line"><span class="cl">   Ã’Ã¶r @PPô¾‚Ã¶ñ³±ŠÃ»ÃÂ½Â¬HÃˆ6#
</span></span><span class="line"><span class="cl">   ağ£½—Â¶ó¿…Œğ§‘x~ó—œ¬éŸ¹Ã»Ã°ó´¯®#Zó…–«<span class="se">\Â©</span>ğ³–…Ã»f&gt;
</span></span><span class="line"><span class="cl">   i
</span></span><span class="line"><span class="cl">   ....
</span></span><span class="line"><span class="cl">   <span class="o">========================================</span> <span class="m">1</span> passed in 0.15s <span class="o">========================================</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸€å †éƒ½æ˜¯ä»€ä¹ˆå­—ç¬¦å‘¢, éƒ½ä¹±ç äº†ã€‚</p>
<p>æ¯•ç«Ÿæˆ‘ä»¬å‘Šè¯‰ <code>hypothesis</code> æ¡†æ¶çš„æ˜¯ï¼Œæˆ‘ä»¬å‚æ•°æ¥å—çš„æ ‡å‡†æ˜¯ä»»æ„çš„å­—ç¬¦ä¸²ï¼Œ <code>hypothesis</code> å°±éå¸¸å°½èŒåœ°å¸®æˆ‘ä»¬ç”Ÿæˆäº†å„ç§å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªæµ‹è¯•æ•°æ®é›†å¯æ¯”æˆ‘ä»¬è‡ªå·±æ‰‹å·¥æ„å»ºçš„èŒƒå›´å¤§å¾—å¤šï¼Œè¿™å°±æ˜¯ property based testing çš„ä¼˜åŠ¿æ‰€åœ¨.</p>
<p>ç¬¬äºŒç§æ–¹æ³•æ˜¯ä½¿ç”¨ <code>hypothesis</code> æ¡†æ¶æä¾›çš„å‘½ä»¤è¡Œå‚æ•° =&ndash;hypothesis-show-statistics=ï¼Œç”¨äºæ‰“å°ç»Ÿè®¡ä¿¡æ¯:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; pytest property_based_testing.py --hypothesis-show-statistics
</span></span><span class="line"><span class="cl"><span class="o">=======================================</span> <span class="nb">test</span> session <span class="nv">starts</span> <span class="o">=======================================</span>
</span></span><span class="line"><span class="cl">platform darwin -- Python 3.12.6, pytest-8.3.3, pluggy-1.5.0
</span></span><span class="line"><span class="cl">rootdir: /Users/ramsayleung/code/python/test_technique
</span></span><span class="line"><span class="cl">plugins: hypothesis-6.115.0
</span></span><span class="line"><span class="cl">collected <span class="m">1</span> item
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">property_based_testing.py .                                                                 <span class="o">[</span>100%<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">======================================</span> Hypothesis <span class="nv">Statistics</span> <span class="o">======================================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">property_based_testing.py::test_decode_inverts_encode:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">- during generate phase <span class="o">(</span>0.03 seconds<span class="o">)</span>:
</span></span><span class="line"><span class="cl">- Typical runtimes: &lt; 1ms, of which &lt; 1ms in data generation
</span></span><span class="line"><span class="cl">- <span class="m">100</span> passing examples, <span class="m">0</span> failing examples, <span class="m">0</span> invalid examples
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">- Stopped because settings.max_examples<span class="o">=</span><span class="nv">100</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">========================================</span> <span class="m">1</span> passed in 0.05s <span class="o">========================================</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šé¢è¿è¡Œäº† 100 æ¡æ•°æ®ï¼Œå¦‚æœä½ è§‰å¾—è¿˜æƒ³è·‘æ›´å¤šï¼Œå¯ä»¥é€šè¿‡ <code>settings</code> è£…é¥°å™¨æŒ‡å®šæ›´å¤š:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@settings</span><span class="p">(</span><span class="n">max_examples</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="quickcheck-and-proptest"><span class="section-num">4</span> Quickcheck &amp; Proptest</h2>
<p>è€Œåœ¨Rustç”Ÿæ€ï¼Œå°±æœ‰ä¸¤ä¸ª Property Based Testing çš„åº“ï¼Œä¸€ä¸ªæ˜¯ç”±Rustç¤¾åŒºçŸ¥åå¼€å‘è€…ï¼Œ<a href="https://github.com/BurntSushi/ripgrep">ripgrep</a>Â <sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>å’Œ regex åº“ä½œè€…ç§»æ¤è‡ª Haskell Quickcheck åº“çš„ <a href="https://github.com/BurntSushi/quickcheck">quickcheck</a>Â <sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup>(åå­—ä¹Ÿä¸€å¹¶ç§»æ¤äº†), å¦å¤–ä¸€ä¸ªæ˜¯æ€è·¯ç»§æ‰¿è‡ª Python Hypothesis çš„ <a href="https://github.com/proptest-rs/proptest">Proptest</a>Â <sup id="fnref:6"><a href="#fn:6" class="footnote-ref" role="doc-noteref">6</a></sup>(è¿™ä½ç›´æ¥ç”¨property based testingæŠ€æœ¯æ¥å‘½åäº†ï¼Œä¸å¾—ä¸è¯´ï¼Œå‘½åçœŸçš„æ˜¯é—¨è‰ºæœ¯)</p>
<p>ä¸¤è€…çš„ç¤¾åŒºæ¥å—åº¦éƒ½ç›¸å·®æ— å‡ (star, ä½¿ç”¨è€…æ•°é‡), è€Œåœ¨å…¬å¸å†…éƒ¨ï¼Œæˆ‘ä¹Ÿå‘ç° quickcheck å’Œ proptest éƒ½æœ‰äººç”¨ï¼Œåæˆ‘æ—è¾¹çš„Principle Engineer ç”¨çš„æ˜¯ proptest, è€Œå¦å¤–ä¸€ä¸ªç°åœ¨å’Œæˆ‘å…±äº‹çš„åŒäº‹ï¼Œå¥¹çš„ä¹‹å‰å›¢é˜Ÿç”¨çš„å°±æ˜¯ quickcheckï¼Œçœ‹åˆ°éƒ½åŠ¿å‡åŠ›æ•Œå˜›ã€‚</p>
<p>ç¿»å¼€ quickcheck å’Œ proptest çš„API æ–‡æ¡£ä¹‹åï¼Œæˆ‘å‘ç°æˆ‘æ›´å–œæ¬¢ quickcheck çš„æ¥å£é£æ ¼ï¼Œè™½è¯´å®ƒçš„æ´»è·ƒåº¦æ›´ä½ä¸€äº›ï¼Œæˆ‘æœ€åè¿˜æ˜¯é€‰æ‹©äº†ä½¿ç”¨ quickcheck.</p>
<p>ä¸‹é¢å°±æ¥ä»‹ç»ä¸€ä¸‹æˆ‘åœ¨Rustä¸Šä½¿ç”¨ quickcheck çš„å¿ƒå¾—:</p>
<p>å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªå¯ä»¥åè½¬åˆ—è¡¨çš„å‡½æ•° <code>reverse</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">reverse</span><span class="o">&lt;</span><span class="n">T</span>: <span class="nb">Clone</span><span class="o">&gt;</span><span class="p">(</span><span class="n">xs</span>: <span class="kp">&amp;</span><span class="p">[</span><span class="n">T</span><span class="p">])</span><span class="w"> </span>-&gt; <span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="fm">vec!</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">rev</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">clone</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">rev</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¯¹äºä»»æ„ç±»å‹çš„åˆ—è¡¨ï¼Œåè½¬ä¹‹åå†åè½¬çš„ç»“æœï¼Œè‚¯å®šæ˜¯å’ŒåŸç»“æœä¸€æ ·çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å£°æ˜æˆ‘ä»¬çš„æ ‡å‡†(specification), é‚£å°±æ˜¯ä»»æ„çš„åˆ—è¡¨ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œæ•´å‹åˆ—è¡¨æˆ–è€…æ˜¯å…¶ä»–çš„ç»“æ„ä½“åˆ—è¡¨:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="cp">#[cfg(test)]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">mod</span> <span class="nn">tests</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="n">quickcheck_macros</span>::<span class="n">quickcheck</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="k">crate</span>::<span class="n">reverse</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cp">#[quickcheck]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">double_reversal_is_identity_isize</span><span class="p">(</span><span class="n">xs</span>: <span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">isize</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">xs</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="o">&amp;</span><span class="n">reverse</span><span class="p">(</span><span class="o">&amp;</span><span class="n">xs</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cp">#[quickcheck]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">double_reversal_is_identity_string</span><span class="p">(</span><span class="n">xs</span>: <span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">xs</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="o">&amp;</span><span class="n">reverse</span><span class="p">(</span><span class="o">&amp;</span><span class="n">xs</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Rust çš„unit test æ˜¯ä¸æ”¯æŒå¸¦å‚æ•°çš„ï¼Œ=#[quickcheck]= è¿™ä¸ªå®å°±ä¼šè‡ªåŠ¨å°† <code>double_reversal_is_identity_isize</code> è½¬æ¢æˆ property based test case, è€Œå¾—ç›ŠäºRustçš„ç±»å‹ç³»ç»Ÿ, <code>quickcheck</code> å°±èƒ½æ¨æ–­å‡ºå…¥å‚å°±æ˜¯æˆ‘ä»¬å£°æ˜çš„æ ‡å‡† <code>Vec&lt;isze&gt;</code>, ä»»æ„ <code>isize</code> ç±»å‹çš„æ•°ç»„.</p>
<h3 id="struct-with-quickcheck"><span class="section-num">4.1</span> Struct with quickcheck</h3>
<p>å¦‚æœä¸Šé¢çš„ä¾‹å­è§‰å¾—è¿‡äºç®€å•çš„è¯ï¼Œç°åœ¨å°±è®©æˆ‘ä»¬çœ‹ä¸ªå¤æ‚ä¸€ç‚¹çš„ä¾‹å­, ä¸€ä¸ªç®€å•çš„å›¾ä¹¦ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒä¼šå‘˜ï¼Œå€Ÿä¹¦ï¼Œè¿˜ä¹¦åŠŸèƒ½ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">chrono</span>::<span class="p">{</span><span class="n">Duration</span><span class="p">,</span><span class="w"> </span><span class="n">NaiveDate</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">collections</span>::<span class="n">HashMap</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cp">#[derive(Debug, Clone, PartialEq)]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">struct</span> <span class="nc">Book</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">isbn</span>: <span class="nb">String</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">title</span>: <span class="nb">String</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">author</span>: <span class="nb">String</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">publication_year</span>: <span class="kt">u16</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cp">#[derive(Debug, Clone, PartialEq)]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">struct</span> <span class="nc">Member</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span>: <span class="kt">u32</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span>: <span class="nb">String</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">email</span>: <span class="nb">String</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cp">#[derive(Debug, Clone)]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">struct</span> <span class="nc">Loan</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">book_isbn</span>: <span class="nb">String</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">member_id</span>: <span class="kt">u32</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">due_date</span>: <span class="nc">NaiveDate</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cp">#[derive(Debug, Clone)]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">struct</span> <span class="nc">Library</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">books</span>: <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="n">Book</span><span class="o">&gt;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">members</span>: <span class="nc">HashMap</span><span class="o">&lt;</span><span class="kt">u32</span><span class="p">,</span><span class="w"> </span><span class="n">Member</span><span class="o">&gt;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">loans</span>: <span class="nb">Vec</span><span class="o">&lt;</span><span class="n">Loan</span><span class="o">&gt;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">current_date</span>: <span class="nc">NaiveDate</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">Library</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">new</span><span class="p">(</span><span class="n">current_date</span>: <span class="nc">NaiveDate</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">Self</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Library</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">books</span>: <span class="nc">HashMap</span>::<span class="n">new</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">members</span>: <span class="nc">HashMap</span>::<span class="n">new</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">loans</span>: <span class="nb">Vec</span>::<span class="n">new</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">current_date</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">add_book</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">book</span>: <span class="nc">Book</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span><span class="p">(),</span><span class="w"> </span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">books</span><span class="p">.</span><span class="n">contains_key</span><span class="p">(</span><span class="o">&amp;</span><span class="n">book</span><span class="p">.</span><span class="n">isbn</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nb">Err</span><span class="p">(</span><span class="s">&#34;Book with this ISBN already exists&#34;</span><span class="p">.</span><span class="n">to_string</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="bp">self</span><span class="p">.</span><span class="n">books</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">book</span><span class="p">.</span><span class="n">isbn</span><span class="p">.</span><span class="n">clone</span><span class="p">(),</span><span class="w"> </span><span class="n">book</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nb">Ok</span><span class="p">(())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">add_member</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">member</span>: <span class="nc">Member</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span><span class="p">(),</span><span class="w"> </span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">members</span><span class="p">.</span><span class="n">contains_key</span><span class="p">(</span><span class="o">&amp;</span><span class="n">member</span><span class="p">.</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nb">Err</span><span class="p">(</span><span class="s">&#34;Member with this ID already exists&#34;</span><span class="p">.</span><span class="n">to_string</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="bp">self</span><span class="p">.</span><span class="n">members</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">member</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">member</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nb">Ok</span><span class="p">(())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">loan_book</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">book_isbn</span>: <span class="kp">&amp;</span><span class="kt">str</span><span class="p">,</span><span class="w"> </span><span class="n">member_id</span>: <span class="kt">u32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span><span class="p">(),</span><span class="w"> </span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="bp">self</span><span class="p">.</span><span class="n">books</span><span class="p">.</span><span class="n">contains_key</span><span class="p">(</span><span class="n">book_isbn</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nb">Err</span><span class="p">(</span><span class="s">&#34;Book not found&#34;</span><span class="p">.</span><span class="n">to_string</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="bp">self</span><span class="p">.</span><span class="n">members</span><span class="p">.</span><span class="n">contains_key</span><span class="p">(</span><span class="o">&amp;</span><span class="n">member_id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nb">Err</span><span class="p">(</span><span class="s">&#34;Member not found&#34;</span><span class="p">.</span><span class="n">to_string</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">loans</span><span class="p">.</span><span class="n">iter</span><span class="p">().</span><span class="n">any</span><span class="p">(</span><span class="o">|</span><span class="n">loan</span><span class="o">|</span><span class="w"> </span><span class="n">loan</span><span class="p">.</span><span class="n">book_isbn</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">book_isbn</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nb">Err</span><span class="p">(</span><span class="s">&#34;Book is already on loan&#34;</span><span class="p">.</span><span class="n">to_string</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">due_date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">current_date</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Duration</span>::<span class="n">days</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">loans</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">Loan</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">book_isbn</span>: <span class="nc">book_isbn</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">member_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">due_date</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nb">Ok</span><span class="p">(())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">return_book</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">book_isbn</span>: <span class="kp">&amp;</span><span class="kt">str</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span><span class="p">(),</span><span class="w"> </span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="n">loans</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="n">iter</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="n">position</span><span class="p">(</span><span class="o">|</span><span class="n">loan</span><span class="o">|</span><span class="w"> </span><span class="n">loan</span><span class="p">.</span><span class="n">book_isbn</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">book_isbn</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="bp">self</span><span class="p">.</span><span class="n">loans</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">index</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nb">Ok</span><span class="p">(())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nb">Err</span><span class="p">(</span><span class="s">&#34;Book is not currently on loan&#34;</span><span class="p">.</span><span class="n">to_string</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>é€šè¿‡ä¸Šé¢çš„ç®€å•ä»£ç ï¼Œå°±å®ç°äº†æ–°å¢å›¾ä¹¦ï¼Œæ–°å¢ä¼šå‘˜ï¼Œå€Ÿä¹¦ï¼Œå’Œè¿˜ä¹¦åŠŸèƒ½ã€‚ç°åœ¨å°±è®©æˆ‘ä»¬æ¥ç»“åˆ <code>quickcheck</code> çš„ <code>Arbitrary</code> æ¥å£ï¼Œå®ç°ç”Ÿæˆä»»æ„çš„å›¾ä¹¦å’Œä¼šå‘˜ï¼Œä»¥ä¾¿ç”¨äºæµ‹è¯•:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">quickcheck</span>::<span class="p">{</span><span class="n">Arbitrary</span><span class="p">,</span><span class="w"> </span><span class="n">Gen</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">Arbitrary</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Book</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">arbitrary</span><span class="p">(</span><span class="n">g</span>: <span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">Gen</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">Self</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Book</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// isbnå¿…é¡»ä»¥`ISBN` å¼€å¤´ï¼Œåæ¥ä»»æ„çš„å¤§äºç­‰äº0ï¼Œå°äºuint32.max_value
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="c1">// çš„æ•´å‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="n">isbn</span>: <span class="nc">format</span><span class="o">!</span><span class="p">(</span><span class="s">&#34;ISBN-{}&#34;</span><span class="p">,</span><span class="w"> </span><span class="kt">u32</span>::<span class="n">arbitrary</span><span class="p">(</span><span class="n">g</span><span class="p">)),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">title</span>: <span class="nb">String</span>::<span class="n">arbitrary</span><span class="p">(</span><span class="n">g</span><span class="p">),</span><span class="w"> </span><span class="c1">// ä»»æ„çš„å­—ç¬¦ä¸²
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="n">author</span>: <span class="nb">String</span>::<span class="n">arbitrary</span><span class="p">(</span><span class="n">g</span><span class="p">),</span><span class="w"> </span><span class="c1">// ä»»æ„çš„å­—ç¬¦ä¸²
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="n">publication_year</span>: <span class="o">*</span><span class="n">g</span><span class="p">.</span><span class="n">choose</span><span class="p">(</span><span class="o">&amp;</span><span class="p">[</span><span class="mi">2014_</span><span class="k">u16</span><span class="p">,</span><span class="w"> </span><span class="mi">2022_</span><span class="k">u16</span><span class="p">,</span><span class="w"> </span><span class="mi">2025_</span><span class="k">u16</span><span class="p">]).</span><span class="n">unwrap</span><span class="p">(),</span><span class="w"> </span><span class="c1">// 2014,2022æˆ–2025å¹´å‡ºç‰ˆçš„ä¹¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">Arbitrary</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Member</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">arbitrary</span><span class="p">(</span><span class="n">g</span>: <span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">Gen</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">Self</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Member</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">id</span>: <span class="kt">u32</span>::<span class="n">arbitrary</span><span class="p">(</span><span class="n">g</span><span class="p">),</span><span class="w"> </span><span class="c1">// ä»»æ„å¤§äº0ï¼Œå°äºuint32.max_valueçš„æ•´å‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="n">name</span>: <span class="nb">String</span>::<span class="n">arbitrary</span><span class="p">(</span><span class="n">g</span><span class="p">),</span><span class="w"> </span><span class="c1">// ä»»æ„å­—ç¬¦ä¸²
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="c1">// ä»»æ„å­—ç¬¦å¼€å¤´, ä»¥@example.com ç»“å°¾çš„å­—ç¬¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">            </span><span class="n">email</span>: <span class="nc">format</span><span class="o">!</span><span class="p">(</span><span class="s">&#34;{}@example.com&#34;</span><span class="p">,</span><span class="w"> </span><span class="nb">String</span>::<span class="n">arbitrary</span><span class="p">(</span><span class="n">g</span><span class="p">)),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ç°åœ¨å°±è®©æˆ‘ä»¬æ¥çœ‹ä¸‹å€ŸåŠ© quickcheck ç¼–å†™çš„ test case, æ³¨æ„å‚æ•°ä¸º <code>Book</code> å’Œ <code>Member</code> ç±»å‹çš„ case, quickcheck å°±ä¼šä»¥æˆ‘ä»¬ä¸Šé¢å®šä¹‰çš„æ ‡å‡†ï¼Œè‡ªåŠ¨ç»™æˆ‘ä»¬ç”Ÿæˆç¬¦åˆè§„å®šçš„ <code>Book</code> å’Œ <code>Member</code> å‚æ•°.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="cp">#[cfg(test)]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">mod</span> <span class="nn">tests</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="n">chrono</span>::<span class="n">NaiveDate</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="n">quickcheck_macros</span>::<span class="n">quickcheck</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="k">crate</span>::<span class="n">book</span>::<span class="n">Member</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="k">super</span>::<span class="p">{</span><span class="n">Book</span><span class="p">,</span><span class="w"> </span><span class="n">Library</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cp">#[quickcheck]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">adding_book_increases_book_count</span><span class="p">(</span><span class="n">book</span>: <span class="nc">Book</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Library</span>::<span class="n">new</span><span class="p">(</span><span class="n">NaiveDate</span>::<span class="n">from_ymd_opt</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">).</span><span class="n">unwrap</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">initial_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">library</span><span class="p">.</span><span class="n">books</span><span class="p">.</span><span class="n">len</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">library</span><span class="p">.</span><span class="n">add_book</span><span class="p">(</span><span class="n">book</span><span class="p">.</span><span class="n">clone</span><span class="p">()).</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">library</span><span class="p">.</span><span class="n">books</span><span class="p">.</span><span class="n">len</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">initial_count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">library</span><span class="p">.</span><span class="n">books</span><span class="p">.</span><span class="n">contains_key</span><span class="p">(</span><span class="o">&amp;</span><span class="n">book</span><span class="p">.</span><span class="n">isbn</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cp">#[quickcheck]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">cannot_loan_nonexistent_book</span><span class="p">(</span><span class="n">book_isbn</span>: <span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="n">member_id</span>: <span class="kt">u32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Library</span>::<span class="n">new</span><span class="p">(</span><span class="n">NaiveDate</span>::<span class="n">from_ymd_opt</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">).</span><span class="n">unwrap</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">library</span><span class="p">.</span><span class="n">loan_book</span><span class="p">(</span><span class="o">&amp;</span><span class="n">book_isbn</span><span class="p">,</span><span class="w"> </span><span class="n">member_id</span><span class="p">).</span><span class="n">is_err</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cp">#[quickcheck]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">fn</span> <span class="nf">can_return_loaned_book</span><span class="p">(</span><span class="n">book</span>: <span class="nc">Book</span><span class="p">,</span><span class="w"> </span><span class="n">member</span>: <span class="nc">Member</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Library</span>::<span class="n">new</span><span class="p">(</span><span class="n">NaiveDate</span>::<span class="n">from_ymd_opt</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">).</span><span class="n">unwrap</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">library</span><span class="p">.</span><span class="n">add_book</span><span class="p">(</span><span class="n">book</span><span class="p">.</span><span class="n">clone</span><span class="p">()).</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">library</span><span class="p">.</span><span class="n">add_member</span><span class="p">(</span><span class="n">member</span><span class="p">.</span><span class="n">clone</span><span class="p">()).</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">library</span><span class="p">.</span><span class="n">loan_book</span><span class="p">(</span><span class="o">&amp;</span><span class="n">book</span><span class="p">.</span><span class="n">isbn</span><span class="p">,</span><span class="w"> </span><span class="n">member</span><span class="p">.</span><span class="n">id</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">library</span><span class="p">.</span><span class="n">return_book</span><span class="p">(</span><span class="o">&amp;</span><span class="n">book</span><span class="p">.</span><span class="n">isbn</span><span class="p">).</span><span class="n">is_ok</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>é€šè¿‡ <code>quickcheck</code> æˆ‘ä»¬å°±å¯ä»¥åªä¸“æ³¨æµ‹è¯•é€»è¾‘ï¼Œå¯ä»¥å‡å®šæµ‹è¯•æ•°æ®é›†æ˜¯å®Œå¤‡çš„äº†ã€‚å¯èƒ½çœ‹åˆ° <code>Book</code> å’Œ <code>Member</code>, ä½ ä¼šè§‰å¾— quickcheck å¹¶æ²¡æœ‰åšå¤ªå¤šäº‹æƒ…ï¼Œä½ æ‰‹å·¥ä¹Ÿå¯ä»¥æ„é€ ã€‚</p>
<p>ä½†æ˜¯æˆ‘åœ¨çš„å®é™…å·¥ä½œä¸­ï¼Œæˆ‘å°±éœ€è¦æ„é€ ä¸€ä¸ªè¶…è¿‡23ä¸ªæˆå‘˜å˜é‡çš„ struct, å¤§éƒ¨åˆ†è¿˜æ˜¯ optional, ç„¶åéœ€è¦å°†è¿™ä¸ª struct å†™å…¥åˆ° parquet æ–‡ä»¶ï¼Œç„¶åå†æµ‹è¯•è¯»å–é€»è¾‘ã€‚
ä¸åŒæˆå‘˜å˜é‡çš„å€¼å¯å–çš„èŒƒå›´å®åœ¨å¤ªå¤šäº†ï¼Œå†å åŠ ä¸Š optional çš„å¯èƒ½æ€§ï¼Œæ„é€ æ•°æ®çš„ä»£ç å†™å¾—ç›¸å½“æ¶å¿ƒ.</p>
<p>æ‰€ä»¥æœ‰äº† quickcheck ä¹‹åï¼Œæˆ‘åªéœ€è¦ä¸ºè¿™ä¸ª struct å®ç° <code>Arbitrary</code> æ¥å£ï¼Œå‰©ä¸‹çš„å°±ç”± <code>quickcheck</code> æ›¿æˆ‘ç”Ÿæˆï¼Œæ‰€ä»¥æˆ‘ç›´æ¥å’ŒPEå¤§ä½¬è¯´:</p>
<blockquote>
<p>property test saves me life, now I couldn&rsquo;t live without it.</p></blockquote>
<h2 id="æ€»ç»“"><span class="section-num">5</span> æ€»ç»“</h2>
<p>æœ¬æ¥æƒ³æŠ’å‘æ„Ÿæƒ³å†™ç‚¹ç»“è¯­ï¼Œä½†æ˜¯çœ‹åˆ° Hypothesis ä½œè€…å†™çš„ <a href="https://hypothesis.readthedocs.io/en/latest/manifesto.html">The purpose of Hypothesis</a><sup id="fnref:7"><a href="#fn:7" class="footnote-ref" role="doc-noteref">7</a></sup> æ¥è¯´æ˜ä»–å¼€å‘çš„ Hypothesis çš„åŠ¨æœºï¼Œä»–çš„æ–‡ç« ç”šè‡³ç”¨æ¥ç»™è¿™ä¸ªã€Šæµ‹è¯•æŠ€èƒ½è¿›é˜¶ã€‹ç³»åˆ—æ€»ç»“éƒ½ç›¸å½“å¦¥å½“ã€‚</p>
<p>æˆ‘å°±è¯•ç¿»è¯‘ä¸‹ä»–æ–‡ç« çš„éƒ¨åˆ†æ®µè½, æ›´æ¨èé˜…è¯»åŸæ–‡ï¼Œå¯è°“æ˜¯ç”¨å¿ƒè‰¯è‹¦ï¼Œå­—å­—ç ç‘:</p>
<blockquote>
<p>è¯·å®¹æˆ‘ç‹‚å¦„ä¸€ä¸‹ï¼ŒHypothesis çš„ç›®æ ‡æ˜¯å¸Œæœ›å¯ä»¥è®©è¿™ä¸ªä¸–ç•Œè¿ˆè¿›åˆ°ä¸€ä¸ªå…¨æ–°ï¼Œç”±é«˜è´¨é‡è½¯ä»¶æ‰“é€ çš„æ–°ä¸–ä»£ã€‚</p>
<p>æ­£å¦‚äººä»¬æ‰€è¯´ï¼Œè½¯ä»¶æ­£åœ¨åå™¬æ•´ä¸ªä¸–ç•Œã€‚ä½†è½¯ä»¶æœ¬èº«å´å¾ˆçƒ‚ï¼Œå®ƒå……æ»¡bugï¼Œåˆä¸å®‰å…¨ï¼Œè¿˜ç»å¸¸è¢«è®¾è®¡å¾—å¾ˆçƒ‚ï¼Œè¿™æ ·çš„è½¯ä»¶å¯è°“æ˜¯ä¸‡æ¶ä¹‹æº.</p>
<p>è€Œè½¯ä»¶æµ‹è¯•çš„çŠ¶å†µç”šè‡³æ›´ç³Ÿç³•ï¼Œè™½ç„¶å¤§å®¶éƒ½è®¤åŒåº”è¯¥å¯¹ä»£ç è¿›è¡Œæµ‹è¯•ï¼Œä½†æ˜¯ä½ èƒ½é—®å¿ƒæ— æ„§åœ°è¯´ï¼Œä½ ç»æ‰‹è¿‡çš„ä»£ç éƒ½æœ‰è¢«å……åˆ†æµ‹è¯•ä¹ˆï¼Ÿ</p>
<p>é—®é¢˜åœ¨äºï¼Œå®åœ¨æ˜¯å¤ªéš¾å†™å‡ºå¥½çš„æµ‹è¯•äº†ï¼Œ
<strong><strong>ä½ å†™æµ‹è¯•ç”¨ä¾‹çš„æ—¶å€™ï¼Œé€šå¸¸æŒæœ‰å’Œä½ å†™ä»£ç æ—¶ä¸€æ ·çš„å‡è®¾ä¸è¯¯åŒºï¼Œä½ å†™çš„æµ‹è¯•ç”¨ä¾‹è‡ªç„¶æ— æ³•å‘ç°ä½ å½“åˆåŸ‹ä¸‹çš„bug</strong></strong> (ç²¾è¾Ÿ)</p>
<p>ä¸æ­¤åŒæ—¶ï¼Œæœ‰å„ç§å„æ ·è®©æµ‹è¯•å˜æˆæ›´å¥½çš„å·¥å…·å´åŸºæœ¬æ— äººä½¿ç”¨ï¼Œæœ€åˆçš„ Quickcheck æ˜¯1999å¹´æ¨å‡ºçš„ï¼Œä½†æ˜¯å¤§å¤šæ•°å¼€å‘è€…ç”šè‡³ä»æœªå¬è¯´è¿‡å®ƒï¼Œæ›´åˆ«æä½¿ç”¨äº†ï¼ˆå¼€å±±å§‹ç¥–çš„Quickcheckåœ¨GitHubåªæœ‰700å¤šä¸ªStarï¼Œå°±çŸ¥é“ä½œè€…æ‰€è¨€ä¸è™šï¼‰ã€‚
è™½ç„¶å…¶ä»–è¯­è¨€æœ‰äº›åŠæˆå“çš„å®ç°ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†éƒ½ä¸å€¼å¾—ä¸€è¯•ã€‚</p>
<p>è€Œ Hypothesis çš„ç›®æ ‡æ­£æ˜¯æ­£æœ¬æ¸…æºï¼ŒæŠŠå…ˆè¿›çš„æµ‹è¯•æŠ€æœ¯ä¼ é€’ç»™å¤§ä¼—ï¼Œå¹¶æä¾›ä¸€ä¸ªé«˜è´¨é‡çš„å®ç°ï¼Œè®©äººä»¬å¯ä»¥æ¥çº³å®ƒã€‚</p>
<p>å¸Œæœ›å¯ä»¥é›†ç™¾å®¶ä¹‹æ‰€é•¿ï¼Œé™„ä»¥ä¸ªäººå¾®è–„ä¹‹åŠ›ï¼Œè®©è½¯ä»¶æµ‹è¯•å˜å¾—æ›´å¥½ã€‚</p></blockquote>
<p>ç³»åˆ—æ–‡ç« :</p>
<ul>
<li><a href="https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%B8%80_%E8%BD%AF%E4%BB%B6%E8%B4%A8%E9%87%8F%E8%AE%A4%E7%9F%A5/">æµ‹è¯•æŠ€èƒ½è¿›é˜¶(ä¸€): è½¯ä»¶è´¨é‡è®¤çŸ¥</a></li>
<li><a href="https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%BA%8C_parameterized_tests/">æµ‹è¯•æŠ€èƒ½è¿›é˜¶(äºŒ): Parameterized Tests</a></li>
<li><a href="https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%B8%89_property_based_testing/">æµ‹è¯•æŠ€èƒ½è¿›é˜¶(ä¸‰): Property Based Testing</a></li>
</ul>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://en.wikipedia.org/wiki/QuickCheck">https://en.wikipedia.org/wiki/QuickCheck</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p><a href="https://hypothesis.works/">https://hypothesis.works/</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p><a href="https://en.wikipedia.org/wiki/Run-length_encoding">https://en.wikipedia.org/wiki/Run-length_encoding</a>&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p><a href="https://github.com/BurntSushi/ripgrep">https://github.com/BurntSushi/ripgrep</a>&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5">
<p><a href="https://github.com/BurntSushi/quickcheck">https://github.com/BurntSushi/quickcheck</a>&#160;<a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:6">
<p><a href="https://github.com/proptest-rs/proptest">https://github.com/proptest-rs/proptest</a>&#160;<a href="#fnref:6" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:7">
<p><a href="https://hypothesis.readthedocs.io/en/latest/manifesto.html">https://hypothesis.readthedocs.io/en/latest/manifesto.html</a>&#160;<a href="#fnref:7" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
]]></content:encoded>
    </item>
    <item>
      <title>æµ‹è¯•æŠ€èƒ½è¿›é˜¶(äºŒ): Parameterized Tests</title>
      <link>https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%BA%8C_parameterized_tests/</link>
      <pubDate>Sun, 13 Oct 2024 09:35:00 -0700</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%BA%8C_parameterized_tests/</guid>
      <description>&lt;h2 id=&#34;å‰è¨€&#34;&gt;&lt;span class=&#34;section-num&#34;&gt;1&lt;/span&gt; å‰è¨€&lt;/h2&gt;
&lt;p&gt;æµ‹è¯•æŠ€å·§å…·æœ‰æ™®é€‚æ€§ï¼Œå¤§å¤šæ˜¯ä¸è¯­è¨€æ— å…³çš„ï¼Œåªæ˜¯ä¸åŒè¯­è¨€çš„ç”Ÿæ€å¯èƒ½å¯¹æµ‹è¯•æŠ€æœ¯çš„æ”¯æŒå„ä¸ä¸€æ ·ï¼Œ
æ¯”å¦‚Pythonå’ŒJavaï¼ŒåŸºæœ¬ä»€ä¹ˆåº“éƒ½æœ‰ï¼Œè€ŒåƒC++ï¼Œæœ‰é¡ºæ‰‹çš„å•å…ƒæµ‹è¯•å’ŒMockåº“èƒ½ç”¨å°±å¾ˆä¸é”™äº†ã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<h2 id="å‰è¨€"><span class="section-num">1</span> å‰è¨€</h2>
<p>æµ‹è¯•æŠ€å·§å…·æœ‰æ™®é€‚æ€§ï¼Œå¤§å¤šæ˜¯ä¸è¯­è¨€æ— å…³çš„ï¼Œåªæ˜¯ä¸åŒè¯­è¨€çš„ç”Ÿæ€å¯èƒ½å¯¹æµ‹è¯•æŠ€æœ¯çš„æ”¯æŒå„ä¸ä¸€æ ·ï¼Œ
æ¯”å¦‚Pythonå’ŒJavaï¼ŒåŸºæœ¬ä»€ä¹ˆåº“éƒ½æœ‰ï¼Œè€ŒåƒC++ï¼Œæœ‰é¡ºæ‰‹çš„å•å…ƒæµ‹è¯•å’ŒMockåº“èƒ½ç”¨å°±å¾ˆä¸é”™äº†ã€‚</p>
<p>å› ä¸ºPythonæ¯”è¾ƒé€‚åˆå†™POC(proof of concept), è€Œæˆ‘æ—¥å¸¸å·¥ä½œçš„è¯­è¨€æ˜¯Java+Rustï¼Œæ‰€ä»¥æˆ‘ä¼šç©¿æ’ç€å¼•ç”¨è¿™ä¸‰ç§è¯­è¨€ã€‚</p>
<h2 id="parameterized-test"><span class="section-num">2</span> Parameterized Test</h2>
<p>åœ¨ä»‹ç» Parameterized Test ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆæ¥çœ‹ä¸ªç®€å•çš„è®¡ç®—ä»·æ ¼ä¸æŠ˜æ‰£çš„å‡½æ•°ï¼ˆå®é™…çš„ç”Ÿäº§ä»£ç è‚¯å®šä¼šæ›´å¤æ‚ï¼Œä½†æ˜¯èƒŒåçš„æ€è·¯æ˜¯ç›¸é€šçš„ï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">calculate_discount</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">discount_percentage</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">price</span> <span class="o">-</span> <span class="p">(</span><span class="n">price</span> <span class="o">*</span> <span class="n">discount_percentage</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é’ˆå¯¹è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šç¼–å†™å¤šä¸ª test case, æ¯”å¦‚ä»·æ ¼æ˜¯ 100, ç»™10%çš„æŠ˜æ‰£; ä»·æ ¼æ˜¯200, ç»™20%çš„æŠ˜æ‰£; ä»·æ ¼æ˜¯50, ç»™0çš„æŠ˜æ‰£ï¼›è¿˜æœ‰å¼‚å¸¸caseï¼Œæ¯”å¦‚ä»·æ ¼ä¸ºè´Ÿæ•°çš„æ—¶å€™ï¼Œæˆ–è€…æŠ˜æ‰£ä¸ºè´Ÿæ•°çš„æ—¶å€™.</p>
<h3 id="å•ä¸ª-test-case"><span class="section-num">2.1</span> å•ä¸ª test case</h3>
<p>å¯¹äºè¿™ä¹ˆå¤šçš„ case, ä¸€ä¸ªç®€å•ç²—æš´çš„æ–¹å¼å°±æ˜¯æŠŠæ‰€æœ‰çš„ case éƒ½å†™åœ¨ä¸€ä¸ª test case é‡Œï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pytest</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_calculate_discount</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># happy path</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">calculate_discount</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="mi">90</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">calculate_discount</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="o">==</span> <span class="mi">160</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">calculate_discount</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># unhappy path</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># assert calculate_discount(-2, 10)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># assert calculate_discount(10, -2)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½†æ˜¯è¿™æ ·çš„åšæ³•ä¸€èˆ¬æ˜¯ä¸æ¨èçš„ï¼ŒBest Practiceæ˜¯ä¸€ä¸ª test case åªæµ‹ä¸€ç§æƒ…å†µï¼Œå› ä¸ºå¦‚æœä¸€ä¸ª test case åŒ…å«å¤šä¸ªæµ‹è¯•æ¡ä»¶ï¼Œå¦‚æœ test case fail äº†ï¼Œé‚£ä¹ˆä¸çœ‹æºç æˆ–è€…å †æ ˆï¼Œä¸€èˆ¬è¿˜çœ‹ä¸å‡ºæ˜¯ä»€ä¹ˆ case å¤±è´¥äº†ï¼Œä¸å¥½æ’æŸ¥ã€‚</p>
<h3 id="å¤šä¸ª-test-case"><span class="section-num">2.2</span> å¤šä¸ª test case</h3>
<p>æ¨èåšæ³•å°±æ˜¯æ¯ä¸ªæµ‹è¯•æ¡ä»¶ä¸€ä¸ªå•ç‹¬çš„ test caseã€‚</p>
<p>å¦å¤–æˆ‘ä»¬é€šè¿‡test caseå‘ç°ä¸Šé¢çš„ä»£ç æ²¡æœ‰å¤„ç†å¼‚å¸¸æƒ…å†µï¼Œæˆ‘ä»¬ç°åœ¨è¦ä¼˜åŒ–ä¸‹æˆ‘ä»¬çš„ä»£ç ï¼Œå¢åŠ å¼‚å¸¸å¤„ç†é€»è¾‘(è¿™ä¸ªå°±æ˜¯TDDæ‰€æ¨å´‡çš„å¼€å‘å“²å­¦, test case å…ˆè¡Œï¼Œé€šè¿‡test caseå‘ç°é—®é¢˜ï¼Œè®©test case failæ‰ï¼Œç„¶åä¿®æ­£ä¸šåŠ¡é€»è¾‘ï¼Œtest caseå†è¿è¡Œé€šè¿‡).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pytest</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">calculate_discount</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">discount_percentage</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">price</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Price must be greater than zero: </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">discount_percentage</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Discount_percentage must be greater than zero: </span><span class="si">{</span><span class="n">discount_percentage</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">price</span> <span class="o">-</span> <span class="p">(</span><span class="n">price</span> <span class="o">*</span> <span class="n">discount_percentage</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TestClassCalculateDiscount</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># happy path</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">test_calculate_discount_with_10_discount_percentage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">assert</span> <span class="n">calculate_discount</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="mi">90</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">test_calculate_discount_with_20_discount_percentage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">assert</span> <span class="n">calculate_discount</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="o">==</span> <span class="mi">160</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">test_calculate_discount_with_0_discount_percentage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">assert</span> <span class="n">calculate_discount</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># unhappy path</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">test_calculate_discount_with_negative_price</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">assert</span> <span class="n">calculate_discount</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">test_calculate_discount_with_negative_discount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">assert</span> <span class="n">calculate_discount</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»£ç çš„ç¡®æ˜¯æ•´æ´æ˜“è¯»äº†ï¼Œä½†è¯è™½å¦‚æ­¤ï¼Œæˆ‘ä»¬è¦å¤šå†™äº†å¾ˆå¤šçš„ test case.</p>
<p>å¦‚æœ <code>calculate_discount</code> å˜å¾—æ›´å¤æ‚ï¼Œæˆ‘ä»¬è¦å†™çš„ test case è‚¯å®šæ˜¯æ›´å¤šæ›´å¤æ‚ï¼Œæ€»ä¸èƒ½éƒ½ copy-paste test caseå§ã€‚</p>
<h3 id="parameterized-test"><span class="section-num">2.3</span> Parameterized Test</h3>
<p>è¯é¢˜å°±å›åˆ° Parameterized Test äº†, å®ƒå°±æ˜¯ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ï¼Œå®ƒå¯ä»¥è®©ä½ ç”¨ä¸åŒçš„æµ‹è¯•æ•°æ®é›†ä¼šè¿è¡Œç›¸åŒçš„æµ‹è¯•é€»è¾‘.
è¿˜æ˜¯ä»¥ä¸Šé¢çš„ä»£ç ä¸ºä¾‹å­ï¼Œä½ ä¼šå‘ç° <code>test_calculate_discount_with_10_discount_percentage</code> å’Œ <code>test_calculate_discount_with_20_discount_percentage</code> çš„æµ‹è¯•é€»è¾‘æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œä½†åªæ˜¯æ•°æ®é›†ä¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ Parameterized Test æ¥ä¼˜åŒ–ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pytest</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TestClassCalculateDiscount</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Parameterized test for valid cases (happy path)</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@pytest.mark.parametrize</span><span class="p">(</span><span class="s2">&#34;price, discount, expected&#34;</span><span class="p">,</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">160</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">test_calculate_discount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">discount</span><span class="p">,</span> <span class="n">expected</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">assert</span> <span class="n">calculate_discount</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">discount</span><span class="p">)</span> <span class="o">==</span> <span class="n">expected</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Parameterized test for invalid cases (unhappy path)</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@pytest.mark.parametrize</span><span class="p">(</span><span class="s2">&#34;price, discount&#34;</span><span class="p">,</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>   <span class="c1"># Invalid price</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>    <span class="c1"># Invalid discount percentage</span>
</span></span><span class="line"><span class="cl">    <span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">test_calculate_discount_invalid_cases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">discount</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">calculate_discount</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">discount</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…¶å®å°±æ˜¯æŠŠæµ‹è¯•é€»è¾‘å’Œæ•°æ®è¿›è¡Œäº†åˆ†ç¦»ï¼Œåé¢éœ€è¦æµ‹è¯•æ–°çš„æ•°æ®é›†ï¼Œåªéœ€è¦å‘æ•°æ®é›†é‡Œé¢æ·»åŠ æ•°æ®å³å¯ã€‚</p>
<p>ç”±æ­¤å¯è§ï¼Œä½¿ç”¨ Parameterized Test æœ‰å‡ ä¸ªæ˜¾è€Œæ˜“è§çš„å¥½å¤„ï¼š</p>
<p>é¦–å…ˆæ˜¯å‡å°‘ä»£ç å†—ä½™ï¼Œä¸éœ€è¦ç±»ä¼¼çš„ä»£ç  copy-paste å¾ˆå¤šæ¬¡ï¼›å…¶æ¬¡æ˜¯æ–¹ä¾¿æåˆ°æµ‹è¯•è¦†ç›–ç‡ï¼Œè¿™ä¸ªåœ¨ä¸Šé¢çš„ä¾‹å­å¯èƒ½ä¸æ˜æ˜¾ï¼Œæˆ‘ä»¬å¯ä»¥å†ä¿®æ”¹ä¸€ä¸‹ <code>calculate_discount</code> å‡½æ•°ï¼Œå¢åŠ ä¸¤ä¸ªåˆ†æ”¯ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">calculate_discount</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">discount_percentage</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">price</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Price must be greater than zero: </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">discount_percentage</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Discount_percentage must be greater than zero: </span><span class="si">{</span><span class="n">discount_percentage</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">price</span> <span class="o">&gt;</span> <span class="mi">50000</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">price</span> <span class="o">-</span> <span class="p">(</span><span class="n">price</span> <span class="o">*</span> <span class="p">(</span><span class="n">discount_percentage</span> <span class="o">*</span> <span class="mf">1.15</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">price</span> <span class="o">&gt;</span> <span class="mi">100000</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">price</span> <span class="o">-</span> <span class="p">(</span><span class="n">price</span> <span class="o">*</span> <span class="p">(</span><span class="n">discount_percentage</span> <span class="o">*</span> <span class="mf">1.18</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">price</span> <span class="o">-</span> <span class="p">(</span><span class="n">price</span> <span class="o">*</span> <span class="n">discount_percentage</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»·æ ¼è¶…è¿‡50000, åœ¨å·²æœ‰æŠ˜æ‰£åŸºç¡€ä¸Šï¼Œå†é¢å¤–ç»™æŠ˜æ‰£çš„15%ä½œä¸ºæŠ˜æ‰£ï¼›ä»·æ ¼è¶…è¿‡100000ï¼Œåœ¨å·²æœ‰æŠ˜æ‰£çš„åŸºç¡€ä¸Šï¼Œå†é¢å¤–ç»™æŠ˜æ‰£çš„18%ä½œä¸ºæŠ˜æ‰£. å¦‚æœè¦è¦†ç›–è¿™ä¸¤ä¸ªæ–°çš„åˆ†æ”¯ï¼Œåªéœ€è¦åœ¨æ•°æ®é›†ä¸Šæ·»åŠ å¤§äº50000 å’Œå¤§äº100000çš„æ•°æ®é›†ï¼Œå°±å¯ä»¥ç›´æ¥è¦†ç›–åˆ°äº†.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@pytest.mark.parametrize</span><span class="p">(</span><span class="s2">&#34;price, discount, expected&#34;</span><span class="p">,</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">160</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">50001</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">44250.885</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">100001</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">88500.885</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">test_calculate_discount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">discount</span><span class="p">,</span> <span class="n">expected</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">calculate_discount</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">discount</span><span class="p">)</span> <span class="o">==</span> <span class="n">expected</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åæµ‹è¯•è¿™æ®µä»£ç çš„æ—¶å€™ï¼Œæˆ‘åˆå‘ç°ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼Œè¿™é‡Œçš„ä»·æ ¼å˜æˆæµ®ç‚¹æ•°åï¼Œæ²¡æœ‰ä½œå°æ•°ç‚¹åå‡ ä½çš„å–æ•´ã€‚</p>
<p>ï¼ˆå¯¹äºè¿™æ ·ç®€å•çš„å‡½æ•°ï¼Œä¹Ÿèƒ½ä¸æ–­åœ°é€šè¿‡å†™ test case å‘ç°æ–°é—®é¢˜ï¼Œè¿™æ— ç–‘å°±æ˜¯ test case æœ€å¤§çš„ä»·å€¼æ‰€åœ¨äº†ï¼‰</p>
<p>ä½¿ç”¨ Parameterized Test è¿˜å¯ä»¥æé«˜æµ‹è¯•ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œè¿™éƒ¨åˆ†å†…å®¹è¿˜æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œå°±ä¸å±•å¼€äº†ã€‚</p>
<h3 id="junit"><span class="section-num">2.4</span> Junit</h3>
<p>åœ¨Javaçš„æµ‹è¯•ç”Ÿæ€ä¸­ï¼ŒJunitæ˜¯æ¯«æ— ç–‘é—®çš„é¾™å¤´å¤§å“¥ï¼Œè€Œåœ¨Junit5 ï¼ŒJunitä¹Ÿå¼•å…¥äº†å¯¹ Parameterized Test çš„æ”¯æŒï¼Œé€šè¿‡ <code>@ParameterizedTest</code> è¿™ä¸ªæšä¸¾å°±å¯ä»¥å°†æŸä¸ª test case æ ‡æ³¨æˆ Parameterized Test, é€šè¿‡ <code>@ValueSource</code> ä¼ å…¥å¾…æµ‹è¯•æ•°æ®é›†ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Numbers</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isOdd</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">2</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@ParameterizedTest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@ValueSource</span><span class="p">(</span><span class="n">ints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">1</span><span class="p">,</span><span class="w"> </span><span class="n">3</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">3</span><span class="p">,</span><span class="w"> </span><span class="n">15</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="p">.</span><span class="na">MAX_VALUE</span><span class="p">})</span><span class="w"> </span><span class="c1">// six numbers</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kt">void</span><span class="w"> </span><span class="nf">isOdd_ShouldReturnTrueForOddNumbers</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Numbers</span><span class="p">.</span><span class="na">isOdd</span><span class="p">(</span><span class="n">number</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™åªæ˜¯æœ€åŸºæœ¬çš„ç”¨æ³•ï¼ŒJunitè¿˜æ”¯æŒé€šè¿‡å‡½æ•°ï¼Œæšä¸¾ï¼ŒCSVæ ¼å¼ç”šè‡³æ–‡ä»¶æ¥ä¼ å…¥å¾…æµ‹è¯•æ•°æ®é›†ï¼Œå¯è°“æ˜¯åŒ…ç½—ä¸‡æœ‰ï¼Œå…·ä½“çš„ç”¨æ³•å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š<a href="https://www.baeldung.com/parameterized-tests-junit-5">Guide to JUnit 5 Parameterized Tests</a><sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> å’Œ <a href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-parameterized-tests">Junitå®˜æ–¹æ–‡æ¡£</a>Â <sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup></p>
<h3 id="rstest-and-test-case"><span class="section-num">2.5</span> rstest &amp; test_case</h3>
<p>Rust ä¹Ÿæœ‰å¯¹Parameterized Testæ”¯æŒçš„åº“ï¼Œä¸€ä¸ªå°±æ˜¯ <a href="https://github.com/la10736/rstest"><code>rstest</code></a><sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>, å¦å¤–ä¸€ä¸ªå°±æ˜¯ <a href="https://github.com/frondeus/test-case"><code>test_case</code></a>Â <sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>, ä¸¤è€…éƒ½å¯¹ Parameterized Test æœ‰è¾ƒå¥½çš„æ”¯æŒï¼Œåœ¨å…¬å¸çš„ä»£ç åº“ä¸­ï¼Œä¸¤è€…æˆ‘éƒ½è§è¿‡æœ‰é¡¹ç›®åœ¨ä½¿ç”¨ï¼Œè€Œæˆ‘åœ¨å·¥ä½œä¸­ä½¿ç”¨çš„æ˜¯ <code>rstest</code>, å› ä¸ºå®ƒçš„åŠŸèƒ½æ›´åŠ å¼ºå¤§ï¼Œç»´æŠ¤è€…ä¹Ÿæ›´åŠ æ´»è·ƒ.</p>
<h2 id="æ€»ç»“"><span class="section-num">3</span> æ€»ç»“</h2>
<p>åœ¨äº†è§£ Parameterized Test ä¹‹å‰ï¼Œæˆ‘çš„æ¯ä¸ªCRåŸºæœ¬éƒ½æœ‰ test case è¦†ç›–ï¼Œä½†æ˜¯åæˆ‘æ—è¾¹ Principle Engineer å·¨ä½¬ review æˆ‘ä»£ç çš„æ—¶å€™ï¼Œæ€»ä¼šè¯´æˆ‘çš„ test case å¤ª verbose å’Œ heavy, æˆ‘åœ¨æƒ³test caseå¤šè¿˜ä¸å¥½å˜›ï¼Œæˆ‘çš„ code coverage éƒ½è¶…è¿‡80%äº†.</p>
<p>ç„¶è€Œä»–çš„æ„æ€æ˜¯ï¼Œä¸æ˜¯è¯´æˆ‘çš„ test case æ²¡æœ‰è¦†ç›–åˆ°ä»£ç ï¼Œæˆ‘100è¡Œçš„å˜æ›´ï¼Œé™„ä¸Š200è¡Œçš„ test case ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œåªä¸è¿‡æˆ‘çš„test caseå¤§å¤šåªæ˜¯æ•°æ®ä¸ä¸€æ ·ï¼Œæµ‹è¯•é€»è¾‘åŸºæœ¬ç›¸åŒï¼Œèƒ½å¦æŠ½è±¡ä¸‹ï¼Œå‡å°‘ä¸‹code redundancy, ç„¶åå°±å¼ºçƒˆå»ºè®®æˆ‘å»çœ‹ä¸‹ <code>Parameterized Test</code> ä»¥åŠ <code>Property Based Test</code>.</p>
<p>å¤§ä½¬çš„ç¡®ä¸€é’ˆè§è¡€ï¼Œæˆ‘çš„ test case å¤§å¤šæ˜¯å¤åˆ¶å·²æœ‰çš„ test case, ä¿®æ”¹ä¸‹å‡½æ•°åï¼Œå†åŠ åŠ å‡å‡æ”¹ä¸‹æ•°æ®é›†ã€‚</p>
<p>ç»ä»–æŒ‡ç‚¹ï¼Œåœ¨äº†è§£ <code>Parameterized Test</code> ä¹‹åï¼Œæˆ‘çš„ç¡®å†ä¹Ÿæ²¡æœ‰å¤åˆ¶ test caseï¼Œæ¯æ¬¡CRçš„test caseä¹Ÿæ›´ç²¾ç®€äº†ï¼ŒCRä¹Ÿæ›´å®¹æ˜“é€šè¿‡äº†.</p>
<p>è€Œä»–æåˆ°çš„ <code>Property Based Test</code> åˆ™æ˜¯ä¸€é¡¹æ›´å¼ºå¤§çš„æµ‹è¯•æŠ€æœ¯ï¼Œä¸‹å›å†åˆ†è§£äº†ã€‚</p>
<p>ç³»åˆ—æ–‡ç« :</p>
<ul>
<li><a href="https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%B8%80_%E8%BD%AF%E4%BB%B6%E8%B4%A8%E9%87%8F%E8%AE%A4%E7%9F%A5/">æµ‹è¯•æŠ€èƒ½è¿›é˜¶(ä¸€): è½¯ä»¶è´¨é‡è®¤çŸ¥</a></li>
<li><a href="https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%BA%8C_parameterized_tests/">æµ‹è¯•æŠ€èƒ½è¿›é˜¶(äºŒ): Parameterized Tests</a></li>
<li><a href="https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%B8%89_property_based_testing/">æµ‹è¯•æŠ€èƒ½è¿›é˜¶(ä¸‰): Property Based Testing</a></li>
</ul>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://www.baeldung.com/parameterized-tests-junit-5">https://www.baeldung.com/parameterized-tests-junit-5</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p><a href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-parameterized-tests">https://junit.org/junit5/docs/current/user-guide/#writing-tests-parameterized-tests</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p><a href="https://github.com/la10736/rstest">https://github.com/la10736/rstest</a>&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p><a href="https://github.com/frondeus/test-case">https://github.com/frondeus/test-case</a>&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
]]></content:encoded>
    </item>
    <item>
      <title>æµ‹è¯•æŠ€èƒ½è¿›é˜¶(ä¸€): è½¯ä»¶è´¨é‡è®¤çŸ¥</title>
      <link>https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%B8%80_%E8%BD%AF%E4%BB%B6%E8%B4%A8%E9%87%8F%E8%AE%A4%E7%9F%A5/</link>
      <pubDate>Sat, 12 Oct 2024 10:30:00 -0700</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%B8%80_%E8%BD%AF%E4%BB%B6%E8%B4%A8%E9%87%8F%E8%AE%A4%E7%9F%A5/</guid>
      <description>&lt;h2 id=&#34;å‰è¨€&#34;&gt;&lt;span class=&#34;section-num&#34;&gt;1&lt;/span&gt; å‰è¨€&lt;/h2&gt;
&lt;p&gt;æœ€è¿‘å‡ ä¸ªæœˆéƒ½åœ¨èµ¶ä¸ªéå¸¸é‡è¦é¡¹ç›®ï¼ŒåŸºæœ¬æ¯å¤©æˆ–æ¯å‡ å¤©éƒ½è¦æäº¤CRï¼Œè€Œå› ä¸ºæ¯ä¸ªCRéƒ½è¦é™„ä¸Šå¯¹åº”çš„ test case, æ‰€ä»¥è¿™æ®µæ—¶é—´å†™äº†éå¸¸å¤šçš„ test case, åˆåœ¨åæˆ‘æ—è¾¹çš„ Principal Engineer å·¨ä½¬èº«ä¸Šå­¦åˆ°äº†å¾ˆå¤šæœ‰ç”¨çš„æµ‹è¯•æŠ€å·§ï¼Œæ‰€ä»¥å°±æƒ³å†™ä¸ªç³»åˆ—æ–‡ç« æ€»ç»“å’Œåˆ†äº«æˆ‘æ‰€å­¦åˆ°çš„æ–°æŠ€èƒ½ã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<h2 id="å‰è¨€"><span class="section-num">1</span> å‰è¨€</h2>
<p>æœ€è¿‘å‡ ä¸ªæœˆéƒ½åœ¨èµ¶ä¸ªéå¸¸é‡è¦é¡¹ç›®ï¼ŒåŸºæœ¬æ¯å¤©æˆ–æ¯å‡ å¤©éƒ½è¦æäº¤CRï¼Œè€Œå› ä¸ºæ¯ä¸ªCRéƒ½è¦é™„ä¸Šå¯¹åº”çš„ test case, æ‰€ä»¥è¿™æ®µæ—¶é—´å†™äº†éå¸¸å¤šçš„ test case, åˆåœ¨åæˆ‘æ—è¾¹çš„ Principal Engineer å·¨ä½¬èº«ä¸Šå­¦åˆ°äº†å¾ˆå¤šæœ‰ç”¨çš„æµ‹è¯•æŠ€å·§ï¼Œæ‰€ä»¥å°±æƒ³å†™ä¸ªç³»åˆ—æ–‡ç« æ€»ç»“å’Œåˆ†äº«æˆ‘æ‰€å­¦åˆ°çš„æ–°æŠ€èƒ½ã€‚</p>
<h2 id="why"><span class="section-num">2</span> Why</h2>
<p>æœ‰ä¸ªå¾ˆè‘—åçš„æ€è€ƒæ–¹å¼ï¼Œå«é»„é‡‘åœˆæ³•åˆ™, ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯å¯¹äºæŸä»¶äº‹æ‰¾åˆ°Whyï¼ŒHowï¼ŒWhatï¼š</p>
<p>æˆ‘ä¸ºä»€ä¹ˆè¦åšï¼Œæˆ‘æ€ä¹ˆåšï¼Œåšè¿™ä»¶äº‹çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>æ‰€ä»¥æˆ‘å°±å…ˆæ¥èŠèŠä¸ºä»€ä¹ˆè¦å†™æµ‹è¯•caseï¼Œæˆ–è€…è¯´ä¸ºä»€ä¹ˆæ˜¯è½¯ä»¶å¼€å‘å†™æµ‹è¯•caseï¼Œåç»­çš„æ–‡ç« å†æ¥èŠèŠHow.</p>
<h2 id="è½¯ä»¶è´¨é‡æ–‡åŒ–"><span class="section-num">3</span> è½¯ä»¶è´¨é‡æ–‡åŒ–</h2>
<p>å…³äºè½¯ä»¶å·¥ç¨‹å¸ˆæ¥å†™æµ‹è¯• case, æœ€æœ‰åçš„åº”è¯¥æ˜¯Googleï¼Œä»–ä»¬å°±æ˜¯æ¨å´‡ç”±è½¯ä»¶å·¥ç¨‹å¸ˆæ¥å†™æµ‹è¯•caseï¼Œè€Œä»–ä»¬çš„æµ‹è¯•æ–‡åŒ–å·²ç»æˆä¸ºè°·æ­Œçš„å·¥ç¨‹æ–‡åŒ–çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚</p>
<p>Googleçš„å·¥ç¨‹å¸ˆä¹Ÿå‰åå†™äº†ä¸¤æœ¬ä¹¦æ¥å¸ƒé“ä»–ä»¬çš„æµ‹è¯•æ–‡åŒ–/å·¥ç¨‹æ–‡åŒ–, ä¹Ÿéå¸¸æ¨èé˜…è¯»:</p>
<ul>
<li><a href="https://book.douban.com/subject/25742200/">Googleè½¯ä»¶æµ‹è¯•ä¹‹é“</a>Â <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></li>
<li><a href="https://book.douban.com/subject/35838155/">Googleè½¯ä»¶å·¥ç¨‹</a>Â <sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup></li>
</ul>
<p>æ¯•ä¸šä»¥åå¾…è¿‡å‡ å®¶å¤§å…¬å¸ï¼Œè¿™å‡ å®¶å…¬å¸çš„æ–‡åŒ–å„æœ‰ä¸åŒï¼Œä½†å°±æˆ‘æ‰€ä¾›èŒè¿‡çš„éƒ¨é—¨è€Œè¨€ï¼Œå¯¹äºæµ‹è¯•ï¼Œä»–ä»¬éƒ½æœ‰ç€ç›¸åŒçš„è§‚ç‚¹ï¼š
ä¸åº”è¯¥ä¹Ÿä¸ä¼šæœ‰æ‰€è°“çš„æµ‹è¯•å·¥ç¨‹å¸ˆï¼Œæ¯ä¸ªè½¯ä»¶å¼€å‘éƒ½åº”è¯¥ä¸ºè‡ªå·±çš„ä»£ç ç¼–å†™æµ‹è¯•ï¼Œå¹¶ä¿è¯è´¨é‡.</p>
<p>å…¶ä¸­å¾®ä¿¡æ”¯ä»˜åŸºæœ¬å°±æ˜¯åœ¨è·µè¡Œã€ŠGoogleè½¯ä»¶æµ‹è¯•ä¹‹é“ã€‹çš„ç†å¿µï¼Œæ¨å¹¿å¾®ä¿¡æ”¯ä»˜è‡ªå·±çš„æµ‹è¯•æ–‡åŒ–ï¼Œå¼ºè°ƒæµ‹è¯•å·¦ç§°ï¼Œé¢å‘æµ‹è¯•è®¾è®¡ç­‰ç­‰ã€‚</p>
<p>Amazon å†…éƒ¨çš„æµ‹è¯•æ–‡åŒ–ä¹Ÿæ˜¯å’ŒGoogle ç›¸å½“ç±»ä¼¼ï¼Œåªæ˜¯è¿œæ²¡æœ‰Googleå‡ºå.</p>
<p>ä¸çŸ¥é“æ˜¯å› ä¸ºAmazonçš„æµ‹è¯•æ–‡åŒ–æ˜¯å—Googleæ‰€å½±å“, è®²ç©¶å…ˆæ¥ååˆ°, ä¸»å®¢åˆ†æ˜; è¿˜æ˜¯Amazonçš„å¼€æºé¡¹ç›®æˆ–è€…æŠ€æœ¯å½±å“åŠ›æ²¡æœ‰Googleé«˜ï¼Œå¯¼è‡´Amazon å·¥ç¨‹æ–‡åŒ–æ²¡æœ‰Googleå‡ºåï¼Œåˆæˆ–æ˜¯å› ä¸ºAmazonå·¥ç¨‹å¸ˆåœ¨è¡€æ±—å·¥å‚æ‰“å·¥ï¼Œå¿™ç€èµ¶éœ€æ±‚ï¼Œæ²¡æœ‰æ—¶é—´å†™ä¹¦å¸ƒé“, æ‰€ä»¥ä¸ä¸ºäººæ‰€çŸ¥å‘¢.</p>
<p>è¿™ç§æ–‡åŒ–èƒŒåï¼Œæ˜¯å¯¹è½¯ä»¶å¼€å‘ä¸è´¨é‡æµ‹è¯•å¯†ä¸å¯åˆ†çš„è®¤çŸ¥ï¼š</p>
<h3 id="èŒè´£"><span class="section-num">3.1</span> èŒè´£</h3>
<p>é¦–å…ˆï¼Œæ¯ä¸ªå·¥ç¨‹å¸ˆï¼Œéƒ½åº”è¯¥ä¸ºä»–ä»¬çš„ä»£ç ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œ
è¿™ä¸ªå·¥ä½œæœ¬èº«å°±æ˜¯ç ”å‘æµç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œè€Œè´¨é‡ä¿éšœåˆæ˜¯è½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸéå¸¸å…³é”®çš„ä¸€æ­¥ï¼Œ
å¦‚æœå†™å‡ºæ¥çš„åŠŸèƒ½å……æ»¡é—®é¢˜ï¼Œè¿™æ ·çš„åŠŸèƒ½å†å¤šï¼Œå¼€å‘å¾—å†å¿«åˆæœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ã€‚</p>
<h3 id="ci-cd"><span class="section-num">3.2</span> CI/CD</h3>
<p>æ‰€ä»¥æˆ‘ç°åœ¨æ‰€åœ¨S3éƒ¨é—¨è€Œè¨€ï¼Œè¦æ±‚æ¯ä¸ªCRéƒ½è¦æœ‰å¯¹åº”çš„æµ‹è¯•ç”¨ä¾‹æ¥ä¿è¯CRä»£ç çš„è´¨é‡ï¼Œå› ä¸ºä»£ç åˆå¹¶åˆ°ä¸»å¹²ä¹‹åï¼Œ
å°±ä¼šè¢« Continuous Deployment è‡ªåŠ¨éƒ¨ç½²ä¸Šçº¿ï¼Œæ‰€ä»¥è¦æ±‚æ¯ä¸ªæåˆ°çš„CRéƒ½æ˜¯ production-readyçš„</p>
<p>è½¯ä»¶å·¥ç¨‹å¸ˆè‡ªå·±ç¼–å†™æµ‹è¯•é…åˆCI/CDå°±å¯ä»¥æ›´æ—©æ›´å¿«åœ°å‘ç°é—®é¢˜ï¼Œå¹¶ä¸”ç”±è½¯ä»¶å·¥ç¨‹å¸ˆå¿«é€Ÿå®Œæˆä¿®å¤, é™ä½åé¦ˆå‘¨æœŸ, æé«˜å¼€å‘æ•ˆç‡.</p>
<h3 id="æˆæœ¬"><span class="section-num">3.3</span> æˆæœ¬</h3>
<p>å…¶æ¬¡ï¼Œæ²Ÿé€šæ˜¯æœ‰æˆæœ¬çš„ï¼Œå¦‚æœå­˜åœ¨æµ‹è¯•å·¥ç¨‹å¸ˆï¼Œè½¯ä»¶å·¥ç¨‹å¸ˆå°±è¦ç»™æµ‹è¯•å·¥ç¨‹å¸ˆäº¤å¾…æ¸…æ¥šä¸šåŠ¡åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Œ
è¿™æ¬¡çš„æ”¹åŠ¨è¦æµ‹ä»€ä¹ˆåŠŸèƒ½ï¼Œé¢„æœŸç»“æœæ˜¯ä»€ä¹ˆï¼Œæ²Ÿé€šæˆæœ¬å°±ç›¸å½“é«˜ï¼Œä½ å¯èƒ½è¿˜éœ€è¦é€šè¿‡æ–‡æ¡£æˆ–è€…å·¥å•å°†æµ‹è¯•å†…å®¹å‘ˆç°ç»™æµ‹è¯•å·¥ç¨‹å¸ˆã€‚</p>
<p>å¦‚æœè½¯ä»¶å·¥ç¨‹å¸ˆéƒ½èƒ½æŠŠè¿™äº›ä¸œè¥¿è§£é‡Šæ¸…æ¥šï¼Œé‚£ä¸ºä»€ä¹ˆä¸è‡ªå·±æŠŠæµ‹è¯•ç”¨ä¾‹å†™å®Œå‘¢, ä½•å¿…åŠ³å¿ƒåŠ³åŠ›å»å†™å·¥å•å‘¢ï¼Ÿ</p>
<h3 id="é¢å‘æµ‹è¯•è®¾è®¡"><span class="section-num">3.4</span> é¢å‘æµ‹è¯•è®¾è®¡</h3>
<p>è™½ç„¶Test-Driven Development(TDD)çš„å¼€å‘ç†å¿µä¸ä¸€å®šæ‰€æœ‰äººéƒ½è®¤åŒ, ä½†æ˜¯è®©è½¯ä»¶å¼€å‘å·¥ç¨‹å¸ˆæ¥ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œèƒ½è®©è½¯ä»¶å·¥ç¨‹å¸ˆæœ‰æµ‹è¯•å…ˆè¡Œï¼Œè®¾è®¡æµ‹è¯•å‹å¥½æ¥å£çš„è®¤çŸ¥, åè¿‡æ¥åˆä¼šå¯¹å…¶æ¥å£è®¾è®¡èƒ½åŠ›æœ‰æ–°çš„è¦æ±‚.</p>
<h3 id="æ•æ·å¼€å‘"><span class="section-num">3.5</span> æ•æ·å¼€å‘</h3>
<p>æ€»ç»“ä¸‹æ¥ï¼Œè®©è½¯ä»¶å·¥ç¨‹å¸ˆå¯¹è´¨é‡è´Ÿè´£ï¼Œè‡ªå·±ç¼–å†™æµ‹è¯•ç”¨ä¾‹, æ˜¯ç¡®ä¿å›¢é˜Ÿèƒ½æ•æ·å¼€å‘(move fast), åˆèƒ½ç¡®ä¿è½¯ä»¶è´¨é‡çš„å…³é”®æ‰‹æ®µ</p>
<h2 id="æ€»ç»“"><span class="section-num">4</span> æ€»ç»“</h2>
<p>æ¯ä¸ªäººå¯¹äºæµ‹è¯•æŠ€å·§çš„è®¤çŸ¥å¹¶ä¸ä¸€æ ·ï¼Œåƒå•å…ƒæµ‹è¯•ï¼Œé›†æˆæµ‹è¯•è¿™ç±»æµ‹è¯•ï¼Œ
åœ¨æˆ‘ä¸ªäººè®¤çŸ¥é‡Œï¼Œæ˜¯å±äºæ¯ä¸ªè½¯ä»¶å·¥ç¨‹å¸ˆéƒ½éœ€è¦æŒæ¡çš„åŸºç¡€æŠ€èƒ½ï¼Œå°±ä¸åœ¨ã€Œè¿›é˜¶ã€ä¹‹åˆ—ã€‚</p>
<p>è€Œåƒæ··æ²Œæµ‹è¯•(Chaos Monkey) è¿™æ ·çš„æµ‹è¯•, è‡ªç„¶å±äºè¿›é˜¶æµ‹è¯•çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯å› ä¸ºå…¶ä¸å…¬å¸çš„åŸºç¡€æ¶æ„å¼ºè€¦åˆ;</p>
<p>åœ¨å¾®ä¿¡æ”¯ä»˜çš„æ—¶å€™ï¼ŒåŒç»„çš„ä¸€ä½åŒäº‹å°±ä¸“é¡¹è´Ÿè´£å…ˆé©±ææ•´ä¸ªå¾®ä¿¡æ”¯ä»˜çš„æ··æ²Œæµ‹è¯•ï¼Œ
å‰åæäº†1å¹´åŠè¿˜åœ¨å¼€å‘ï¼Œéƒ½æ˜¯å’Œè¿ç»´å›¢é˜Ÿä»¥åŠåŸºç¡€ç»„ä»¶å›¢é˜Ÿå¯†åˆ‡åˆä½œæ¥å¼€å‘æ··æ²Œæµ‹è¯•åŠŸèƒ½çš„ï¼Œ
æ— æ³•ç”¨ç¤ºä¾‹ä»£ç æ¥ç›´è§‚å‘ˆç°ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šåˆ—å…¥è¿™ä¸ªç³»åˆ—ã€‚</p>
<p>è¿™ç³»åˆ—æ–‡ç« æ›´ä¸“æ³¨äºæ—¥å¸¸å¼€å‘ä¸­ï¼Œæ¯ä¸ªè½¯ä»¶å·¥ç¨‹å¸ˆéƒ½æœ‰æœºä¼šç”¨ä¸Šçš„æµ‹è¯•æŠ€å·§.</p>
<p>ç³»åˆ—æ–‡ç« :</p>
<ul>
<li><a href="https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%B8%80_%E8%BD%AF%E4%BB%B6%E8%B4%A8%E9%87%8F%E8%AE%A4%E7%9F%A5/">æµ‹è¯•æŠ€èƒ½è¿›é˜¶(ä¸€): è½¯ä»¶è´¨é‡è®¤çŸ¥</a></li>
<li><a href="https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%BA%8C_parameterized_tests/">æµ‹è¯•æŠ€èƒ½è¿›é˜¶(äºŒ): Parameterized Tests</a></li>
<li><a href="https://ramsayleung.github.io/zh/post/2024/%E6%B5%8B%E8%AF%95%E6%8A%80%E8%83%BD%E8%BF%9B%E9%98%B6%E4%B8%89_property_based_testing/">æµ‹è¯•æŠ€èƒ½è¿›é˜¶(ä¸‰): Property Based Testing</a></li>
</ul>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://book.douban.com/subject/25742200/">https://book.douban.com/subject/25742200/</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p><a href="https://book.douban.com/subject/35838155/">https://book.douban.com/subject/35838155/</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
]]></content:encoded>
    </item>
  </channel>
</rss>
