<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>linux on è¿‡æ²³å’</title>
    <link>https://ramsayleung.github.io/zh/categories/linux/</link>
    <description>Recent content in linux on è¿‡æ²³å’</description>
    <image>
      <title>è¿‡æ²³å’</title>
      <url>https://ramsayleung.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E</url>
      <link>https://ramsayleung.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E</link>
    </image>
    <generator>Hugo -- 0.120.4</generator>
    <language>zh</language>
    <copyright>See this site&amp;rsquo;s source code here, licensed under GPLv3 Â·</copyright>
    <lastBuildDate>Sat, 20 May 2023 08:32:35 -0700</lastBuildDate>
    <atom:link href="https://ramsayleung.github.io/zh/categories/linux/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Linuxä¸‹å¦‚ä½•é¿å…è“ç‰™éŸ³ç®±è‡ªåŠ¨å…³æœº</title>
      <link>https://ramsayleung.github.io/zh/post/2023/linux%E4%B8%8B%E5%A6%82%E4%BD%95%E9%81%BF%E5%85%8D%E8%93%9D%E7%89%99%E9%9F%B3%E7%AE%B1%E8%87%AA%E5%8A%A8%E5%85%B3%E6%9C%BA/</link>
      <pubDate>Mon, 15 May 2023 20:48:00 -0700</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2023/linux%E4%B8%8B%E5%A6%82%E4%BD%95%E9%81%BF%E5%85%8D%E8%93%9D%E7%89%99%E9%9F%B3%E7%AE%B1%E8%87%AA%E5%8A%A8%E5%85%B3%E6%9C%BA/</guid>
      <description>1 é—®é¢˜ æœ€è¿‘æ•´ç†äº†æ¡Œä¸Šä¹±ç³Ÿç³Ÿçš„çº¿ï¼ŒæŠŠåŸæ¥ä½¿ç”¨aux çº¿è¿æ¥çš„è“ç‰™éŸ³å“æ¢æˆé€šè¿‡è“ç‰™è¿æ¥ã€‚ ç„¶åå°±å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œåªè¦éŸ³å“æ²¡æœ‰å‘å‡ºå£°éŸ³è¶…è¿‡30åˆ†é’Ÿï¼Œè“ç‰™</description>
      <content:encoded><![CDATA[<h2 id="é—®é¢˜"><span class="section-num">1</span> é—®é¢˜</h2>
<p>æœ€è¿‘æ•´ç†äº†æ¡Œä¸Šä¹±ç³Ÿç³Ÿçš„çº¿ï¼ŒæŠŠåŸæ¥ä½¿ç”¨aux çº¿è¿æ¥çš„è“ç‰™éŸ³å“æ¢æˆé€šè¿‡è“ç‰™è¿æ¥ã€‚ <br/></p>
<p>ç„¶åå°±å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œåªè¦éŸ³å“æ²¡æœ‰å‘å‡ºå£°éŸ³è¶…è¿‡30åˆ†é’Ÿï¼Œè“ç‰™éŸ³å“å°±ä¼šæ–­å¼€è¿æ¥ï¼Œå¹¶ä¸”è‡ªåŠ¨å…³æœºï¼Œå³ä½¿è“ç‰™éŸ³å“è¿æ¥ç€ç”µæºã€‚ <br/></p>
<p>ä¸€ç•ªæœç´¢ä¹‹åï¼Œå°±åœ¨çŸ¥ä¹ä¸Šå‘ç°äº†è¿™ä¸ªé—®é¢˜ï¼š<a href="https://www.zhihu.com/question/41682642">æ±‚é—®å¦‚ä½•é¿å…è“ç‰™éŸ³ç®±è‡ªåŠ¨å…³æœºï¼Ÿ</a> <br/></p>
<p>ä½†é‡Œé¢æåˆ°çš„è§£å†³æ–¹æ¡ˆï¼Œå¤§å¤šåªé€‚ç”¨äºç‰¹å®šå¹³å°ï¼Œä¾‹å¦‚Windows æˆ–è€…Macos, æ²¡æœ‰æåˆ° Linux ä¸Šçš„è§£å†³æ–¹æ¡ˆã€‚ <br/></p>
<p>æ¯è¿‡åŠä¸ªå°æ—¶æ‰‹åŠ¨æ‰“å¼€è“ç‰™éŸ³å“å†è¿æ¥çš„æ–¹å¼ï¼Œå®åœ¨æ˜¯å¤ªè ¢äº†ã€‚ <br/></p>
<h2 id="çµæ„Ÿ"><span class="section-num">2</span> çµæ„Ÿ</h2>
<p>ä½†æ˜¯çŸ¥ä¹é—®é¢˜é‡Œé¢çš„éƒ¨åˆ†å›ç­”ç»™äº†æˆ‘çµæ„Ÿï¼Œè®©æˆ‘ä»¬æƒ³èµ·å›½å†…æŸäº›APP ä¸ºäº†ä¿æ´»ï¼Œé¿å…è¢«ç³»ç»Ÿkill æ‰ï¼Œåœ¨åå°æ’­æ”¾æ— å£°éŸ³é¢‘çš„æ“ä½œã€‚ <br/></p>
<p>æˆ‘å¯ä»¥ä»¥ä½éŸ³é‡å¾ªç¯æ’­æ”¾ä¸€æ®µéŸ³é¢‘ï¼Œä»¥å®ç°ä¿æ´»çš„ä½œç”¨ï¼š <br/></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">mpg123 -f <span class="m">1000</span> ~/music/listen_to_the_sea.mp3 --loop -1
</span></span></code></pre></td></tr></table>
</div>
</div><p>mpg123 æ˜¯mp3 æ’­æ”¾å‘½ä»¤è¡Œï¼Œ <code>-f 1000</code> å‚æ•°çš„å«ä¹‰æ˜¯ï¼š100%çš„éŸ³é‡æ˜¯32768, 1000 çº¦ç­‰äºæ˜¯1000/32768 = 3% çš„éŸ³é‡ï¼Œ <code>-loop -1</code> å°±æ˜¯æŒ‡æ— é™å¾ªç¯æ’­æ”¾ã€‚ <br/></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">man mpg123
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-f factor, --scale factor
</span></span><span class="line"><span class="cl">Change scale factor <span class="o">(</span>default: 32768<span class="o">)</span>.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">--loop <span class="nb">times</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> looping track<span class="o">(</span>s<span class="o">)</span> a certain number of times, &lt; <span class="m">0</span> means infinite loop <span class="o">(</span>not with --random!<span class="o">)</span>.
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ä¼˜åŒ–"><span class="section-num">3</span> ä¼˜åŒ–</h2>
<p>è¿™æ ·å°±å®ç°äº†ä¸€ä¸ªå¯ç”¨çš„ç‰ˆæœ¬ï¼Œåªæ˜¯è¿˜è¦ä¾èµ–ä¸€ä¸ª mp3 æ–‡ä»¶ï¼Œè‚¯å®šè¿˜æœ‰ä¼˜åŒ–çš„ç©ºé—´ã€‚ <br/></p>
<p>ä¸€ç•ªè°ƒç ”ä¹‹åå‘ç°ï¼Œ <code>play/sox</code> å‘½ä»¤å¯ä»¥æ’­æ”¾æŒ‡å®šé¢‘ç‡å’Œæ—¶é•¿çš„å£°éŸ³ï¼Œå¯ä»¥æ’­æ”¾20 hzä»¥ä¸‹çš„å£°éŸ³ï¼Œè¿™ä¸ªé¢‘ç‡ä¸‹çš„å£°éŸ³äººè€³æ˜¯å¬ä¸åˆ°çš„ï¼š <br/></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">play -q -n synth <span class="m">10</span> sin <span class="m">20</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>-q</code>: ä¸æ˜¾ç¤ºæ’­æ”¾è¿›åº¦æ¡ <br/></li>
<li><code>-n synth 10</code> æ’­æ”¾10ç§’çš„éŸ³é¢‘ <br/></li>
<li><code>sin 20</code> é¢‘ç‡ä¸º20 hz(å¦‚æœå¬åˆ°äº†ï¼Œå¯ä»¥è®¾ç½®æˆæ›´ä½) <br/></li>
</ul>
<p>æ‰§è¡Œå‘½ä»¤ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨ <code>pavucontrol</code> å‘½ä»¤æŸ¥çœ‹å£°éŸ³è¾“å‡ºï¼Œåº”è¯¥æ˜¯ç±»ä¼¼è¿™æ ·çš„æ•ˆæœï¼š <br/></p>
<p><figure>
    <img loading="lazy" src="/ox-hugo/sox_pavucontrol.png"/> 
</figure>
 <br/></p>
<h2 id="å®šæ—¶æ‰§è¡Œ"><span class="section-num">4</span> å®šæ—¶æ‰§è¡Œ</h2>
<p>ä¸€ç›´å¼€ç€ä¸ªterminal çª—å£è¿è¡Œå‘½ä»¤æœ‰ç‚¹éº»çƒ¦ï¼Œè¿™ç§é‡å¤æ€§çš„å·¥ä½œï¼Œå°±å¯ä»¥äº¤ç»™ crontab, è®©å®ƒæ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œæ¯æ¬¡æ’­æ”¾10ç§’ã€‚ <br/></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">* * * * * play -q -n synth <span class="m">10</span> sin <span class="m">20</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½†å®é™…è¿è¡Œï¼Œå‘ç°å£°éŸ³ä¸èƒ½å¦‚é¢„æœŸé‚£æ ·æ’­æ”¾ã€‚ä¸€ç•ªæœç´¢ä¹‹åï¼Œå‘ç° <a href="https://askubuntu.com/questions/832072/can-i-use-cron-to-chime-at-top-of-hour-like-a-grandfather-clock">StackExchange</a> ä¸Šæœ‰ä¸ªç­”æ¡ˆæåˆ°éœ€è¦ export ä¸ªç¯å¢ƒå˜é‡ï¼Œæ‰€ä»¥æœ€å¥½åˆ›å»ºä¸ªè„šæœ¬ <code>play_beep.sh</code>: <br/></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nb">export</span> <span class="nv">XDG_RUNTIME_DIR</span><span class="o">=</span>/run/user/1000
</span></span><span class="line"><span class="cl">play -q -n synth <span class="m">10</span> sin <span class="m">10</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="k">$(</span>date<span class="k">)</span> <span class="c1"># æ‰“å°æ—¥æœŸï¼Œä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿æ’æŸ¥</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åå†å®‰è£…ä¸€ä¸ª crontab ä»»åŠ¡: <br/></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">* * * * * /usr/bin/sh /home/ramsay/code/shell/play_beep.sh &gt;&gt; /tmp/beep.log 2&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç»è¿‡éªŒè¯ï¼Œä¸€å¤©éƒ½æ²¡æœ‰æ–­å¼€è¿‡è“ç‰™ï¼Œè‡ªåŠ¨å…³æœºäº†ã€‚ <br/></p>
<h2 id="å‚è€ƒ"><span class="section-num">5</span> å‚è€ƒ</h2>
<ul>
<li><a href="https://www.zhihu.com/question/41682642">æ±‚é—®å¦‚ä½•é¿å…è“ç‰™éŸ³ç®±è‡ªåŠ¨å…³æœºï¼Ÿ</a> <br/></li>
<li><a href="https://askubuntu.com/questions/832072/can-i-use-cron-to-chime-at-top-of-hour-like-a-grandfather-clock/832266#832266">Can I use cron to chime at top of hour like a grandfather clock?</a> <br/></li>
</ul>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
]]></content:encoded>
    </item>
    <item>
      <title>lsof can&#39;t identify protocol</title>
      <link>https://ramsayleung.github.io/zh/post/2018/lsof_cant_identify_protocol/</link>
      <pubDate>Wed, 11 Apr 2018 15:24:00 +0800</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2018/lsof_cant_identify_protocol/</guid>
      <description>Socket æ³„æ¼å¼•èµ·çš„Tomcat å®•æœºé—®é¢˜åˆ†æ åœ¨2018å¹´4æœˆ9å·ä¸‹åˆï¼Œæ”¶åˆ°åé¦ˆï¼šæµ‹è¯•é›†ç¾¤éƒ¨åˆ†æ¥å£è®¿é—®æœ‰é—®é¢˜ï¼Œè¯·æ±‚æ—¶è€Œæ­£å¸¸ï¼Œæ—¶è€Œè¶…æ—¶ã€‚ æœ€è¿‘çš„æµ‹è¯•ç¯å¢ƒçœŸ</description>
      <content:encoded><![CDATA[<p>Socket æ³„æ¼å¼•èµ·çš„Tomcat å®•æœºé—®é¢˜åˆ†æ</p>
<p>åœ¨2018å¹´4æœˆ9å·ä¸‹åˆï¼Œæ”¶åˆ°åé¦ˆï¼šæµ‹è¯•é›†ç¾¤éƒ¨åˆ†æ¥å£è®¿é—®æœ‰é—®é¢˜ï¼Œè¯·æ±‚æ—¶è€Œæ­£å¸¸ï¼Œæ—¶è€Œè¶…æ—¶ã€‚</p>
<p>æœ€è¿‘çš„æµ‹è¯•ç¯å¢ƒçœŸçš„æ˜¯é—®é¢˜å¤šå¤šï¼Œå¯æ˜¯æµ‹è¯•ç¯å¢ƒå°±æ˜¯æˆ‘æ­å»ºçš„ï¼Œå†ã€‚æŸ¥çœ‹æ—¥å¿—å‘ç°87 è¿™å° æœåŠ¡å™¨çš„Tomcat æ— æ³•è®¿é—®ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">2018-04-09 17:41:31,568 - [ERROR] - from org.apache.tomcat.util.net.NioEndpoint in http-nio-47001-Acceptor-0
</span></span><span class="line"><span class="cl">Socket accept failed
</span></span><span class="line"><span class="cl">java.io.IOException: Too many open files
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept0(Native Method)
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:422)
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:250)
</span></span><span class="line"><span class="cl">at org.apache.tomcat.util.net.NioEndpoint$Acceptor.run(NioEndpoint.java:825)
</span></span><span class="line"><span class="cl">at java.lang.Thread.run(Thread.java:745)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2018-04-09 17:41:33,168 - [ERROR] - from org.apache.tomcat.util.net.NioEndpoint in http-nio-47001-Acceptor-0
</span></span><span class="line"><span class="cl">Socket accept failed
</span></span><span class="line"><span class="cl">java.io.IOException: Too many open files
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept0(Native Method)
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:422)
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:250)
</span></span><span class="line"><span class="cl">at org.apache.tomcat.util.net.NioEndpoint$Acceptor.run(NioEndpoint.java:825)
</span></span><span class="line"><span class="cl">at java.lang.Thread.run(Thread.java:745)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="linux-æ–‡ä»¶å¥æŸ„é™åˆ¶"><span class="section-num">1</span> Linux æ–‡ä»¶å¥æŸ„é™åˆ¶</h2>
<p>æŠ¥é”™çœ‹èµ·æ¥åƒæ˜¯è¿›ç¨‹æ‰“å¼€æ–‡ä»¶å¥æŸ„çš„ä¸ªæ•°è¾¾åˆ°äº†linuxçš„é™åˆ¶ã€‚è€Œè¿™ç§é™åˆ¶æ˜¯åˆ†ä¸ºç³»ç»Ÿå±‚é¢çš„å’Œç”¨æˆ·å±‚é¢çš„</p>
<h3 id="ç³»ç»Ÿå±‚é¢"><span class="section-num">1.1</span> ç³»ç»Ÿå±‚é¢</h3>
<p>ç³»ç»Ÿå±‚é¢çš„åœ¨ï¼š/proc/sys/fs/file-maxé‡Œè®¾ç½®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">cat /proc/sys/fs/file-max
</span></span><span class="line"><span class="cl"><span class="m">2442976</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ç”¨æˆ·å±‚é¢"><span class="section-num">1.2</span> ç”¨æˆ·å±‚é¢</h3>
<p>ç”¨æˆ·å±‚é¢çš„é™åˆ¶åœ¨ï¼š/etc/security/limits.confé‡Œè®¾å®šã€‚é€šè¿‡<code>ulimit -a</code> æŸ¥çœ‹ç³»ç»Ÿå…è®¸å•ä¸ªè¿›ç¨‹æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æ•°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="nb">ulimit</span> -a
</span></span><span class="line"><span class="cl">core file size          <span class="o">(</span>blocks, -c<span class="o">)</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">data seg size           <span class="o">(</span>kbytes, -d<span class="o">)</span> unlimited
</span></span><span class="line"><span class="cl">scheduling priority             <span class="o">(</span>-e<span class="o">)</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">file size               <span class="o">(</span>blocks, -f<span class="o">)</span> unlimited
</span></span><span class="line"><span class="cl">pending signals                 <span class="o">(</span>-i<span class="o">)</span> <span class="m">192059</span>
</span></span><span class="line"><span class="cl">max locked memory       <span class="o">(</span>kbytes, -l<span class="o">)</span> <span class="m">64</span>
</span></span><span class="line"><span class="cl">max memory size         <span class="o">(</span>kbytes, -m<span class="o">)</span> unlimited
</span></span><span class="line"><span class="cl">open files                      <span class="o">(</span>-n<span class="o">)</span> <span class="m">65536</span>
</span></span><span class="line"><span class="cl">pipe size            <span class="o">(</span><span class="m">512</span> bytes, -p<span class="o">)</span> <span class="m">8</span>
</span></span><span class="line"><span class="cl">POSIX message queues     <span class="o">(</span>bytes, -q<span class="o">)</span> <span class="m">819200</span>
</span></span><span class="line"><span class="cl">real-time priority              <span class="o">(</span>-r<span class="o">)</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">stack size              <span class="o">(</span>kbytes, -s<span class="o">)</span> <span class="m">10240</span>
</span></span><span class="line"><span class="cl">cpu <span class="nb">time</span>               <span class="o">(</span>seconds, -t<span class="o">)</span> unlimited
</span></span><span class="line"><span class="cl">max user processes              <span class="o">(</span>-u<span class="o">)</span> <span class="m">65535</span>
</span></span><span class="line"><span class="cl">virtual memory          <span class="o">(</span>kbytes, -v<span class="o">)</span> unlimited
</span></span><span class="line"><span class="cl">file locks                      <span class="o">(</span>-x<span class="o">)</span> unlimited
</span></span></code></pre></td></tr></table>
</div>
</div><p>å•ä¸ªè¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æ•°æ˜¯ 65536</p>
<h2 id="lsof-æ˜¾ç¤ºå¤§é‡open-file"><span class="section-num">2</span> lsof æ˜¾ç¤ºå¤§é‡open file</h2>
<p>æŒ‰ç…§Tomcat ç»™å‡ºçš„æŠ¥é”™ä¿¡æ¯ï¼Œç™»å½•87 è¿™å°æœåŠ¡å™¨æ£€æŸ¥æ‰“å¼€çš„æ–‡ä»¶æ•°ï¼Œå‘ç°æ‰“å¼€çš„æ–‡ä»¶è¶…è¿‡70000:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">lsof <span class="p">|</span>wc -l
</span></span><span class="line"><span class="cl"><span class="m">75924</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åæ‰¾å‡ºæ‰“å¼€æ–‡ä»¶æ•°æœ€å¤šçš„è¿›ç¨‹ï¼ŒæŒ‰æ–‡ä»¶æ•°é™åºæ’åˆ—ï¼Œå·¦è¾¹æ˜¯ open file çš„æ•°é‡ï¼Œå³è¾¹æ˜¯è¿›ç¨‹IDï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">lsof -n<span class="p">|</span>awk <span class="s1">&#39;{print $2}&#39;</span><span class="p">|</span> sort <span class="p">|</span> uniq -c <span class="p">|</span> sort -nr <span class="p">|</span> head
</span></span><span class="line"><span class="cl"><span class="m">65966</span> <span class="m">25204</span>
</span></span><span class="line"><span class="cl"><span class="m">5374</span> <span class="m">20179</span>
</span></span><span class="line"><span class="cl"><span class="m">184</span> <span class="m">27275</span>
</span></span><span class="line"><span class="cl"><span class="m">65</span> <span class="m">5361</span>
</span></span><span class="line"><span class="cl"><span class="m">61</span> <span class="m">29421</span>
</span></span><span class="line"><span class="cl"><span class="m">16</span> <span class="m">22177</span>
</span></span><span class="line"><span class="cl"><span class="m">14</span> <span class="m">19751</span>
</span></span><span class="line"><span class="cl"><span class="m">12</span> <span class="m">22181</span>
</span></span><span class="line"><span class="cl"><span class="m">12</span> <span class="m">22179</span>
</span></span><span class="line"><span class="cl"><span class="m">12</span> <span class="m">22178</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‘ç° <code>25204</code> è¿™ä¸ªè¿›ç¨‹æ‰“å¼€äº†å¤§é‡çš„æ–‡ä»¶ï¼Œå·²ç»è¶…è¿‡äº†å•ä¸ªè¿›ç¨‹çš„æœ€å¤§æ–‡ä»¶æ•°é™åˆ¶ã€‚è€Œè¿™ä¸ªè¿›ç¨‹å°±æ˜¯éƒ¨ç½²çš„java åº”ç”¨å¯¹åº”çš„è¿›ç¨‹ã€‚æ‰“å¼€çš„æ–‡ä»¶å¥æŸ„æ•°é‡å·²ç»è¶…è¿‡Linux é™åˆ¶ï¼Œ
Tomcat æ— æ³•åˆ›å»ºæ–°çš„socket è¿æ¥ã€‚</p>
<h2 id="can-t-identify-protocol"><span class="section-num">3</span> can&rsquo;t identify protocol</h2>
<p>ç”¨ lsof æŸ¥çœ‹ java åº”ç”¨æ‰“å¼€çš„æ–‡ä»¶çš„æ—¶å€™ï¼Œå‘ç°æœ‰éå¸¸å¤šå¥‡æ€ªçš„è¾“å‡ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">java    <span class="m">25204</span> nemo *516u  sock                0,6       0t0 <span class="m">215137625</span> can<span class="s1">&#39;t identify protocol
</span></span></span><span class="line"><span class="cl"><span class="s1">java    25204 nemo *517u  sock                0,6       0t0 215137626 can&#39;</span>t identify protocol
</span></span><span class="line"><span class="cl">java    <span class="m">25204</span> nemo *518u  sock                0,6       0t0 <span class="m">215137627</span> can<span class="s1">&#39;t identify protocol
</span></span></span><span class="line"><span class="cl"><span class="s1">java    25204 nemo *519u  sock                0,6       0t0 215137628 can&#39;</span>t identify protocol
</span></span><span class="line"><span class="cl">java    <span class="m">25204</span> nemo *520u  sock                0,6       0t0 <span class="m">215137629</span> can<span class="s1">&#39;t identify protocol
</span></span></span><span class="line"><span class="cl"><span class="s1">java    25204 nemo *521u  sock                0,6       0t0 215137630 can&#39;</span>t identify protocol
</span></span><span class="line"><span class="cl">java    <span class="m">25204</span> nemo *522u  sock                0,6       0t0 <span class="m">215137631</span> can<span class="s1">&#39;t identify protocol
</span></span></span><span class="line"><span class="cl"><span class="s1">java    25204 nemo *523u  sock                0,6       0t0 215137634 can&#39;</span>t identify protocol
</span></span><span class="line"><span class="cl">java    <span class="m">25204</span> nemo *524u  sock                0,6       0t0 <span class="m">215137635</span> can<span class="s1">&#39;t identify protocol
</span></span></span><span class="line"><span class="cl"><span class="s1">java    25204 nemo *525u  sock                0,6       0t0 215137636 can&#39;</span>t identify protocol
</span></span><span class="line"><span class="cl">java    <span class="m">25204</span> nemo *526u  sock                0,6       0t0 <span class="m">215137637</span> can<span class="s1">&#39;t identify protocol
</span></span></span><span class="line"><span class="cl"><span class="s1">java    25204 nemo *527u  sock                0,6       0t0 215137638 can&#39;</span>t identify protocol
</span></span><span class="line"><span class="cl">java    <span class="m">25204</span> nemo *528u  sock                0,6       0t0 <span class="m">215137639</span> can<span class="s1">&#39;t identify protocol
</span></span></span><span class="line"><span class="cl"><span class="s1">java    25204 nemo *529u  sock                0,6       0t0 215137640 can&#39;</span>t identify protocol
</span></span><span class="line"><span class="cl">java    <span class="m">25204</span> nemo *530u  sock                0,6       0t0 <span class="m">215137641</span> can<span class="s1">&#39;t identify protocol
</span></span></span><span class="line"><span class="cl"><span class="s1">java    25204 nemo *531u  sock                0,6       0t0 215137642 can&#39;</span>t identify protocol
</span></span><span class="line"><span class="cl">java    <span class="m">25204</span> nemo *532u  sock                0,6       0t0 <span class="m">215137644</span> can<span class="s1">&#39;t identify protocol
</span></span></span><span class="line"><span class="cl"><span class="s1">java    25204 nemo *533u  sock                0,6       0t0 215137646 can&#39;</span>t identify protocol
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç»Ÿè®¡ä¹‹åå‘ç°ï¼Œ <code>can't identify protocol</code> è¿™æ ·çš„æ–‡ä»¶æ•°é‡éå¸¸å¤šï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">lsof -p 25204<span class="p">|</span>grep <span class="s2">&#34;can&#39;t identify protocol&#34;</span><span class="p">|</span>wc -l
</span></span><span class="line"><span class="cl"><span class="m">64214</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¹Ÿå°±æ˜¯å¤§éƒ¨ä»½æ‰“å¼€çš„æ–‡ä»¶éƒ½æ˜¯å±äº <code>cant' identify  protocol</code> çš„æ–‡ä»¶ã€‚</p>
<h2 id="é—®é¢˜å®šä½"><span class="section-num">4</span> é—®é¢˜å®šä½</h2>
<p>Google æœç´¢ä¹‹åå‘ç°ï¼Œè¿™ä¸ª <code>cant' identify protocol</code> çš„ä¸œä¸œå‡ºç°çš„åŸå› æ˜¯å› ä¸º è¿™äº›
sockets å¤„äº <code>CLOSED</code> çš„çŠ¶æ€ï¼Œä½†æ˜¯å´æ²¡æœ‰çœŸæ­£close æ‰ï¼Œæ­£å¤„äº <code>half-close</code> çŠ¶æ€ã€‚å› æ­¤ï¼Œå¦‚æœä½¿ç”¨ <code>netstat</code> æ¥æŸ¥çœ‹socket çŠ¶æ€ï¼Œæ˜¯ä¸ä¼šæ˜¾ç¤ºè¿™äº› <code>half-close</code>çš„ socket çš„ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">netstat  -nat <span class="p">|</span>wc -l
</span></span><span class="line"><span class="cl"><span class="m">881</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨ <code>netstat</code> çš„æ”¹è¿›ç‰ˆæœ¬ <code>ss</code> å°±èƒ½å‘ç°å¤§é‡å¤„äº <code>Closed</code> çŠ¶æ€çš„ socket:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">ss -s
</span></span><span class="line"><span class="cl">Total: <span class="m">76052</span> <span class="o">(</span>kernel 76254<span class="o">)</span>
</span></span><span class="line"><span class="cl">TCP:   <span class="m">75924</span> <span class="o">(</span>estab 123, closed 75524, orphaned 0, synrecv 0, timewait 173/0<span class="o">)</span>, ports <span class="m">104</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Transport Total     IP        IPv6
</span></span><span class="line"><span class="cl">*         <span class="m">76254</span>    -         -
</span></span><span class="line"><span class="cl">RAW       <span class="m">0</span>         <span class="m">0</span>         <span class="m">0</span>
</span></span><span class="line"><span class="cl">UDP       <span class="m">9</span>         <span class="m">6</span>         <span class="m">3</span>
</span></span><span class="line"><span class="cl">TCP       <span class="m">116</span>       <span class="m">80</span>        <span class="m">36</span>
</span></span><span class="line"><span class="cl">INET      <span class="m">125</span>       <span class="m">86</span>        <span class="m">39</span>
</span></span><span class="line"><span class="cl">FRAG      <span class="m">0</span>         <span class="m">0</span>         <span class="m">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¥ç€æŸ¥çœ‹å†…æ ¸çš„ socket æƒ…å†µï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">cat /proc/net/sockstat
</span></span><span class="line"><span class="cl">sockets: used <span class="m">75724</span>
</span></span><span class="line"><span class="cl">TCP: inuse <span class="m">886</span> orphan <span class="m">0</span> tw <span class="m">0</span> alloc <span class="m">72134</span> mem <span class="m">222</span>
</span></span><span class="line"><span class="cl">UDP: inuse <span class="m">5</span> mem <span class="m">0</span>
</span></span><span class="line"><span class="cl">UDPLITE: inuse <span class="m">0</span>
</span></span><span class="line"><span class="cl">RAW: inuse <span class="m">0</span>
</span></span><span class="line"><span class="cl">FRAG: inuse <span class="m">0</span> memory <span class="m">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¾ˆå¤šçš„ socket å¤„äº <code>alloc</code>, åªæœ‰å°‘é‡çš„ socket å¤„äº <code>inuse</code>. å¯ä»¥ç¡®è®¤æ˜¯ java åº”ç”¨å‡ºç°äº† socket fd çš„æ³„æ¼ã€‚ ä½†æ˜¯ä¸ºä»€ä¹ˆä¼šæœ‰é‚£ä¹ˆå¤šçš„socket æ³„æ¼å‘¢ï¼Ÿ</p>
<h2 id="å¤§èƒ†å‡è®¾"><span class="section-num">5</span> å¤§èƒ†å‡è®¾</h2>
<p>ç°åœ¨å¯ä»¥ç¡®å®šçš„æ˜¯ javaåº”ç”¨å‡ºç°äº†é—®é¢˜ï¼Œå¯¼è‡´äº†socket æ³„æ¼ï¼Œè®© Tomcat æ— æ³•å»ºç«‹æ–°è¿æ¥ï¼Œæœ€ç»ˆå®•æœºã€‚æ—¢ç„¶å¯¼è‡´é—®é¢˜å‡ºç°çš„æ˜¯ java åº”ç”¨ï¼Œé‚£ä¹ˆå°±åº”è¯¥å»æ£€æŸ¥åº”ç”¨æ—¥å¿—ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">2018-04-09 17:41:31,491 - [ERROR] - from com.alibaba.druid.pool.DruidDataSource in Druid-ConnectionPool-CreateScheduler--4-thread-214
</span></span><span class="line"><span class="cl">create connection error, url: jdbc:mysql://test-server-host:3306/db_name?readOnlyPropagatesToServer=false&amp;rewriteBatchedStatements=true&amp;failOverReadOnly=false&amp;socketTimeout=6000&amp;connectTimeout=20000&amp;zeroDateTimeBehavior=convertToNull&amp;allowMultiQueries=true&amp;characterEncoding=utf-8&amp;autoReconnect=true
</span></span><span class="line"><span class="cl">com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: Could not create connection to database server. Attempted reconnect 3 times. Giving up.
</span></span><span class="line"><span class="cl">at sun.reflect.GeneratedConstructorAccessor169.newInstance(Unknown Source)
</span></span><span class="line"><span class="cl">at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
</span></span><span class="line"><span class="cl">at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.Util.getInstance(Util.java:408)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:918)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:897)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:886)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:860)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.connectWithRetries(ConnectionImpl.java:2163)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2088)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.&lt;init&gt;(ConnectionImpl.java:806)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.JDBC4Connection.&lt;init&gt;(JDBC4Connection.java:47)
</span></span><span class="line"><span class="cl">at sun.reflect.GeneratedConstructorAccessor152.newInstance(Unknown Source)
</span></span><span class="line"><span class="cl">at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
</span></span><span class="line"><span class="cl">at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:410)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:328)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.filter.FilterChainImpl.connection_connect(FilterChainImpl.java:148)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.filter.stat.StatFilter.connection_connect(StatFilter.java:211)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.filter.FilterChainImpl.connection_connect(FilterChainImpl.java:142)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:1423)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:1477)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.pool.DruidDataSource$CreateConnectionTask.runInternal(DruidDataSource.java:1884)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.pool.DruidDataSource$CreateConnectionTask.run(DruidDataSource.java:1849)
</span></span><span class="line"><span class="cl">at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
</span></span><span class="line"><span class="cl">at java.util.concurrent.FutureTask.run(FutureTask.java:266)
</span></span><span class="line"><span class="cl">at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
</span></span><span class="line"><span class="cl">at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
</span></span><span class="line"><span class="cl">at java.lang.Thread.run(Thread.java:745)
</span></span><span class="line"><span class="cl">Caused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
</span></span><span class="line"><span class="cl">at sun.reflect.GeneratedConstructorAccessor157.newInstance(Unknown Source)
</span></span><span class="line"><span class="cl">at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
</span></span><span class="line"><span class="cl">at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:989)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.MysqlIO.&lt;init&gt;(MysqlIO.java:341)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2251)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.connectWithRetries(ConnectionImpl.java:2104)
</span></span><span class="line"><span class="cl">... 21 common frames omitted
</span></span><span class="line"><span class="cl">Caused by: java.net.SocketException: Too many open files
</span></span><span class="line"><span class="cl">at java.net.Socket.createImpl(Socket.java:460)
</span></span><span class="line"><span class="cl">at java.net.Socket.getImpl(Socket.java:520)
</span></span><span class="line"><span class="cl">at java.net.Socket.setTcpNoDelay(Socket.java:980)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.StandardSocketFactory.configureSocket(StandardSocketFactory.java:132)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:203)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.MysqlIO.&lt;init&gt;(MysqlIO.java:300)
</span></span><span class="line"><span class="cl">... 23 common frames omitted
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2018-04-09 17:41:31,568 - [ERROR] - from org.apache.tomcat.util.net.NioEndpoint in http-nio-47001-Acceptor-0
</span></span><span class="line"><span class="cl">Socket accept failed
</span></span><span class="line"><span class="cl">java.io.IOException: Too many open files
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept0(Native Method)
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:422)
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:250)
</span></span><span class="line"><span class="cl">at org.apache.tomcat.util.net.NioEndpoint$Acceptor.run(NioEndpoint.java:825)
</span></span><span class="line"><span class="cl">at java.lang.Thread.run(Thread.java:745)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2018-04-09 17:41:33,168 - [ERROR] - from org.apache.tomcat.util.net.NioEndpoint in http-nio-47001-Acceptor-0
</span></span><span class="line"><span class="cl">Socket accept failed
</span></span><span class="line"><span class="cl">java.io.IOException: Too many open files
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept0(Native Method)
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:422)
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:250)
</span></span><span class="line"><span class="cl">at org.apache.tomcat.util.net.NioEndpoint$Acceptor.run(NioEndpoint.java:825)
</span></span><span class="line"><span class="cl">at java.lang.Thread.run(Thread.java:745)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2018-04-09 17:41:34,470 - [ERROR] - from com.alibaba.druid.pool.DruidDataSource in Druid-ConnectionPool-CreateScheduler--4-thread-216
</span></span><span class="line"><span class="cl">create connection error, url: jdbc:mysql://test-server-url:3306/db_name?readOnlyPropagatesToServer=false&amp;rewriteBatchedStatements=true&amp;failOverReadOnly=false&amp;socketTimeout=6000&amp;connectTimeout=20000&amp;zeroDateTimeBehavior=convertToNull&amp;allowMultiQueries=true&amp;characterEncoding=utf-8&amp;autoReconnect=true
</span></span><span class="line"><span class="cl">com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: Could not create connection to database server. Attempted reconnect 3 times. Giving up.
</span></span><span class="line"><span class="cl">at sun.reflect.GeneratedConstructorAccessor169.newInstance(Unknown Source)
</span></span><span class="line"><span class="cl">at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
</span></span><span class="line"><span class="cl">at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.Util.getInstance(Util.java:408)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:918)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:897)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:886)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:860)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.connectWithRetries(ConnectionImpl.java:2163)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2088)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.&lt;init&gt;(ConnectionImpl.java:806)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.JDBC4Connection.&lt;init&gt;(JDBC4Connection.java:47)
</span></span><span class="line"><span class="cl">at sun.reflect.GeneratedConstructorAccessor152.newInstance(Unknown Source)
</span></span><span class="line"><span class="cl">at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
</span></span><span class="line"><span class="cl">at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:410)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:328)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.filter.FilterChainImpl.connection_connect(FilterChainImpl.java:148)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.filter.stat.StatFilter.connection_connect(StatFilter.java:211)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.filter.FilterChainImpl.connection_connect(FilterChainImpl.java:142)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:1423)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:1477)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.pool.DruidDataSource$CreateConnectionTask.runInternal(DruidDataSource.java:1884)
</span></span><span class="line"><span class="cl">at com.alibaba.druid.pool.DruidDataSource$CreateConnectionTask.run(DruidDataSource.java:1849)
</span></span><span class="line"><span class="cl">at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
</span></span><span class="line"><span class="cl">at java.util.concurrent.FutureTask.run(FutureTask.java:266)
</span></span><span class="line"><span class="cl">at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
</span></span><span class="line"><span class="cl">at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
</span></span><span class="line"><span class="cl">at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
</span></span><span class="line"><span class="cl">at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
</span></span><span class="line"><span class="cl">at java.lang.Thread.run(Thread.java:745)
</span></span><span class="line"><span class="cl">Caused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
</span></span><span class="line"><span class="cl">at sun.reflect.GeneratedConstructorAccessor157.newInstance(Unknown Source)
</span></span><span class="line"><span class="cl">at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
</span></span><span class="line"><span class="cl">at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:989)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.MysqlIO.&lt;init&gt;(MysqlIO.java:341)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2251)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.ConnectionImpl.connectWithRetries(ConnectionImpl.java:2104)
</span></span><span class="line"><span class="cl">... 23 common frames omitted
</span></span><span class="line"><span class="cl">Caused by: java.net.SocketException: Too many open files
</span></span><span class="line"><span class="cl">at java.net.Socket.createImpl(Socket.java:460)
</span></span><span class="line"><span class="cl">at java.net.Socket.getImpl(Socket.java:520)
</span></span><span class="line"><span class="cl">at java.net.Socket.setTcpNoDelay(Socket.java:980)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.StandardSocketFactory.configureSocket(StandardSocketFactory.java:132)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:203)
</span></span><span class="line"><span class="cl">at com.mysql.jdbc.MysqlIO.&lt;init&gt;(MysqlIO.java:300)
</span></span><span class="line"><span class="cl">... 25 common frames omitted
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2018-04-09 17:41:34,769 - [ERROR] - from org.apache.tomcat.util.net.NioEndpoint in http-nio-47001-Acceptor-0
</span></span><span class="line"><span class="cl">Socket accept failed
</span></span><span class="line"><span class="cl">java.io.IOException: Too many open files
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept0(Native Method)
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:422)
</span></span><span class="line"><span class="cl">at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:250)
</span></span><span class="line"><span class="cl">at org.apache.tomcat.util.net.NioEndpoint$Acceptor.run(NioEndpoint.java:825)
</span></span><span class="line"><span class="cl">at java.lang.Thread.run(Thread.java:745)
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ£€æŸ¥æ—¥å¿—å‘ç°ï¼Œåœ¨ Tomcat å½»åº•æŒ‚æœºä¹‹å‰ï¼Œæ›¾ç»æœ‰æ¯”è¾ƒå¤§é‡çš„æ•°æ®æºè¿æ¥æ± å‡ºé”™ï¼Œæ— æ³•è®¿é—® Mysql, ä½†æ˜¯éå¸¸å¥‡æ€ªçš„æ˜¯ï¼Œåœ¨87 è¿™å°æœºå™¨ä¸Šé¢ï¼Œæ˜¯å¯ä»¥ä½¿ç”¨ mysql å‘½ä»¤è¡Œè¿æ¥åˆ°æµ‹è¯•æ•°æ®åº“çš„ï¼Œè¯´æ˜ Mysql çš„è¿æ¥æ˜¯æ²¡æœ‰é—®é¢˜ã€‚</p>
<p>ä½†æ˜¯æ•°æ®æºè¿æ¥å°±ä¼šå‡ºé”™ï¼ï¼ çœŸçš„æ˜¯å¾ˆå¥‡æ€ªï¼Œä¸ºä»€ä¹ˆè¿æ¥æ± ä¼šæŠ¥é”™ï¼Œæœ‰æ²¡æœ‰å¯èƒ½æ˜¯è¿™äº›å¼‚å¸¸å¯¼è‡´ socket æ³„æ¼å‘¢ï¼Ÿåæ¥ï¼Œåœ¨æœ¬åœ°è¿è¡Œåº”ç”¨ï¼Œæœ‰æ—¶å€™ä¼šå‘ç°IDE çš„æ§åˆ¶å°æŠ¥é”™ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span><span class="lnt">96
</span><span class="lnt">97
</span><span class="lnt">98
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mi">2018</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">11</span> <span class="mi">09</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="mi">48</span><span class="p">,</span><span class="mi">363</span> <span class="o">-</span> <span class="p">[</span><span class="n">ERROR</span><span class="p">]</span> <span class="o">-</span> <span class="n">from</span> <span class="n">com</span><span class="o">.</span><span class="n">alibaba</span><span class="o">.</span><span class="n">druid</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">DruidDataSource</span> <span class="ow">in</span> <span class="n">poolTaskScheduler</span><span class="o">-</span><span class="mi">11</span>
</span></span><span class="line"><span class="cl"><span class="n">discard</span> <span class="n">connection</span>
</span></span><span class="line"><span class="cl"><span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">jdbc4</span><span class="o">.</span><span class="n">CommunicationsException</span><span class="p">:</span> <span class="n">Communications</span> <span class="n">link</span> <span class="n">failure</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">last</span> <span class="n">packet</span> <span class="n">successfully</span> <span class="n">received</span> <span class="n">from</span> <span class="n">the</span> <span class="n">server</span> <span class="n">was</span> <span class="mi">100</span><span class="p">,</span><span class="mi">610</span> <span class="n">milliseconds</span> <span class="n">ago</span><span class="o">.</span>  <span class="n">The</span> <span class="n">last</span> <span class="n">packet</span> <span class="n">sent</span> <span class="n">successfully</span> <span class="n">to</span> <span class="n">the</span> <span class="n">server</span> <span class="n">was</span> <span class="mi">0</span> <span class="n">milliseconds</span> <span class="n">ago</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">sun</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">GeneratedConstructorAccessor108</span><span class="o">.</span><span class="n">newInstance</span><span class="p">(</span><span class="n">Unknown</span> <span class="n">Source</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">sun</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">DelegatingConstructorAccessorImpl</span><span class="o">.</span><span class="n">newInstance</span><span class="p">(</span><span class="n">DelegatingConstructorAccessorImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">45</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">Constructor</span><span class="o">.</span><span class="n">newInstance</span><span class="p">(</span><span class="n">Constructor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">423</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">handleNewInstance</span><span class="p">(</span><span class="n">Util</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">425</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">SQLError</span><span class="o">.</span><span class="n">createCommunicationsException</span><span class="p">(</span><span class="n">SQLError</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">989</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">reuseAndReadPacket</span><span class="p">(</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">3556</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">reuseAndReadPacket</span><span class="p">(</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">3456</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">checkErrorPacket</span><span class="p">(</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">3897</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">sendCommand</span><span class="p">(</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">2524</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">sqlQueryDirect</span><span class="p">(</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">2677</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">ConnectionImpl</span><span class="o">.</span><span class="n">execSQL</span><span class="p">(</span><span class="n">ConnectionImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">2545</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">ConnectionImpl</span><span class="o">.</span><span class="n">execSQL</span><span class="p">(</span><span class="n">ConnectionImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">2503</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">StatementImpl</span><span class="o">.</span><span class="n">executeQuery</span><span class="p">(</span><span class="n">StatementImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">1369</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">alibaba</span><span class="o">.</span><span class="n">druid</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">FilterChainImpl</span><span class="o">.</span><span class="n">statement_executeQuery</span><span class="p">(</span><span class="n">FilterChainImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">2363</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">alibaba</span><span class="o">.</span><span class="n">druid</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">FilterAdapter</span><span class="o">.</span><span class="n">statement_executeQuery</span><span class="p">(</span><span class="n">FilterAdapter</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">2481</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">alibaba</span><span class="o">.</span><span class="n">druid</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">FilterEventAdapter</span><span class="o">.</span><span class="n">statement_executeQuery</span><span class="p">(</span><span class="n">FilterEventAdapter</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">302</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">alibaba</span><span class="o">.</span><span class="n">druid</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">FilterChainImpl</span><span class="o">.</span><span class="n">statement_executeQuery</span><span class="p">(</span><span class="n">FilterChainImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">2360</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">alibaba</span><span class="o">.</span><span class="n">druid</span><span class="o">.</span><span class="n">proxy</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">StatementProxyImpl</span><span class="o">.</span><span class="n">executeQuery</span><span class="p">(</span><span class="n">StatementProxyImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">211</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">alibaba</span><span class="o">.</span><span class="n">druid</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">DruidPooledStatement</span><span class="o">.</span><span class="n">executeQuery</span><span class="p">(</span><span class="n">DruidPooledStatement</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">138</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">atom</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TStatementWrapper</span><span class="o">.</span><span class="n">executeQuery</span><span class="p">(</span><span class="n">TStatementWrapper</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">315</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TGroupStatement</span><span class="o">.</span><span class="n">executeQueryOnConnection</span><span class="p">(</span><span class="n">TGroupStatement</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">549</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TGroupStatement</span><span class="o">$</span><span class="mf">4.</span><span class="n">tryOnDataSource</span><span class="p">(</span><span class="n">TGroupStatement</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">633</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TGroupStatement</span><span class="o">$</span><span class="mf">4.</span><span class="n">tryOnDataSource</span><span class="p">(</span><span class="n">TGroupStatement</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">615</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">dbselector</span><span class="o">.</span><span class="n">AbstractDBSelector</span><span class="o">.</span><span class="n">tryOnDataSourceHolder</span><span class="p">(</span><span class="n">AbstractDBSelector</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">155</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">dbselector</span><span class="o">.</span><span class="n">OneDBSelector</span><span class="o">.</span><span class="n">tryExecuteInternal</span><span class="p">(</span><span class="n">OneDBSelector</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">52</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">dbselector</span><span class="o">.</span><span class="n">AbstractDBSelector</span><span class="o">.</span><span class="n">tryExecute</span><span class="p">(</span><span class="n">AbstractDBSelector</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">405</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">dbselector</span><span class="o">.</span><span class="n">AbstractDBSelector</span><span class="o">.</span><span class="n">tryExecute</span><span class="p">(</span><span class="n">AbstractDBSelector</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">412</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TGroupStatement</span><span class="o">.</span><span class="n">executeQuery</span><span class="p">(</span><span class="n">TGroupStatement</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">488</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TGroupStatement</span><span class="o">.</span><span class="n">executeInternal</span><span class="p">(</span><span class="n">TGroupStatement</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">131</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TGroupStatement</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">TGroupStatement</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">101</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">repo</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">spi</span><span class="o">.</span><span class="n">My_JdbcHandler</span><span class="o">.</span><span class="n">executeQuery</span><span class="p">(</span><span class="n">My_JdbcHandler</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">521</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">repo</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">spi</span><span class="o">.</span><span class="n">My_Cursor</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">My_Cursor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">106</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">repo</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">handler</span><span class="o">.</span><span class="n">QueryMyHandler</span><span class="o">.</span><span class="n">handle</span><span class="p">(</span><span class="n">QueryMyHandler</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">89</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">AbstractGroupExecutor</span><span class="o">.</span><span class="n">executeInner</span><span class="p">(</span><span class="n">AbstractGroupExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">47</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">AbstractGroupExecutor</span><span class="o">.</span><span class="n">execByExecPlanNode</span><span class="p">(</span><span class="n">AbstractGroupExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">36</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">TopologyExecutor</span><span class="o">.</span><span class="n">execByExecPlanNode</span><span class="p">(</span><span class="n">TopologyExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">66</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">MatrixExecutor</span><span class="o">.</span><span class="n">execByExecPlanNodeByOne</span><span class="p">(</span><span class="n">MatrixExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">670</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">MatrixExecutor</span><span class="o">.</span><span class="n">execByExecPlanNode</span><span class="p">(</span><span class="n">MatrixExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">659</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">MatrixExecutor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">MatrixExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">137</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TConnection</span><span class="o">.</span><span class="n">executeSQL</span><span class="p">(</span><span class="n">TConnection</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">241</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TPreparedStatement</span><span class="o">.</span><span class="n">executeSQL</span><span class="p">(</span><span class="n">TPreparedStatement</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">64</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TStatement</span><span class="o">.</span><span class="n">executeInternal</span><span class="p">(</span><span class="n">TStatement</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">133</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">taobao</span><span class="o">.</span><span class="n">tddl</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">TPreparedStatement</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">TPreparedStatement</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">49</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">sun</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">GeneratedMethodAccessor148</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">Unknown</span> <span class="n">Source</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">sun</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">DelegatingMethodAccessorImpl</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">DelegatingMethodAccessorImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">43</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">Method</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">Method</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">498</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">PreparedStatementLogger</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">PreparedStatementLogger</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">59</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">sun</span><span class="o">.</span><span class="n">proxy</span><span class="o">.$</span><span class="n">Proxy102</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">Unknown</span> <span class="n">Source</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">statement</span><span class="o">.</span><span class="n">PreparedStatementHandler</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">PreparedStatementHandler</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">63</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">statement</span><span class="o">.</span><span class="n">RoutingStatementHandler</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">RoutingStatementHandler</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">79</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">SimpleExecutor</span><span class="o">.</span><span class="n">doQuery</span><span class="p">(</span><span class="n">SimpleExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">63</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">BaseExecutor</span><span class="o">.</span><span class="n">queryFromDatabase</span><span class="p">(</span><span class="n">BaseExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">325</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">BaseExecutor</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">BaseExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">156</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">CachingExecutor</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">CachingExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">109</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">executor</span><span class="o">.</span><span class="n">CachingExecutor</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">CachingExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">83</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">sun</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">GeneratedMethodAccessor146</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">Unknown</span> <span class="n">Source</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">sun</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">DelegatingMethodAccessorImpl</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">DelegatingMethodAccessorImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">43</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">Method</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">Method</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">498</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">plugin</span><span class="o">.</span><span class="n">Invocation</span><span class="o">.</span><span class="n">proceed</span><span class="p">(</span><span class="n">Invocation</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">49</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">fastfish</span><span class="o">.</span><span class="n">interceptor</span><span class="o">.</span><span class="n">DbLogInterceptor</span><span class="o">.</span><span class="n">intercept</span><span class="p">(</span><span class="n">DbLogInterceptor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">49</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">plugin</span><span class="o">.</span><span class="n">Plugin</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">Plugin</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">61</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">sun</span><span class="o">.</span><span class="n">proxy</span><span class="o">.$</span><span class="n">Proxy100</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Unknown</span> <span class="n">Source</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">DefaultSqlSession</span><span class="o">.</span><span class="n">selectList</span><span class="p">(</span><span class="n">DefaultSqlSession</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">148</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">DefaultSqlSession</span><span class="o">.</span><span class="n">selectList</span><span class="p">(</span><span class="n">DefaultSqlSession</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">141</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">sun</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">GeneratedMethodAccessor145</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">Unknown</span> <span class="n">Source</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">sun</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">DelegatingMethodAccessorImpl</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">DelegatingMethodAccessorImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">43</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">Method</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">Method</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">498</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">mybatis</span><span class="o">.</span><span class="n">spring</span><span class="o">.</span><span class="n">SqlSessionTemplate</span><span class="o">$</span><span class="n">SqlSessionInterceptor</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">SqlSessionTemplate</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">434</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">sun</span><span class="o">.</span><span class="n">proxy</span><span class="o">.$</span><span class="n">Proxy87</span><span class="o">.</span><span class="n">selectList</span><span class="p">(</span><span class="n">Unknown</span> <span class="n">Source</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">mybatis</span><span class="o">.</span><span class="n">spring</span><span class="o">.</span><span class="n">SqlSessionTemplate</span><span class="o">.</span><span class="n">selectList</span><span class="p">(</span><span class="n">SqlSessionTemplate</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">231</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">binding</span><span class="o">.</span><span class="n">MapperMethod</span><span class="o">.</span><span class="n">executeForMany</span><span class="p">(</span><span class="n">MapperMethod</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">128</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">binding</span><span class="o">.</span><span class="n">MapperMethod</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">MapperMethod</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">68</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">ibatis</span><span class="o">.</span><span class="n">binding</span><span class="o">.</span><span class="n">MapperProxy</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">MapperProxy</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">53</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">sun</span><span class="o">.</span><span class="n">proxy</span><span class="o">.$</span><span class="n">Proxy124</span><span class="o">.</span><span class="n">selectAll</span><span class="p">(</span><span class="n">Unknown</span> <span class="n">Source</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">fastfish</span><span class="o">.</span><span class="n">services</span><span class="o">.</span><span class="n">BusinessService</span><span class="o">.</span><span class="n">getAll</span><span class="p">(</span><span class="n">BusinessService</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">73</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">fastfish</span><span class="o">.</span><span class="n">services</span><span class="o">.</span><span class="n">BusinessService</span><span class="o">.</span><span class="n">loadDB</span><span class="p">(</span><span class="n">BusinessService</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">38</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">sun</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">GeneratedMethodAccessor190</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">Unknown</span> <span class="n">Source</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">sun</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">DelegatingMethodAccessorImpl</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">DelegatingMethodAccessorImpl</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">43</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">Method</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">Method</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">498</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">springframework</span><span class="o">.</span><span class="n">scheduling</span><span class="o">.</span><span class="n">support</span><span class="o">.</span><span class="n">ScheduledMethodRunnable</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">ScheduledMethodRunnable</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">65</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">org</span><span class="o">.</span><span class="n">springframework</span><span class="o">.</span><span class="n">scheduling</span><span class="o">.</span><span class="n">support</span><span class="o">.</span><span class="n">DelegatingErrorHandlingRunnable</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">DelegatingErrorHandlingRunnable</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">54</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">concurrent</span><span class="o">.</span><span class="n">Executors</span><span class="o">$</span><span class="n">RunnableAdapter</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">Executors</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">511</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">concurrent</span><span class="o">.</span><span class="n">FutureTask</span><span class="o">.</span><span class="n">runAndReset</span><span class="o">$$$</span><span class="n">capture</span><span class="p">(</span><span class="n">FutureTask</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">308</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">concurrent</span><span class="o">.</span><span class="n">FutureTask</span><span class="o">.</span><span class="n">runAndReset</span><span class="p">(</span><span class="n">FutureTask</span><span class="o">.</span><span class="n">java</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">concurrent</span><span class="o">.</span><span class="n">ScheduledThreadPoolExecutor</span><span class="o">$</span><span class="n">ScheduledFutureTask</span><span class="o">.</span><span class="n">access</span><span class="o">$</span><span class="mi">301</span><span class="p">(</span><span class="n">ScheduledThreadPoolExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">180</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">concurrent</span><span class="o">.</span><span class="n">ScheduledThreadPoolExecutor</span><span class="o">$</span><span class="n">ScheduledFutureTask</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">ScheduledThreadPoolExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">294</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">concurrent</span><span class="o">.</span><span class="n">ThreadPoolExecutor</span><span class="o">.</span><span class="n">runWorker</span><span class="p">(</span><span class="n">ThreadPoolExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">1149</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">concurrent</span><span class="o">.</span><span class="n">ThreadPoolExecutor</span><span class="o">$</span><span class="n">Worker</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">ThreadPoolExecutor</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">624</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">Thread</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="ne">Thread</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">748</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Caused</span> <span class="n">by</span><span class="p">:</span> <span class="n">java</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">EOFException</span><span class="p">:</span> <span class="n">Can</span> <span class="ow">not</span> <span class="n">read</span> <span class="n">response</span> <span class="n">from</span> <span class="n">server</span><span class="o">.</span> <span class="n">Expected</span> <span class="n">to</span> <span class="n">read</span> <span class="mi">4</span> <span class="n">bytes</span><span class="p">,</span> <span class="n">read</span> <span class="mi">0</span> <span class="n">bytes</span> <span class="n">before</span> <span class="n">connection</span> <span class="n">was</span> <span class="n">unexpectedly</span> <span class="n">lost</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">readFully</span><span class="p">(</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">3008</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="n">mysql</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">reuseAndReadPacket</span><span class="p">(</span><span class="n">MysqlIO</span><span class="o">.</span><span class="n">java</span><span class="p">:</span><span class="mi">3466</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span> <span class="mi">83</span> <span class="n">common</span> <span class="n">frames</span> <span class="n">omitted</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ˜¯æ•°æ®æ± è¿æ¥å‡ºé”™ã€‚ä½†æ˜¯æˆ‘æœ¬åœ°çš„åº”ç”¨ç¡®å®æ˜¯å¯ä»¥è®¿é—®æµ‹è¯•æ•°æ®åº“çš„ï¼Œ æ¯”è¾ƒæœ‰è¶£çš„å¼‚å¸¸å°±æ˜¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Caused by: java.io.EOFException: Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ•°æ®è¿˜æ²¡æœ‰è¯»å®Œï¼Œ Connection å°±ä¸¢äº†ã€‚ä¸ºä»€ä¹ˆä¼š lost connection å‘¢ï¼Œå¯èƒ½æ•°æ®åº“å‡ºé—®é¢˜ï¼Œä¹Ÿå¯èƒ½æ˜¯ç½‘ç»œå‡ºäº†é—®é¢˜ã€‚</p>
<p>æˆ‘è¿˜èƒ½ä»æ•°æ®åº“è¯»åˆ°æ•°æ®ï¼Œè¯´æ˜æ•°æ®åº“æ²¡é—®é¢˜çš„ï¼Œå…¼ä¹‹è¿™ä¸ªå¼‚å¸¸åªæ˜¯å¶å°”å‡ºç°ï¼Œæ‰€ä»¥å¯èƒ½å°±æ˜¯ç½‘ç»œå‡ºé—®é¢˜äº†ã€‚</p>
<p>å¦‚æ­¤è¯´æ¥ï¼Œæ˜¯å¦å¯èƒ½æ˜¯å› ä¸ºæµ‹è¯•ç¯å¢ƒç½‘ç»œä¸ç¨³å®šï¼Œè¿æ¥æ± æ— æ³•å’Œ Mysql ä¿æŒè¿æ¥ï¼Œåœ¨ä¸¢æ‰ Connection ä¹‹åï¼Œè¿æ¥æ± é‡æ–°å‘èµ·è¿æ¥ï¼Œä½†æ˜¯å› ä¸ºç½‘ç»œä¸ç¨³å®šåˆä¸¢æ‰äº†Connection, ä¸æ–­å¾ªç¯è¿™ä¸ªè¿‡ç¨‹ï¼Œå¯¼è‡´å»ºç«‹çš„ socket è¿æ¥è¶Š æ¥è¶Šå¤šï¼Œä½†æ˜¯å»ºç«‹çš„ socket å¾ˆå¿«å°±è¢«Close æ‰äº†ï¼Œå†…æ ¸åˆæ²¡æœ‰æŠŠè¿™äº› Close æ‰çš„ socket èµ„æºå›æ”¶æ‰ï¼Œå› æ­¤æ‰“å¼€çš„ socket æ–‡ä»¶è¶Šæ¥è¶Šå¤šï¼Œæœ€åå¯¼è‡´ Tomcat å› ä¸ºæ‰“å¼€çš„æ–‡ä»¶è¿‡å¤šæ— æ³•å»ºç«‹æ–°çš„ socket è¿æ¥ã€‚</p>
<h2 id="å°å¿ƒæ±‚è¯"><span class="section-num">6</span> å°å¿ƒæ±‚è¯</h2>
<p>å¦‚æœè¿æ¥æ± çœŸçš„ä¸æ–­å°è¯•è¿æ¥Mysql çš„è¯ï¼Œå¿…å®šä¼šå»ºç«‹å¾ˆå¤šçš„è¿æ¥ï¼Œè€ŒMysql æ˜¯ä¼šå°†è¿™äº›è®°å½•ä¿å­˜ä¸‹æ¥çš„ï¼Œæ£€æŸ¥Mysql çš„å˜é‡ï¼š</p>
<figure>
    <img loading="lazy" src="https://imgur.com/gAxepYH.png"/> 
</figure>

<p>æŸ¥çœ‹Mysql çš„æ–‡æ¡£å…³äº <code>Connection</code> å’Œ <code>Thread_connected</code> çš„è¯´æ˜ï¼š</p>
<ul>
<li>
<p>Connections</p>
<blockquote>
<p>The number of connection attempts (successful or not) to the MySQL server.</p>
</blockquote>
</li>
<li>
<p>Threads_connected</p>
<blockquote>
<p>The number of currently open connections.</p>
</blockquote>
</li>
</ul>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æ—¶å…±æœ‰20000 å¤šçš„è¿æ¥è¯·æ±‚ï¼Œä½†æ˜¯çœŸæ­£è¢« Mysql accpet å¹¶ä¸”æœåŠ¡çš„åªæœ‰ 28 ä¸ªè¿æ¥ã€‚çœ‹æ¥çš„ç¡®æ˜¯å› ä¸ºè¿æ¥æ± çš„è¿æ¥å¯¼è‡´ socket æ³„æ¼</p>
<h3 id="æ›´æ–°"><span class="section-num">6.1</span> æ›´æ–°</h3>
<p>å’Œè¿ç»´åŒå­¦æ²Ÿé€šä¹‹åï¼Œå‘ç°ä¸¢è¿æ¥çš„åŸå› ä¸æ˜¯ç½‘ç»œä¸ç¨³å®šï¼Œè€Œæ˜¯æµ‹è¯•é›†ç¾¤éƒ½æ˜¯è™šæ‹Ÿæœºï¼Œå†…å­˜ ç”¨å…‰ï¼Œå¯¼è‡´æ— æ³•å»ºç«‹æ–°çš„è¿æ¥ï¼Œå†…æ ¸é‡Šæ”¾ä¸€éƒ¨åˆ†èµ„æºä¹‹ååˆå¯ä»¥å»ºç«‹è¿æ¥äº†ã€‚å†…å­˜ç”¨å®Œï¼Œæˆ‘èƒ½æ€ä¹ˆåŠï¼Œæˆ‘ä¹Ÿå¾ˆæ— å¥ˆã€‚</p>
<h2 id="è§£å†³æ–¹æ³•"><span class="section-num">7</span> è§£å†³æ–¹æ³•</h2>
<p>è™½è¯´åŸºæœ¬ç¡®å®šäº† socket æ³„æ¼çš„æºå¤´ï¼Œä½†æ˜¯å¯¹äºå†…æ ¸ä¸ºä»€ä¹ˆæ— æ³•å›æ”¶å·²ç»å…³é—­ socket çš„åŸå› ä¾ç„¶ä¸æ˜ç¡®ã€‚</p>
<p>æœ€ä»¤äººç™¾æ€ä¸å¾—å…¶è§£çš„æ˜¯ï¼Œéƒ¨ç½²äº†åº”ç”¨çš„æµ‹è¯•æœåŠ¡å™¨æœ‰ä¸¤å°ï¼Œå¦å¤–ä¸€ å°æœåŠ¡å™¨ä¹Ÿæœ‰åŒæ ·çš„è¿æ¥æ± é—®é¢˜ï¼Œä½†æ˜¯å´æ²¡æœ‰å‡ºç° socket æ³„æ¼é—®é¢˜ï¼Œ å‡ºç°æ³„æ¼çš„åªæœ‰ 87 è¿™å°æœºå™¨ã€‚çœŸçš„ä»¤äººè´¹è§£. æ‰€ä»¥æœ€åè§£å†³æ–¹æ³•å°±æ˜¯æ’¤ä¸‹ 87 æœåŠ¡å™¨çš„åº”ç”¨ï¼Œæ¢ä¸€å°æœåŠ¡å™¨æ¥éƒ¨ç½²ã€‚</p>
<p>æ–°çš„æœåŠ¡å™¨éƒ¨ç½²åº”ç”¨ä¹‹åè™½è¯´ä¹Ÿæœ‰åŒæ ·çš„æ•°æ®åº“è¿æ¥æ± å¼‚å¸¸ï¼Œä½†æ˜¯å´æ²¡æœ‰å‡ºç° socket æ³„æ¼ï¼Œåˆæ­¥å®šä½æ˜¯ 87è¿™å°æœºå™¨çš„å†…æ ¸ç¯å¢ƒå­˜åœ¨é—®é¢˜ã€‚</p>
<h2 id="å‚è€ƒ"><span class="section-num">8</span> å‚è€ƒ</h2>
<ul>
<li><a href="http://mdba.cn/2015/03/10/tcp-socket%E6%96%87%E4%BB%B6%E5%8F%A5%E6%9F%84%E6%B3%84%E6%BC%8F/">tcp-socketæ–‡ä»¶å¥æŸ„æ³„æ¼/</a></li>
<li><a href="https://idea.popcount.org/2012-12-09-lsof-cant-identify-protocol/">lsof-cant-identify-protocol/</a></li>
</ul>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
]]></content:encoded>
    </item>
    <item>
      <title>å¤§è¯Linuxæ–‡ä»¶ç³»ç»Ÿ</title>
      <link>https://ramsayleung.github.io/zh/post/2017/linux_file_system/</link>
      <pubDate>Thu, 30 Mar 2017 00:00:00 +0800</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2017/linux_file_system/</guid>
      <description>an discussion about linux file system</description>
      <content:encoded><![CDATA[<p>ä¸ä¹…å‰ï¼ŒApple çš„æ–‡ä»¶ç³»ç»Ÿ (Apple File System) æ–°æ¨å‡ºï¼Œç„¶åå„æ–¹ä¾¿ä¸€èµ·æŒ¤èº«å‘å‰å¯¹APFS &ldquo;è¯„å¤´å“è¶³&rdquo;,æˆ‘æ˜¯ä¸äº†è§£ APFS ,æ‰€ä»¥ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå‘è¨€æƒå˜›ï¼Œä¸è¿‡è¯åˆ†ä¸¤å¤´ï¼›</p>
<p>å¯¹Linuxçš„æ–‡ä»¶ç³»ç»Ÿï¼Œæˆ‘è¿˜æ˜¯æœ‰äº†è§£è¿‡çš„ï¼Œæ‰€ä»¥å¯ä»¥èŠèŠLinux çš„æ–‡ä»¶ç³»ç»Ÿï¼›ä¸Windows å’ŒApple ä¸¤å®¶å•†ä¸šå…¬å¸ä¸åŒï¼ŒLinux æ˜¯å¼€æºçš„ï¼Œå› æ­¤ï¼Œåªè¦ä½ æœ‰è¶³å¤Ÿçš„æ—¶é—´å’Œèƒ½åŠ›ï¼Œä½ å°±å¯ä»¥è‡ªå·±å†™ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œè¿™ä¸ªä¹Ÿæ˜¯Linux æ–‡ä»¶ç³»ç»Ÿä¼—å¤šçš„ä¸»è¦åŸå› ã€‚</p>
<p>é‚£ä¹ˆæœ‰ä¼—å¤šçš„Linux æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒä»¬çš„å·®å¼‚,ä¼˜ç¼ºç‚¹åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<h2 id="file-system"><span class="section-num">1</span> File System</h2>
<p>åœ¨å¼€å§‹ &ldquo;å¤§è¯&rdquo; å„ç§æ–‡ä»¶ç³»ç»Ÿçš„æ—¶å€™ï¼Œæˆ‘å…ˆæƒ³è°ˆè°ˆä»€ä¹ˆæ˜¯æ–‡ä»¶ç³»ç»Ÿã€‚</p>
<p>ä¸€èˆ¬ç”¨æˆ·å¹³æ—¶éƒ½ä¼šæœ‰ä¸Šç™¾G çš„æ•°æ®ï¼Œé‚£ä¹ˆå¤šçš„æ•°æ®ï¼Œåº”è¯¥æ€ä¹ˆä¿å­˜å‘¢ï¼Ÿ</p>
<p>ä¸çŸ¥é“æ€ä¹ˆå›ç­”ï¼Œå¯ä»¥å…ˆç±»æ¯”ä¸€ä¸‹ï¼Œæƒ³è±¡ä¸€ä¸‹ä½ æœ‰å¾ˆå¤šä¹¦ï¼Œä½ ä¼šæ€ä¹ˆæ”¾ç½®ä½ çš„ä¹¦ç±å‘¢ï¼Ÿç›´æ¥ä¸¢åœ¨å®¢å…ä¸­é—´ï¼Ÿæˆ–è€…æ˜¯æŒ‰ä¹¦å†…å®¹åˆ†ç±» æ”¾åˆ°ä¹¦æ¶ä¸Šï¼Ÿå¦‚æœåˆ†ç±»çš„è¯ï¼Œæ˜¯æŒ‰æ€ä¹ˆåˆ’åˆ†å‘¢ï¼Ÿä½ ä¹°å›æ¥çš„ä¹¦æ¶ä¸€æ¬¡å¯ä»¥æ”¾ç½®å¤šå°‘ä¹¦ç±å‘¢ï¼Ÿæ€ä¹ˆæ‰èƒ½æ›´å¿«åœ°æ‰¾åˆ°ä½ è¦æ‰¾çš„ä¹¦å‘¢ï¼Ÿ</p>
<p>å…¶å®æ–‡ä»¶ç³»ç»Ÿå¤„ç†ï¼Œæ£€ç´¢æ–‡ä»¶å’Œä½ æ”¾ç½®ï¼ŒæŸ¥æ‰¾ä¹¦ç±æ˜¯ç±»ä¼¼çš„ï¼æ­¤å¤–,åœ¨Windows ä¸‹å¸¸è§åˆ°çš„æ ¼å¼åŒ–ï¼Œå…¶å®å°±æ˜¯åœ¨ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿä¹‹é—´åˆ‡æ¢ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆæ•°æ®ä¼šä¸¢å¤±å‘¢ï¼Ÿ</p>
<p>ä½ å¯ä»¥ç±»æ¯”æˆä½ å®¶é‡Œè£…ä¿®ï¼Œæƒ³æ¢æ–°çš„ä¹¦æ¶ï¼Œä½†æ˜¯å¦‚æœä¸æŠŠåŸæ¥ä¹¦æ¶ä¸Šçš„ä¹¦ç±æ¬å‡ºå‡†å¤‡è£…ä¿®çš„å±‹å­ï¼Œè£…ä¿®æ—¶è‚¯å®šä¼šæŸåä¹¦ç±å˜›ï¼</p>
<h2 id="journaling"><span class="section-num">2</span> Journaling</h2>
<p>åœ¨æ¯”è¾ƒæ–‡ä»¶ç³»ç»Ÿä¹‹å‰ï¼Œå…ˆèŠèŠæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ—¥å¿— (Journaling), è€Œæœ‰äº›æ–‡ä»¶ç³»ç»Ÿæ˜¯æœ‰æ—¥å¿—åŠŸèƒ½çš„ï¼Œè€Œæœ‰äº›æ˜¯æ²¡æœ‰æ—¥å¿—åŠŸèƒ½çš„ï¼›</p>
<p>ä¸ºäº†äº†è§£å®ƒä»¬ä¹‹é—´çš„å·®å¼‚ï¼Œå°±éœ€è¦å…ˆäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯æ—¥å¿—ã€‚æ—¥å¿—çš„å‡ºç°æœ¬è´¨è€Œè¨€éƒ½æ˜¯ä¸ºäº†æ›´å¥½åœ°ä¿å­˜æ•°æ®ã€‚</p>
<p>å‡è®¾ä½ æ­£åœ¨å‘ç£ç›˜é‡Œå†™å…¥æ–‡ä»¶ï¼Œçªç„¶é—´æ–­ç”µäº†ï¼Œä½†æ˜¯ä½ çš„æ–‡ä»¶æ˜¯æ²¡æœ‰å®Œæˆå†™å…¥ç£ç›˜çš„ï¼Œè€Œä½ çš„ç”µè„‘æ˜¯ä¸çŸ¥é“æ˜¯å¦å·²ç»å®Œæˆå†™å…¥ï¼Œæ‰€ä»¥ä¸‹æ¬¡é‡æ–°æ¥ç”µå¯åŠ¨ç”µè„‘çš„æ—¶å€™ï¼Œæ˜¯æ²¡æœ‰â€œäººâ€å‘ŠçŸ¥ç”µè„‘æ˜¯å¦è¦é‡æ–°å†™æ•°æ®çš„ï¼Ÿè¿™æ ·æ•°æ®å°±ä¸¢å¤±äº†ã€‚</p>
<p>èƒ½ä¸èƒ½åœ¨æ–‡ä»¶è¿˜æ²¡æœ‰å®Œæˆå†™å›ç£ç›˜åˆä¸­é€”å‡ºç°é”™è¯¯çš„æ—¶å€™ï¼Œå‘Šè¯‰ç³»ç»Ÿä½ çš„ ç›®æ ‡æ–‡ä»¶è¿˜æœ‰æ•°æ®æ²¡æœ‰å†™å›ç£ç›˜ï¼Œä½ è¦è®°å¾—å®Œæˆè¿™é¡¹å·¥ä½œé˜¿ï¼Ÿ</p>
<p>å½“ç„¶å¯ä»¥ï¼Œè¿™å°±æ˜¯æ–‡ä»¶ç³»ç»Ÿä¸­æ—¥å¿—çš„åŠŸèƒ½ï¼Œåœ¨æ—¥å¿—çš„ååŠ©ä¸‹ï¼Œä½ çš„ç”µè„‘ä¼šåœ¨æ—¥å¿—ä¸­è®°ç€ï¼Œâ€œæˆ‘è¦æŠŠæŸæŸæ–‡ä»¶å†™å…¥åˆ°ç£ç›˜â€ï¼Œå¦‚æœé¡ºåˆ©å®Œæˆå†™å…¥ç£ç›˜å·¥ä½œï¼Œæ—¥å¿—çš„è¿™é¡¹è®°å½•å°±ä¼šè¢«åˆ é™¤ï¼Œå¦‚æœä¸­é€”å‡ºç°å¼‚å¸¸ï¼Œä¾‹ å¦‚æ–­ç”µäº†ï¼Œé‡æ–°å¯åŠ¨çš„æ—¶å€™ï¼Œä½ çš„ç³»ç»Ÿå°±ä¼šå‘ç°ï¼Œæˆ‘è¦å†™å…¥æŸæŸæ–‡ä»¶çš„å·¥ä½œè¿˜æ²¡å®Œæˆï¼Œå®ƒå°±ä¼šç»§ç»­æœªäº†çš„äº‹ä¸šï¼Œè¿™æ ·å°±å¯ä»¥ä¿éšœæ•°æ®ä¸ä¼šä¸¢å¤±ã€‚</p>
<p>(è€Œä½ æ—¥å¸¸å·¥ä½œç”Ÿæ´»ä¸­ï¼Œæ•°æ®çš„ä¸¢å¤±æ˜¯å› ä¸ºä½ æ²¡æœ‰ä¿å­˜æ•°æ®ï¼Œå³æ²¡æœ‰æŠŠæ•°æ®å†™å…¥åˆ°ç£ç›˜). å¦‚å›¾ï¼š</p>
<figure>
    <img loading="lazy" src="https://www.howtogeek.com/wp-content/uploads/2017/02/img_58af43716360e.png%20"/> 
</figure>

<p>å› ä¸ºå†™å…¥æ—¥å¿—éœ€è¦é¢å¤–çš„å·¥ä½œï¼Œæ‰€ä»¥éœ€è¦é¢å¤–çš„èµ„æºï¼Œä½†æ˜¯è¿™æ ·çš„æ¶ˆè€—æ˜¯ç›¸å½“å€¼å¾—åœ°ã€‚</p>
<h2 id="comparison"><span class="section-num">3</span> Comparison</h2>
<p>ä¸‹é¢å¯¹æ¯”ä¸€ä¸‹ å„ç§æ–‡ä»¶ç³»ç»Ÿçš„ç‰¹æ€§</p>
<figure>
    <img loading="lazy" src="/ox-hugo/comparison_file_system.png"
         alt="Figure 1: å›¾æ¥è‡ªarchwiki"/> <figcaption>
            <p><span class="figure-number">Figure 1: </span>å›¾æ¥è‡ªarchwiki</p>
        </figcaption>
</figure>

<p>å¦‚æœä½ æƒ³äº†è§£ä½ çš„Linux å†…æ ¸æ‰€æ”¯æŒçš„æ–‡ä»¶ç³»ç»Ÿï¼Œä½ å¯ä»¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">cat /proc/filesystems
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç°åœ¨å°±æ¥æ¯”è¾ƒä¸€ä¸‹å„ç§å¸¸è§çš„Linuxæ–‡ä»¶ç³»ç»Ÿ</p>
<h3 id="ext"><span class="section-num">3.1</span> Ext</h3>
<p>Ext æ˜¯æŒ‡&quot;Extended file system(æ‰©å±•æ–‡ä»¶ç³»ç»Ÿ)&quot;,åº”è¯¥ç®—æ˜¯Linux æ–‡ä»¶ç³»ç»Ÿé‡Œé¢çš„è€å¤§çˆ·äº†ï¼Œå®ƒæ˜¯ä»ç»å…¸çš„ Minix çš„æ–‡ä»¶ç³»ç»Ÿè¡ç”Ÿè¿‡æ¥çš„ï¼Œä¸ºLinux ä¸“é—¨è®¾è®¡çš„ï¼Œä½†æ˜¯å®ƒç¼ºä¹å¾ˆå¤šé‡è¦çš„ç‰¹æ€§ï¼Œæ¯”å¦‚ä¸Šé¢æåˆ°çš„æ—¥å¿—åŠŸèƒ½ï¼Œæ‰€ä»¥å¤§éƒ¨ä»½çš„Linux å‘è¡Œç‰ˆæœ¬éƒ½æ˜¯ä¸æ”¯æŒ Ext äº†</p>
<h3 id="ext2"><span class="section-num">3.2</span> Ext2</h3>
<p>Ext2 ä¹Ÿæ˜¯ä¸æ”¯æŒæ—¥å¿—çš„ï¼Œä½†æ˜¯å®ƒæ˜¯ç¬¬ä¸€ä¸ªæ”¯æŒæ‰©å±•æ–‡ä»¶å±æ€§å’Œ2T å®¹é‡çš„Linux æ–‡ä»¶ç³»ç»Ÿï¼Œä½†æ˜¯æ­£ç”±äºExt2 ä¸æ”¯æŒæ—¥å¿—åŠŸèƒ½ï¼Œå®ƒå¯ä»¥æ›´å°‘åœ°å†™ç£ç›˜ï¼Œæ‰€ä»¥å®ƒé€‚åˆåƒUSB è¿™ç§é—ªå­˜ï¼Œä½†æ˜¯Ext2 æ— æ³•è¢«Windows è¯†åˆ«çš„ï¼Œæ‰€ä»¥å®ƒçš„é—ªå­˜åŠŸèƒ½æ›´å¤šåœ°è¢«FAT32å’ŒexFATæ‰€ä»£æ›¿ï¼Œæ¢è¨€ä¹‹ï¼ŒExt2 ç”¨çš„ä¹Ÿä¸å¤š</p>
<h3 id="ext3"><span class="section-num">3.3</span> Ext3</h3>
<p>Ext3 å°±æ˜¯Ext2 å¸¦æœ‰æ—¥å¿—åŠŸèƒ½çš„æ‰©å±•ï¼Œå¹¶ä¸”Ext3 ä¹Ÿå‘åå…¼å®¹Ext2,æ‰€ä»¥ä½ åœ¨Ext2 å’ŒExt3 ä¹‹é—´åˆ‡æ¢ä¹Ÿæ˜¯ä¸éœ€è¦é‡æ–°æ ¼å¼åŒ–æ»´ï¼Œä½†æ˜¯æœ€å¸¸ç”¨çš„è¿˜ä¸æ˜¯Ext3,è€Œæ˜¯Ext4 :)</p>
<h3 id="ext4"><span class="section-num">3.4</span> Ext4</h3>
<p>Ext4 ä¹Ÿæ˜¯å‘åå…¼å®¹ Ext3 å’ŒExt2 çš„ï¼Œæ‰€ä»¥ä½ æ˜¯å¯ä»¥åœ¨Ext4,Ext3,Ext2 ä¹‹é—´åˆ‡æ¢è€Œæ— éœ€æ ¼å¼åŒ–æ–‡ä»¶ç³»ç»Ÿã€‚</p>
<p>Ext4 åŒ…å«å¾ˆå¤šæ–°çš„ç‰¹æ€§ï¼Œä¾‹å¦‚æ”¯æŒå­˜å‚¨æ›´å¤§çš„æ–‡ä»¶ï¼Œæ”¯æŒå»¶è¿Ÿåˆ†é…ä»¥ æ”¹è¿›å¯¹é—ªå­˜çš„æ”¯æŒï¼Œè¿˜èƒ½æœ‰æ•ˆåœ°å‡å°‘æ–‡ä»¶çš„ç¢ç‰‡åŒ–ï¼Œæé«˜åˆ©ç”¨æ•ˆç‡ã€‚</p>
<p>æ˜¾è€Œæ˜“è§ï¼ŒExt4 æ˜¯æœ€å…ˆè¿›çš„ Ext ç³»åˆ—çš„æ–‡ä»¶ç³»ç»Ÿï¼Œä¹Ÿæ˜¯å¤§éƒ¨åˆ†Linux å‘è¡Œç‰ˆæœ¬çš„é»˜è®¤æ–‡ä»¶ç³»ç»Ÿ</p>
<h3 id="zfs"><span class="section-num">3.5</span> ZFS</h3>
<p>ZFS æœ€åˆæ˜¯ç»™Sun çš„Solaris è®¾è®¡çš„ï¼ŒSun è¢«æ”¶è´­åï¼Œç°åœ¨æ˜¯å±äºOracle çš„ï¼ŒZFS æ”¯æŒ å¤§é‡éå¸¸å…ˆè¿›çš„ç‰¹æ€§ï¼Œæ¯”å¦‚è¯´ å¿«ç…§ (snapshot),åŠ¨æ€å­˜å‚¨ (dynamic disk striping), é©±åŠ¨æ± ç­‰ (drive pool);</p>
<p>æ­¤å¤–ZFS æ–‡ä»¶çš„æ¯ä¸ªæ–‡ä»¶éƒ½æ˜¯æœ‰æ ¡éªŒå’Œçš„ï¼Œæ‰€ä»¥é€šè¿‡æ£€æŸ¥æ ¡éªŒå’Œï¼Œå°±èƒ½ç¡®å®šæ–‡ä»¶çš„å®Œæ•´æ€§ã€‚ä½†æ˜¯ï¼Œè™½è¯´ZFS éå¸¸å¼ºå¤§ï¼Œå´å› ä¸ºZFS license çš„ç¼˜æ•…ï¼Œ ZFS æ— æ³•æ·»åŠ åˆ° Linux å†…æ ¸çš„ã€‚å¦‚æœä½ éå¸¸æƒ³è¦å°è¯•ZFS çš„è¯ï¼Œä½ å¯ä»¥è‡ªè¡Œæ·»åŠ å¯¹Linux å‘è¡Œç‰ˆæœ¬ä¸Šé¢æ·»åŠ ZFS çš„æ”¯æŒ</p>
<h3 id="brtfs"><span class="section-num">3.6</span> BrtFS</h3>
<p>Brtfs æ˜¯ç”±Oracle è®¾è®¡çš„ä¸€ä¸ªæ”¯æŒå†™æ—¶å¤åˆ¶ (copy on write) çš„ç°ä»£æ–‡ä»¶ç³»ç»Ÿ;</p>
<p>è€ŒBtrfs çš„æ„æ€æ˜¯ B æ ‘æ–‡ä»¶ç³»ç»Ÿ (B-Tree File System),å®ƒæ”¯æŒå¤§é‡éå¸¸å…ˆè¿›çš„ç‰¹æ€§ï¼Œä¾‹å¦‚ åŠ¨æ€inode åˆ†é…ï¼Œæ•°æ®æ ¡éªŒå’Œï¼Œæœ‰æ•ˆçš„å¢é‡å¤‡ä»½ï¼Œé©±åŠ¨æ± ï¼Œæœ€å¤§æ”¯æŒ 2^64 byte å®¹é‡å³16 Eib å¤§çš„æ–‡ä»¶ã€‚</p>
<p>BtrFS æ˜¯è¢«è®¾è®¡æˆå–ä»£Ext ç³»åˆ—çš„æ–‡ä»¶ç³»ç»Ÿçš„ï¼Œåªä¸è¿‡å› ä¸ºç°åœ¨çš„BtrFS è¿˜æ²¡æœ‰è¶³å¤Ÿæˆç†Ÿï¼Œæ‰€ä»¥è¿˜æ²¡æœ‰å¤§å…¬å¸åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ BtrFS,ä½†æ˜¯BtrFS çš„æœªæ¥å¯æœŸ</p>
<h3 id="jfs"><span class="section-num">3.7</span> JFS</h3>
<p>JFS æ˜¯IBM ä¸ºIBM è‡ªå®¶çš„AIX æ“ä½œç³»ç»Ÿè®¾è®¡çš„æ—¥å¿—æ–‡ä»¶ç³»ç»Ÿ (Journaled File System), åæ¥è¿ç§»åˆ°äº†Linux ç³»ç»Ÿä¸Š (HP-UX ä¹Ÿæœ‰ä¸€ä¸ªå«åšJFS çš„æ–‡ä»¶ç³»ç»Ÿ).</p>
<p>åœ¨AIX ç³»ç»Ÿä¸Šæ˜¯å­˜åœ¨è¿‡ä¸¤ä»£çš„JFSæ–‡ä»¶ç³»ç»Ÿçš„ï¼Œåˆ†åˆ«æ˜¯ JFS1å’ŒJFS2,è€ŒLinux ä¸Šå°±åªæœ‰JFS2äº†(Linux ä¸Šçš„JFSéƒ½æ˜¯æŒ‡JFS2)ã€‚</p>
<p>JFS æ— è®ºåœ¨å¤„ç†å¤§æ–‡ä»¶è¿˜æ˜¯å°æ–‡ä»¶éƒ½æœ‰éå¸¸ä¸é”™çš„è¡¨ç°ï¼Œå¹¶ä¸”CPU å ç”¨ä¹Ÿæ˜¯æ¯”è¾ƒä½çš„ï¼›JFS ä¹Ÿæ˜¯æ”¯æŒéå¸¸å¤šçš„ç‰¹æ€§çš„ï¼Œä¾‹å¦‚ B+ æ ‘ï¼ŒåŠ¨æ€Inode åˆ†é…ï¼Œå¹¶å‘IOç­‰ã€‚</p>
<p>JFS ä¹Ÿæ˜¯ä¸€ä¸ªè®¾è®¡ä¼˜ç§€çš„æ–‡ä»¶ç³»ç»Ÿå¹¶ä¸”æ”¯æŒå¤§éƒ¨åˆ†çš„Linux å‘è¡Œç‰ˆæœ¬ï¼Œä½†æ˜¯å› ä¸ºå®ƒæœ€åˆæ˜¯ä¸ºAIX è®¾è®¡ï¼Œæ‰€ä»¥åœ¨å¤„äºç”Ÿäº§ç¯å¢ƒä¸Šçš„LinuxæœåŠ¡å™¨çš„æµ‹è¯•å°±ä¸å¦‚Ext :(.</p>
<h3 id="reiserfs"><span class="section-num">3.8</span> ReiserFS</h3>
<p>ReiserFs æ˜¯ç¬¬ä¸€ä¸ªè¢«å¼•è¿›Linux æ ‡å‡†å†…æ ¸çš„æ—¥å¿—æ–‡ä»¶ç³»ç»Ÿ(åœ¨å†…æ ¸ç‰ˆæœ¬ä¸º2.4.1çš„æ—¶å€™å¼•è¿›),ä¹Ÿæ˜¯Linux æ–‡ä»¶ç³»ç»Ÿçš„ä¸€æ¬¡é£è·ƒï¼Œé‚£æ—¶çš„ReiserFS åŒ…å«äº†å¾ˆå¤šExt æ²¡æœ‰çš„æ–°ç‰¹æ€§ã€‚</p>
<p>è™½è¯´ ReiserFS åœ¨Linux æœ‰ä¸€ä¸ªéå¸¸åä¸½çš„å¼€å¤´ï¼Œä½†æ˜¯åæ¥ReiserFS çš„å¼€å‘å°±é™·å…¥äº†åœæ»ï¼Œå› ä¸ºReiserFS çš„æ ¸å¿ƒå¼€å‘è€…Hans Reiser(ReiserFS åå­—çš„æ¥ç”±)å› ä¸ºè°‹æ€å¦»å­è€Œè¢«æ”¶ç›‘ :(ã€‚</p>
<p>è€Œåæ¥çš„ReiserFS ä¹Ÿæ²¡æœ‰å‡ºç°åœ¨ä¸»è¦çš„Linux å†…æ ¸ç‰ˆæœ¬é‡Œé¢ï¼Œè™½è¯´ReiserFSæ˜¯éå¸¸å¥½çš„æ–‡ä»¶ç³»ç»Ÿï¼Œä½†æ˜¯å®ƒå‰æ™¯å¦‚ä½•ï¼Œæˆ‘ä»¬ä¹Ÿåªèƒ½æ‹­ç›®ä»¥å¾…äº†</p>
<h3 id="xfs"><span class="section-num">3.9</span> XFS</h3>
<p>XFS æœ€åˆæ˜¯Silicon Graphics ä¸ºSGI IRX æ“ä½œç³»ç»Ÿè®¾è®¡çš„64ä½é«˜æ€§èƒ½æ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨2001 å¹´è¿ç§»åˆ°äº†Linux.</p>
<p>å¾—ç›ŠäºXFS åŸºäº allocation groups çš„è®¾è®¡ï¼ŒXFS æ‹¥æœ‰éå¸¸ä¼˜ç§€çš„å¹¶è¡ŒIO èƒ½åŠ›ï¼Œå¹¶æ”¯æŒå»¶è¿Ÿåˆ†é… (delayed allocation) ä»¥æ”¹è¿›æ–‡ä»¶ç¢ç‰‡åŒ–ï¼Œåœ¨æŸç§ç¨‹åº¦ä¸Šï¼ŒXFS å’ŒExt æœ‰ä¸€å®šçš„ç›¸ä¼¼ï¼›</p>
<p>æ­¤å¤–ï¼Œè™½è¯´XFS æ˜¯é«˜æ€§èƒ½çš„æ–‡ä»¶ç³»ç»Ÿï¼Œä½†æ˜¯é‚£åªæ˜¯é’ˆå¯¹å¤§æ–‡ä»¶è€Œè¨€çš„ï¼Œå¯¹äºå°æ–‡ä»¶XFS å°±æœ‰ç‚¹åŠ›æ‰€ä¸èƒ½åŠ (å½“ç„¶ï¼Œè¿™æ˜¯ç›¸å¯¹è€Œè¨€).</p>
<p>æ‰€ä»¥å¦‚æœæ˜¯éœ€è¦ ç»å¸¸å¤„ç†å¤§æ–‡ä»¶çš„æœåŠ¡å™¨ï¼ŒXFS ä¼šæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©</p>
<h2 id="å°ç»“"><span class="section-num">4</span> å°ç»“</h2>
<p>å¦‚æœå°†Linux çš„æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œåˆ†ç±»çš„è¯ï¼Œè¿˜å¯ä»¥åˆ†æˆ FUSE (Filesystem in Userspace,
è®©ç”¨æˆ·åœ¨æ²¡æœ‰æƒé™çš„æƒ…å†µä¸‹ï¼Œåˆ›å»ºè‡ªå·±çš„æ–‡ä»¶ç³»ç»Ÿ), Stackable file System (å…ˆè¿›çš„å¤šå±‚æ¬¡ç»Ÿä¸€æ–‡ä»¶ç³»ç»Ÿ), Read-only file systems (åªè¯»æ–‡ä»¶ç³»ç»Ÿ), Clustered file systems
(é›†ç¾¤æ–‡ä»¶ç³»ç»Ÿ)ç­‰ç­‰ã€‚</p>
<p>Linux çš„æ–‡ä»¶ç³»ç»Ÿè¿˜æœ‰å¾ˆå¤šï¼Œæ¯ä¸€ç§éƒ½æœ‰è‡ªå·±çš„ç‰¹ç‚¹ï¼›ä½†æ˜¯å¦‚æœä½ æƒ³é—®ï¼š&ldquo;Linux æœ€å¥½çš„æ–‡ä»¶ç³»ç»Ÿæ˜¯ä»€ä¹ˆï¼Ÿ&quot;;è¿™ä¸ªé—®é¢˜å°±è·Ÿ &ldquo;æœ€å¥½çš„Linux å‘è¡Œç‰ˆæœ¬æ˜¯ä»€ä¹ˆï¼Ÿ&rdquo;, &ldquo;æœ€å¥½çš„æ–‡æœ¬ç¼–è¾‘å™¨æ˜¯ä»€ä¹ˆï¼Ÿ&rdquo; ä¸€æ ·ï¼Œæ˜¯æ²¡æœ‰æ ‡å‡†ç­”æ¡ˆï¼Œä¸€åƒä¸ªäººéƒ½æœ‰ä¸€åƒä¸ªå“ˆå§†é›·ç‰¹äº†ï¼Œä½ çš„å“ˆå§†é›·ç‰¹æ˜¯ä»€ä¹ˆæ ·å­ï¼Œåªæœ‰ä½ è‡ªå·±æ¸…æ¥šã€‚</p>
<p>ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿå¯¹åº”ä¸åŒçš„åœºæ™¯ï¼Œåªæœ‰é’ˆå¯¹ç‰¹å®šåœºæ™¯çš„æœ€ä¼˜è§£å†³æ–¹æ¡ˆï¼å¦‚æœè¿˜ä¸çŸ¥é“æ€ä¹ˆé€‰æ‹©ï¼Œé‚£å°±é€‰æ‹©Ext4 å§ï¼Œæ— æ³•åšå‡ºé€‰ æ‹©æ—¶ï¼Œé»˜è®¤çš„å°±æ˜¯æœ€å¥½ :)</p>
<h2 id="å‚è€ƒ"><span class="section-num">5</span> å‚è€ƒ</h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/File_system">https://en.wikipedia.org/wiki/File_system</a></li>
<li><a href="https://btrfs.wiki.kernel.org/index.php/Main_Page">https://btrfs.wiki.kernel.org/index.php/Main_Page</a></li>
<li><a href="https://en.wikipedia.org/wiki/JFS_(file_system)">https://en.wikipedia.org/wiki/JFS_(file_system)</a></li>
<li><a href="https://en.wikipedia.org/wiki/ReiserFS">https://en.wikipedia.org/wiki/ReiserFS</a></li>
<li><a href="https://www.howtogeek.com/howto/33552/htg-explains-which-linux-file-system-should-you-choose/">https://www.howtogeek.com/howto/33552/htg-explains-which-linux-file-system-should-you-choose/</a></li>
<li><a href="https://en.wikipedia.org/wiki/ZFS">https://en.wikipedia.org/wiki/ZFS</a></li>
<li><a href="https://en.wikipedia.org/wiki/XFS">https://en.wikipedia.org/wiki/XFS</a></li>
<li><a href="https://wiki.archlinux.org/index.php/file_systems">https://wiki.archlinux.org/index.php/file_systems</a></li>
</ul>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
]]></content:encoded>
    </item>
    <item>
      <title>æ¯æ ‘é€¢æ˜¥ä¹‹ArchLinuxé¢†é£éªš</title>
      <link>https://ramsayleung.github.io/zh/post/2017/install_archlinux/</link>
      <pubDate>Mon, 27 Feb 2017 00:00:00 +0800</pubDate>
      <guid>https://ramsayleung.github.io/zh/post/2017/install_archlinux/</guid>
      <description>An description about how to install arch linux in an old machine</description>
      <content:encoded><![CDATA[<h2 id="æ¯æ ‘"><span class="section-num">1</span> æ¯æ ‘</h2>
<p>å‘¨æœ«å›äº†ä¸€è¶Ÿå®¶ï¼Œæ²¡å¸¦è‡ªå·±çš„ç¬”è®°æœ¬ï¼Œåœ¨å®¶é—²æ¥æ— äº‹ï¼Œæ— æ„ä¸­çœ‹åˆ°å¢™è§’çš„ç”µè„‘ï¼Œå·²ç»å°˜å°å·²ä¹…åæ­£æ— äº‹ï¼Œä½•ä¸ç©ç©è¿™å°è€å¤è‘£å‘¢ï¼Ÿäºæ˜¯æŠŠç”µè„‘æ‹¿å»ä¿®ç†åº—æŠŠåäº†çš„ç¡¬ä»¶ä¿®å¥½ã€‚</p>
<p>ç¦»å¼€åº—çš„æ—¶å€™ï¼Œè€æ¿è¯´ï¼šâ€œä½ çš„ç³»ç»Ÿæœ‰é—®é¢˜ï¼Œæˆ‘çœ‹åˆ°ä½ è‡ªå·±ä¹Ÿæœ‰Ghost,å°±ä¸å¸®æè¿™ç³»ç»Ÿäº†ï¼Œ ä½ è‡ªå·±éƒ½èƒ½è§£å†³çš„ï¼Œæ¨èä½ è¿˜æ˜¯ç”¨XPå§ï¼Œè¿™ç”µè„‘é…ç½®ä½ï¼Œè¿˜æ˜¯XPå¥½ç”¨â€ã€‚æˆ‘å¿ä¸ä½å›å¤´å¯¹è€æ¿ä¸€ç¬‘ :)</p>
<h2 id="æ˜¥è‡³"><span class="section-num">2</span> æ˜¥è‡³</h2>
<p>åƒæˆ‘è¿™ç§Linuxer,è¿™ä¹ˆå¯èƒ½å†è£…å›XPå‘¢ï¼Œæœ€åˆè£…Win7,ä¹Ÿæ˜¯è€ƒè™‘åˆ°è€çˆ¹çš„æŠ€æœ¯ hold ä¸ä½ Linux, ç°åœ¨æ‰‹æœºé‚£ä¹ˆå‘è¾¾ï¼Œä»–å°±ä¸éœ€è¦ç”µè„‘äº†ï¼Œæ‰€ä»¥ï¼Œæ­¤æ—¶ä¸è£…Linux,æ›´å¾…ä½•æ—¶å‘¢ï¼Ÿ</p>
<h2 id="arch-linux"><span class="section-num">3</span> Arch Linux</h2>
<p>æˆ‘æ²¡æœ‰é€‰æ‹© Xubuntu è¿™ç§é€‚åˆè€æœºå™¨çš„ Ubuntu è¡ç”Ÿå‘è¡Œç‰ˆæœ¬ï¼Œå› ä¸ºæˆ‘ä¸å–œæ¬¢Ubuntu, æ‰€ä»¥æˆ‘æœ€åé€‰æ‹©çš„æ˜¯ Arch linux,å®˜ç½‘è¯´æœ€ä½é…ç½®åªéœ€500MBå†…å­˜ï¼Œ800MBçš„ ç¡¬ç›˜å­˜å‚¨ç©ºé—´ï¼Œæ­£é€‚åˆå®¶é‡Œçš„è€å®¶ä¼™</p>
<h3 id="å®‰è£…è¿‡ç¨‹"><span class="section-num">3.1</span> å®‰è£…è¿‡ç¨‹</h3>
<h4 id="ä¸‹è½½é•œåƒ"><span class="section-num">3.1.1</span> ä¸‹è½½é•œåƒ</h4>
<p><a href="https://www.archlinux.org/download/">Download Link</a> ,åœ¨ç½‘æ˜“çš„é•œåƒä¸‹è½½ISO, ç„¶åç”¨ddåˆ»å½•åˆ°Uç›˜ï¼ŒWindows å¯ä»¥é€‰æ‹© <a href="http://sourceforge.net/projects/usbwriter">USBwriter</a></p>
<h4 id="åˆ†åŒº"><span class="section-num">3.1.2</span> åˆ†åŒº</h4>
<p>ä½¿ç”¨fdisk, æˆ‘çš„ç¡¬ç›˜æ˜¯/dev/sda,å¦‚æœè¿˜æœ‰ä¸€å—ç¡¬ç›˜ï¼Œé‚£åº”è¯¥å°±æ˜¯/dev/sdb</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">fdisk /dev/sda
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>n:æ–°å»ºä¸€ä¸ªåˆ†åŒºï¼Œp æŒ‡ä¸»åˆ†åŒºï¼Œe æ˜¯æŒ‡æ‰©å±•åˆ†åŒº(é€»è¾‘åˆ†åŒºæ˜¯å»ºç«‹åœ¨æ‰©å±•åˆ†åŒºä¸Šçš„)
ä¸€å—ç¡¬ç›˜ä¸»åˆ†åŒºåŠ ä¸Šæ‰©å±•åˆ†åŒºæœ€å¤šåªèƒ½æ˜¯4ä¸ª</li>
<li>d: åˆ é™¤</li>
<li>m: æŸ¥è¯¢å…¶ä»–å‘½ä»¤ï¼Œä¸çŸ¥é“æ€ä¹ˆæ“ä½œå°±è¾“å…¥m å§</li>
</ul>
<p>åˆ†åŒºç»“æŸä»¥åï¼Œè¾“å…¥ <code>w</code> å®Œæˆåˆ†åŒº (æˆ‘åˆ†äº†ä¸‰ä¸ªåˆ†åŒº /dev/sda1 -&gt; swap
/dev/sda2 -&gt; / /dev/sda3 -&gt; /home)</p>
<h4 id="æ ¼å¼åŒ–åˆ†åŒº"><span class="section-num">3.1.3</span> æ ¼å¼åŒ–åˆ†åŒº</h4>
<p>æ ¼å¼åŒ– sda2 sda3ä¸ºext4æ ¼å¼ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">mkfs.ext4 /dev/sda2
</span></span><span class="line"><span class="cl">mkfs.ext4 /dev/sda3
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ ¼å¼åŒ–sda1 ä¸ºswap(è™šæ‹Ÿå†…å­˜),ä¸€èˆ¬æ˜¯å†…å­˜çš„ä¸¤å€ï¼Œå½“ç„¶å¦‚æœä½ çš„å†…å­˜å¾ˆå¤§çš„è¯å°±ä¸ç”¨åˆ’è¿™ä¸ªåˆ†åŒºäº†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">mkswap /dev/sda1
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¿€æ´»swap</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">swapon /dev/sda1
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="æŒ‚è½½"><span class="section-num">3.1.4</span> æŒ‚è½½</h4>
<p>å°†sda2æŒ‚è½½åˆ°/mnt,å…¶å®å°±æ˜¯è®©sda2åˆ†åŒºåšç³»ç»Ÿçš„æ ¹åˆ†åŒºï¼Œ/mnt/homeåŒç†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">mount /dev/sda2 /mnt
</span></span><span class="line"><span class="cl">mount /dev/sda3 /mnt/home
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="æ›´æ–°pacmanæº"><span class="section-num">3.1.5</span> æ›´æ–°pacmanæº</h4>
<p>ç½‘æ˜“çš„æºä¸é”™ï¼Œç¼–è¾‘ <code>/etc/pacman.d/mirrorlist</code> æ·»åŠ  <code>Server = http://mirrors.163.com/archlinux/$repo/os/$arch</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">vim /etc/pacman.d/mirrorlist
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åæ·»åŠ ï¼›æ·»åŠ å®Œä¹‹åï¼Œæ›´æ–°ä¸€ä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -Syy
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="å®‰è£…åŸºæœ¬ç³»ç»Ÿ"><span class="section-num">3.1.6</span> å®‰è£…åŸºæœ¬ç³»ç»Ÿ</h4>
<p>å®‰è£…åŸºæœ¬ç³»ç»Ÿåˆ° /mnt,å³sda2åˆ†åŒº</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacstrap /mnt base base-devel
</span></span></code></pre></td></tr></table>
</div>
</div><p>éœ€è¦å®‰è£…çš„éƒ½å®‰è£…å§ï¼Œç„¶åèµ°å¼€ç…®ä¸€æ¯å’–å•¡ï¼Œæ…¢æ…¢å“å°</p>
<h4 id="ç”Ÿæˆfstab"><span class="section-num">3.1.7</span> ç”Ÿæˆfstab</h4>
<p>fstab çš„ä½œç”¨ï¼š</p>
<blockquote>
<p>The fstab(5) file can be used to define how disk partitions, various other block devices, or remote filesystems should be mounted into the filesystem</p>
</blockquote>
<p>ç”Ÿæˆfstab,å¹¶ä¸”æŸ¥çœ‹æ˜¯å¦æ­£ç¡®ç”Ÿæˆfstab</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">genfstab -U -p /mnt &gt;&gt; /mnt/etc/fstab
</span></span><span class="line"><span class="cl">cat /mnt/etc/fstab
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="é…ç½®ç³»ç»Ÿ"><span class="section-num">3.1.8</span> é…ç½®ç³»ç»Ÿ</h4>
<p>åˆ‡æ¢åˆ°æ–°çš„ç³»ç»Ÿï¼Œç„¶åä½ ä¼šå‘ç°å‘½ä»¤è¡Œæç¤ºç¬¦å‘ç”Ÿäº†æ”¹å˜</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">arch-chroot /mnt
</span></span></code></pre></td></tr></table>
</div>
</div><!--list-separator-->
<ol>
<li>
<p>è®¾ç½®åœ°åŒº</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">ln -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<!--list-separator-->
<ol start="2">
<li>
<p>è®¾ç½®è¯­è¨€</p>
<p>ç¼–è¾‘ <code>/etc/locale.gen</code>,å› ä¸ºè¯¥æ–‡ä»¶æ‰€æœ‰çš„ä¿¡æ¯éƒ½æ˜¯è¢«æ³¨é‡Šæ»´ï¼Œæ‰€ä»¥åœ¨æœ€ä¸Šé¢æ·»åŠ <code>en_US.UTF-8 UTF-8</code> å³å¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">vim /etc/locale.gen
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åæ·»åŠ ï¼›æ·»åŠ å®Œæˆåï¼Œæ‰§è¡Œ <code>locale-gen</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">locale-gen
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¥ç€é…ç½® <code>locale.conf</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="nv">LANG</span><span class="o">=</span>en_US.UTF-8 &gt; /etc/locale.conf
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">LANG</span><span class="o">=</span>en_US.UTF-8
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<!--list-separator-->
<ol start="3">
<li>
<p>è®¾ç½®ä¸»æœºå</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">echo</span> samray-arch &gt; /etc/hostname
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<!--list-separator-->
<ol start="4">
<li>
<p>è®¾ç½®å¯†ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">passwd
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<!--list-separator-->
<ol start="5">
<li>
<p>é…ç½®ç½‘ç»œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -S net-tools
</span></span><span class="line"><span class="cl">systemctl <span class="nb">enable</span> dhcpcd.service
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<!--list-separator-->
<ol start="6">
<li>
<p>å®‰è£…GRUB</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -S grub-bios
</span></span></code></pre></td></tr></table>
</div>
</div><p>æŠŠgrub å®‰è£…åˆ°ç¡¬ç›˜sda,å¦‚æœåŒç³»ç»Ÿçš„è¯ï¼Œè¿˜è¦è§†æƒ…å†µåšæ›´æ”¹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">grub-install --recheck /dev/sda
</span></span><span class="line"><span class="cl">grub-mkconfig -o /boot/grub/grub.cfg
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h4 id="æ”¶å°¾å·¥ä½œ"><span class="section-num">3.1.9</span> æ”¶å°¾å·¥ä½œ</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">exit</span>
</span></span><span class="line"><span class="cl">umount /mnt/home
</span></span><span class="line"><span class="cl">umount /mnt
</span></span><span class="line"><span class="cl">reboot
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ ·Arch linux å°±è£…å¥½äº†ï¼Œä¸è¿‡ä½ é‡å¯ä¼šå‘ç°ï¼Œä½ çš„ç³»ç»Ÿæ˜¯æ²¡æœ‰å›¾å½¢åŒ–ç•Œé¢çš„</p>
<h3 id="å®‰è£…æ¡Œé¢ç¯å¢ƒ"><span class="section-num">3.2</span> å®‰è£…æ¡Œé¢ç¯å¢ƒ</h3>
<h4 id="å®‰è£…xæœåŠ¡"><span class="section-num">3.2.1</span> å®‰è£…xæœåŠ¡</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -S xorg-server xorg-server-utils xorg-xinit
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="å®‰è£…æ˜¾å¡é©±åŠ¨"><span class="section-num">3.2.2</span> å®‰è£…æ˜¾å¡é©±åŠ¨</h4>
<p>æŸ¥æ‰¾è‡ªå·±çš„æ˜¾å¡ç±»å‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">ispci <span class="p">|</span>grep VGA
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åæœç´¢åŒ¹é…è‡ªå·±æ˜¾å¡çš„é©±åŠ¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -Ss xf86-video <span class="p">|</span>less
</span></span></code></pre></td></tr></table>
</div>
</div><p>Intel é›†æˆæ˜¾å¡ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -S xf86-video-intel
</span></span></code></pre></td></tr></table>
</div>
</div><p>è™šæ‹Ÿæœºæ˜¾å¡ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -S xf86-video-vesa
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¬”è®°æœ¬è§¦æ‘¸æ¿é©±åŠ¨ (è€å®¶ä¼™æ˜¯å°å¼ï¼Œä¸éœ€è¦äº†):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -S xf86-input-synaptics
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®‰è£…è¾“å…¥æ³•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -S scim-pinyin
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…ˆå®‰è£… slim(å›¾åƒç™»å½•ç®¡ç†å™¨)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -S slim
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®‰è£…xfce4</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pacman -S xfce4
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯åŠ¨xfce4</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">startxfce4
</span></span></code></pre></td></tr></table>
</div>
</div><p>åŸºæœ¬å°±å¤§åŠŸå‘Šæˆäº†ï¼Œå› ä¸ºæˆ‘çš„å°å¼ç”µè„‘æ˜¯bios, æ‰€ä»¥ä¸ç”¨æŠ˜è…¾uefi, è¿˜æœ‰æ— çº¿ç½‘ç»œã€‚</p>
<p><strong>Action is louder than words</strong>,è¿˜æ˜¯å¤šåŠ¨æ‰‹æ‰è¡Œï¼Œæˆ‘éƒ½è£…äº†ä¸‰æ¬¡æ‰æˆåŠŸï¼Œå†…æ ¸ç©ºæŒ‡é’ˆå’Œæ®µé”™è¯¯éƒ½é‡åˆ°äº† :ï¼‰</p>
<h3 id="å‚è€ƒ"><span class="section-num">3.3</span> å‚è€ƒ</h3>
<p><a href="https://wiki.archlinux.org/index.php/installation_guide">https://wiki.archlinux.org/index.php/installation_guide</a></p>
<div center class="qr-container">
<img src="/ox-hugo/qrcode_gh_e06d750e626f_1.jpg" alt="qrcode_gh_e06d750e626f_1.jpg" width="160px" height="160px" center="t" class="qr-container" />
å…¬å·åŒæ­¥æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨ğŸ‘»
</div>
]]></content:encoded>
    </item>
  </channel>
</rss>
